cscope 15 $HOME/work/SILVER               0000871860
	@manage.py

1 #!/
u¤
/
bš
/
’v
 
pythÚ


2 
impÜt
 
os


3 
impÜt
 
sys


5 
	g__Çme__
 == "__main__":

6 
os
.
’vœÚ
.
£tdeçuÉ
("DJANGO_SETTINGS_MODULE", "settings")

7 
	gŒy
:

8 
äom
 
djªgo
.
cÜe
.
mªagem’t
 
impÜt
 
execu‹_äom_commªd_lše


9 
exû±
 
ImpÜtE¼Ü
:

10 #Th
above
 
impÜt
 
may
 
ç
 
some
 
Ùh”
 
»asÚ
. 
Ensu»
 
th©
 
the


11 #issu
is
 
»®ly
 
th©
 
Djªgo
 i 
missšg
 
to
 
avoid
 
maskšg
 
Ùh”


12 #exû±iÚ 
Ú
 
PythÚ
 2.

13 
Œy
:

14 
impÜt
 
djªgo


15 
exû±
 
ImpÜtE¼Ü
:

16 
¿i£
 
ImpÜtE¼Ü
(

21 
¿i£


22 
execu‹_äom_commªd_lše
(
sys
.
¬gv
)

	@settings.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

14 
impÜt
 
os


15 
impÜt
 
d©‘ime


17 
äom
 
sv”
 
impÜt
 
HOOK_EVENTS
 
as
 
_HOOK_EVENTS


18 
äom
 
	gdjªgo
.
	guts
.
log
 
impÜt
 
DEFAULT_LOGGING
 
as
 
	gLOGGING


21 
The£
 
£‰šgs
 
¬e
 
u£d
 
by
 
	gthe
 ``
	gmªage
.
	gpy
`` 
	gcommªd
.

25 
	gDEBUG
 = 
F®£


27 
SITE_ID
 = 1

29 
USE_TZ
 = 
True


30 
TIME_ZONE
 = 'UTC'

32 
DATABASES
 = {

39 
EXTERNAL_APPS
 = [

40 #DjªgØ
autocom¶‘e


44 #DjªgØ
cÜe
 
­ps


45 #'
djªgo_admš_boÙ¡¿µed
',

54 #Requœed 
­ps


59 #Dev 
toŞs


60 #'
djªgo_ex‹nsiÚs
',

63 
	gINTERNAL_APPS
 = [

67 
	gINSTALLED_APPS
 = 
EXTERNAL_APPS
 + 
INTERNAL_APPS


69 
ROOT_URLCONF
 = 'silver.urls'

70 
PROJECT_ROOT
 = 
os
.
·th
.
	$dœÇme
(
__fe__
)

72 
FIXTURE_DIRS
 = (

73 
PROJECT_ROOT
,

74 
PROJECT_ROOT
 + '/silver/'

77 
TEMPLATES
 = [

80 'APP_DIRS': 
True
,

82 
PROJECT_ROOT
 + '/payment_processors/templates/',

83 
PROJECT_ROOT
 + '/templates/',

84 
PROJECT_ROOT
 + '/silver/templates/',

97 
	}
}

100 
MEDIA_ROOT
 = 
PROJECT_ROOT
 + '/app_media/'

101 
MEDIA_URL
 = '/app_media/'

103 
STATIC_ROOT
 = 
PROJECT_ROOT
 + '/app_static/'

104 
STATIC_URL
 = '/app_static/'

106 
MIDDLEWARE_CLASSES
 = (

115 
	gSECRET_KEY
 = 'secret'

117 
REST_FRAMEWORK
 = {

121 
HOOK_EVENTS
 = 
_HOOK_EVENTS


123 
SILVER_DEFAULT_DUE_DAYS
 = 5

124 
SILVER_DOCUMENT_PREFIX
 = 'documents/'

125 
SILVER_DOCUMENT_STORAGE
 = 
NÚe


126 
SILVER_PAYMENT_TOKEN_EXPIRATION
 = 
d©‘ime
.
	$timed–
(
mšu‹s
=5)

127 
SILVER_AUTOMATICALLY_CREATE_TRANSACTIONS
 = 
True


129 
LOGGING
['loggers']['xhtml2pdf'] = {

132 
	}
}

134 
LOGGING
['loggers']['pisa'] = {

139 
LOGGING
['loggers']['django'] = {

144 
LOGGING
['loggers']['django.security'] = {

148 
LOGGING
['fÜm©‹rs'] = LOGGING.
g‘
('formatters', {})

149 
	gLOGGING
['formatters']['verbose'] = {

154 
EMAIL_BACKEND
 = 'django.core.mail.backends.console.EmailBackend'

156 
PAYMENT_PROCESSORS
 = {

162 
PAYMENT_METHOD_SECRET
 = 
b
'YOUR_FERNET_KEY_HERE' #F”Ãt.
	$g’”©e_key
()

164 
CELERY_BROKER_URL
 = 'redis://localhost:6379/'

165 
CELERY_BEAT_SCHEDULE
 = {

168 'scheduË': 
d©‘ime
.
	`timed–
(
£cÚds
=5)

170 
	}
}

171 
	gLOCK_MANAGER_CONNECTION
 = {'host': 'localhost', 'port': 6379, 'db': 1}

173 
PDF_GENERATION_TIME_LIMIT
 = 60

175 
TRANSACTION_SAVE_TIME_LIMIT
 = 5

177 
Œy
:

178 
äom
 
£‰šgs_loÿl
 
impÜt
 *

179 
exû±
 
ImpÜtE¼Ü
:

180 
·ss


	@settings_test.py

1 
äom
 
£‰šgs
 
impÜt
 *

3 
	gŒigg”ed_´oûssÜ
 = 'triggered'

4 
mªu®_´oûssÜ
 = 'manual'

5 
çšg_void_´oûssÜ
 = 'failing_void'

7 
PAYMENT_PROCESSORS
 = {

8 
Œigg”ed_´oûssÜ
: {

11 
mªu®_´oûssÜ
: {

14 
çšg_void_´oûssÜ
: {

	@setup.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 #-*- 
’codšg
: 
utf
-8 -*-

18 
PythÚ
 
£tup
 
fe
 
the
 
sv”
 
	g­p
.

20 
In
 
Üd”
 
to
 
your
 
­p
 
©
 
	gpypi
.
	gpythÚ
.
	gÜg
, 
ü—‹
 
ª
 
accouÁ
‡t

21 
	gpypi
.
	gpythÚ
.
Üg
 
ªd
 
	glogš
, 
th’
 
your
 
Ãw
 
­p
 
like
 
	gso
:

23 
pythÚ
 
£tup
.
py
 

25 
If
 
your
 
Çme
 
is
 
¡l
 
ä“
, 
you
 
ÿn
 
now
 
make
 you¸
fœ¡
 
»Ëa£
 
but
 first you

26 
should
 
check
 
you
 
¬e
 
u¶ßdšg
 
the
 
cÜ»ù
 
	gfes
:

28 
pythÚ
 
£tup
.
py
 
sdi¡


30 
In¥eù
 
the
 
ouut
 
thÜoughly
. 
Th”e
 
shouldn
't be‡nyemp files‡nd if your

31 
­p
 
šşudes
 
¡©icfes
 
Ü
 
‹m¶©es
, 
make
 
su»
 
th©
 
they
 
­³¬
 
š
 
the
 
	gli¡
.

32 
If
 
som‘hšg
 
is
 
	gwrÚg
, 
you
 
Ãed
 
to
 
ed™
 
	gMANIFEST
.
š
 
ªd
 
run
 
the
 
commªd
 
	gagaš
.

34 
If
 
®l
 
looks
 
	ggood
, 
you
 
ÿn
 
make
 
your
 
fœ¡
 
	g»Ëa£
:

36 
pythÚ
 
£tup
.
py
 
sdi¡
 
u¶ßd


38 
FÜ
 
Ãw
 
»Ëa£s
, 
you
 
Ãed
 
to
 
bump
 
the
 
v”siÚ
 
numb”
 
š


39 
	gsv”
/
	g__š™__
.
py
 
ªd
 
	g»
-
run
 
the
 
above
 
	gcommªd
.

41 
FÜ
 
mÜe
 
šfÜm©iÚ
 
Ú
 
ü—tšg
 
sourû
 
	gdi¡ributiÚs
, 
£e


42 
	gh‰p
:

46 
impÜt
 
os


47 
äom
 
£tu±oŞs
 
impÜt
 
£tup
, 
fšd_·ckages


50 
	gš¡®l_»quœes
 = [
lše
.
	$¡r
()

51 
lše
 
š
 
	`İ’
("»quœem’ts/commÚ.txt").
	$»adlšes
()

52 
nÙ
 
lše
.
	`¡r
().
	`¡¬tsw™h
('#')]

55 
def
 
	$»ad
(
âame
):

56 
Œy
:

57  
	`İ’
(
os
.
·th
.
	`još
(os.·th.
	`dœÇme
(
__fe__
), 
âame
)).
	$»ad
()

58 
exû±
 
IOE¼Ü
:

61 
	`£tup
(

62 
Çme
="django-silver",

63 
v”siÚ
='0.4.4',

64 
desütiÚ
=
	`»ad
('DESCRIPTION'),

65 
lÚg_desütiÚ
=
	`»ad
('README.rst'),

66 
liûn£
='Apache 2.0',

67 
¶©fÜms
=['OS Independent'],

68 
keywÜds
='django,‡pp,„eusable, billing, invoicing,‡pi',

69 
authÜ
='Presslabs',

70 
authÜ_ema
='ping@presslabs.com',

71 
u¾
='http://www.presslabs.com/silver/',

72 
·ckages
=
	`fšd_·ckages
(),

73 
exŒas_»quœe
={

75 
	}
},

76 
	gšşude_·ckage_d©a
=
True
,

77 
	gš¡®l_»quœes
=
š¡®l_»quœes
,

78 
	gşassif›rs
=[

	@silver/__init__.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 #-*- 
codšg
: 
utf
-8 -*-

18 
	gHOOK_EVENTS
 = {

19 #'
ªy
.
ev’t
.
Çme
': '
Aµ
.
Mod–
.
AùiÚ
' (created/updated/deleted)

	@silver/admin.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
os


17 
impÜt
 
”ºo


18 
impÜt
 
loggšg


19 
impÜt
 
»que¡s


20 
äom
 
cŞËùiÚs
 
impÜt
 
Ord”edDiù


22 
äom
 
PyPDF2
 
impÜt
 
	gPdfFeR—d”
, 
PdfFeM”g”


23 
äom
 
d®
 
impÜt
 
autocom¶‘e


25 
äom
 
djªgo
 
impÜt
 
fÜms


26 
äom
 
	gdjªgo
.
cÜe
 
impÜt
 
u¾»sŞv”s


27 
äom
 
	gdjªgo
.
cÚŒib
 
impÜt
 
mes§ges


28 
äom
 
	gdjªgo
.
	gcÚŒib
.
admš
 
	$impÜt
 (
h–³rs
, 
s™e
, 
TabuÏrIÆše
, 
Mod–Admš
,

29 
Sim¶eLi¡F‹r
)

30 
äom
 
djªgo
.
cÚŒib
.
admš
.
aùiÚs
 
impÜt
 
d–‘e_£Ëùed
 
as
 
d–‘e_£Ëùed_


31 
äom
 
djªgo
.
cÚŒib
.
admš
.
mod–s
 
impÜt
 
LogEÁry
, 
CHANGE


32 
äom
 
djªgo
.
cÚŒib
.
cÚ‹Áty³s
.
mod–s
 
impÜt
 
CÚ‹ÁTy³


33 
äom
 
djªgo
.
cÜe
.
exû±iÚs
 
impÜt
 
V®id©iÚE¼Ü


34 
äom
 
djªgo
.
db
 
impÜt
 
cÚÃùiÚs


35 
äom
 
djªgo
.
db
.
mod–s
 
impÜt
 
BLANK_CHOICE_DASH


36 
äom
 
djªgo
.
fÜms
 
impÜt
 
ChoiûF›ld


37 
äom
 
djªgo
.
uts
.
html
 
impÜt
 
esÿ³


38 
äom
 
djªgo_fsm
 
impÜt
 
T¿ns™iÚNÙAÎowed


39 
äom
 
djªgo
.
cÜe
.
u¾»sŞv”s
 
impÜt
 
»v”£


40 
äom
 
djªgo
.
uts
.
Œª¦©iÚ
 
impÜt
 
ug‘‹xt_Ïzy
 
as
 
_


41 
äom
 
djªgo
.
uts
 
impÜt
 
timezÚe


42 
äom
 
djªgo
.
shÜtcuts
 
impÜt
 
»nd”


43 
äom
 
djªgo
.
h‰p
 
impÜt
 
H‰pRe¥Ú£


45 
äom
 
sv”
.
uts
.
š‹º©iÚ®
 
impÜt
 
cu¼’c›s


46 
äom
 
sv”
.
uts
.
·ym’ts
 
impÜt
 
g‘_·ym’t_u¾


47 
äom
 
sv”
.
·ym’t_´oûssÜs
.
mixšs
 
impÜt
 
Paym’tProûssÜTy³s


49 
äom
 
mod–s
 
	$impÜt
 (
PÏn
, 
M‘”edF—tu»
, 
SubsütiÚ
, 
Cu¡om”
, 
Provid”
,

50 
M‘”edF—tu»Un™sLog
, 
Invoiû
, 
Docum’tEÁry
,

51 
ProduùCode
, 
ProfÜma
, 
BlšgLog
, 
BlšgDocum’tBa£
,

52 
T¿n§ùiÚ
, 
Paym’tM‘hod
)

53 
äom
 
docum’ts_g’”©Ü
 
impÜt
 
Docum’tsG’”©Ü


56 
logg”
 = 
loggšg
.
	`g‘Logg”
('silver')

59 
def
 
	$m‘ad©a
(
obj
):

60 
d
 = 
u
'(None)'

61 
obj
.
m‘a
:

62 
d
 = 
u
''

63 
key
, 
v®ue
 
š
 
obj
.
m‘a
.
	$™”™ems
():

64 
d
 +ğ
u
'%s: <code>%s</code><br>' % (
	`esÿ³
(
key
), 
	$esÿ³
(
v®ue
))

65  
d


66 
m‘ad©a
.
®low_gs
 = 
True


69 
def
 
	$x
(
obj
):

70  ("{} {:.2f}%".
	$fÜm©
(
obj
.
§Ës_x_Çme
, obj.
§Ës_x_³rûÁ
)

71 
obj
.
§Ës_x_³rûÁ
 > 0 '')

72 
x
.
admš_Üd”_f›ld
 = 'sales_tax_percent'

75 
şass
 
	$LiveMod–Admš
(
Mod–Admš
):

76 
def
 
	$g‘_qu”y£t
(
£lf
, 
»que¡
):

77 
qs
 = 
£lf
.
mod–
.
®l_objeùs
.
	$g‘_qu”y£t
()

78 
Üd”šg
 = 
£lf
.
	$g‘_Üd”šg
(
»que¡
)

79 
Üd”šg
:

80 
qs
 = qs.
	$Üd”_by
(*
Üd”šg
)

81  
qs


83 
def
 
	$d–‘e_mod–
(
£lf
, 
»que¡
, 
obj
):

84 'h¬d_d–‘e' 
š
 
	$dœ
(
obj
):

85 
obj
.
	$h¬d_d–‘e
()

87 
	`su³r
(
LiveMod–Admš
, 
£lf
).
	$d–‘e_mod–
(
»que¡
, 
obj
)

89 
def
 
	$d–‘e_£Ëùed
(
£lf
, 
»que¡
, 
qu”y£t
):

90 'h¬d_d–‘e' 
š
 
	$dœ
(
qu”y£t
):

91 
qu”y£t
.
d–‘e
 = qu”y£t.
h¬d_d–‘e


92  
	$d–‘e_£Ëùed_
(
£lf
, 
»que¡
, 
qu”y£t
)

94 
d–‘e_£Ëùed
.
shÜt_desütiÚ
 = 
	`_
("Delete selected "

97 
aùiÚs
 = ['delete_selected']

100 
şass
 
	$PÏnFÜm
(
fÜms
.
Mod–FÜm
):

101 
şass
 
M‘a
:

102 
mod–
 = 
PÏn


103 
f›lds
 = ('provider', 'name', 'product_code', 'interval',

109 
def
 
	$ş—n
(
£lf
):

110 
m‘”ed_ã©u»s
 = 
£lf
.
ş—Ãd_d©a
.
	`g‘
('metered_features')

111 
PÏn
.
	$v®id©e_m‘”ed_ã©u»s
(
m‘”ed_ã©u»s
)

112  
£lf
.
ş—Ãd_d©a


115 
şass
 
	$PÏnAdmš
(
Mod–Admš
):

116 
li¡_di¥Ïy
 = ['name', 'description', 'interval_display',

118 
£¬ch_f›lds
 = ['name']

119 
li¡_f‹r
 = ['provider']

120 
fÜm
 = 
PÏnFÜm


122 
def
 
	$š‹rv®_di¥Ïy
(
£lf
, 
obj
):

123  ('{:d} {}s'.
	$fÜm©
(
obj
.
š‹rv®_couÁ
, obj.
š‹rv®
)

124 
obj
.
š‹rv®_couÁ
 != 1

125 '{:d} {}'.
	$fÜm©
(
obj
.
š‹rv®_couÁ
, obj.
š‹rv®
))

126 
š‹rv®_di¥Ïy
.
shÜt_desütiÚ
 = 'Interval'

128 
def
 
	$desütiÚ
(
£lf
, 
obj
):

129 
d
 = 
u
'SubsütiÚ: <code>{:.2f} {}</code><br>'.
	$fÜm©
(
obj
.
amouÁ
,

130 
obj
.
cu¼’cy
)

131 
fmt
 = 
u
'{name}: <code>{price:.2f} {currency}</code>'

132 
f
 
š
 
obj
.
m‘”ed_ã©u»s
.
	$®l
():

133 
d
 +ğ
fmt
.
	$fÜm©
(

134 
Çme
=
f
.name,

135 
´iû
=
f
.
´iû_³r_un™
,

136 
cu¼’cy
=
obj
.currency,

138 
f
.
šşuded_un™s
 > 0:

139 
d
 +ğ
u
'<code> ({:.2f} inşuded)</code>'.
	$fÜm©
(
f
.
šşuded_un™s
)

140 
d
 +ğ
u
'<br>'

141  
d


142 
desütiÚ
.
®low_gs
 = 
True


145 
şass
 
	$M‘”edF—tu»Un™sLogInLše
(
TabuÏrIÆše
):

146 
mod–
 = 
M‘”edF—tu»Un™sLog


147 
li¡_di¥Ïy
 = ['metered_feature']

148 
»adÚly_f›lds
 = ('start_date', 'end_date', )

149 
exŒa
 = 0

151 
def
 
	$g‘_fÜm£t
(
£lf
, 
»que¡
, 
obj
=
NÚe
, **
kw¬gs
):

152 
£lf
.
·»Á_obj
 = 
obj


153  
	`su³r
(
M‘”edF—tu»Un™sLogInLše
, 
£lf
).
	$g‘_fÜm£t
(

154 
»que¡
, 
obj
, **
kw¬gs
)

156 
def
 
	$fÜmf›ld_fÜ_fÜeignkey
(
£lf
, 
db_f›ld
, 
»que¡
=
NÚe
, **
kw¬gs
):

157 
db_f›ld
.
Çme
 =ğ'm‘”ed_ã©u»' 
ªd
 
	`ha§‰r
(
£lf
, 'parent_obj'):

158 
£lf
.
·»Á_obj
:

159 
kw¬gs
['qu”y£t'] = 
db_f›ld
.
»l
.
to
.
objeùs
.
	`f‹r
(**{

160 '¶ª': 
£lf
.
·»Á_obj
.
¶ª


161 
	}
})

162  
su³r
(
M‘”edF—tu»Un™sLogInLše
,

163 
£lf
).
	$fÜmf›ld_fÜ_fÜeignkey
(
db_f›ld
, 
»que¡
,

164 **
kw¬gs
)

167 
şass
 
	$BlšgLogInLše
(
TabuÏrIÆše
):

168 
mod–
 = 
BlšgLog


169 
f›lds
 = ['billing_date', 'plan_billed_up_to', 'metered_features_billed_up_to',

171 
»adÚly_f›lds
 = 
f›lds


172 
v”bo£_Çme
 = 'Automatic billing†og'

173 
v”bo£_Çme_¶u¿l
 = 
v”bo£_Çme


175 
def
 
	$has_add_³rmissiÚ
(
£lf
, 
»que¡
):

176  
F®£


178 
def
 
	$has_d–‘e_³rmissiÚ
(
£lf
, 
»que¡
, 
obj
=
NÚe
):

179  
F®£


181 
def
 
	$švoiû_lšk
(
£lf
, 
obj
):

182  
obj
.
švoiû
.
admš_chªge_u¾
 obj.invoice 'None'

183 
švoiû_lšk
.
shÜt_desütiÚ
 = 'Invoice'

184 
švoiû_lšk
.
®low_gs
 = 
True


186 
def
 
	$´ofÜma_lšk
(
£lf
, 
obj
):

187  
obj
.
´ofÜma
.
admš_chªge_u¾
 obj.proforma 'None'

188 
´ofÜma_lšk
.
shÜt_desütiÚ
 = 'Proforma'

189 
´ofÜma_lšk
.
®low_gs
 = 
True


192 
şass
 
	$SubsütiÚAdmš
(
Mod–Admš
):

193 
li¡_di¥Ïy
 = ['customer', 'plan', 'last_billing_date', 'trial_end',

194 '¡¬t_d©e', '’ded_©', '¡©e', 
m‘ad©a
]

195 
li¡_f‹r
 = ['plan', 'state', 'plan__provider', 'customer']

196 
»adÚly_f›lds
 = ['state', ]

197 
aùiÚs
 = ['activate', 'cancel_now', 'cancel_at_end_of_cycle', 'end']

198 
£¬ch_f›lds
 = ['customer__first_name', 'customer__last_name',

200 
šlšes
 = [
M‘”edF—tu»Un™sLogInLše
, 
BlšgLogInLše
]

202 
def
 
	$g‘_qu”y£t
(
£lf
, 
»que¡
):

203  
	`su³r
(
SubsütiÚAdmš
, 
£lf
).
	`g‘_qu”y£t
(
»que¡
) \

204 .
	`´eãtch_»Ï‹d
('billing_logs')

206 
def
 
	$³rfÜm_aùiÚ
(
£lf
, 
»que¡
, 
aùiÚ
, 
qu”y£t
):

207 
Œy
:

208 
m‘hod
 = 
	$g‘©Œ
(
SubsütiÚ
, 
aùiÚ
)

209 
exû±
 
A‰ribu‹E¼Ü
:

210 
£lf
.
	`mes§ge_u£r
(
»que¡
, 'IÎeg®‡ùiÚ.', 
Ëv–
=
mes§ges
.
ERROR
)

213 
çed_couÁ
 = 0

214 
qu”y£t_couÁ
 = 
qu”y£t
.
	$couÁ
()

215 
’Œy
 
š
 
qu”y£t
:

216 
Œy
:

217 
	$m‘hod
(
’Œy
)

218 
’Œy
.
	$§ve
()

220 
LogEÁry
.
objeùs
.
	`log_aùiÚ
(

221 
u£r_id
=
»que¡
.
u£r
.
id
,

222 
cÚ‹Á_ty³_id
=
CÚ‹ÁTy³
.
objeùs
.
	`g‘_fÜ_mod–
(
’Œy
).
pk
,

223 
objeù_id
=
’Œy
.
id
,

224 
objeù_»´
=
	`unicode
(
’Œy
),

225 
aùiÚ_æag
=
CHANGE
,

226 
chªge_mes§ge
='{aùiÚ}‡ùiÚ in™Ÿ‹d by u£r.'.
	`fÜm©
(

227 
aùiÚ
÷ùiÚ.
	`»¶aû
('_', ' ').
	`¡r
().
	$ÿp™®ize
()

230 
exû±
 
T¿ns™iÚNÙAÎowed
:

231 
çed_couÁ
 += 1

232 
çed_couÁ
:

233 
çed_couÁ
 =ğ
qu”y£t_couÁ
:

234 
£lf
.
	`mes§ge_u£r
(
»que¡
, 'Illegal state change‡ttempt.',

235 
Ëv–
=
mes§ges
.
ERROR
)

237 
£lf
.
	`mes§ge_u£r
(
»que¡
, '%d state(s) changed (%d failed).' %

238 (
qu”y£t_couÁ
 - 
çed_couÁ
, failed_count),

239 
Ëv–
=
mes§ges
.
WARNING
)

241 
£lf
.
	`mes§ge_u£r
(
»que¡
, 'Successfully changed %d state(s).' %

242 
qu”y£t_couÁ
)

244 
def
 
	$aùiv©e
(
£lf
, 
»que¡
, 
qu”y£t
):

245 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 'aùiv©e', 
qu”y£t
)

246 
aùiv©e
.
shÜt_desütiÚ
 = 'Activatehe selected Subscription(s) '

248 
def
 
	$»aùiv©e
(
£lf
, 
»que¡
, 
qu”y£t
):

249 #NOTE: 
d—ùiv©ed
 
now


250 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, '»aùiv©e', 
qu”y£t
)

251 
»aùiv©e
.
shÜt_desütiÚ
 = 'Reactivatehe selected Subscription(s) '

253 
def
 
	$ÿnûl_now
(
£lf
, 
»que¡
, 
qu”y£t
):

254 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, '_ÿnûl_now', 
qu”y£t
)

255 
ÿnûl_now
.
shÜt_desütiÚ
 = 'Cancelhe selected Subscription(s)‚ow'

257 
def
 
	$ÿnûl_©_’d_of_cyşe
(
£lf
, 
»que¡
, 
qu”y£t
):

258 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, '_ÿnûl_©_’d_of_blšg_cyşe', 
qu”y£t
)

259 
ÿnûl_©_’d_of_cyşe
.
shÜt_desütiÚ
 = 'Cancelhe '\

263 
def
 
	$’d
(
£lf
, 
»que¡
, 
qu”y£t
):

264 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, '’d', 
qu”y£t
)

265 
’d
.
shÜt_desütiÚ
 = 'Endhe selected Subscription(s) '

268 
şass
 
	$Cu¡om”Admš
(
LiveMod–Admš
):

269 
f›lds
 = ['company', 'first_name', 'last_name', 'customer_reference',

274 
li¡_di¥Ïy
 = ['__unicode__', 'customer_reference',

275 
x
, 'cÚsŞid©ed_blšg', 
m‘ad©a
]

276 
£¬ch_f›lds
 = ['customer_reference', 'first_name', 'last_name', 'company',

279 
aùiÚs
 = ['generate_all_documents']

280 
exşude
 = ['live']

282 
def
 
	$g’”©e_®l_docum’ts
(
£lf
, 
»que¡
, 
qu”y£t
):

283 
»que¡
.
POST
.
	`g‘
('post'):

284 
blšg_d©e
 = 
timezÚe
.
	`now
().
	$d©e
()

285 
	`Docum’tsG’”©Ü
().
	$g’”©e
(
blšg_d©e
=billing_date,

286 
cu¡om”s
=
qu”y£t
,

287 
fÜû_g’”©e
=
True
)

289 
msg
 = 'Successfully generated‡ll user{term} documents.'

290 
qu”y£t
.
	`couÁ
() > 1:

291 
msg
 = msg.
	`fÜm©
(
‹rm
='s\'')

293 
msg
 = msg.
	`fÜm©
(
‹rm
='\'s')

294 
£lf
.
	$mes§ge_u£r
(
»que¡
, 
msg
)

296  
NÚe


298 
aùive_subs
 = []

299 
ÿnûËd_subs
 = []

300 
cu¡om”
 
š
 
qu”y£t
:

301 
subs
 = 
cu¡om”
.
subsütiÚs
.
	$®l
()

302 
sub
 
š
 
subs
:

303 
sub
.
¡©e
 =ğ
SubsütiÚ
.
STATES
.
ACTIVE
:

304 
aùive_subs
.
	$­³nd
(
sub
)

305 
–if
 
sub
.
¡©e
 =ğ
SubsütiÚ
.
STATES
.
CANCELED
:

306 
ÿnûËd_subs
.
	$­³nd
(
sub
)

308 
	`Ën
(
aùive_subs
è+†’(
ÿnûËd_subs
) == 0:

309 
msg
 = 'The user does‚ot have‡ny‡ctive or canceled documents.'

310 
£lf
.
	$mes§ge_u£r
(
»que¡
, 
msg
, 
Ëv–
=
mes§ges
.
WARNING
)

311  
NÚe


313 
cÚ‹xt
 = {

314 't™Ë': 
	`_
('Are you sure?'),

315 'aùive_subsütiÚs': 
aùive_subs
,

316 'ÿnûËd_subsütiÚs': 
ÿnûËd_subs
,

317 'qu”y£t': 
qu”y£t
,

318 'aùiÚ_checkbox_Çme': 
h–³rs
.
ACTION_CHECKBOX_NAME
,

319 'İts': 
£lf
.
mod–
.
_m‘a


321 
	}
}

322  
»nd”
(
»que¡
, 'admš/issue_®l_cu¡om”_docum’ts.html', 
cÚ‹xt
)

323 
	gg’”©e_®l_docum’ts
.
	gshÜt_desütiÚ
 = 'Generate‡ll user\'s Invoices‡nd Proformas'

326 
şass
 
	$Provid”Admš
(
LiveMod–Admš
):

327 
f›lds
 = ['company', 'name', 'email', 'address_1', 'address_2', 'city',

333 
li¡_di¥Ïy
 = ['__unicode__', 'invoice_series_list_display',

334 '´ofÜma_£r›s_li¡_di¥Ïy', 
m‘ad©a
]

335 
£¬ch_f›lds
 = ['customer_reference', 'name', 'company', 'address_1',

338 
aùiÚs
 = ['generate_monthly_totals']

339 
exşude
 = ['live']

341 
def
 
	$švoiû_£r›s_li¡_di¥Ïy
(
£lf
, 
obj
):

342  '{}-{}'.
	$fÜm©
(
obj
.
švoiû_£r›s
, obj.
švoiû_¡¬tšg_numb”
)

343 
švoiû_£r›s_li¡_di¥Ïy
.
shÜt_desütiÚ
 = 'Invoice series starting‚umber'

345 
def
 
	$´ofÜma_£r›s_li¡_di¥Ïy
(
£lf
, 
obj
):

346  '{}-{}'.
	$fÜm©
(
obj
.
´ofÜma_£r›s
,

347 
obj
.
´ofÜma_¡¬tšg_numb”
)

348 
´ofÜma_£r›s_li¡_di¥Ïy
.
shÜt_desütiÚ
 = 'Proforma series starting‚umber'

350 
def
 
	$_compu‹_mÚthly_tÙ®s
(
£lf
, 
mod–_kÏss
, 
´ovid”
, 
docum’ts
):

351 
kÏss_Çme_¶u¿l
 = 
mod–_kÏss
.
__Çme__
 + 's'

353 
tÙ®s
 = {
	}
}

354 
tÙ®s
[
kÏss_Çme_¶u¿l
] = 
	$Ord”edDiù
()

356 
®l_docum’ts
 = 
docum’ts
.
	$f‹r
(
´ovid”
=provider)

357 
·id_docum’ts
 = 
docum’ts
.
	$f‹r
(

358 
´ovid”
=provider,

359 
¡©e
=
BlšgDocum’tBa£
.
STATES
.
PAID


361 
docum’ts_mÚths
 = 
docum’ts
.
	`Üd”_by
().
	`f‹r
(

362 
´ovid”
=provider

363 ).
	`v®ues
(

365 ).
	$di¡šù
()

367 
tÙ®_d¿á
 = 
	`sum
(

368 
doc
.
tÙ®
 doø
	`š
 (

369 
docum’ts
.
	$f‹r
(

370 
´ovid”
=provider,

371 
¡©e
=
BlšgDocum’tBa£
.
STATES
.
DRAFT


376 
tÙ®s
[
kÏss_Çme_¶u¿l
]['d¿á_tÙ®'] = 
	$¡r
(
tÙ®_d¿á
)

377 
tÙ®s
[
kÏss_Çme_¶u¿l
]['’Œ›s'] = 
	$Ord”edDiù
()

378 
docum’ts_mÚths
 = 
	`sÜ‹d
([
mÚth
['month']

379 
mÚth
 
š
 
docum’ts_mÚths


380 
mÚth
['month']])

381 
mÚth_v®ue
 
š
 
docum’ts_mÚths
:

382 
mÚth_v®ue
 
is
 
NÚe
:

384 
di¥Ïy_d©e
 = 
mÚth_v®ue
.
	`¡ráime
('%B %Y')

385 
tÙ®s
[
kÏss_Çme_¶u¿l
]['’Œ›s'][
di¥Ïy_d©e
] = 
	$Ord”edDiù
()

387 
®l_docum’ts_äom_mÚth
 = 
®l_docum’ts
.
	$f‹r
(

388 
issue_d©e__mÚth
=
mÚth_v®ue
.
mÚth
,

389 
issue_d©e__y—r
=
mÚth_v®ue
.
y—r


391 
·id_docum’ts_äom_mÚth
 = 
·id_docum’ts
.
	$f‹r
(

392 
issue_d©e__mÚth
=
mÚth_v®ue
.
mÚth
,

393 
issue_d©e__y—r
=
mÚth_v®ue
.
y—r


395 
tÙ®
 = 
	$sum
(
švoiû
.
tÙ®
 švoiû 
š
 
®l_docum’ts_äom_mÚth
)

396 
tÙ®_·id
 = 
	$sum
(
švoiû
.
tÙ®
 švoiû 
š
 
·id_docum’ts_äom_mÚth
)

397 
tÙ®s
[
kÏss_Çme_¶u¿l
]['’Œ›s'][
di¥Ïy_d©e
]['tÙ®'] = 
	$¡r
(
tÙ®
)

398 
tÙ®s
[
kÏss_Çme_¶u¿l
]['’Œ›s'][
di¥Ïy_d©e
]['·id'] = 
	$¡r
(
tÙ®_·id
)

399 
tÙ®s
[
kÏss_Çme_¶u¿l
]['’Œ›s'][
di¥Ïy_d©e
]['uÅaid'] = 
	`¡r
(
tÙ®
 - 
tÙ®_·id
)

401  
tÙ®s


403 
def
 
	$g’”©e_mÚthly_tÙ®s
(
£lf
, 
»que¡
, 
qu”y£t
):

404 
tÙ®s
 = {
	}
}

406 
švoiûs
 = 
Invoiû
.
objeùs
.
exŒa
(

407 
£Ëù
={

408 'mÚth': 
cÚÃùiÚs
[
Invoiû
.
objeùs
.
db
].
İs
.
d©e_Œunc_sql
(

412 ).
	$f‹r
(

413 
´ovid”__š
=
qu”y£t
,

414 
¡©e__š
=[
BlšgDocum’tBa£
.
STATES
.
DRAFT
,

415 
BlšgDocum’tBa£
.
STATES
.
ISSUED
,

416 
BlšgDocum’tBa£
.
STATES
.
PAID
]

419 
´ofÜmas
 = 
ProfÜma
.
objeùs
.
	`exŒa
(

420 
£Ëù
={

421 'mÚth': 
cÚÃùiÚs
[
Invoiû
.
objeùs
.
db
].
İs
.
	`d©e_Œunc_sql
(

424 
	}
}

425 ).
	$f‹r
(

426 
´ovid”__š
=
qu”y£t
,

427 
¡©e__š
=[
BlšgDocum’tBa£
.
STATES
.
DRAFT
,

428 
BlšgDocum’tBa£
.
STATES
.
ISSUED
,

429 
BlšgDocum’tBa£
.
STATES
.
PAID
]

432 
´ovid”
 
š
 
qu”y£t
:

433 
tÙ®s
[
´ovid”
.
Çme
] = 
	$Ord”edDiù
()

434 
švoiûs_tÙ®
 = 
£lf
.
	$_compu‹_mÚthly_tÙ®s
(
Invoiû
, 
´ovid”
,

435 
švoiûs
)

436 
tÙ®s
[
´ovid”
.
Çme
].
	$upd©e
(
švoiûs_tÙ®
)

438 
´ofÜmas_tÙ®
 = 
£lf
.
	$_compu‹_mÚthly_tÙ®s
(
ProfÜma
, 
´ovid”
,

439 
´ofÜmas
)

440 
tÙ®s
[
´ovid”
.
Çme
].
	$upd©e
(
´ofÜmas_tÙ®
)

442 
cÚ‹xt
 = {

443 't™Ë': 
	`_
('Monthlyotals'),

444 'tÙ®s': 
tÙ®s
,

445 'qu”y£t': 
qu”y£t
,

446 'İts': 
£lf
.
mod–
.
_m‘a


447 
	}
}

449  
»nd”
(
»que¡
, 'admš/mÚthly_tÙ®s.html', 
cÚ‹xt
)

451 
	gg’”©e_mÚthly_tÙ®s
.
	gshÜt_desütiÚ
 = 'Generate monthlyotals'

454 
şass
 
	$Docum’tEÁryFÜm
(
fÜms
.
Mod–FÜm
):

456 
şass
 
M‘a
:

457 
mod–
 = 
Docum’tEÁry


458 
f›lds
 = ('description', 'prorated', 'product_code', 'unit',

460 
widg‘s
 = {

461 'desütiÚ': 
fÜms
.
	`Tex»a
(
©Œs
={'cols': 50, 'rows': 3})

462 
	}
}

465 
şass
 
	$Docum’tEÁryIÆše
(
TabuÏrIÆše
):

466 
mod–
 = 
Docum’tEÁry


467 
fÜm
 = 
Docum’tEÁryFÜm


468 
exŒa
 = 0

471 
şass
 
	$BlšgDocum’tFÜm
(
fÜms
.
Mod–FÜm
):

472 
Œª§ùiÚ_cu¼’cy
 = 
	`ChoiûF›ld
(

473 
choiûs
=(
BLANK_CHOICE_DASH
 + 
	`li¡
(
cu¼’c›s
)), 
»quœed
=
F®£
,

476 
def
 
	$__š™__
(
£lf
, *
¬gs
, **
kw¬gs
):

477 #Ià
™
's‡nƒdit‡ction, savehe…rovider‡ndhe‚umber. Checkhe

478 #§ve(è
m‘hod
 
to
 
£e
 
theœ
 
u£fuÊess
.

479 
š¡ªû
 = 
kw¬gs
.
	`g‘
('instance')

480 
£lf
.
š™Ÿl_numb”
 = 
š¡ªû
.
numb”
 š¡ªû 
NÚe


481 
£lf
.
š™Ÿl_£r›s
 = 
š¡ªû
.
£r›s
 š¡ªû 
NÚe


482 
£lf
.
´ovid”
 = 
š¡ªû
.´ovid” š¡ªû 
NÚe


484 
	`su³r
(
BlšgDocum’tFÜm
, 
£lf
).
	$__š™__
(*
¬gs
, **
kw¬gs
)

486 
def
 
	$ş—n
(
£lf
, *
¬gs
, **
kw¬gs
):

487 
ş—Ãd_d©a
 = 
	`su³r
(
BlšgDocum’tFÜm
, 
£lf
).
	$ş—n
(*
¬gs
, **
kw¬gs
)

489 
cu¡om”
 = 
ş—Ãd_d©a
.
	`g‘
('cu¡om”', 
NÚe
)

490 
nÙ
 
cu¡om”
:

491  
ş—Ãd_d©a


493 
cu¼’cy
 = 
ş—Ãd_d©a
['currency']

495 
ş—Ãd_d©a
['transaction_currency'] = (

496 
ş—Ãd_d©a
['Œª§ùiÚ_cu¼’cy'] 
Ü
 
cu¡om”
.
cu¼’cy
 or currency

499 
£lf
.
š¡ªû
:

500 
£lf
.
š¡ªû
.
Œª§ùiÚ_cu¼’cy
 = 
ş—Ãd_d©a
['transaction_currency']

502  
ş—Ãd_d©a


504 
def
 
	$§ve
(
£lf
, 
comm™
=
True
, *
¬gs
, **
kw¬gs
):

505 
obj
 = 
	`su³r
(
BlšgDocum’tFÜm
, 
£lf
).
	$§ve
(
comm™
=
F®£
)

506 #Th
´ovid”
 
has
 
chªged
 => 
g’”©e
 
a
 
Ãw
 
numb”
 
which
 
cÜ»¥Úds


507 #tØ
Ãw
 
´ovid”
's count

508 
£lf
.
´ovid”
 !ğ
obj
.provider:

509 
obj
.
numb”
 = 
NÚe


511 #Ià
the
 
numb”
 
šput
 
box
 
was
 
ju¡
 
ş—Ãd
 => 
¶aû
 
back
he

512 #Şd 
numb”
. 
This
 
wl
 
´ev’t
 
äom
 
havšg
 
unu£d
 
numb”s
.

513 
£lf
.
š™Ÿl_numb”
 
ªd
 
nÙ
 
obj
.
numb”
:

514 ià(
obj
.
£r›s
 
ªd
 
£lf
.
š™Ÿl_£r›s
‡nd

515 
obj
.
£r›s
 =ğ
£lf
.
š™Ÿl_£r›s
):

516 
obj
.
numb”
 = 
£lf
.
š™Ÿl_numb”


518 
comm™
:

519 
obj
.
	$§ve
()

520  
obj


523 
şass
 
	$InvoiûFÜm
(
BlšgDocum’tFÜm
):

524 
şass
 
M‘a
:

525 
mod–
 = 
Invoiû


526 #NOTE: 
The
 
exaù
 
f›lds
 
fl
 
be
 
added
 
š
 
the
 
InvoiûAdmš
. 
This
 
was


527 #added 
h”e
 
to
 
»move
 
the
 
d•»ÿtiÚ
 
w¬nšg
.

528 
f›lds
 = ()

531 
şass
 
	$ProfÜmaFÜm
(
BlšgDocum’tFÜm
):

532 
şass
 
M‘a
:

533 
mod–
 = 
ProfÜma


534 #NOTE: 
The
 
exaù
 
f›lds
 
fl
 
be
 
added
 
š
 
the
 
ProfÜmaAdmš
. 
This
 
was


535 #added 
h”e
 
to
 
»move
 
the
 
d•»ÿtiÚ
 
w¬nšg
.

536 
f›lds
 = ()

539 
şass
 
	$DueD©eF‹r
(
Sim¶eLi¡F‹r
):

540 #Humª-
»adabË
 
t™Ë
 
which
 
wl
 
be
 
di¥Ïyed
 
š
 
the


541 #righˆ
admš
 
sideb¬
 
ju¡
 
above
 
the
 
f‹r
 
İtiÚs
.

542 
t™Ë
 = 'due date'

544 #P¬am‘” 
the
 
f‹r
 
th©
 
wl
 
be
 
u£d
 
š
h
URL
 
qu”y
.

545 
·¿m‘”_Çme
 = 'due_date_filter'

547 
def
 
	$lookups
(
£lf
, 
»que¡
, 
mod–_admš
):

549 
R‘uºs
 
a
 
li¡
 
of
 
tu¶es
. 
The
 
fœ¡
 
–em’t
 
š
 
—ch


550 
tu¶e
 
is
 
the
 
coded
 
v®ue
 th
İtiÚ
 
th©
 
wl


551 
­³¬
 
š
 
the
 
URL
 
qu”y
. 
The
 
£cÚd
 
–em’t
 
is
he

552 
humª
-
»adabË
 
Çme
 
the
 
İtiÚ
 
th©
 
wl
 
­³¬


553 
š
 
the
 
right
 
sideb¬
.

556 ('due_this_mÚth', 
	`_
('All duehis month')),

557 ('due_today', 
	`_
('All dueoday')),

558 ('ov”due_sšû_Ï¡_mÚth', 
	`_
('All overdue since†ast month')),

559 ('ov”due', 
	`_
('All overdue'))

562 
def
 
	$qu”y£t
(
£lf
, 
»que¡
, 
qu”y£t
):

564 
R‘uºs
 
the
 
f‹»d
 
qu”y£t
 
ba£d
 
Ú
h
v®ue


565 
´ovided
 
š
 
the
 
qu”y
 
¡ršg
 
ªd
 
»Œ›vabË
 
vŸ


566 `
£lf
.
	`v®ue
()`.

568 #Com·» 
the
 
»que¡ed
 
	`v®ue
 (
e™h”
 '80s' 
Ü
 '90s')

569 #tØ
decide
 
how
 
to
 
f‹r
 
the
 
qu”y£t
.

570 
£lf
.
	`v®ue
() == 'due_this_month':

571  
qu”y£t
.
	$due_this_mÚth
()

572 
£lf
.
	`v®ue
() == 'due_today':

573  
qu”y£t
.
	$due_today
()

574 
£lf
.
	`v®ue
() == 'overdue_since_last_month':

575  
qu”y£t
.
	$ov”due_sšû_Ï¡_mÚth
()

576 
£lf
.
	`v®ue
() == 'overdue':

577  
qu”y£t
.
	$ov”due
()

579  
qu”y£t


582 
şass
 
	$BlšgDocum’tAdmš
(
Mod–Admš
):

583 
li¡_di¥Ïy
 = ['series_number', 'customer', 'state',

585 'ÿnûl_d©e', 
x
, 'total', 'transaction_total', 'get_related_document']

587 
li¡_f‹r
 = ('´ovid”__com·ny', '¡©e', 'cu¡om”', 
DueD©eF‹r
)

589 
commÚ_f›lds
 = ['company', 'address_1', 'address_2', 'city',

591 
cu¡om”_£¬ch_f›lds
 = ['cu¡om”__{f›ld}'.
	$fÜm©
(
f›ld
=field)

592 
f›ld
 
š
 
commÚ_f›lds
 + ['first_name',

594 
´ovid”_£¬ch_f›lds
 = ['´ovid”__{f›ld}'.
	$fÜm©
(
f›ld
=field)

595 
f›ld
 
š
 
commÚ_f›lds
 + ['name']]

596 
£¬ch_f›lds
 = (
cu¡om”_£¬ch_f›lds
 + 
´ovid”_£¬ch_f›lds
 +

599 
d©e_h›¿rchy
 = 'issue_date'

601 
f›lds
 = (('series', 'number'), 'provider', 'customer', 'issue_date',

606 
»adÚly_f›lds
 = ('state', 'total', 'related_document')

607 
šlšes
 = [
Docum’tEÁryIÆše
]

608 
aùiÚs
 = ['issue', 'pay', 'cancel', 'clone', 'download_selected_documents',

611 
def
 
	$g‘_qu”y£t
(
£lf
, 
»que¡
):

612  
	`su³r
(
BlšgDocum’tAdmš
, 
£lf
).
	`g‘_qu”y£t
(
»que¡
) \

613 .
	`£Ëù_»Ï‹d
('related_document',

618 @
´İ”ty


619 
def
 
	$_mod–
(
£lf
):

620 
¿i£
 
NÙIm¶em’‹dE¼Ü


622 @
´İ”ty


623 
def
 
	$_mod–_Çme
(
£lf
):

624 
¿i£
 
NÙIm¶em’‹dE¼Ü


626 
def
 
	$³rfÜm_aùiÚ
(
£lf
, 
»que¡
, 
qu”y£t
, 
aùiÚ
):

627 
m‘hod
 = 
	$g‘©Œ
(
£lf
.
_mod–
, 
aùiÚ
, 
NÚe
)

628 
nÙ
 
m‘hod
:

629 
£lf
.
	`mes§ge_u£r
(
»que¡
, 'IÎeg®‡ùiÚ.', 
Ëv–
=
mes§ges
.
ERROR
)

632 
çed_chªges
 = []

633 
çed_aùiÚs
 = []

635 
»adabË_aùiÚ
 = 
aùiÚ
.
	`»¶aû
('_', ' ').
	`¡r
().
	$ÿp™®ize
()

637 
»suÉs
 = []

638 
’Œy
 
š
 
qu”y£t
:

639 
Œy
:

640 
»suÉ
 = 
	$m‘hod
(
’Œy
)

641 
»suÉ
:

642 
»suÉs
.
	$­³nd
(
»suÉ
)

643 
’Œy
.
	$§ve
()

645 
LogEÁry
.
objeùs
.
	`log_aùiÚ
(

646 
u£r_id
=
»que¡
.
u£r
.
id
,

647 
cÚ‹Á_ty³_id
=
CÚ‹ÁTy³
.
objeùs
.
	`g‘_fÜ_mod–
(
’Œy
).
pk
,

648 
objeù_id
=
’Œy
.
id
,

649 
objeù_»´
=
	`unicode
(
’Œy
),

650 
aùiÚ_æag
=
CHANGE
,

651 
chªge_mes§ge
='{aùiÚ}‡ùiÚ in™Ÿ‹d by u£r.'.
	$fÜm©
(

652 
aùiÚ
=
»adabË_aùiÚ


655 
exû±
 
T¿ns™iÚNÙAÎowed
:

656 
çed_chªges
.
	$­³nd
(
’Œy
.
id
)

657 
exû±
 
V®ueE¼Ü
 
as
 
”rÜ
:

658 
çed_aùiÚs
.
	$­³nd
(
”rÜ
.
mes§ge
)

659 
exû±
 
A‰ribu‹E¼Ü
:

660 
çed_aùiÚs
.
	`­³nd
('{aùiÚ} faed fÜ {docum’t}.'.
	$fÜm©
(

661 
aùiÚ
=
»adabË_aùiÚ
, 
docum’t
=
’Œy


664 
çed_aùiÚs
:

665 
msg
 = "\n".
	$još
(
çed_aùiÚs
)

666 
£lf
.
	$mes§ge_u£r
(
»que¡
, 
msg
, 
Ëv–
=
mes§ges
.
ERROR
)

668 
çed_chªges
:

669 
çed_ids
 = ' '.
	`još
(
	$m­
(
¡r
, 
çed_chªges
))

670 
msg
 = "The state change failed for {model_name}(s) with "\

671 "ids: {ids}".
	`fÜm©
(
mod–_Çme
=
£lf
.
_mod–_Çme
.
	`low”
(),

672 
ids
=
çed_ids
)

673 
£lf
.
	$mes§ge_u£r
(
»que¡
, 
msg
, 
Ëv–
=
mes§ges
.
ERROR
)

675 
nÙ
 
çed_aùiÚs
 
ªd
‚Ù 
çed_chªges
:

676 
qs_couÁ
 = 
qu”y£t
.
	$couÁ
()

677 
aùiÚ
 == 'clone_into_draft':

678 
»suÉs
 = ', '.
	$još
(
»suÉ
.
£r›s_numb”
 »suÉ 
š
 
»suÉs
)

679 
msg
 = 'Successfully cloned {count} {model_name}(s) ' \

680 'štØ{»suÉs}.'.
	`fÜm©
(

681 
mod–_Çme
=
£lf
.
_mod–_Çme
.
	`low”
(), 
couÁ
=
qs_couÁ
,

682 
»suÉs
=results

685 
msg
 = 'SucûssfuÎy chªged {couÁ} {mod–_Çme}(s).'.
	`fÜm©
(

686 
mod–_Çme
=
£lf
.
_mod–_Çme
.
	`low”
(), 
couÁ
=
qs_couÁ


688 
£lf
.
	$mes§ge_u£r
(
»que¡
, 
msg
)

690 
def
 
	$has_d–‘e_³rmissiÚ
(
£lf
, 
»que¡
, 
obj
=
NÚe
):

691 
»que¡
.
u£r
.
is_su³ru£r
:

692  
True


693  
F®£


695 
def
 
	$g‘_aùiÚs
(
£lf
, 
»que¡
):

696 
aùiÚs
 = 
	`su³r
(
BlšgDocum’tAdmš
, 
£lf
).
	$g‘_aùiÚs
(
»que¡
)

697 
nÙ
 
»que¡
.
u£r
.
is_su³ru£r
:

698 'd–‘e_£Ëùed' 
š
 
aùiÚs
:

699 
d–
 
aùiÚs
['delete_selected']

700  
aùiÚs


702 
def
 
	$tÙ®
(
£lf
, 
obj
):

703  '{:.2f} {cu¼’cy}'.
	$fÜm©
(
obj
.
tÙ®
,

704 
cu¼’cy
=
obj
.currency)

706 
def
 
	$Œª§ùiÚ_tÙ®
(
£lf
, 
obj
):

707 
obj
.
Œª§ùiÚ_xe_¿‹
:

708  '{:.2f} {cu¼’cy}'.
	$fÜm©
(
obj
.
tÙ®_š_Œª§ùiÚ_cu¼’cy
,

709 
cu¼’cy
=
obj
.
Œª§ùiÚ_cu¼’cy
)

710  
NÚe


712 
def
 
	$_dowÆßd_pdf
(
£lf
, 
u¾
, 
ba£_·th
):

713 
loÿl_fe_·th
 = 
os
.
·th
.
	`još
(
ba£_·th
, 'billing-temp-document.pdf')

714 
»¥Ú£
 = 
»que¡s
.
	$g‘
(
u¾
, 
¡»am
=
True
)

715 
should_we_bad_h—d”s
 = 
True


716 
w™h
 
	`İ’
(
loÿl_fe_·th
, 'wb'è
as
 
out_fe
:

717 
chunk
 
š
 
»¥Ú£
.
	$™”_cÚ‹Á
(
chunk_size
=1024):

718 
chunk
:

719 
should_we_bad_h—d”s
:

720 
pdf_h—d”_pos
 = 
chunk
.
	`fšd
('%PDF-')

721 
pdf_h—d”_pos
 > 0:

722 #Th
fe
 
dÛs
 
nÙ
 
¡¬t
 
w™h
 
the
 '%PDF-' 
h—d”


723 #=> 
Œim
 
ev”ythšg
 
up
 
to
 
th©
 
pos™iÚ


724 
chunk
 = chunk[
pdf_h—d”_pos
:]

725 
should_we_bad_h—d”s
 = 
F®£


726 
out_fe
.
	$wr™e
(
chunk
)

727 
out_fe
.
	$æush
()

729  
loÿl_fe_·th


731 
def
 
	$dowÆßd_£Ëùed_docum’ts
(
£lf
, 
»que¡
, 
qu”y£t
):

732 #NOTE (
impÜÁ
): 
this
 
wÜks
 
Úly
 
the
 
pdf
 
is
 
nÙ
 
¡Üed
 
Ú
 
loÿl


733 #disk 
as
 
™
 
is
 
ãtched
 
vŸ
 
HTTP


734 
now
 = 
timezÚe
.
	$now
()

736 
qu”y£t
 = qu”y£t.
	$f‹r
(

737 
¡©e__š
=[
BlšgDocum’tBa£
.
STATES
.
ISSUED
,

738 
BlšgDocum’tBa£
.
STATES
.
CANCELED
,

739 
BlšgDocum’tBa£
.
STATES
.
PAID
]

742 
ba£_·th
 = '/tmp'

743 
m”g”
 = 
	$PdfFeM”g”
()

744 
docum’t
 
š
 
qu”y£t
:

745 
docum’t
.
pdf
:

746 
loÿl_fe_·th
 = 
£lf
.
	$_dowÆßd_pdf
(
docum’t
.
pdf
.
u¾
, 
ba£_·th
)

747 
Œy
:

748 
»ad”
 = 
	`PdfFeR—d”
(
	`fe
(
loÿl_fe_·th
, 'rb'))

749 
m”g”
.
	$­³nd
(
»ad”
)

750 
loggšg_ùx
 = {

751 'numb”': 
docum’t
.
£r›s_numb”
,

753 
	}
}

754 
exû±
 
Exû±iÚ
 
as
 
e
:

755 
loggšg_ùx
 = {

756 'numb”': 
docum’t
.
£r›s_numb”
,

758 '”rÜ': 
e


761 
logg”
.
debug
('Admš‡gg»g©PDF g’”©iÚ: %s', 
loggšg_ùx
)

763 
	gŒy
:

764 
os
.
	$»move
(
loÿl_fe_·th
)

765 
exû±
 
OSE¼Ü
 
as
 
e
:

766 
e
.
”ºo
 !ğ”ºo.
ENOENT
:

767 
¿i£


769 
»¥Ú£
 = 
	`H‰pRe¥Ú£
(
cÚ‹Á_ty³
='application/pdf')

770 
f’ame
 = 'Blšg-Docum’ts-{now}.pdf'.
	$fÜm©
(
now
=now)

771 
cÚ‹Á_di¥os™iÚ
 = '©chm’t; f’ame="{â}'.
	$fÜm©
(
â
=
f’ame
)

772 
»¥Ú£
['CÚ‹Á-Di¥os™iÚ'] = 
cÚ‹Á_di¥os™iÚ


774 
m”g”
.
	$wr™e
(
»¥Ú£
)

775 
m”g”
.
	$şo£
()

777  
»¥Ú£


779 
dowÆßd_£Ëùed_docum’ts
.
shÜt_desütiÚ
 = 'Download selected documents'

781 
def
 
	$g‘_»Ï‹d_docum’t
(
£lf
, 
obj
):

782  
obj
.
»Ï‹d_docum’t
.
admš_chªge_u¾
 obj.»Ï‹d_docum’ˆ
NÚe


783 
g‘_»Ï‹d_docum’t
.
shÜt_desütiÚ
 = 'Related document'

784 
g‘_»Ï‹d_docum’t
.
®low_gs
 = 
True


787 
şass
 
	$InvoiûDocum’tEÁryIÆše
(
Docum’tEÁryIÆše
):

788 
fk_Çme
 = 'invoice'

791 
şass
 
	$InvoiûAdmš
(
BlšgDocum’tAdmš
):

792 
fÜm
 = 
InvoiûFÜm


793 
li¡_di¥Ïy
 = 
BlšgDocum’tAdmš
.list_display + [

796 
šlšes
 = [
InvoiûDocum’tEÁryIÆše
]

798 
def
 
	$issue
(
£lf
, 
»que¡
, 
qu”y£t
):

799 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'issue')

800 
issue
.
shÜt_desütiÚ
 = 'Issuehe selected invoice(s)'

802 
def
 
	$·y
(
£lf
, 
»que¡
, 
qu”y£t
):

803 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'pay')

804 
·y
.
shÜt_desütiÚ
 = 'Payhe selected invoice(s)'

806 
def
 
	$ÿnûl
(
£lf
, 
»que¡
, 
qu”y£t
):

807 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'cancel')

808 
ÿnûl
.
shÜt_desütiÚ
 = 'Cancelhe selected invoice(s)'

810 
def
 
	$şÚe
(
£lf
, 
»que¡
, 
qu”y£t
):

811 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'clone_into_draft')

812 
şÚe
.
shÜt_desütiÚ
 = 'Clonehe selected invoice(s) into draft'

814 
def
 
	$m¬k_pdf_fÜ_g’”©iÚ
(
£lf
, 
»que¡
, 
qu”y£t
):

815 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'mark_for_generation')

816 
m¬k_pdf_fÜ_g’”©iÚ
.
shÜt_desütiÚ
 = 'Markhe selected invoice(s) for PDF generation'

818 
def
 
	$švoiû_pdf
(
£lf
, 
švoiû
):

819 
švoiû
.
pdf
:

820 
u¾
 = 
	`»v”£
('švoiû-pdf', 
kw¬gs
={'švoiû_id': 
švoiû
.
id
})

821  '<¨h»f="{u¾}"¬g‘="_bÏnk">{u¾}</a>'.
	$fÜm©
(
u¾
=url)

823  
NÚe


824 
švoiû_pdf
.
®low_gs
 = 
True


826 @
´İ”ty


827 
def
 
	$_mod–
(
£lf
):

828  
Invoiû


830 @
´İ”ty


831 
def
 
	$_mod–_Çme
(
£lf
):

835 
şass
 
	$ProfÜmaDocum’tEÁryIÆše
(
Docum’tEÁryIÆše
):

836 
fk_Çme
 = 'proforma'

839 
şass
 
	$ProfÜmaAdmš
(
BlšgDocum’tAdmš
):

840 
fÜm
 = 
ProfÜmaFÜm


841 
li¡_di¥Ïy
 = 
BlšgDocum’tAdmš
.list_display + [

844 
šlšes
 = [
ProfÜmaDocum’tEÁryIÆše
]

845 
aùiÚs
 = 
BlšgDocum’tAdmš
.actions + ['create_invoice']

847 
def
 
	$issue
(
£lf
, 
»que¡
, 
qu”y£t
):

848 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'issue')

849 
issue
.
shÜt_desütiÚ
 = 'Issuehe selected…roforma(s)'

851 
def
 
	$ü—‹_švoiû
(
£lf
, 
»que¡
, 
qu”y£t
):

852 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'create_invoice')

853 
ü—‹_švoiû
.
shÜt_desütiÚ
 = 'Create invoice from…roforma(s)'

855 
def
 
	$·y
(
£lf
, 
»que¡
, 
qu”y£t
):

856 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'pay')

857 
·y
.
shÜt_desütiÚ
 = 'Payhe selected…roforma(s)'

859 
def
 
	$ÿnûl
(
£lf
, 
»que¡
, 
qu”y£t
):

860 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'cancel')

861 
ÿnûl
.
shÜt_desütiÚ
 = 'Cancelhe selected…roforma(s)'

863 
def
 
	$şÚe
(
£lf
, 
»que¡
, 
qu”y£t
):

864 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'clone_into_draft')

865 
şÚe
.
shÜt_desütiÚ
 = 'Clonehe selected…roforma(s) into draft'

867 
def
 
	$m¬k_pdf_fÜ_g’”©iÚ
(
£lf
, 
»que¡
, 
qu”y£t
):

868 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'mark_for_generation')

869 
m¬k_pdf_fÜ_g’”©iÚ
.
shÜt_desütiÚ
 = 'Markhe selected…roforma(s) for PDF generation'

871 
def
 
	$´ofÜma_pdf
(
£lf
, 
´ofÜma
):

872 
´ofÜma
.
pdf
:

873 
u¾
 = 
	`»v”£
('´ofÜma-pdf', 
kw¬gs
={'´ofÜma_id': 
´ofÜma
.
id
})

874  '<¨h»f="{u¾}"¬g‘="_bÏnk">{u¾}</a>'.
	$fÜm©
(
u¾
=url)

876  
NÚe


877 
´ofÜma_pdf
.
®low_gs
 = 
True


879 @
´İ”ty


880 
def
 
	$_mod–
(
£lf
):

881  
ProfÜma


883 @
´İ”ty


884 
def
 
	$_mod–_Çme
(
£lf
):

888 
şass
 
	$T¿n§ùiÚFÜm
(
fÜms
.
Mod–FÜm
):

889 
şass
 
M‘a
:

890 
mod–
 = 
T¿n§ùiÚ


891 
f›lds
 = ['proforma', 'invoice', 'amount', 'currency', 'state',

895 
»adÚly_f›lds
 = ['state', 'uuid', 'last_access']

896 
ü—‹_Úly_f›lds
 = ['amount', 'currency', 'proforma', 'invoice',

899 
widg‘s
 = {

900 'švoiû': 
autocom¶‘e
.
	`Mod–S–eù2
(

901 
u¾
='autocomplete-invoice'

903 '´ofÜma': 
autocom¶‘e
.
	`Mod–S–eù2
(

904 
u¾
='autocomplete-proforma'

906 '·ym’t_m‘hod': 
autocom¶‘e
.
	`Mod–S–eù2
(

907 
u¾
='autocomplete-payment-method'

910 
	}
}

912 
def
 
	$__š™__
(
£lf
, *
¬gs
, **
kw¬gs
):

913 
	`su³r
(
T¿n§ùiÚFÜm
, 
£lf
).
	$__š™__
(*
¬gs
, **
kw¬gs
)

915 'amouÁ' 
š
 
£lf
.
f›lds
:

916 
£lf
.
f›lds
['amouÁ'].
»quœed
 = 
F®£


917 'cu¼’cy' 
š
 
£lf
.
f›lds
:

918 
£lf
.
f›lds
['cu¼’cy'].
»quœed
 = 
F®£


920 
def
 
	$ş—n
(
£lf
):

921 ià((
£lf
.
ş—Ãd_d©a
['amouÁ'] 
ªd
 
nÙ
 s–f.ş—Ãd_d©a['cu¼’cy']è
Ü


922 (
£lf
.
ş—Ãd_d©a
['amouÁ'] 
is
 
NÚe
 
ªd
 self.cleaned_data['currency'])):

923 
¿i£
 
	`V®id©iÚE¼Ü
('You mustƒither specify both‡mount‡nd currency fields or '

926 
docum’t
 = 
£lf
.
ş—Ãd_d©a
['´ofÜma'] 
Ü
 self.cleaned_data['invoice']

927 
nÙ
 
£lf
.
ş—Ãd_d©a
['currency']:

928 
£lf
.
ş—Ãd_d©a
['amouÁ'] = 
docum’t
.
amouÁ_to_be_ch¬ged_š_Œª§ùiÚ_cu¼’cy


929 
£lf
.
ş—Ãd_d©a
['cu¼’cy'] = 
docum’t
.
Œª§ùiÚ_cu¼’cy


931  
£lf
.
ş—Ãd_d©a


934 
şass
 
	$T¿n§ùiÚAdmš
(
Mod–Admš
):

935 
fÜm
 = 
T¿n§ùiÚFÜm


937 
li¡_di¥Ïy
 = ('__unicode__', 'external_reference', 'related_invoice', 'related_proforma',

941 
li¡_f‹r
 = ('payment_method__customer', 'state',

943 
£¬ch_f›lds
 = ('external_reference',)

945 
aùiÚs
 = ['execute', 'process', 'cancel', 'settle', 'fail']

946 
Üd”šg
 = ['-created_at']

948 
def
 
	$g‘_qu”y£t
(
£lf
, 
»que¡
):

949  
	`su³r
(
T¿n§ùiÚAdmš
, 
£lf
).
	`g‘_qu”y£t
(
»que¡
) \

950 .
	`£Ëù_»Ï‹d
('payment_method__customer',

953 
def
 
	$g‘_»adÚly_f›lds
(
£lf
, 
»que¡
, 
š¡ªû
=
NÚe
):

954 
š¡ªû
:

955  
£lf
.
fÜm
.
M‘a
.
»adÚly_f›lds
 + s–f.fÜm.M‘a.
ü—‹_Úly_f›lds


956  
£lf
.
fÜm
.
M‘a
.
»adÚly_f›lds


958 
def
 
	$g‘_·y_u¾
(
£lf
, 
obj
):

959  
u
'<¨h»f="%s">%s</a>' % (
	`g‘_·ym’t_u¾
(
obj
, 
NÚe
),

960 
obj
.
·ym’t_´oûssÜ
)

962 
g‘_·y_u¾
.
®low_gs
 = 
True


963 
g‘_·y_u¾
.
shÜt_desütiÚ
 = 'Pay URL'

965 
def
 
	$g‘_cu¡om”
(
£lf
, 
obj
):

966 
lšk
 = 
u¾»sŞv”s
.
	`»v”£
("admin:silver_customer_change",

967 
¬gs
=[
obj
.
·ym’t_m‘hod
.
cu¡om”
.
pk
])

968  
u
'<¨h»f="%s">%s</a>' % (
lšk
, 
obj
.
·ym’t_m‘hod
.
cu¡om”
)

969 
g‘_cu¡om”
.
®low_gs
 = 
True


970 
g‘_cu¡om”
.
shÜt_desütiÚ
 = 'Customer'

972 
def
 
	$g‘_is_»cu¼šg
(
£lf
, 
obj
):

973  
obj
.
·ym’t_m‘hod
.
v”if›d


974 
g‘_is_»cu¼šg
.
boŞ—n
 = 
True


975 
g‘_is_»cu¼šg
.
shÜt_desütiÚ
 = 'Recurring'

977 
def
 
	$g‘_·ym’t_m‘hod
(
£lf
, 
obj
):

978 
lšk
 = 
u¾»sŞv”s
.
	`»v”£
("admin:silver_paymentmethod_change",

979 
¬gs
=[
obj
.
·ym’t_m‘hod
.
pk
])

980  
u
'<¨h»f="%s">%s</a>' % (
lšk
, 
obj
.
·ym’t_m‘hod
)

981 
g‘_·ym’t_m‘hod
.
®low_gs
 = 
True


982 
g‘_·ym’t_m‘hod
.
shÜt_desütiÚ
 = 'Payment Method'

984 
def
 
	$³rfÜm_aùiÚ
(
£lf
, 
»que¡
, 
qu”y£t
, 
aùiÚ
, 
di¥Ïy_v”b
=
NÚe
):

985 
çed_couÁ
 = 0

986 
Œª§ùiÚs_couÁ
 = 
	$Ën
(
qu”y£t
)

988 
aùiÚ
 
nÙ
 
š
 
£lf
.
aùiÚs
:

989 
£lf
.
	`mes§ge_u£r
(
»que¡
, 'IÎeg®‡ùiÚ.', 
Ëv–
=
mes§ges
.
ERROR
)

992 
m‘hod
 = 
	$g‘©Œ
(
T¿n§ùiÚ
, 
aùiÚ
)

994 
Œª§ùiÚ
 
š
 
qu”y£t
:

995 
Œy
:

996 
	$m‘hod
(
Œª§ùiÚ
)

997 
Œª§ùiÚ
.
	$§ve
()

998 
exû±
 
T¿ns™iÚNÙAÎowed
:

999 
çed_couÁ
 += 1

1001 
£‰Ëd_couÁ
 = 
Œª§ùiÚs_couÁ
 - 
çed_couÁ


1003 
nÙ
 
çed_couÁ
:

1004 
£lf
.
	`mes§ge_u£r
(

1005 
»que¡
,

1007 
di¥Ïy_v”b
 
Ü
 
aùiÚ
, 
Œª§ùiÚs_couÁ


1010 
–if
 
çed_couÁ
 !ğ
Œª§ùiÚs_couÁ
:

1012 
£lf
.
	`mes§ge_u£r
(

1013 
»que¡
,

1015 
di¥Ïy_v”b
 
Ü
 
aùiÚ
, 
£‰Ëd_couÁ
, 
çed_couÁ


1017 
Ëv–
=
mes§ges
.
WARNING


1020 
£lf
.
	`mes§ge_u£r
(

1021 
»que¡
,

1022 'Couldn\'ˆ% ªy oàth£Ëùed¿n§ùiÚs.' % 
aùiÚ
,

1023 
Ëv–
=
mes§ges
.
ERROR


1026 
aùiÚ
 =‡ùiÚ.
	$ÿp™®ize
()

1028 
logg”
.
	`šfo
('[Admš][% T¿n§ùiÚ]: %s', 
aùiÚ
, {

1029 'd‘a': '% T¿n§ùiÚ‡ùiÚ in™Ÿ‹d by u£r.' % 
aùiÚ
,

1030 'u£r_id': 
»que¡
.
u£r
.
id
,

1031 'u£r_¡aff': 
»que¡
.
u£r
.
is_¡aff
,

1032 'çed_couÁ': 
çed_couÁ
,

1033 '£‰Ëd_couÁ': 
£‰Ëd_couÁ


1034 
	}
})

1036 
def
 
	$execu‹
(
£lf
, 
»que¡
, 
qu”y£t
):

1037 
çed_couÁ
 = 0

1038 
Œª§ùiÚs_couÁ
 = 
	$Ën
(
qu”y£t
)

1040 
Œª§ùiÚ
 
š
 
qu”y£t
:

1041 
Œy
:

1042 
·ym’t_´oûssÜ
 = 
Œª§ùiÚ
.
·ym’t_m‘hod
.
	$g‘_·ym’t_´oûssÜ
()

1043 
·ym’t_´oûssÜ
.
ty³
 !ğ
Paym’tProûssÜTy³s
.
Trigg”ed
:

1045 
·ym’t_´oûssÜ
.
	$execu‹_Œª§ùiÚ
(
Œª§ùiÚ
)

1046 
exû±
 
Exû±iÚ
:

1047 
çed_couÁ
 += 1

1048 
logg”
.
	`”rÜ
('Encounteredƒxception whileƒxecutingransaction '

1049 'w™h id=%s.', 
Œª§ùiÚ
.
id
, 
exc_šfo
=
True
)

1051 
£‰Ëd_couÁ
 = 
Œª§ùiÚs_couÁ
 - 
çed_couÁ


1053 
nÙ
 
çed_couÁ
:

1054 
£lf
.
	`mes§ge_u£r
(

1055 
»que¡
,

1056 'SucûssfuÎyƒxecu‹d %d¿n§ùiÚs.' % (
Œª§ùiÚs_couÁ
)

1058 
–if
 
çed_couÁ
 !ğ
Œª§ùiÚs_couÁ
:

1059 
£lf
.
	`mes§ge_u£r
(

1060 
»que¡
,

1062 
£‰Ëd_couÁ
, 
çed_couÁ


1064 
Ëv–
=
mes§ges
.
WARNING


1067 
£lf
.
	`mes§ge_u£r
(

1068 
»que¡
,

1070 
Ëv–
=
mes§ges
.
ERROR


1073 
logg”
.
	`šfo
('[Admin][%s Transaction]: Execute', {

1075 'u£r_id': 
»que¡
.
u£r
.
id
,

1076 'u£r_¡aff': 
»que¡
.
u£r
.
is_¡aff
,

1077 'çed_couÁ': 
çed_couÁ
,

1078 '£‰Ëd_couÁ': 
£‰Ëd_couÁ


1079 
	}
})

1080 
execu‹
.
shÜt_desütiÚ
 = 'Executehe selectedransactions'

1082 
def
 
	$´oûss
(
£lf
, 
»que¡
, 
qu”y£t
):

1083 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'process', 'processed')

1084 
´oûss
.
shÜt_desütiÚ
 = 'Processhe selectedransactions'

1086 
def
 
	$ÿnûl
(
£lf
, 
»que¡
, 
qu”y£t
):

1087 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'cancel', 'canceled')

1088 
ÿnûl
.
shÜt_desütiÚ
 = 'Cancelhe selectedransactions'

1090 
def
 
	$£‰Ë
(
£lf
, 
»que¡
, 
qu”y£t
):

1091 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'settle', 'settled')

1092 
£‰Ë
.
shÜt_desütiÚ
 = 'Settlehe selectedransactions'

1094 
def
 
	$ç
(
£lf
, 
»que¡
, 
qu”y£t
):

1095 
£lf
.
	`³rfÜm_aùiÚ
(
»que¡
, 
qu”y£t
, 'fail', 'failed')

1096 
ç
.
shÜt_desütiÚ
 = 'Failhe selectedransactions'

1098 
def
 
	$»Ï‹d_švoiû
(
£lf
, 
obj
):

1099  
obj
.
švoiû
.
admš_chªge_u¾
 obj.švoiû 
NÚe


1100 
»Ï‹d_švoiû
.
®low_gs
 = 
True


1101 
»Ï‹d_švoiû
.
shÜt_desütiÚ
 = 'Invoice'

1103 
def
 
	$»Ï‹d_´ofÜma
(
£lf
, 
obj
):

1104  
obj
.
´ofÜma
.
admš_chªge_u¾
 obj.´ofÜm¨
NÚe


1105 
»Ï‹d_´ofÜma
.
®low_gs
 = 
True


1106 
»Ï‹d_´ofÜma
.
shÜt_desütiÚ
 = 'Proforma'

1109 
şass
 
	$Paym’tM‘hodAdmš
(
Mod–Admš
):

1110 
li¡_di¥Ïy
 = ('customer', 'payment_processor', 'added_at', 'verified',

1112 
li¡_f‹r
 = ('customer', 'verified', 'canceled',

1114 
£¬ch_f›lds
 = ['customer__first_name', 'customer__last_name',

1118 
s™e
.(
T¿n§ùiÚ
, 
T¿n§ùiÚAdmš
)

1119 
s™e
.(
Paym’tM‘hod
, 
Paym’tM‘hodAdmš
)

1120 
s™e
.(
PÏn
, 
PÏnAdmš
)

1121 
s™e
.(
SubsütiÚ
, 
SubsütiÚAdmš
)

1122 
s™e
.(
Cu¡om”
, 
Cu¡om”Admš
)

1123 
s™e
.(
Provid”
, 
Provid”Admš
)

1124 
s™e
.(
Invoiû
, 
InvoiûAdmš
)

1125 
s™e
.(
ProfÜma
, 
ProfÜmaAdmš
)

1126 
s™e
.(
ProduùCode
)

1127 
s™e
.(
M‘”edF—tu»
)

	@silver/api/__init__.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 #-*- 
codšg
: 
utf
-8 -*-

17 
	g__v”siÚ__
 = '0.1.2'

	@silver/api/exceptions.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
»¡_äamewÜk
 
impÜt
 
¡©us


16 
äom
 
	g»¡_äamewÜk
.
exû±iÚs
 
impÜt
 
APIExû±iÚ


19 
şass
 
	$APICÚæiùExû±iÚ
(
APIExû±iÚ
):

20 
¡©us_code
 = 
¡©us
.
HTTP_409_CONFLICT


21 
deçuÉ_d‘a
 = 'The„equest could‚ot be completed dueo‡ conflict ' \

	@silver/api/filters.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
djªgo_f‹rs
 
	$impÜt
 (
F‹rS‘
, 
Ch¬F‹r
, 
BoŞ—nF‹r
, 
D©eF‹r
,

16 
Numb”F‹r
)

17 
äom
 
djªgo_f‹rs
.
f›lds
 
impÜt
 
Lookup


19 
äom
 
sv”
.
mod–s
 
	$impÜt
 (
M‘”edF—tu»
, 
SubsütiÚ
, 
Cu¡om”
, 
Provid”
,

20 
PÏn
, 
Invoiû
, 
ProfÜma
, 
T¿n§ùiÚ
, 
Paym’tM‘hod
,

21 
BlšgDocum’tBa£
)

24 
şass
 
	$MuÉËCh¬F‹r
(
Ch¬F‹r
):

25 
def
 
	$f‹r
(
£lf
, 
qs
, 
v®ue
):

26 
v®ue
:

27 
v®ue
 = v®ue.
	`¥l™
(',')

29 
lookup
 = 
	`Lookup
(
v®ue
, 'in')

30  
	`su³r
(
MuÉËCh¬F‹r
, 
£lf
).
	$f‹r
(
qs
, 
lookup
)

33 
şass
 
	$M‘”edF—tu»sF‹r
(
F‹rS‘
):

34 
Çme
 = 
	`Ch¬F‹r
Òame='Çme', 
lookup_ex´
='icontains')

36 
şass
 
M‘a
:

37 
mod–
 = 
M‘”edF—tu»


38 
f›lds
 = ('name', )

41 
şass
 
	$SubsütiÚF‹r
(
F‹rS‘
):

42 
¶ª
 = 
	`Ch¬F‹r
(
Çme
='¶ª__Çme', 
lookup_ex´
='iexact')

43 
»ã»nû
 = 
	`MuÉËCh¬F‹r
(
Çme
='»ã»nû', 
lookup_ex´
='iexact')

45 
şass
 
M‘a
:

46 
mod–
 = 
SubsütiÚ


47 
f›lds
 = ['plan', 'reference', 'state']

50 
şass
 
	$Cu¡om”F‹r
(
F‹rS‘
):

51 
aùive
 = 
	`BoŞ—nF‹r
(
Çme
='is_aùive', 
lookup_ex´
='iexact')

52 
ema
 = 
	`Ch¬F‹r
(
Çme
='ema', 
lookup_ex´
='icontains')

53 
com·ny
 = 
	`Ch¬F‹r
(
Çme
='com·ny', 
lookup_ex´
='icontains')

54 
fœ¡_Çme
 = 
	`Ch¬F‹r
(
Çme
='fœ¡_Çme', 
lookup_ex´
='icontains')

55 
Ï¡_Çme
 = 
	`Ch¬F‹r
(
Çme
='Ï¡_Çme', 
lookup_ex´
='icontains')

56 
couÁry
 = 
	`Ch¬F‹r
(
Çme
='couÁry', 
lookup_ex´
='icontains')

57 
§Ës_x_Çme
 = 
	`Ch¬F‹r
(
Çme
='§Ës_x_Çme', 
lookup_ex´
='icontains')

58 
§Ës_x_numb”
 = 
	`Ch¬F‹r
(
Çme
='sales_tax_number',

59 
lookup_ex´
='icontains')

60 
cÚsŞid©ed_blšg
 = 
	`Ch¬F‹r
(
Çme
='consolidated_billing',

61 
lookup_ex´
='icontains')

62 
»ã»nû
 = 
	`MuÉËCh¬F‹r
(
Çme
='customer_reference',

63 
lookup_ex´
='iexact')

65 
şass
 
M‘a
:

66 
mod–
 = 
Cu¡om”


67 
f›lds
 = ['email', 'first_name', 'last_name', 'company', 'active',

72 
şass
 
	$Provid”F‹r
(
F‹rS‘
):

73 
ema
 = 
	`Ch¬F‹r
(
Çme
='ema', 
lookup_ex´
='icontains')

74 
com·ny
 = 
	`Ch¬F‹r
(
Çme
='com·ny', 
lookup_ex´
='icontains')

76 
şass
 
M‘a
:

77 
mod–
 = 
Provid”


78 
f›lds
 = ['email', 'company']

81 
şass
 
	$PÏnF‹r
(
F‹rS‘
):

82 
Çme
 = 
	`Ch¬F‹r
Òame='Çme', 
lookup_ex´
='icontains')

83 
cu¼’cy
 = 
	`Ch¬F‹r
(
Çme
='cu¼’cy', 
lookup_ex´
='icontains')

84 
’abËd
 = 
	`BoŞ—nF‹r
(
Çme
='’abËd', 
lookup_ex´
='iexact')

85 
´iv©e
 = 
	`BoŞ—nF‹r
(
Çme
='´iv©e', 
lookup_ex´
='iexact')

86 
š‹rv®
 = 
	`Ch¬F‹r
(
Çme
='š‹rv®', 
lookup_ex´
='icontains')

87 
´oduù_code
 = 
	`Ch¬F‹r
(
Çme
='´oduù_code', 
lookup_ex´
='icontains')

88 
´ovid”
 = 
	`Ch¬F‹r
(
Çme
='´ovid”__com·ny', 
lookup_ex´
='icontains')

90 
şass
 
M‘a
:

91 
mod–
 = 
PÏn


92 
f›lds
 = ['name', 'currency', 'enabled', 'private', 'product_code',

96 
şass
 
	$BlšgDocum’tF‹r
(
F‹rS‘
):

97 
id
 = 
	`Numb”F‹r
(
Çme
='id', 
lookup_ex´
='iexact')

98 
¡©e
 = 
	`MuÉËCh¬F‹r
(
Çme
='¡©e', 
lookup_ex´
='iexact')

99 
numb”
 = 
	`Numb”F‹r
(
Çme
='numb”', 
lookup_ex´
='iexact')

100 
cu¡om”
 = 
	`Numb”F‹r
(
Çme
='cu¡om”__pk', 
lookup_ex´
='iexact')

101 
cu¡om”_Çme
 = 
	`Ch¬F‹r
(
Çme
='cu¡om”__Çme', 
lookup_ex´
='icontains')

102 
cu¡om”_com·ny
 = 
	`Ch¬F‹r
(
Çme
='customer__company',

103 
lookup_ex´
='icontains')

104 
´ovid”_Çme
 = 
	`Ch¬F‹r
(
Çme
='´ovid”__Çme', 
lookup_ex´
='icontains')

105 
´ovid”_com·ny
 = 
	`Ch¬F‹r
(
Çme
='provider__company',

106 
lookup_ex´
='icontains')

107 
issue_d©e
 = 
	`D©eF‹r
(
Çme
='issue_d©e', 
lookup_ex´
='iexact')

108 
due_d©e
 = 
	`D©eF‹r
(
Çme
='due_d©e', 
lookup_ex´
='iexact')

109 
·id_d©e
 = 
	`D©eF‹r
(
Çme
='due_d©e', 
lookup_ex´
='iexact')

110 
ÿnûl_d©e
 = 
	`D©eF‹r
(
Çme
='ÿnûl_d©e', 
lookup_ex´
='iexact')

111 
cu¼’cy
 = 
	`MuÉËCh¬F‹r
(
Çme
='cu¼’cy', 
lookup_ex´
='icontains')

112 
§Ës_x_Çme
 = 
	`MuÉËCh¬F‹r
(
Çme
='§Ës_x_Çme', 
lookup_ex´
='icontains')

113 
is_ov”due
 = 
	`BoŞ—nF‹r
(
Çme
='ov”due', 
m‘hod
='filter_is_overdue')

115 
def
 
	$f‹r_is_ov”due
(
£lf
, 
qu”y£t
, 
_
, 
v®ue
):

116 
v®ue
:

117  
qu”y£t
.
	$ov”due
()

118  
qu”y£t
.
	$nÙ_ov”due
()

120 
şass
 
M‘a
:

121 
mod–
 = 
BlšgDocum’tBa£


122 
f›lds
 = ['id', 'state', 'number', 'customer_name', 'customer_company',

128 
şass
 
	$InvoiûF‹r
(
BlšgDocum’tF‹r
):

129 
£r›s
 = 
	`Ch¬F‹r
(
Çme
='provider__invoice_series',

130 
lookup_ex´
='icontains')

132 
şass
 
	$M‘a
(
BlšgDocum’tF‹r
.
M‘a
):

133 
mod–
 = 
Invoiû


134 
f›lds
 = 
BlšgDocum’tF‹r
.
M‘a
.fields + ['series', ]

137 
şass
 
	$ProfÜmaF‹r
(
BlšgDocum’tF‹r
):

138 
£r›s
 = 
	`Ch¬F‹r
(
Çme
='provider__proforma_series',

139 
lookup_ex´
='icontains')

141 
şass
 
	$M‘a
(
BlšgDocum’tF‹r
.
M‘a
):

142 
mod–
 = 
ProfÜma


143 
f›lds
 = 
BlšgDocum’tF‹r
.
M‘a
.fields + ['series', ]

146 
şass
 
	$T¿n§ùiÚF‹r
(
F‹rS‘
):

147 
·ym’t_´oûssÜ
 = 
	`Ch¬F‹r
(

148 
Çme
='payment_method__payment_processor',

149 
lookup_ex´
='iexact'

151 
¡©e
 = 
	`Ch¬F‹r
(
Çme
='state')

152 
mš_amouÁ
 = 
	`Numb”F‹r
(
Çme
='amouÁ', 
lookup_ex´
='gte')

153 
max_amouÁ
 = 
	`Numb”F‹r
(
Çme
='amouÁ', 
lookup_ex´
='lte')

154 
cu¼’cy
 = 
	`Ch¬F‹r
(
Çme
='cu¼’cy', 
lookup_ex´
='iexact')

155 
di§bËd
 = 
	`BoŞ—nF‹r
(
Çme
='disabled')

157 
şass
 
M‘a
:

158 
mod–
 = 
T¿n§ùiÚ


159 
f›lds
 = ['payment_method', 'state', 'min_amount', 'max_amount',

163 
şass
 
	$Paym’tM‘hodF‹r
(
F‹rS‘
):

164 
´oûssÜ
 = 
	`Ch¬F‹r
(
Çme
='·ym’t_´oûssÜ', 
lookup_ex´
='iexact')

165 
ÿnûËd
 = 
	`BoŞ—nF‹r
(
Çme
='canceled')

166 
v”if›d
 = 
	`BoŞ—nF‹r
(
Çme
='verified')

168 
şass
 
M‘a
:

169 
mod–
 = 
Paym’tM‘hod


170 
f›lds
 = ['processor', 'canceled', 'verified']

	@silver/api/pagination.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
äom
 
	g»¡_äamewÜk
.
£‰šgs
 
impÜt
 
­i_£‰šgs


17 
äom
 
	g»¡_äamewÜk
.
·gš©iÚ
 
impÜt
 
PageNumb”Pagš©iÚ


18 
äom
 
	g»¡_äamewÜk
.
»¥Ú£
 
impÜt
 
Re¥Ú£


19 
äom
 
	g»¡_äamewÜk
.
	guts
.
u¾s
 
impÜt
 
	g»¶aû_qu”y_·¿m
, 
»move_qu”y_·¿m


22 
şass
 
	$LškH—d”Pagš©iÚ
(
PageNumb”Pagš©iÚ
):

23 
·ge_size
 = 
­i_£‰šgs
.
PAGE_SIZE
 
Ü
 30

24 
·ge_size_qu”y_·¿m
 = 'page_size'

25 
max_·ge_size
 = 100

27 
def
 
	$g‘_Ï¡_lšk
(
£lf
):

28 
u¾
 = 
£lf
.
»que¡
.
	$bud_absŞu‹_uri
()

29 
·ge_numb”
 = 
£lf
.
·ge
.
·gš©Ü
.
num_·ges


30  
	$»¶aû_qu”y_·¿m
(
u¾
, 
£lf
.
·ge_qu”y_·¿m
, 
·ge_numb”
)

32 
def
 
	$g‘_fœ¡_lšk
(
£lf
, 
di¥Ïy_·ge_qu”y_·¿m
=
True
):

33 
u¾
 = 
£lf
.
»que¡
.
	$bud_absŞu‹_uri
()

34 
di¥Ïy_·ge_qu”y_·¿m
:

35 
·ge_numb”
 = 
£lf
.
·ge
.
·gš©Ü
.
	$v®id©e_numb”
(1)

36  
	$»¶aû_qu”y_·¿m
(
u¾
, 
£lf
.
·ge_qu”y_·¿m
, 
·ge_numb”
)

38  
	$»move_qu”y_·¿m
(
u¾
, 
£lf
.
·ge_qu”y_·¿m
)

40 
def
 
	$g‘_·gš©ed_»¥Ú£
(
£lf
, 
d©a
):

41 
Ãxt_u¾
 = 
£lf
.
	$g‘_Ãxt_lšk
()

42 
´evious_u¾
 = 
£lf
.
	$g‘_´evious_lšk
()

43 
fœ¡_u¾
 = 
£lf
.
	$g‘_fœ¡_lšk
()

44 
Ï¡_u¾
 = 
£lf
.
	$g‘_Ï¡_lšk
()

46 
Ãxt_u¾
 
is
 
nÙ
 
NÚe
 
ªd
 
´evious_u¾
 is‚ot None:

47 
lšk
 = '<{next_url}>;„el="next", <{previous_url}>;„el="prev"'

48 
–if
 
Ãxt_u¾
 
is
 
nÙ
 
NÚe
:

49 
lšk
 = '<{next_url}>;„el="next"'

50 
–if
 
´evious_u¾
 
is
 
nÙ
 
NÚe
:

51 
lšk
 = '<{previous_url}>;„el="prev"'

53 
lšk
 = ''

55 
lšk
:

56 
lšk
 += ', '

58 
lšk
 += '<{first_url}>;„el="first", <{last_url}>„el="last"'

60 
lšk
 =†šk.
	$fÜm©
(
Ãxt_u¾
òext_u¾, 
´evious_u¾
=previous_url,

61 
fœ¡_u¾
=fœ¡_u¾, 
Ï¡_u¾
=last_url)

62 
h—d”s
 = {'Lšk': 
lšk
} lšk {}

64  
Re¥Ú£
(
d©a
, 
h—d”s
=headers)

	@silver/api/serializers/__init__.py

	@silver/api/serializers/billing_entities_serializers.py

1 
äom
 
»¡_äamewÜk
 
impÜt
 
£rŸliz”s


2 
äom
 
	g»¡_äamewÜk
.
f›lds
 
impÜt
 
JSONF›ld


3 
äom
 
	g»¡_äamewÜk
.
»ÏtiÚs
 
impÜt
 
Hy³¾škedR–©edF›ld


5 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
commÚ
 
impÜt
 
Cu¡om”U¾


6 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
subsütiÚs_£rŸliz”s
 
impÜt
 
SubsütiÚU¾


7 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gProvid”
, 
Cu¡om”


10 
şass
 
	$Provid”S”Ÿliz”
(
£rŸliz”s
.
Hy³¾škedMod–S”Ÿliz”
):

11 
m‘a
 = 
	$JSONF›ld
(
»quœed
=
F®£
)

13 
şass
 
M‘a
:

14 
mod–
 = 
Provid”


15 
f›lds
 = ('id', 'url', 'name', 'company', 'invoice_series', 'flow',

21 
def
 
	$v®id©e
(
£lf
, 
d©a
):

22 
d©a
 = 
	`su³r
(
Provid”S”Ÿliz”
, 
£lf
).
	$v®id©e
(
d©a
)

24 
æow
 = 
d©a
.
	`g‘
('æow', 
NÚe
)

25 
æow
 =ğ
Provid”
.
FLOWS
.
PROFORMA
:

26 
nÙ
 
d©a
.
	`g‘
('´ofÜma_¡¬tšg_numb”', 
NÚe
è
ªd
\

27 
nÙ
 
d©a
.
	`g‘
('´ofÜma_£r›s', 
NÚe
):

28 
”rÜs
 = {'proforma_series': "This field is„equired‡she "

32 "´ofÜma."
	}
}

33 
¿i£
 
£rŸliz”s
.
	$V®id©iÚE¼Ü
(
”rÜs
)

34 
–if
 
nÙ
 
d©a
.
	`g‘
('proforma_series'):

35 
”rÜs
 = {'proforma_series': "This field is„equired‡she "

36 "cho£Àæow i ´ofÜma."
	}
}

37 
¿i£
 
£rŸliz”s
.
	$V®id©iÚE¼Ü
(
”rÜs
)

38 
–if
 
nÙ
 
d©a
.
	`g‘
('´ofÜma_¡¬tšg_numb”', 
NÚe
):

39 
”rÜs
 = {'proforma_starting_number': "This field is„equired "

41 "´ofÜma."
	}
}

42 
¿i£
 
£rŸliz”s
.
	$V®id©iÚE¼Ü
(
”rÜs
)

44  
d©a


47 
şass
 
	$Provid”U¾
(
Hy³¾škedR–©edF›ld
):

48 
def
 
	$g‘_u¾
(
£lf
, 
obj
, 
v›w_Çme
, 
»que¡
, 
fÜm©
):

49 
kw¬gs
 = {'pk': 
obj
.
pk
}

50  
£lf
.
	$»v”£
(
v›w_Çme
, 
kw¬gs
=kw¬gs, 
»que¡
ôeque¡, 
fÜm©
=format)

52 
def
 
	$g‘_objeù
(
£lf
, 
v›w_Çme
, 
v›w_¬gs
, 
v›w_kw¬gs
):

53  
£lf
.
qu”y£t
.
	`g‘
(
pk
=
v›w_kw¬gs
['pk'])

55 
def
 
	$u£_pk_Úly_İtimiz©iÚ
(
£lf
):

56 #W
have
 
the
 
com¶‘e
 
objeù
 
š¡ªû
 
®»ady
. 
We
 
dÚ
't‚eed

57 #tØ
run
 
the
 'Úly g‘hpk fÜhi »ÏtiÚsh' 
code
.

58  
F®£


61 
şass
 
	$Cu¡om”S”Ÿliz”
(
£rŸliz”s
.
Hy³¾škedMod–S”Ÿliz”
):

62 
subsütiÚs
 = 
	`SubsütiÚU¾
(
v›w_Çme
='subsütiÚ-d‘a', 
mªy
=
True
,

63 
»ad_Úly
=
True
)

64 
·ym’t_m‘hods
 = 
£rŸliz”s
.
	`Hy³¾škedId’t™yF›ld
(

65 
v›w_Çme
='·ym’t-m‘hod-li¡', 
sourû
='*',

66 
lookup_u¾_kw¬g
='customer_pk'

68 
Œª§ùiÚs
 = 
£rŸliz”s
.
	`Hy³¾škedId’t™yF›ld
(

69 
v›w_Çme
='Œª§ùiÚ-li¡', 
sourû
='*',

70 
lookup_u¾_kw¬g
='customer_pk'

72 
m‘a
 = 
	$JSONF›ld
(
»quœed
=
F®£
)

73 
u¾
 = 
	`Cu¡om”U¾
(
v›w_Çme
='cu¡om”-d‘a', 
»ad_Úly
=
True
, 
sourû
='*')

75 
şass
 
M‘a
:

76 
mod–
 = 
Cu¡om”


77 
f›lds
 = ('id', 'url', 'customer_reference', 'first_name', 'last_name',

	@silver/api/serializers/common.py

1 
äom
 
»¡_äamewÜk
 
impÜt
 
£rŸliz”s


2 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

3 
äom
 
	g»¡_äamewÜk
.
»ÏtiÚs
 
impÜt
 
Hy³¾škedR–©edF›ld


5 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


7 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
´oduù_codes_£rŸliz”
 
impÜt
 
ProduùCodeR–©edF›ld


8 
äom
 
	gsv”
.
mod–s
 
impÜt
 
M‘”edF—tu»


11 
şass
 
	$Cu¡om”U¾
(
Hy³¾škedR–©edF›ld
):

12 
def
 
	$g‘_u¾
(
£lf
, 
obj
, 
v›w_Çme
, 
»que¡
, 
fÜm©
):

13 
kw¬gs
 = {'cu¡om”_pk': 
obj
.
pk
}

14  
£lf
.
	$»v”£
(
v›w_Çme
, 
kw¬gs
=kw¬gs, 
»que¡
ôeque¡, 
fÜm©
=format)

16 
def
 
	$g‘_objeù
(
£lf
, 
v›w_Çme
, 
v›w_¬gs
, 
v›w_kw¬gs
):

17  
£lf
.
qu”y£t
.
	`g‘
(
pk
=
v›w_kw¬gs
['customer_pk'])

19 
def
 
	$u£_pk_Úly_İtimiz©iÚ
(
£lf
):

20 #W
have
 
the
 
com¶‘e
 
objeù
 
š¡ªû
 
®»ady
. 
We
 
dÚ
't‚eed

21 #tØ
run
 
the
 'Úly g‘hpk fÜhi »ÏtiÚsh' 
code
.

22  
F®£


25 
şass
 
	$Paym’tM‘hodT¿n§ùiÚsU¾
(
£rŸliz”s
.
Hy³¾škedId’t™yF›ld
):

26 
def
 
	$g‘_u¾
(
£lf
, 
obj
, 
v›w_Çme
, 
»que¡
, 
fÜm©
):

27 
lookup_v®ue
 = 
	$g‘©Œ
(
obj
, 
£lf
.
lookup_f›ld
)

28 
kw¬gs
 = {'·ym’t_m‘hod_id': 
	`¡r
(
lookup_v®ue
),

29 'cu¡om”_pk': 
obj
.
cu¡om”_id
}

30  
£lf
.
	$»v”£
(
v›w_Çme
, 
kw¬gs
=kwargs,

31 
»que¡
ôeque¡, 
fÜm©
=format)

34 
şass
 
	$M‘”edF—tu»S”Ÿliz”
(
£rŸliz”s
.
Mod–S”Ÿliz”
):

35 
´oduù_code
 = 
	$ProduùCodeR–©edF›ld
()

37 
şass
 
M‘a
:

38 
mod–
 = 
M‘”edF—tu»


39 
f›lds
 = ('name', 'unit', 'price_per_unit', 'included_units',

42 
def
 
	$ü—‹
(
£lf
, 
v®id©ed_d©a
):

43 
´oduù_code
 = 
v®id©ed_d©a
.
	`pİ
('product_code')

44 
´oduù_code
.
	$§ve
()

46 
v®id©ed_d©a
.
	`upd©e
({'´oduù_code': 
´oduù_code
})

48 
m‘”ed_ã©u»
 = 
M‘”edF—tu»
.
objeùs
.
	$ü—‹
(**
v®id©ed_d©a
)

50  
m‘”ed_ã©u»


53 
şass
 
	$PDFU¾
(
£rŸliz”s
.
Hy³¾škedR–©edF›ld
):

54 
def
 
	$g‘_u¾
(
£lf
, 
obj
, 
v›w_Çme
, 
»que¡
, 
fÜm©
):

55 
	$nÙ
 (
obj
.
pdf
 
ªd
 obj.pdf.
u¾
):

56  
NÚe


58 
	`g‘©Œ
(
£‰šgs
, 'SILVER_SHOW_PDF_STORAGE_URL', 
True
):

59  
»que¡
.
	$bud_absŞu‹_uri
(
obj
.
pdf
.
u¾
)

61  
£lf
.
	`»v”£
(
v›w_Çme
, 
kw¬gs
={'pdf_pk': 
obj
.
pdf
.
pk
},

62 
	g»que¡
=
»que¡
, 
	gfÜm©
=
fÜm©
)

	@silver/api/serializers/documents_serializers.py

1 
äom
 
»¡_äamewÜk
 
impÜt
 
	g£rŸliz”s


3 #äom 
sv”
.
­i
.
£rŸliz”s
 
impÜt
 
PDFU¾


4 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
commÚ
 
impÜt
 
	gCu¡om”U¾
, 
PDFU¾


5 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
Œª§ùiÚ_£rŸliz”s
 
impÜt
 
T¿n§ùiÚS”Ÿliz”


6 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gDocum’tEÁry
, 
	gCu¡om”
, 
	gInvoiû
, 
	gProfÜma
, 
BlšgDocum’tBa£


9 
şass
 
	$Docum’tEÁryS”Ÿliz”
(
£rŸliz”s
.
Hy³¾škedMod–S”Ÿliz”
):

10 
´oduù_code
 = 
£rŸliz”s
.
	`SlugR–©edF›ld
(

11 
¦ug_f›ld
='value',

12 
»ad_Úly
=
True


15 
şass
 
M‘a
:

16 
mod–
 = 
Docum’tEÁry


17 
f›lds
 = ('description', 'unit', 'unit_price', 'quantity', 'total',

22 
şass
 
	$Docum’tU¾
(
£rŸliz”s
.
Hy³¾škedId’t™yF›ld
):

23 
def
 
	$__š™__
(
£lf
, 
´ofÜma_v›w_Çme
, 
švoiû_v›w_Çme
, *
¬gs
, **
kw¬gs
):

24 #th
v›w_Çme
 
is
 
»quœed
 
Ú
 
HIF
 
š™
, 
but
 
we
 
Úly
 
know
 
wh©
 
™
 
wl


25 #b
š
 
g‘_u¾


26 
kw¬gs
['view_name'] = ''

27 
	`su³r
(
Docum’tU¾
, 
£lf
).
	$__š™__
(*
¬gs
, **
kw¬gs
)

29 
£lf
.
švoiû_v›w_Çme
 = invoice_view_name

30 
£lf
.
´ofÜma_v›w_Çme
 =…roforma_view_name

32 
def
 
	$g‘_u¾
(
£lf
, 
obj
, 
v›w_Çme
, 
»que¡
, 
fÜm©
):

33 
v›w_Çme
 = (
£lf
.
švoiû_v›w_Çme
 
obj
.
kšd
 == 'invoice' 

34 
£lf
.
´ofÜma_v›w_Çme
)

36 
lookup_v®ue
 = 
	$g‘©Œ
(
obj
, 
£lf
.
lookup_f›ld
)

38 
nÙ
 
lookup_v®ue
:

41 
kw¬gs
 = {

42 
£lf
.
lookup_u¾_kw¬g
: 
	`¡r
(
lookup_v®ue
)

43 
	}
}

45  
£lf
.
	$»v”£
(
v›w_Çme
, 
kw¬gs
=kwargs,

46 
»que¡
ôeque¡, 
fÜm©
=format)

49 
şass
 
	$Docum’tS”Ÿliz”
(
£rŸliz”s
.
Hy³¾škedMod–S”Ÿliz”
):

51 
A
 
»ad
-
Úly
 
£rŸliz”s
 
ProfÜmas
 
ªd
 
Invoiûs


53 
cu¡om”
 = 
	`Cu¡om”U¾
(
v›w_Çme
='customer-detail',

54 
qu”y£t
=
Cu¡om”
.
objeùs
.
	$®l
())

55 
pdf_u¾
 = 
	`PDFU¾
(
v›w_Çme
='pdf', 
sourû
='*', 
»ad_Úly
=
True
)

56 
u¾
 = 
	`Docum’tU¾
(
´ofÜma_v›w_Çme
='proforma-detail',

57 
švoiû_v›w_Çme
='invoice-detail', )

59 
Œª§ùiÚs
 = 
£rŸliz”s
.
	$S”Ÿliz”M‘hodF›ld
()

61 
def
 
	$g‘_Œª§ùiÚs
(
£lf
, 
docum’t
):

62 
docum’t
.
kšd
 == 'invoice':

63 
Œª§ùiÚs
 = 
docum’t
.
švoiû_Œª§ùiÚs
.
	$®l
()

64 
–if
 
docum’t
.
kšd
 == 'proforma':

65 
Œª§ùiÚs
 = 
docum’t
.
´ofÜma_Œª§ùiÚs
.
	$®l
()

69 
Œª§ùiÚ
 
š
 
Œª§ùiÚs
:

70 #Thi 
is
 
dÚe
 
to
 
avoid
 
´eãtchšg
 
®»ady
 
´eãtched
 
»sourûs


71 
Œª§ùiÚ
.
·ym’t_m‘hod
.
cu¡om”
 = 
docum’t
.customer

72 
Œª§ùiÚ
.
´ovid”
 = 
docum’t
.provider

74  
	`T¿n§ùiÚS”Ÿliz”
(
Œª§ùiÚs
, 
mªy
=
True
,

75 
cÚ‹xt
=
£lf
.cÚ‹xt).
d©a


77 
şass
 
M‘a
:

78 
mod–
 = 
BlšgDocum’tBa£


79 
f›lds
 = ('id', 'url', 'kind', 'series', 'number', 'provider',

84 
»ad_Úly_f›lds
 = 
f›lds


87 
şass
 
	$InvoiûS”Ÿliz”
(
£rŸliz”s
.
Hy³¾škedMod–S”Ÿliz”
):

88 
švoiû_’Œ›s
 = 
	$Docum’tEÁryS”Ÿliz”
(
mªy
=
True
)

89 
pdf_u¾
 = 
	`PDFU¾
(
v›w_Çme
='pdf', 
sourû
='*', 
»ad_Úly
=
True
)

90 
cu¡om”
 = 
	`Cu¡om”U¾
(
v›w_Çme
='customer-detail',

91 
qu”y£t
=
Cu¡om”
.
objeùs
.
	$®l
())

92 
Œª§ùiÚs
 = 
	$T¿n§ùiÚS”Ÿliz”
(
mªy
=
True
, 
»ad_Úly
=True)

94 
şass
 
M‘a
:

95 
mod–
 = 
Invoiû


96 
f›lds
 = ('id', 'series', 'number', 'provider', 'customer',

103 
»ad_Úly_f›lds
 = ('archived_provider', 'archived_customer', 'total',

105 
exŒa_kw¬gs
 = {

106 'Œª§ùiÚ_cu¼’cy': {'»quœed': 
F®£
},

108 
	}
}

110 
def
 
	$ü—‹
(
£lf
, 
v®id©ed_d©a
):

111 
’Œ›s
 = 
v®id©ed_d©a
.
	`pİ
('švoiû_’Œ›s', 
NÚe
)

113 #C»©
the
 
Ãw
 
švoiû
 
objeù


114 
švoiû
 = 
Invoiû
.
objeùs
.
	$ü—‹
(**
v®id©ed_d©a
)

116 #Add 
the
 
švoiû
 
’Œ›s


117 
’Œy
 
š
 
’Œ›s
:

118 
’Œy_diù
 = 
	$diù
()

119 
’Œy_diù
['švoiû'] = 
švoiû


120 
f›ld
 
š
 
’Œy
.
	$™ems
():

121 
’Œy_diù
[
f›ld
[0]] = field[1]

123 
Docum’tEÁry
.
objeùs
.
	$ü—‹
(**
’Œy_diù
)

125  
švoiû


127 
def
 
	$upd©e
(
£lf
, 
š¡ªû
, 
v®id©ed_d©a
):

128 #Th
´ovid”
 
has
 
chªged
 => 
fÜû
 
the
 
g’”©iÚ
 
of
h
cÜ»ù
 
numb”


129 #cÜ»¥Údšg 
to
 
the
 
couÁ
 
of
h
Ãw
 
´ovid”


130 
cu¼’t_´ovid”
 = 
š¡ªû
.
´ovid”


131 
Ãw_´ovid”
 = 
v®id©ed_d©a
.
	`g‘
('provider')

132 
Ãw_´ovid”
 
ªd
‚ew_´ovid” !ğ
cu¼’t_´ovid”
:

133 
š¡ªû
.
numb”
 = 
NÚe


135 
upd©—bË_f›lds
 = 
š¡ªû
.updateable_fields

136 
f›ld_Çme
 
š
 
upd©—bË_f›lds
:

137 
f›ld_v®ue
 = 
v®id©ed_d©a
.
	`g‘
(
f›ld_Çme
,

138 
	$g‘©Œ
(
š¡ªû
, 
f›ld_Çme
))

139 
	$£‰r
(
š¡ªû
, 
f›ld_Çme
, 
f›ld_v®ue
)

140 
š¡ªû
.
	$§ve
()

142  
š¡ªû


144 
def
 
	$v®id©e
(
£lf
, 
d©a
):

145 
d©a
 = 
	`su³r
(
InvoiûS”Ÿliz”
, 
£lf
).
	$v®id©e
(
d©a
)

147 
£lf
.
š¡ªû
:

148 
£lf
.
š¡ªû
.
	$ş—n
()

150 
£lf
.
š¡ªû
 
ªd
 
d©a
['¡©e'] !ğ£lf.š¡ªû.
¡©e
:

151 
msg
 = "Direct state modification is‚ot‡llowed." \

153 
¿i£
 
£rŸliz”s
.
	$V®id©iÚE¼Ü
(
msg
)

154  
d©a


157 
şass
 
	$ProfÜmaS”Ÿliz”
(
£rŸliz”s
.
Hy³¾škedMod–S”Ÿliz”
):

158 
´ofÜma_’Œ›s
 = 
	$Docum’tEÁryS”Ÿliz”
(
mªy
=
True
)

159 
pdf_u¾
 = 
	`PDFU¾
(
v›w_Çme
='pdf', 
sourû
='*', 
»ad_Úly
=
True
)

160 
cu¡om”
 = 
	`Cu¡om”U¾
(
v›w_Çme
='customer-detail',

161 
qu”y£t
=
Cu¡om”
.
objeùs
.
	$®l
())

162 
Œª§ùiÚs
 = 
	$T¿n§ùiÚS”Ÿliz”
(
mªy
=
True
, 
»ad_Úly
=True)

164 
şass
 
M‘a
:

165 
mod–
 = 
ProfÜma


166 
f›lds
 = ('id', 'series', 'number', 'provider', 'customer',

173 
»ad_Úly_f›lds
 = ('archived_provider', 'archived_customer', 'total',

175 
exŒa_kw¬gs
 = {

176 'Œª§ùiÚ_cu¼’cy': {'»quœed': 
F®£
},

178 
	}
}

180 
def
 
	$ü—‹
(
£lf
, 
v®id©ed_d©a
):

181 
’Œ›s
 = 
v®id©ed_d©a
.
	`pİ
('´ofÜma_’Œ›s', 
NÚe
)

183 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	$ü—‹
(**
v®id©ed_d©a
)

185 
’Œy
 
š
 
’Œ›s
:

186 
’Œy_diù
 = 
	$diù
()

187 
’Œy_diù
['´ofÜma'] = 
´ofÜma


188 
f›ld
 
š
 
’Œy
.
	$™ems
():

189 
’Œy_diù
[
f›ld
[0]] = field[1]

191 
Docum’tEÁry
.
objeùs
.
	$ü—‹
(**
’Œy_diù
)

193  
´ofÜma


195 
def
 
	$upd©e
(
£lf
, 
š¡ªû
, 
v®id©ed_d©a
):

196 #Th
´ovid”
 
has
 
chªged
 => 
fÜû
 
the
 
g’”©iÚ
 
of
h
cÜ»ù
 
numb”


197 #cÜ»¥Údšg 
to
 
the
 
couÁ
 
of
h
Ãw
 
´ovid”


198 
cu¼’t_´ovid”
 = 
š¡ªû
.
´ovid”


199 
Ãw_´ovid”
 = 
v®id©ed_d©a
.
	`g‘
('provider')

200 
Ãw_´ovid”
 
ªd
‚ew_´ovid” !ğ
cu¼’t_´ovid”
:

201 
š¡ªû
.
numb”
 = 
NÚe


203 
upd©—bË_f›lds
 = 
š¡ªû
.updateable_fields

204 
f›ld_Çme
 
š
 
upd©—bË_f›lds
:

205 
f›ld_v®ue
 = 
v®id©ed_d©a
.
	`g‘
(
f›ld_Çme
,

206 
	$g‘©Œ
(
š¡ªû
, 
f›ld_Çme
))

207 
	$£‰r
(
š¡ªû
, 
f›ld_Çme
, 
f›ld_v®ue
)

208 
š¡ªû
.
	$§ve
()

210  
š¡ªû


212 
def
 
	$v®id©e
(
£lf
, 
d©a
):

213 
d©a
 = 
	`su³r
(
ProfÜmaS”Ÿliz”
, 
£lf
).
	$v®id©e
(
d©a
)

215 
£lf
.
š¡ªû
:

216 
£lf
.
š¡ªû
.
	$ş—n
()

218 
£lf
.
š¡ªû
 
ªd
 
d©a
['¡©e'] !ğ£lf.š¡ªû.
¡©e
:

219 
msg
 = "Direct state modification is‚ot‡llowed." \

221 
¿i£
 
£rŸliz”s
.
	$V®id©iÚE¼Ü
(
msg
)

222  
d©a


	@silver/api/serializers/payment_methods_serializers.py

1 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
	gObjeùDÛsNÙExi¡
, 
	gV®id©iÚE¼Ü
, 
NON_FIELD_ERRORS


2 
äom
 
»¡_äamewÜk
 
impÜt
 
£rŸliz”s


4 
äom
 
sv”
 
impÜt
 
	g·ym’t_´oûssÜs


5 #äom 
sv”
.
­i
.
£rŸliz”s
 
impÜt
 
Paym’tM‘hodT¿n§ùiÚsU¾
, 
Paym’tProûssÜS”Ÿliz”


6 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
commÚ
 
impÜt
 
	gCu¡om”U¾
, 
Paym’tM‘hodT¿n§ùiÚsU¾


7 
äom
 
	gsv”
.
mod–s
 
impÜt
 
Paym’tM‘hod


10 
şass
 
	$Paym’tProûssÜU¾
(
£rŸliz”s
.
Hy³¾škedR–©edF›ld
):

11 
def
 
	$__š™__
(
£lf
, 
v›w_Çme
=
NÚe
, **
kw¬gs
):

12 
	`su³r
(
Paym’tProûssÜU¾
, 
£lf
).
	$__š™__
(
v›w_Çme
, **
kw¬gs
)

14 
def
 
	$g‘_u¾
(
£lf
, 
obj
, 
v›w_Çme
, 
»que¡
, 
fÜm©
):

15 
lookup_v®ue
 = 
	$g‘©Œ
(
obj
, 
£lf
.
lookup_f›ld
)

16 
kw¬gs
 = {'´oûssÜ_Çme': 
lookup_v®ue
}

18  
£lf
.
	$»v”£
(

19 
v›w_Çme
, 
kw¬gs
=kw¬gs, 
»que¡
ôeque¡, 
fÜm©
=format

22 
def
 
	$g‘_objeù
(
£lf
, 
v›w_Çme
, 
v›w_¬gs
, 
v›w_kw¬gs
):

23 
Œy
:

24  
·ym’t_´oûssÜs
.
	`g‘_š¡ªû
(
v›w_kw¬gs
['processor_name'])

25 
exû±
 
ImpÜtE¼Ü
:

26 
¿i£
 
ObjeùDÛsNÙExi¡


29 
şass
 
	$Paym’tM‘hodU¾
(
£rŸliz”s
.
Hy³¾škedR–©edF›ld
):

30 
def
 
	$g‘_u¾
(
£lf
, 
obj
, 
v›w_Çme
, 
»que¡
, 
fÜm©
):

31 
kw¬gs
 = {'·ym’t_m‘hod_id': 
obj
.
pk
,

32 'cu¡om”_pk': 
obj
.
cu¡om”_id
}

33  
£lf
.
	$»v”£
(
v›w_Çme
, 
kw¬gs
=kw¬gs, 
»que¡
ôeque¡, 
fÜm©
=format)

35 
def
 
	$g‘_objeù
(
£lf
, 
v›w_Çme
, 
v›w_¬gs
, 
v›w_kw¬gs
):

36  
£lf
.
qu”y£t
.
	`g‘
(
id
=
v›w_kw¬gs
['payment_method_id'])

39 
şass
 
	$Paym’tM‘hodS”Ÿliz”
(
£rŸliz”s
.
Hy³¾škedMod–S”Ÿliz”
):

40 
u¾
 = 
	`Paym’tM‘hodU¾
(
v›w_Çme
='·ym’t-m‘hod-d‘a', 
sourû
="*",

41 
»ad_Úly
=
True
)

42 
Œª§ùiÚs
 = 
	`Paym’tM‘hodT¿n§ùiÚsU¾
(

43 
v›w_Çme
='·ym’t-m‘hod-Œª§ùiÚ-li¡', 
sourû
='*')

44 
·ym’t_´oûssÜ_Çme
 = 
£rŸliz”s
.
	`Mod–F›ld
(

45 
mod–_f›ld
=
	`Paym’tM‘hod
().
_m‘a
.
	`g‘_f›ld
('payment_processor'),

46 
sourû
="payment_processor",

47 
Ïb–
="Payment Processor"

49 
·ym’t_´oûssÜ
 = 
£rŸliz”s
.
	$S”Ÿliz”M‘hodF›ld
()

51 
def
 
	$g‘_·ym’t_´oûssÜ
(
£lf
, 
obj
):

52  
	`Paym’tProûssÜS”Ÿliz”
(
obj
.
	`g‘_·ym’t_´oûssÜ
(),

53 
cÚ‹xt
=
£lf
.cÚ‹xt).
d©a


55 
şass
 
M‘a
:

56 
mod–
 = 
Paym’tM‘hod


57 
f›lds
 = ('url', 'transactions', 'customer', 'payment_processor_name',

60 
exŒa_kw¬gs
 = {

61 'added_©': {'»ad_Úly': 
True
},

62 'cu¡om”': {'»ad_Úly': 
True
, 'lookup_url_kwarg': 'customer_pk'}

63 
	}
}

65 
def
 
	$v®id©e
(
£lf
, 
©Œs
):

66 
©Œs
 = 
	`su³r
(
Paym’tM‘hodS”Ÿliz”
, 
£lf
).
	$v®id©e
(
©Œs
)

68 
£lf
.
š¡ªû
:

69 
£lf
.
š¡ªû
.
ÿnûËd
:

70 
¿i£
 
	`V®id©iÚE¼Ü
(

74 #RuÀ
mod–
 
ş—n
 
ªd
 
hªdË
 
V®id©iÚE¼Üs


75 
Œy
:

76 #U£ 
the
 
exi¡šg
 
š¡ªû
 
to
 
avoid
 
unique
 
f›ld
 
”rÜs


77 
·ym’t_m‘hod
 = 
£lf
.
š¡ªû


78 
·ym’t_m‘hod_diù
 = 
·ym’t_m‘hod
.
__diù__
.
	$cİy
()

80 
©Œibu‹
, 
v®ue
 
š
 
©Œs
.
	$™ems
():

81 
	$£‰r
(
·ym’t_m‘hod
, 
©Œibu‹
, 
v®ue
)

83 
·ym’t_m‘hod
.
	$fuÎ_ş—n
()

85 #Rev”ˆ
chªges
 
to
 
exi¡šg
 
š¡ªû


86 
·ym’t_m‘hod
.
__diù__
 = 
·ym’t_m‘hod_diù


87 
exû±
 
V®id©iÚE¼Ü
 
as
 
e
:

88 
”rÜs
 = 
e
.
”rÜ_diù


89 
nÚ_f›ld_”rÜs
 = 
”rÜs
.
	$pİ
(
NON_FIELD_ERRORS
, 
NÚe
)

90 
nÚ_f›ld_”rÜs
:

91 
”rÜs
['non_field_errors'] = [

92 
”rÜ
 
subli¡
 
š
 
nÚ_f›ld_”rÜs
 error in sublist

94 
¿i£
 
£rŸliz”s
.
	$V®id©iÚE¼Ü
(
”rÜs
)

96  
©Œs


98 
def
 
	$v®id©e_·ym’t_´oûssÜ_Çme
(
£lf
, 
v®ue
):

99 
v®ue
 
nÙ
 
š
 
Paym’tM‘hod
.
Paym’tProûssÜs
.
	$as_li¡
():

100 
¿i£
 
£rŸliz”s
.
	`V®id©iÚE¼Ü
('"{}" is‚ot‡ valid '

101 'choiû'.
	$fÜm©
(
v®ue
))

102 
£lf
.
š¡ªû
 
ªd
 
v®ue
 !ğ£lf.š¡ªû.
·ym’t_´oûssÜ
:

103 
mes§ge
 = "This field may‚ot be modified."

104 
¿i£
 
£rŸliz”s
.
	$V®id©iÚE¼Ü
(
mes§ge
)

106  
v®ue


108 
def
 
	$v®id©e_v”if›d
(
£lf
, 
v®ue
):

109 
£lf
.
š¡ªû
 
ªd
 
nÙ
 
v®ue
‡nd s–f.š¡ªû.
v”if›d
:

110 
mes§ge
 = "You cannot unverify‡…ayment method."

111 
¿i£
 
£rŸliz”s
.
	$V®id©iÚE¼Ü
(
mes§ge
)

113  
v®ue


116 
şass
 
	$Paym’tProûssÜS”Ÿliz”
(
£rŸliz”s
.
S”Ÿliz”
):

117 
ty³
 = 
£rŸliz”s
.
	$Ch¬F›ld
(
max_Ëngth
=64)

118 
Çme
 = 
£rŸliz”s
.
	$Ch¬F›ld
(
max_Ëngth
=64)

119 
®lowed_cu¼’c›s
 = 
£rŸliz”s
.
	$Li¡F›ld
()

120 
u¾
 = 
	`Paym’tProûssÜU¾
(

121 
v›w_Çme
='·ym’t-´oûssÜ-d‘a', 
sourû
='*', 
lookup_f›ld
='name',

122 
»ad_Úly
=
True


	@silver/api/serializers/plans_serializer.py

1 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
V®id©iÚE¼Ü


2 
äom
 
»¡_äamewÜk
 
impÜt
 
£rŸliz”s


4 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
commÚ
 
impÜt
 
M‘”edF—tu»S”Ÿliz”


5 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
´oduù_codes_£rŸliz”
 
impÜt
 
ProduùCodeR–©edF›ld


6 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gProvid”
, 
	gPÏn
, 
M‘”edF—tu»


9 
şass
 
	$PÏnS”Ÿliz”
(
£rŸliz”s
.
Hy³¾škedMod–S”Ÿliz”
):

10 
m‘”ed_ã©u»s
 = 
	$M‘”edF—tu»S”Ÿliz”
(

11 
»quœed
=
F®£
, 
mªy
=
True


13 
´ovid”
 = 
£rŸliz”s
.
	`Hy³¾škedR–©edF›ld
(

14 
qu”y£t
=
Provid”
.
objeùs
.
	`®l
(),

15 
v›w_Çme
='provider-detail',

17 
´oduù_code
 = 
	$ProduùCodeR–©edF›ld
()

19 
şass
 
M‘a
:

20 
mod–
 = 
PÏn


21 
f›lds
 = ('name', 'url', 'interval', 'interval_count', 'amount',

25 
def
 
	$v®id©e_m‘”ed_ã©u»s
(
£lf
, 
v®ue
):

26 
m‘”ed_ã©u»s
 = []

27 
mf_d©a
 
š
 
v®ue
:

28 
m‘”ed_ã©u»s
.
	`­³nd
(
	$M‘”edF—tu»
(**
mf_d©a
))

30 
Œy
:

31 
PÏn
.
	$v®id©e_m‘”ed_ã©u»s
(
m‘”ed_ã©u»s
)

32 
exû±
 
V®id©iÚE¼Ü
, 
e
:

33 
¿i£
 
£rŸliz”s
.
	`V®id©iÚE¼Ü
(
	`¡r
(
e
)[3:-2])

35  
v®ue


37 
def
 
	$ü—‹
(
£lf
, 
v®id©ed_d©a
):

38 
m‘”ed_ã©u»s_d©a
 = 
v®id©ed_d©a
.
	`pİ
('metered_features')

39 
m‘”ed_ã©u»s
 = []

40 
mf_d©a
 
š
 
m‘”ed_ã©u»s_d©a
:

41 
mf
 = 
	$M‘”edF—tu»S”Ÿliz”
(
d©a
=
mf_d©a
)

42 
mf
.
	$is_v®id
(
¿i£_exû±iÚ
=
True
)

43 
mf
 = mf.
	$ü—‹
(
mf
.
v®id©ed_d©a
)

44 
m‘”ed_ã©u»s
.
	$­³nd
(
mf
)

46 
´oduù_code
 = 
v®id©ed_d©a
.
	`pİ
('product_code')

47 
´oduù_code
.
	$§ve
()

49 
v®id©ed_d©a
.
	`upd©e
({'´oduù_code': 
´oduù_code
})

51 
¶ª
 = 
PÏn
.
objeùs
.
	$ü—‹
(**
v®id©ed_d©a
)

52 
¶ª
.
m‘”ed_ã©u»s
.
	$add
(*
m‘”ed_ã©u»s
)

53 
¶ª
.
´oduù_code
 =…roduct_code

55 
¶ª
.
	$§ve
()

57  
¶ª


59 
def
 
	$upd©e
(
£lf
, 
š¡ªû
, 
v®id©ed_d©a
):

60 
š¡ªû
.
Çme
 = 
v®id©ed_d©a
.
	`g‘
('name', instance.name)

61 
š¡ªû
.
g’”©e_aá”
 = 
v®id©ed_d©a
.
	`g‘
('generate_after',

62 
š¡ªû
.
g’”©e_aá”
)

63 
š¡ªû
.
due_days
 = 
v®id©ed_d©a
.
	`g‘
('due_days', instance.due_days)

64 
š¡ªû
.
	$§ve
()

66  
š¡ªû


	@silver/api/serializers/product_codes_serializer.py

1 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
ObjeùDÛsNÙExi¡


2 
äom
 
»¡_äamewÜk
 
impÜt
 
£rŸliz”s


4 
äom
 
	gsv”
.
mod–s
 
impÜt
 
ProduùCode


7 
şass
 
	$ProduùCodeR–©edF›ld
(
£rŸliz”s
.
SlugR–©edF›ld
):

8 
def
 
	$__š™__
(
£lf
, **
kw¬gs
):

9 
	`su³r
(
ProduùCodeR–©edF›ld
, 
£lf
).
	`__š™__
(

10 
¦ug_f›ld
='v®ue', 
qu”y£t
=
ProduùCode
.
objeùs
.
	`®l
(), **
kw¬gs
)

12 
def
 
	$to_š‹º®_v®ue
(
£lf
, 
d©a
):

13 
Œy
:

14  
ProduùCode
.
objeùs
.
	`g‘
(**{
£lf
.
¦ug_f›ld
: 
d©a
})

15 
exû±
 
ObjeùDÛsNÙExi¡
:

16  
ProduùCode
(**{
£lf
.
¦ug_f›ld
: 
d©a
})

17 
	$exû±
 (
Ty³E¼Ü
, 
V®ueE¼Ü
):

18 
£lf
.
	`ç
('invalid')

21 
şass
 
	$ProduùCodeS”Ÿliz”
(
£rŸliz”s
.
Hy³¾škedMod–S”Ÿliz”
):

22 
şass
 
M‘a
:

23 
mod–
 = 
ProduùCode


24 
f›lds
 = ('url', 'value')

	@silver/api/serializers/subscriptions_serializers.py

1 
äom
 
»¡_äamewÜk
 
impÜt
 
£rŸliz”s


2 
äom
 
	g»¡_äamewÜk
.
f›lds
 
impÜt
 
JSONF›ld


3 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

5 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
commÚ
 
impÜt
 
	gCu¡om”U¾
, 
M‘”edF—tu»S”Ÿliz”


6 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
¶ªs_£rŸliz”
 
impÜt
 
PÏnS”Ÿliz”


7 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gM‘”edF—tu»Un™sLog
, 
	gSubsütiÚ
, 
Cu¡om”


10 
şass
 
	$MFUn™sLogU¾
(
£rŸliz”s
.
Hy³¾škedR–©edF›ld
):

11 
def
 
	$g‘_u¾
(
£lf
, 
obj
, 
v›w_Çme
, 
»que¡
, 
fÜm©
):

12 
cu¡om”_pk
 = 
»que¡
.
·r£r_cÚ‹xt
['kwargs']['customer_pk']

13 
subsütiÚ_pk
 = 
»que¡
.
·r£r_cÚ‹xt
['kwargs']['subscription_pk']

14 
kw¬gs
 = {

15 'cu¡om”_pk': 
cu¡om”_pk
,

16 'subsütiÚ_pk': 
subsütiÚ_pk
,

17 'mf_´oduù_code': 
obj
.
´oduù_code
.
v®ue


18 
	}
}

19  
£lf
.
	$»v”£
(
v›w_Çme
, 
kw¬gs
=kw¬gs, 
»que¡
=request,

20 
fÜm©
=format)

23 
şass
 
	$M‘”edF—tu»InSubsütiÚS”Ÿliz”
(
M‘”edF—tu»S”Ÿliz”
):

24 
u¾
 = 
	`MFUn™sLogU¾
(
v›w_Çme
='mf-log-un™s', 
sourû
='*', 
»ad_Úly
=
True
)

26 
şass
 
	$M‘a
(
M‘”edF—tu»S”Ÿliz”
.
M‘a
):

27 
f›lds
 = 
M‘”edF—tu»S”Ÿliz”
.
M‘a
.fields + ('url',)

30 
şass
 
	$MFUn™sLogS”Ÿliz”
(
£rŸliz”s
.
Hy³¾škedMod–S”Ÿliz”
):

31 #Th2 
lšes
 
b–ow
 
¬e
 
Ãeded
 
beÿu£
 
of
 
a
 
DRF3
 
bug


32 
¡¬t_d©e
 = 
£rŸliz”s
.
	$D©eF›ld
(
»ad_Úly
=
True
)

33 
’d_d©e
 = 
£rŸliz”s
.
	$D©eF›ld
(
»ad_Úly
=
True
)

35 
şass
 
M‘a
:

36 
mod–
 = 
M‘”edF—tu»Un™sLog


37 
f›lds
 = ('consumed_units', 'start_date', 'end_date')

40 
şass
 
	$SubsütiÚU¾
(
£rŸliz”s
.
Hy³¾škedR–©edF›ld
):

41 
def
 
	$g‘_u¾
(
£lf
, 
obj
, 
v›w_Çme
, 
»que¡
, 
fÜm©
):

42 
kw¬gs
 = {'cu¡om”_pk': 
obj
.
cu¡om”_id
, 'subsütiÚ_pk': obj.
pk
}

43  
	$»v”£
(
v›w_Çme
, 
kw¬gs
=kw¬gs, 
»que¡
=request,

44 
fÜm©
=format)

47 
şass
 
	$SubsütiÚS”Ÿliz”
(
£rŸliz”s
.
Hy³¾škedMod–S”Ÿliz”
):

48 
ŒŸl_’d
 = 
£rŸliz”s
.
	$D©eF›ld
(
»quœed
=
F®£
)

49 
¡¬t_d©e
 = 
£rŸliz”s
.
	$D©eF›ld
(
»quœed
=
F®£
)

50 
’ded_©
 = 
£rŸliz”s
.
	$D©eF›ld
(
»ad_Úly
=
True
)

51 
u¾
 = 
	`SubsütiÚU¾
(
v›w_Çme
='subsütiÚ-d‘a', 
sourû
='*',

52 
qu”y£t
=
SubsütiÚ
.
objeùs
.
	`®l
(), 
»quœed
=
F®£
)

53 
upd©—bË_buck‘s
 = 
£rŸliz”s
.
	$R—dOÆyF›ld
()

54 
m‘a
 = 
	$JSONF›ld
(
»quœed
=
F®£
)

56 
şass
 
M‘a
:

57 
mod–
 = 
SubsütiÚ


58 
f›lds
 = ('id', 'url', 'plan', 'customer', 'trial_end', 'start_date',

61 
»ad_Úly_f›lds
 = ('state', 'updateable_buckets')

62 
exŒa_kw¬gs
 = {'cu¡om”': {'lookup_u¾_kw¬g': 'cu¡om”_pk'}
	}
}

64 
def
 
	$v®id©e
(
£lf
, 
©Œs
):

65 
©Œs
 = 
	`su³r
(
SubsütiÚS”Ÿliz”
, 
£lf
).
	$v®id©e
(
©Œs
)

67 
š¡ªû
 = 
	$SubsütiÚ
(**
©Œs
)

68 
š¡ªû
.
	$ş—n
()

69  
©Œs


72 
şass
 
	$SubsütiÚD‘aS”Ÿliz”
(
SubsütiÚS”Ÿliz”
):

73 
¶ª
 = 
	$PÏnS”Ÿliz”
(
»ad_Úly
=
True
)

75 
şass
 
	$M‘a
(
SubsütiÚS”Ÿliz”
.
M‘a
):

76 
f›lds
 = 
SubsütiÚS”Ÿliz”
.
M‘a
.fields + ('plan',)

	@silver/api/serializers/transaction_serializers.py

1 
impÜt
 
jwt


2 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


3 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
	gV®id©iÚE¼Ü
, 
NON_FIELD_ERRORS


4 
äom
 
»¡_äamewÜk
 
impÜt
 
£rŸliz”s


6 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
blšg_’t™›s_£rŸliz”s
 
impÜt
 
Provid”U¾


7 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
commÚ
 
impÜt
 
Cu¡om”U¾


8 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
·ym’t_m‘hods_£rŸliz”s
 
impÜt
 
Paym’tM‘hodU¾


9 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gPaym’tM‘hod
, 
T¿n§ùiÚ


11 
äom
 
	gsv”
.
	guts
.
·ym’ts
 
impÜt
 
g‘_·ym’t_u¾


14 
şass
 
	$T¿n§ùiÚU¾
(
£rŸliz”s
.
Hy³¾škedId’t™yF›ld
):

15 
def
 
	$g‘_u¾
(
£lf
, 
obj
, 
v›w_Çme
, 
»que¡
, 
fÜm©
):

16 
lookup_v®ue
 = 
	$g‘©Œ
(
obj
, 
£lf
.
lookup_f›ld
)

17 
kw¬gs
 = {'Œª§ùiÚ_uuid': 
	`¡r
(
lookup_v®ue
),

18 'cu¡om”_pk': 
obj
.
cu¡om”
.
pk
}

19  
£lf
.
	$»v”£
(
v›w_Çme
, 
kw¬gs
=kw¬gs, 
»que¡
ôeque¡, 
fÜm©
=format)

21 
def
 
	$g‘_objeù
(
£lf
, 
v›w_Çme
, 
v›w_¬gs
, 
v›w_kw¬gs
):

22  
£lf
.
qu”y£t
.
	`g‘
(
uuid
=
v›w_kw¬gs
['transaction_uuid'])

25 
şass
 
	$T¿n§ùiÚPaym’tU¾
(
£rŸliz”s
.
Hy³¾škedId’t™yF›ld
):

26 
def
 
	$g‘_u¾
(
£lf
, 
obj
, 
v›w_Çme
, 
»que¡
, 
fÜm©
):

27 
nÙ
 
obj
.
ÿn_be_cÚsumed
:

28  
NÚe


29  
	$g‘_·ym’t_u¾
(
obj
, 
»que¡
)

31 
def
 
	$g‘_objeù
(
£lf
, 
v›w_Çme
, 
v›w_¬gs
, 
v›w_kw¬gs
):

32 
Œy
:

33 
Œª§ùiÚ_uuid
 = 
jwt
.
	`decode
(
v›w_kw¬gs
['token'],

34 
£‰šgs
.
PAYMENT_METHOD_SECRET
)['transaction']

35  
£lf
.
qu”y£t
.
	$g‘
(
uuid
=
Œª§ùiÚ_uuid
)

36 
	$exû±
 (
jwt
.
ExpœedSigÇtu»E¼Ü
, jwt.
DecodeE¼Ü
, jwt.
Inv®idTok’E¼Ü
):

37  
NÚe


40 
şass
 
	$T¿n§ùiÚS”Ÿliz”
(
£rŸliz”s
.
Hy³¾škedMod–S”Ÿliz”
):

41 
·ym’t_m‘hod
 = 
	`Paym’tM‘hodU¾
(
v›w_Çme
='payment-method-detail',

42 
lookup_f›ld
='payment_method',

43 
qu”y£t
=
Paym’tM‘hod
.
objeùs
.
	$®l
())

44 
u¾
 = 
	`T¿n§ùiÚU¾
(
v›w_Çme
='Œª§ùiÚ-d‘a', 
lookup_f›ld
='uuid', )

45 
·y_u¾
 = 
	`T¿n§ùiÚPaym’tU¾
(
lookup_u¾_kw¬g
='token',

46 
v›w_Çme
='payment')

47 
cu¡om”
 = 
	`Cu¡om”U¾
(
v›w_Çme
='cu¡om”-d‘a', 
»ad_Úly
=
True
)

48 
´ovid”
 = 
	`Provid”U¾
(
v›w_Çme
='´ovid”-d‘a', 
»ad_Úly
=
True
)

49 
id
 = 
£rŸliz”s
.
	`Ch¬F›ld
(
sourû
='uuid', 
»ad_Úly
=
True
)

50 
amouÁ
 = 
£rŸliz”s
.
	$Decim®F›ld
(
»quœed
=
F®£
, 
decim®_¶aûs
=2,

51 
max_dig™s
=12, 
mš_v®ue
=0)

53 
şass
 
M‘a
:

54 
mod–
 = 
T¿n§ùiÚ


55 
f›lds
 = ('id', 'url', 'customer', 'provider', 'amount', 'currency',

61 
»ad_Úly_f›lds
 = ('customer', 'provider', 'can_be_consumed', 'pay_url',

65 
upd©—bË_f›lds
 = ('valid_until', 'success_url', 'failed_url')

66 
exŒa_kw¬gs
 = {'amouÁ': {'»quœed': 
F®£
},

67 'cu¼’cy': {'»quœed': 
F®£
},

69 '´ofÜma': {'v›w_Çme': '´ofÜma-d‘a'}
	}
}

71 
def
 
	$v®id©e
(
£lf
, 
©Œs
):

72 
©Œs
 = 
	`su³r
(
T¿n§ùiÚS”Ÿliz”
, 
£lf
).
	$v®id©e
(
©Œs
)

74 
nÙ
 
©Œs
:

75  
©Œs


77 
£lf
.
š¡ªû
:

78 
£lf
.
š¡ªû
.
¡©e
 !ğ
T¿n§ùiÚ
.
S‹s
.
In™Ÿl
:

79 
mes§ge
 = "Theransaction cannot be modified once it is in {}"\

80 " s‹.".
	$fÜm©
(
£lf
.
š¡ªû
.
¡©e
)

81 
¿i£
 
£rŸliz”s
.
	$V®id©iÚE¼Ü
(
mes§ge
)

83 #RuÀ
mod–
 
ş—n
 
ªd
 
hªdË
 
V®id©iÚE¼Üs


84 
Œy
:

85 #U£ 
the
 
exi¡šg
 
š¡ªû
 
to
 
avoid
 
unique
 
f›ld
 
”rÜs


86 
£lf
.
š¡ªû
:

87 
Œª§ùiÚ
 = 
£lf
.
š¡ªû


88 
Œª§ùiÚ_diù
 = 
Œª§ùiÚ
.
__diù__
.
	$cİy
()

90 
”rÜs
 = {
	}
}

91 
©Œibu‹
, 
v®ue
 
š
 
	g©Œs
.
	$™ems
():

92 
©Œibu‹
 
š
 
£lf
.
M‘a
.
upd©—bË_f›lds
:

95 
	`g‘©Œ
(
Œª§ùiÚ
, 
©Œibu‹
è!ğ
v®ue
:

96 
”rÜs
[
©Œibu‹
] = "This field may‚ot be modified."

97 
	$£‰r
(
Œª§ùiÚ
, 
©Œibu‹
, 
v®ue
)

99 
”rÜs
:

100 
¿i£
 
£rŸliz”s
.
	$V®id©iÚE¼Ü
(
”rÜs
)

102 
Œª§ùiÚ
.
	$fuÎ_ş—n
()

104 #Rev”ˆ
chªges
 
to
 
exi¡šg
 
š¡ªû


105 
Œª§ùiÚ
.
__diù__
 = 
Œª§ùiÚ_diù


107 
Œª§ùiÚ
 = 
	$T¿n§ùiÚ
(**
©Œs
)

108 
Œª§ùiÚ
.
	$fuÎ_ş—n
()

109 
exû±
 
V®id©iÚE¼Ü
 
as
 
e
:

110 
”rÜs
 = 
e
.
”rÜ_diù


111 
nÚ_f›ld_”rÜs
 = 
”rÜs
.
	$pİ
(
NON_FIELD_ERRORS
, 
NÚe
)

112 
nÚ_f›ld_”rÜs
:

113 
”rÜs
['non_field_errors'] = [

114 
”rÜ
 
subli¡
 
š
 
nÚ_f›ld_”rÜs
 error in sublist

116 
¿i£
 
£rŸliz”s
.
	$V®id©iÚE¼Ü
(
”rÜs
)

118  
©Œs


	@silver/api/urls.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
äom
 
	gdjªgo
.
	gcÚf
.
u¾s
 
impÜt
 
u¾


18 
äom
 
sv”
 
impÜt
 
v›ws
 
as
 
sv”_v›ws


19 
äom
 
	gsv”
.
	g­i
.
v›ws
 
impÜt
 
	gblšg_’t™›s_v›ws
, 
	gdocum’ts_v›ws
, 
	g·ym’t_m‘hod_v›ws
, \

20 
	g¶ª_v›ws
, 
	g´oduù_code_v›ws
, 
	gsubsütiÚ_v›ws
, 
Œª§ùiÚ_v›ws


22 
	gu¾·‰”ns
 = [

23 
u¾
(
r
'^customers/$',

24 
blšg_’t™›s_v›ws
.
Cu¡om”Li¡
.
as_v›w
(), 
Çme
='customer-list'),

25 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/$',

26 
blšg_’t™›s_v›ws
.
Cu¡om”D‘a
.
as_v›w
(), 
Çme
='customer-detail'),

28 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/subscriptions/$',

29 
subsütiÚ_v›ws
.
SubsütiÚLi¡
.
as_v›w
(), 
Çme
='subscription-list'),

30 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/subscriptions/(?P<subscription_pk>[0-9]+)/$',

31 
subsütiÚ_v›ws
.
SubsütiÚD‘a
.
as_v›w
(), 
Çme
='subscription-detail'),

32 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/subscriptions/(?P<subscription_pk>[0-9]+)/metered-features/(?P<mf_product_code>([^/])+)/$',

33 
subsütiÚ_v›ws
.
M‘”edF—tu»Un™sLogD‘a
.
as_v›w
(), 
Çme
='mf-log-units'),

34 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/subscriptions/(?P<subscription_pk>[0-9]+)/activate/$',

35 
subsütiÚ_v›ws
.
SubsütiÚAùiv©e
.
as_v›w
(), 
Çme
='sub-activate'),

36 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/subscriptions/(?P<subscription_pk>[0-9]+)/cancel/$',

37 
subsütiÚ_v›ws
.
SubsütiÚCªûl
.
as_v›w
(), 
Çme
='sub-cancel'),

38 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/subscriptions/(?P<subscription_pk>[0-9]+)/reactivate/$',

39 
subsütiÚ_v›ws
.
SubsütiÚR—ùiv©e
.
as_v›w
(), 
Çme
='sub-reactivate'),

41 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/payment_methods/$',

42 
·ym’t_m‘hod_v›ws
.
Paym’tM‘hodLi¡
.
as_v›w
(), 
Çme
='payment-method-list'),

43 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/payment_methods/(?P<payment_method_id>[0-9]+)/$',

44 
·ym’t_m‘hod_v›ws
.
Paym’tM‘hodD‘a
.
as_v›w
(), 
Çme
='payment-method-detail'),

45 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/payment_methods/(?P<payment_method_id>[0-9]+)/(?P<requested_action>(cancel))_request/$',

46 
·ym’t_m‘hod_v›ws
.
Paym’tM‘hodAùiÚ
.
as_v›w
(), 
Çme
='payment-method-action'),

48 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/payment_methods/(?P<payment_method_id>[0-9]+)/transactions/$',

49 
Œª§ùiÚ_v›ws
.
T¿n§ùiÚLi¡
.
as_v›w
(), 
Çme
='payment-method-transaction-list'),

50 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/transactions/$',

51 
Œª§ùiÚ_v›ws
.
T¿n§ùiÚLi¡
.
as_v›w
(), 
Çme
='transaction-list'),

52 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/transactions/(?P<transaction_uuid>[0-9a-z-]+)/$',

53 
Œª§ùiÚ_v›ws
.
T¿n§ùiÚD‘a
.
as_v›w
(), 
Çme
='transaction-detail'),

54 
u¾
(
r
'^customers/(?P<customer_pk>[0-9]+)/transactions/(?P<transaction_uuid>[0-9a-z-]+)/(?P<requested_action>(cancel))_request/$',

55 
Œª§ùiÚ_v›ws
.
T¿n§ùiÚAùiÚ
.
as_v›w
(), 
Çme
='transaction-action'),

57 
u¾
(
r
'^payment_processors/$',

58 
·ym’t_m‘hod_v›ws
.
Paym’tProûssÜLi¡
.
as_v›w
(), 
Çme
='payment-processor-list'),

59 
u¾
(
r
'^payment_processors/(?P<processor_name>[a-zA-Z\-\_]+)/$',

60 
·ym’t_m‘hod_v›ws
.
Paym’tProûssÜD‘a
.
as_v›w
(), 
Çme
='payment-processor-detail'),

62 
u¾
(
r
'^plans/$',

63 
¶ª_v›ws
.
PÏnLi¡
.
as_v›w
(), 
Çme
='plan-list'),

64 
u¾
(
r
'^plans/(?P<pk>[0-9]+)/$',

65 
¶ª_v›ws
.
PÏnD‘a
.
as_v›w
(), 
Çme
='plan-detail'),

66 
u¾
(
r
'plans/(?P<pk>[0-9]+)/metered-features/$',

67 
¶ª_v›ws
.
PÏnM‘”edF—tu»s
.
as_v›w
(), 
Çme
='plans-metered-features'),

69 
u¾
(
r
'^metered-features/$',

70 
subsütiÚ_v›ws
.
M‘”edF—tu»Li¡
.
as_v›w
(), 
Çme
='metered-feature-list'),

72 
u¾
(
r
'^providers/$',

73 
blšg_’t™›s_v›ws
.
Provid”Li¡C»©e
.
as_v›w
(), 
Çme
='provider-list'),

74 
u¾
(
r
'^providers/(?P<pk>[0-9]+)/$',

75 
blšg_’t™›s_v›ws
.
Provid”R‘r›veUpd©eDe¡roy
.
as_v›w
(), 
Çme
='provider-detail'),

77 
u¾
(
r
'^product-codes/$',

78 
´oduù_code_v›ws
.
ProduùCodeLi¡C»©e
.
as_v›w
(), 
Çme
='productcode-list'),

79 
u¾
(
r
'^product-codes/(?P<pk>[0-9]+)/$',

80 
´oduù_code_v›ws
.
ProduùCodeR‘r›veUpd©e
.
as_v›w
(), 
Çme
='productcode-detail'),

82 
u¾
(
r
'^invoices/$',

83 
docum’ts_v›ws
.
InvoiûLi¡C»©e
.
as_v›w
(), 
Çme
='invoice-list'),

84 
u¾
(
r
'^invoices/(?P<pk>[0-9]+)/$',

85 
docum’ts_v›ws
.
InvoiûR‘r›veUpd©e
.
as_v›w
(), 
Çme
='invoice-detail'),

86 
u¾
(
r
'^invoices/(?P<document_pk>[0-9]+)/entries/$',

87 
docum’ts_v›ws
.
InvoiûEÁryC»©e
.
as_v›w
(), 
Çme
='invoice-entry-create'),

88 
u¾
(
r
'^invoices/(?P<document_pk>[0-9]+)/entries/(?P<entry_pk>[0-9]+)/$',

89 
docum’ts_v›ws
.
InvoiûEÁryUpd©eDe¡roy
.
as_v›w
(), 
Çme
='invoice-entry-update'),

90 
u¾
(
r
'^invoices/(?P<pk>[0-9]+)/state/$',

91 
docum’ts_v›ws
.
InvoiûS‹HªdËr
.
as_v›w
(), 
Çme
='invoice-state'),

92 
u¾
(
r
'^invoices/(?P<invoice_id>\d+).pdf$',

93 
sv”_v›ws
.
švoiû_pdf
, 
Çme
='invoice-pdf'),

95 
u¾
(
r
'^proformas/$',

96 
docum’ts_v›ws
.
ProfÜmaLi¡C»©e
.
as_v›w
(), 
Çme
='proforma-list'),

97 
u¾
(
r
'^proformas/(?P<pk>[0-9]+)/$',

98 
docum’ts_v›ws
.
ProfÜmaR‘r›veUpd©e
.
as_v›w
(), 
Çme
='proforma-detail'),

99 
u¾
(
r
'^proformas/(?P<document_pk>[0-9]+)/entries/$',

100 
docum’ts_v›ws
.
ProfÜmaEÁryC»©e
.
as_v›w
(), 
Çme
='proforma-entry-create'),

101 
u¾
(
r
'^proformas/(?P<document_pk>[0-9]+)/entries/(?P<entry_pk>[0-9]+)/$',

102 
docum’ts_v›ws
.
ProfÜmaEÁryUpd©eDe¡roy
.
as_v›w
(),

103 
Çme
='proforma-entry-update'),

104 
u¾
(
r
'^proformas/(?P<pk>[0-9]+)/state/$',

105 
docum’ts_v›ws
.
ProfÜmaS‹HªdËr
.
as_v›w
(), 
Çme
='proforma-state'),

106 
u¾
(
r
'^proformas/(?P<pk>[0-9]+)/invoice/$',

107 
docum’ts_v›ws
.
ProfÜmaInvoiûR‘r›veC»©e
.
as_v›w
(),

108 
Çme
='proforma-invoice'),

109 
u¾
(
r
'^proformas/(?P<proforma_id>\d+).pdf$',

110 
sv”_v›ws
.
´ofÜma_pdf
, 
Çme
='proforma-pdf'),

111 
u¾
(
r
'^pdfs/(?P<pdf_pk>[0-9]+)/$',

112 
docum’ts_v›ws
.
PDFR‘r›ve
.
as_v›w
(),

113 
Çme
='pdf'),

114 
u¾
(
r
'^documents/$',

115 
docum’ts_v›ws
.
Docum’tLi¡
.
as_v›w
(), 
Çme
='document-list')

	@silver/api/views/__init__.py

	@silver/api/views/billing_entities_views.py

1 
äom
 
	gdjªgo
.
h‰p
 
impÜt
 
H‰p404


2 
äom
 
	gdjªgo_f‹rs
.
»¡_äamewÜk
 
impÜt
 
DjªgoF‹rBack’d


3 
äom
 
»¡_äamewÜk
 
impÜt
 
	gg’”ics
, 
³rmissiÚs


4 
äom
 
»¡_äamewÜk_bulk
 
impÜt
 
Li¡BulkC»©eAPIV›w


6 
äom
 
	gsv”
.
	g­i
.
f‹rs
 
impÜt
 
	gCu¡om”F‹r
, 
Provid”F‹r


7 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
blšg_’t™›s_£rŸliz”s
 
impÜt
 
	gCu¡om”S”Ÿliz”
, \

8 
Provid”S”Ÿliz”


9 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gCu¡om”
, 
Provid”


12 
şass
 
	$Cu¡om”Li¡
(
g’”ics
.
Li¡C»©eAPIV›w
):

13 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

14 
£rŸliz”_şass
 = 
Cu¡om”S”Ÿliz”


15 
qu”y£t
 = 
Cu¡om”
.
objeùs
.
	$®l
()

16 
f‹r_back’ds
 = (
DjªgoF‹rBack’d
,)

17 
f‹r_şass
 = 
Cu¡om”F‹r


20 
şass
 
	$Cu¡om”D‘a
(
g’”ics
.
R‘r›veUpd©eDe¡royAPIV›w
):

21 
def
 
	$g‘_objeù
(
£lf
):

22 
pk
 = 
£lf
.
kw¬gs
.
	`g‘
('cu¡om”_pk', 
NÚe
)

23 
Œy
:

24  
Cu¡om”
.
objeùs
.
	$g‘
(
pk
=pk)

25 
	$exû±
 (
Ty³E¼Ü
, 
V®ueE¼Ü
, 
Cu¡om”
.
DÛsNÙExi¡
):

26 
¿i£
 
H‰p404


28 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

29 
£rŸliz”_şass
 = 
Cu¡om”S”Ÿliz”


30 
mod–
 = 
Cu¡om”


33 
şass
 
	$Provid”Li¡C»©e
(
Li¡BulkC»©eAPIV›w
):

34 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

35 
£rŸliz”_şass
 = 
Provid”S”Ÿliz”


36 
qu”y£t
 = 
Provid”
.
objeùs
.
	$®l
()

37 
f‹r_back’ds
 = (
DjªgoF‹rBack’d
,)

38 
f‹r_şass
 = 
Provid”F‹r


41 
şass
 
	$Provid”R‘r›veUpd©eDe¡roy
(
g’”ics
.
R‘r›veUpd©eDe¡royAPIV›w
):

42 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

43 
£rŸliz”_şass
 = 
Provid”S”Ÿliz”


44 
qu”y£t
 = 
Provid”
.
objeùs
.
	`®l
()

	@silver/api/views/documents_views.py

1 
impÜt
 
djªgo


2 
äom
 
	gdjªgo
.
	gdb
.
mod–s
 
impÜt
 
Q


3 
äom
 
	gdjªgo
.
h‰p
 
impÜt
 
H‰pRe¥Ú£Redœeù


5 
äom
 
	gdjªgo_f‹rs
.
»¡_äamewÜk
 
impÜt
 
DjªgoF‹rBack’d


6 
äom
 
»¡_äamewÜk
 
impÜt
 
	gg’”ics
, 
	g³rmissiÚs
, 
	gf‹rs
, 
¡©us


7 
äom
 
	g»¡_äamewÜk
.
g’”ics
 
impÜt
 
	gg‘_objeù_Ü_404
, 
Li¡APIV›w


8 
äom
 
	g»¡_äamewÜk
.
»¥Ú£
 
impÜt
 
Re¥Ú£


9 
äom
 
	g»¡_äamewÜk
.
v›ws
 
impÜt
 
APIV›w


11 
äom
 
	gsv”
.
	g­i
.
f‹rs
 
impÜt
 
	gInvoiûF‹r
, 
	gProfÜmaF‹r
, 
BlšgDocum’tF‹r


12 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
docum’ts_£rŸliz”s
 
impÜt
 
	gInvoiûS”Ÿliz”
, \

13 
	gDocum’tEÁryS”Ÿliz”
, 
	gProfÜmaS”Ÿliz”
, 
Docum’tS”Ÿliz”


14 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gInvoiû
, 
	gBlšgDocum’tBa£
, 
	gDocum’tEÁry
, 
	gProfÜma
, 
PDF


17 
şass
 
	$InvoiûLi¡C»©e
(
g’”ics
.
Li¡C»©eAPIV›w
):

18 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

19 
£rŸliz”_şass
 = 
InvoiûS”Ÿliz”


20 
qu”y£t
 = 
Invoiû
.
objeùs
.
	`®l
()\

21 .
	`£Ëù_»Ï‹d
('related_document')\

22 .
	`´eãtch_»Ï‹d
('invoice_transactions')

23 
f‹r_back’ds
 = (
DjªgoF‹rBack’d
,)

24 
f‹r_şass
 = 
InvoiûF‹r


27 
şass
 
	$InvoiûR‘r›veUpd©e
(
g’”ics
.
R‘r›veUpd©eAPIV›w
):

28 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

29 
£rŸliz”_şass
 = 
InvoiûS”Ÿliz”


30 
qu”y£t
 = 
Invoiû
.
objeùs
.
	$®l
()

33 
şass
 
	$DocEÁryC»©e
(
g’”ics
.
C»©eAPIV›w
):

34 
def
 
	$g‘_mod–
(
£lf
):

35 
¿i£
 
NÙIm¶em’‹dE¼Ü


37 
def
 
	$g‘_mod–_Çme
(
£lf
):

38 
¿i£
 
NÙIm¶em’‹dE¼Ü


40 
def
 
	$po¡
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

41 
doc_pk
 = 
kw¬gs
.
	`g‘
('document_pk')

42 
Mod–
 = 
£lf
.
	$g‘_mod–
()

43 
mod–_Çme
 = 
£lf
.
	$g‘_mod–_Çme
()

45 
Œy
:

46 
docum’t
 = 
Mod–
.
objeùs
.
	$g‘
(
pk
=
doc_pk
)

47 
exû±
 
Mod–
.
DÛsNÙExi¡
:

48 
msg
 = "{mod–}‚Ù found".
	$fÜm©
(
mod–
=
mod–_Çme
)

49  
	`Re¥Ú£
({"d‘a": 
msg
}, stus=¡©us.HTTP_404_NOT_FOUND)

51 
docum’t
.
¡©e
 !ğ
BlšgDocum’tBa£
.
STATES
.
DRAFT
:

52 
msg
 = "{model}ƒntries can be‡dded only whenhe {model_lower} is"\

53 " iÀd¿á s‹.".
fÜm©
(
mod–
=
mod–_Çme
,

54 
mod–_low”
=
mod–_Çme
.
	$low”
())

55  
	`Re¥Ú£
({"d‘a": 
msg
}, stus=¡©us.HTTP_403_FORBIDDEN)

57 
£rŸliz”
 = 
Docum’tEÁryS”Ÿliz”
(
d©a
=
»que¡
.data,

58 
cÚ‹xt
={'»que¡': 
»que¡
})

60 
£rŸliz”
.
	$is_v®id
(
¿i£_exû±iÚ
=
True
):

61 #Thi 
wl
 
be
 
e™”
 {
švoiû
: <
švoiû_objeù
>
	}
} 
Ü


62 #{
´ofÜma
: <
´ofÜma_objeù
>} 
as
 
a
 
Docum’tEÁry
 
ÿn
 
have
‡

63 #fÜeigÀ
key
 
to
 
e™h”
 
ª
 
švoiû
 
Ü
 
a
 
´ofÜma


64 
exŒa_cÚ‹xt
 = {
mod–_Çme
.
low”
(): 
docum’t
}

65 
£rŸliz”
.
	$§ve
(**
exŒa_cÚ‹xt
)

67  
	$Re¥Ú£
(
£rŸliz”
.
d©a
, 
¡©us
=¡©us.
HTTP_201_CREATED
)

70 
şass
 
	$InvoiûEÁryC»©e
(
DocEÁryC»©e
):

71 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

72 
£rŸliz”_şass
 = 
Docum’tEÁryS”Ÿliz”


73 
qu”y£t
 = 
Docum’tEÁry
.
objeùs
.
	$®l
()

75 
def
 
	$po¡
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

76  
	`su³r
(
InvoiûEÁryC»©e
, 
£lf
).
	$po¡
(
»que¡
, *
¬gs
, **
kw¬gs
)

78 
def
 
	$g‘_mod–
(
£lf
):

79  
Invoiû


81 
def
 
	$g‘_mod–_Çme
(
£lf
):

85 
şass
 
	$DocEÁryUpd©eDe¡roy
(
APIV›w
):

87 
def
 
	$put
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

88 
doc_pk
 = 
kw¬gs
.
	`g‘
('document_pk')

89 
’Œy_pk
 = 
kw¬gs
.
	`g‘
('entry_pk')

91 
Mod–
 = 
£lf
.
	$g‘_mod–
()

92 
mod–_Çme
 = 
£lf
.
	$g‘_mod–_Çme
()

94 
docum’t
 = 
	$g‘_objeù_Ü_404
(
Mod–
, 
pk
=
doc_pk
)

95 
docum’t
.
¡©e
 !ğ
BlšgDocum’tBa£
.
STATES
.
DRAFT
:

96 
msg
 = "{model}ƒntries can be‡dded only whenhe {model_lower} is"\

97 " iÀd¿á s‹.".
	`fÜm©
(
mod–
=
mod–_Çme
,

98 
mod–_low”
=
mod–_Çme
.
	$low”
())

99  
	`Re¥Ú£
({"d‘a": 
msg
}, stus=¡©us.HTTP_403_FORBIDDEN)

101 
£¬ched_f›lds
 = {
mod–_Çme
.
low”
(): 
docum’t
, 'pk': 
’Œy_pk
}

102 
’Œy
 = 
	$g‘_objeù_Ü_404
(
Docum’tEÁry
, **
£¬ched_f›lds
)

104 
£rŸliz”
 = 
	`Docum’tEÁryS”Ÿliz”
(
’Œy
, 
d©a
=
»que¡
.data,

105 
cÚ‹xt
={'»que¡': 
»que¡
})

107 
£rŸliz”
.
	$is_v®id
(
¿i£_exû±iÚ
=
True
):

108 
£rŸliz”
.
	$§ve
()

109  
	$Re¥Ú£
(
£rŸliz”
.
d©a
)

111 
def
 
	$d–‘e
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

112 
doc_pk
 = 
kw¬gs
.
	`g‘
('document_pk')

113 
’Œy_pk
 = 
kw¬gs
.
	`g‘
('entry_pk')

115 
Mod–
 = 
£lf
.
	$g‘_mod–
()

116 
mod–_Çme
 = 
£lf
.
	$g‘_mod–_Çme
()

118 
docum’t
 = 
	$g‘_objeù_Ü_404
(
Mod–
, 
pk
=
doc_pk
)

119 
docum’t
.
¡©e
 !ğ
BlšgDocum’tBa£
.
STATES
.
DRAFT
:

120 
msg
 = "{model}ƒntries can be deleted only whenhe {model_lower} is"\

121 " iÀd¿á s‹.".
	`fÜm©
(
mod–
=
mod–_Çme
,

122 
mod–_low”
=
mod–_Çme
.
	$low”
())

123  
	`Re¥Ú£
({"d‘a": 
msg
}, stus=¡©us.HTTP_403_FORBIDDEN)

125 
£¬ched_f›lds
 = {
mod–_Çme
.
low”
(): 
docum’t
, 'pk': 
’Œy_pk
}

126 
’Œy
 = 
	$g‘_objeù_Ü_404
(
Docum’tEÁry
, **
£¬ched_f›lds
)

127 
’Œy
.
	$d–‘e
()

129  
	$Re¥Ú£
(
¡©us
=¡©us.
HTTP_204_NO_CONTENT
)

131 
def
 
	$g‘_mod–
(
£lf
):

132 
¿i£
 
NÙIm¶em’‹dE¼Ü


134 
def
 
	$g‘_mod–_Çme
(
£lf
):

135 
¿i£
 
NÙIm¶em’‹dE¼Ü


138 
şass
 
	$InvoiûEÁryUpd©eDe¡roy
(
DocEÁryUpd©eDe¡roy
):

139 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

140 
£rŸliz”_şass
 = 
Docum’tEÁryS”Ÿliz”


141 
qu”y£t
 = 
Docum’tEÁry
.
objeùs
.
	$®l
()

143 
def
 
	$put
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

144  
	`su³r
(
InvoiûEÁryUpd©eDe¡roy
, 
£lf
).
	$put
(
»que¡
, *
¬gs
,

145 **
kw¬gs
)

147 
def
 
	$d–‘e
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

148  
	`su³r
(
InvoiûEÁryUpd©eDe¡roy
, 
£lf
).
	$d–‘e
(
»que¡
, *
¬gs
,

149 **
kw¬gs
)

151 
def
 
	$g‘_mod–
(
£lf
):

152  
Invoiû


154 
def
 
	$g‘_mod–_Çme
(
£lf
):

158 
şass
 
	$InvoiûS‹HªdËr
(
APIV›w
):

159 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

160 
£rŸliz”_şass
 = 
InvoiûS”Ÿliz”


162 
def
 
	$put
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

163 
švoiû_pk
 = 
kw¬gs
.
	`g‘
('pk')

164 
Œy
:

165 
švoiû
 = 
Invoiû
.
objeùs
.
	$g‘
(
pk
=
švoiû_pk
)

166 
exû±
 
Invoiû
.
DÛsNÙExi¡
:

167  
	`Re¥Ú£
({"d‘a": "Invoiû‚Ù found"
	}
},

168 
	g¡©us
=
¡©us
.
HTTP_404_NOT_FOUND
)

170 
¡©e
 = 
»que¡
.
d©a
.
g‘
('¡©e', 
NÚe
)

171 
	g¡©e
 =ğ
Invoiû
.
STATES
.
ISSUED
:

172 
švoiû
.
¡©e
 !ğ
Invoiû
.
STATES
.
DRAFT
:

173 
msg
 = "An invoice can be issued only if it is in draft state."

174  
Re¥Ú£
({"d‘a": 
msg
},

175 
¡©us
=¡©us.
HTTP_403_FORBIDDEN
)

177 
issue_d©e
 = 
»que¡
.
d©a
.
g‘
('issue_d©e', 
NÚe
)

178 
	gdue_d©e
 = 
»que¡
.
d©a
.
g‘
('due_d©e', 
NÚe
)

179 
	gšvoiû
.
	$issue
(
issue_d©e
, 
due_d©e
)

180 
–if
 
¡©e
 =ğ
Invoiû
.
STATES
.
PAID
:

181 
švoiû
.
¡©e
 !ğ
Invoiû
.
STATES
.
ISSUED
:

182 
msg
 = "An invoice can be…aid only if it is in issued state."

183  
	`Re¥Ú£
({"d‘a": 
msg
},

184 
	g¡©us
=
¡©us
.
HTTP_403_FORBIDDEN
)

186 
·id_d©e
 = 
»que¡
.
d©a
.
g‘
('·id_d©e', 
NÚe
)

187 
	gšvoiû
.
	$·y
(
·id_d©e
)

188 
–if
 
¡©e
 =ğ
Invoiû
.
STATES
.
CANCELED
:

189 
švoiû
.
¡©e
 !ğ
Invoiû
.
STATES
.
ISSUED
:

190 
msg
 = "An invoice can be canceled only if it is in issued " \

192  
	`Re¥Ú£
({"d‘a": 
msg
},

193 
	g¡©us
=
¡©us
.
HTTP_403_FORBIDDEN
)

195 
ÿnûl_d©e
 = 
»que¡
.
d©a
.
g‘
('ÿnûl_d©e', 
NÚe
)

196 
	gšvoiû
.
	$ÿnûl
(
ÿnûl_d©e
)

197 
–if
 
nÙ
 
¡©e
:

198 
msg
 = "You haveo…rovide‡ value forhe state field."

199  
	`Re¥Ú£
({"d‘a": 
msg
}, stus=¡©us.HTTP_403_FORBIDDEN)

201 
msg
 = "Illegal state value."

202  
Re¥Ú£
({"d‘a": 
msg
}, 
¡©us
=¡©us.
HTTP_403_FORBIDDEN
)

204 
£rŸliz”
 = 
InvoiûS”Ÿliz”
(
švoiû
, 
cÚ‹xt
={'»que¡': 
»que¡
})

205  
	$Re¥Ú£
(
£rŸliz”
.
d©a
)

208 
şass
 
	$ProfÜmaLi¡C»©e
(
g’”ics
.
Li¡C»©eAPIV›w
):

209 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

210 
£rŸliz”_şass
 = 
ProfÜmaS”Ÿliz”


211 
qu”y£t
 = 
ProfÜma
.
objeùs
.
	`®l
()\

212 .
	`£Ëù_»Ï‹d
('related_document')\

213 .
	`´eãtch_»Ï‹d
('proforma_transactions')

214 
f‹r_back’ds
 = (
DjªgoF‹rBack’d
,)

215 
f‹r_şass
 = 
ProfÜmaF‹r


218 
şass
 
	$ProfÜmaR‘r›veUpd©e
(
g’”ics
.
R‘r›veUpd©eAPIV›w
):

219 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

220 
£rŸliz”_şass
 = 
ProfÜmaS”Ÿliz”


221 
qu”y£t
 = 
ProfÜma
.
objeùs
.
	$®l
()

224 
şass
 
	$ProfÜmaEÁryC»©e
(
DocEÁryC»©e
):

225 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

226 
£rŸliz”_şass
 = 
Docum’tEÁryS”Ÿliz”


227 
qu”y£t
 = 
Docum’tEÁry
.
objeùs
.
	$®l
()

229 
def
 
	$po¡
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

230  
	`su³r
(
ProfÜmaEÁryC»©e
, 
£lf
).
	$po¡
(
»que¡
, *
¬gs
, **
kw¬gs
)

232 
def
 
	$g‘_mod–
(
£lf
):

233  
ProfÜma


235 
def
 
	$g‘_mod–_Çme
(
£lf
):

239 
şass
 
	$ProfÜmaEÁryUpd©eDe¡roy
(
DocEÁryUpd©eDe¡roy
):

240 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

241 
£rŸliz”_şass
 = 
Docum’tEÁryS”Ÿliz”


242 
qu”y£t
 = 
Docum’tEÁry
.
objeùs
.
	$®l
()

244 
def
 
	$put
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

245  
	`su³r
(
ProfÜmaEÁryUpd©eDe¡roy
, 
£lf
).
	$put
(
»que¡
, *
¬gs
,

246 **
kw¬gs
)

248 
def
 
	$d–‘e
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

249  
	`su³r
(
ProfÜmaEÁryUpd©eDe¡roy
, 
£lf
).
	$d–‘e
(
»que¡
, *
¬gs
,

250 **
kw¬gs
)

252 
def
 
	$g‘_mod–
(
£lf
):

253  
ProfÜma


255 
def
 
	$g‘_mod–_Çme
(
£lf
):

259 
şass
 
	$ProfÜmaInvoiûR‘r›veC»©e
(
APIV›w
):

260 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

261 
£rŸliz”_şass
 = 
InvoiûS”Ÿliz”


263 
def
 
	$po¡
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

264 
´ofÜma_pk
 = 
kw¬gs
.
	`g‘
('pk')

266 
Œy
:

267 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	$g‘
(
pk
=
´ofÜma_pk
)

268 
exû±
 
ProfÜma
.
DÛsNÙExi¡
:

269  
	`Re¥Ú£
({"d‘a": "ProfÜm¨nÙ found"
	}
},

270 
	g¡©us
=
¡©us
.
HTTP_404_NOT_FOUND
)

272 
nÙ
 
´ofÜma
.
»Ï‹d_docum’t
:

273 
´ofÜma
.
	$ü—‹_švoiû
()

275 
£rŸliz”
 = 
	`InvoiûS”Ÿliz”
(
´ofÜma
.
»Ï‹d_docum’t
,

276 
cÚ‹xt
={'»que¡': 
»que¡
})

277  
	$Re¥Ú£
(
£rŸliz”
.
d©a
)

279 
def
 
	$g‘
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

280 
´ofÜma_pk
 = 
kw¬gs
.
	`g‘
('pk')

282 
Œy
:

283 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	$g‘
(
pk
=
´ofÜma_pk
)

284 
exû±
 
ProfÜma
.
DÛsNÙExi¡
:

285  
	`Re¥Ú£
({"d‘a": "ProfÜm¨nÙ found"
	}
},

286 
	g¡©us
=
¡©us
.
HTTP_404_NOT_FOUND
)

288 
£rŸliz”
 = 
InvoiûS”Ÿliz”
(
´ofÜma
.
»Ï‹d_docum’t
,

289 
cÚ‹xt
={'»que¡': 
»que¡
})

290  
	$Re¥Ú£
(
£rŸliz”
.
d©a
)

293 
şass
 
	$ProfÜmaS‹HªdËr
(
APIV›w
):

294 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

295 
£rŸliz”_şass
 = 
ProfÜmaS”Ÿliz”


297 
def
 
	$put
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

298 
´ofÜma_pk
 = 
kw¬gs
.
	`g‘
('pk')

299 
Œy
:

300 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	$g‘
(
pk
=
´ofÜma_pk
)

301 
exû±
 
ProfÜma
.
DÛsNÙExi¡
:

302  
	`Re¥Ú£
({"d‘a": "ProfÜm¨nÙ found"
	}
},

303 
	g¡©us
=
¡©us
.
HTTP_404_NOT_FOUND
)

305 
¡©e
 = 
»que¡
.
d©a
.
g‘
('¡©e', 
NÚe
)

306 
	g¡©e
 =ğ
ProfÜma
.
STATES
.
ISSUED
:

307 
´ofÜma
.
¡©e
 !ğ
ProfÜma
.
STATES
.
DRAFT
:

308 
msg
 = "A…roforma can be issued only if it is in draft state."

309  
Re¥Ú£
({"d‘a": 
msg
},

310 
¡©us
=¡©us.
HTTP_403_FORBIDDEN
)

312 
issue_d©e
 = 
»que¡
.
d©a
.
g‘
('issue_d©e', 
NÚe
)

313 
	gdue_d©e
 = 
»que¡
.
d©a
.
g‘
('due_d©e', 
NÚe
)

314 
	g´ofÜma
.
	$issue
(
issue_d©e
, 
due_d©e
)

315 
–if
 
¡©e
 =ğ
ProfÜma
.
STATES
.
PAID
:

316 
´ofÜma
.
¡©e
 !ğ
ProfÜma
.
STATES
.
ISSUED
:

317 
msg
 = "A…roforma can be…aid only if it is in issued state."

318  
	`Re¥Ú£
({"d‘a": 
msg
},

319 
	g¡©us
=
¡©us
.
HTTP_403_FORBIDDEN
)

321 
·id_d©e
 = 
»que¡
.
d©a
.
g‘
('·id_d©e', 
NÚe
)

322 
	g´ofÜma
.
	$·y
(
·id_d©e
)

323 
–if
 
¡©e
 =ğ
ProfÜma
.
STATES
.
CANCELED
:

324 
´ofÜma
.
¡©e
 !ğ
ProfÜma
.
STATES
.
ISSUED
:

325 
msg
 = "A…roforma can be canceled only if it is in issued " \

327  
	`Re¥Ú£
({"d‘a": 
msg
},

328 
	g¡©us
=
¡©us
.
HTTP_403_FORBIDDEN
)

330 
ÿnûl_d©e
 = 
»que¡
.
d©a
.
g‘
('ÿnûl_d©e', 
NÚe
)

331 
	g´ofÜma
.
	$ÿnûl
(
ÿnûl_d©e
)

332 
–if
 
nÙ
 
¡©e
:

333 
msg
 = "You haveo…rovide‡ value forhe state field."

334  
	`Re¥Ú£
({"d‘a": 
msg
}, stus=¡©us.HTTP_403_FORBIDDEN)

336 
msg
 = "Illegal state value."

337  
Re¥Ú£
({"d‘a": 
msg
}, 
¡©us
=¡©us.
HTTP_403_FORBIDDEN
)

339 
£rŸliz”
 = 
ProfÜmaS”Ÿliz”
(
´ofÜma
, 
cÚ‹xt
={'»que¡': 
»que¡
})

340  
	$Re¥Ú£
(
£rŸliz”
.
d©a
)

343 
şass
 
	$Docum’tLi¡
(
Li¡APIV›w
):

344 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

345 
£rŸliz”_şass
 = 
Docum’tS”Ÿliz”


346 
f‹r_şass
 = 
BlšgDocum’tF‹r


347 
f‹r_back’ds
 = (
f‹rs
.
Ord”šgF‹r
, 
DjªgoF‹rBack’d
)

348 
Üd”šg_f›lds
 = ('due_date', )

349 
Üd”šg
 = ('-due_date', '-number')

351 
def
 
	$g‘_qu”y£t
(
£lf
):

352 
djªgo_v”siÚ
 = 
djªgo
.
	`g‘_v”siÚ
().
	`¥l™
('.')

353 
djªgo_v”siÚ
[0] =ğ'1' 
ªd
 (django_version[1]) < 11:

354  
BlšgDocum’tBa£
.
objeùs
.
	`f‹r
(

355 
	`Q
(
kšd
='švoiû'è| Q(kšd='´ofÜma', 
»Ï‹d_docum’t
=
NÚe
)

356 ).
	`£Ëù_»Ï‹d
('customer', 'provider', 'pdf')

358 
švoiûs
 = 
BlšgDocum’tBa£
.
objeùs
 \

359 .
	`f‹r
(
kšd
='invoice') \

360 .
	`´eãtch_»Ï‹d
('invoice_transactions__payment_method')

361 
´ofÜmas
 = 
BlšgDocum’tBa£
.
objeùs
 \

362 .
	`f‹r
(
kšd
='´ofÜma', 
»Ï‹d_docum’t
=
NÚe
) \

363 .
	`´eãtch_»Ï‹d
('proforma_transactions__payment_method')

365  (
švoiûs
 | 
´ofÜmas
).
	`£Ëù_»Ï‹d
('customer', 'provider', 'pdf')

368 
şass
 
	$PDFR‘r›ve
(
g’”ics
.
R‘r›veAPIV›w
):

369 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAdmšU£r
,)

370 
qu”y£t
 = 
PDF
.
objeùs
.
	$®l
()

371 
lookup_u¾_kw¬g
 = 'pdf_pk'

373 
def
 
	$g‘
(
£lf
, *
¬gs
, **
kw¬gs
):

374 
pdf
 = 
£lf
.
	$g‘_objeù
()

375  
	`H‰pRe¥Ú£Redœeù
(
pdf
.
u¾
)

	@silver/api/views/payment_method_views.py

1 
äom
 
	gdjªgo
.
h‰p
 
impÜt
 
H‰p404


2 
äom
 
	gdjªgo_f‹rs
.
»¡_äamewÜk
 
impÜt
 
DjªgoF‹rBack’d


3 
äom
 
»¡_äamewÜk
 
impÜt
 
	g³rmissiÚs
, 
¡©us


4 
äom
 
	g»¡_äamewÜk
.
g’”ics
 
impÜt
 
	gLi¡APIV›w
, 
	gR‘r›veAPIV›w
, 
	gLi¡C»©eAPIV›w
, \

5 
	gg‘_objeù_Ü_404
, 
R‘r›veUpd©eAPIV›w


6 
äom
 
	g»¡_äamewÜk
.
»¥Ú£
 
impÜt
 
Re¥Ú£


7 
äom
 
	g»¡_äamewÜk
.
v›ws
 
impÜt
 
APIV›w


9 
äom
 
sv”
 
impÜt
 
·ym’t_´oûssÜs


10 
äom
 
	gsv”
.
	g­i
.
f‹rs
 
impÜt
 
Paym’tM‘hodF‹r


11 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
·ym’t_m‘hods_£rŸliz”s
 
impÜt
 
	gPaym’tProûssÜS”Ÿliz”
, \

12 
Paym’tM‘hodS”Ÿliz”


13 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gPaym’tM‘hod
, 
Cu¡om”


16 
şass
 
	$Paym’tProûssÜLi¡
(
Li¡APIV›w
):

17 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

18 
£rŸliz”_şass
 = 
Paym’tProûssÜS”Ÿliz”


19 
Üd”šg
 = ('-name', )

21 
def
 
	$g‘_qu”y£t
(
£lf
):

22  
·ym’t_´oûssÜs
.
	$g‘_®l_š¡ªûs
()

25 
şass
 
	$Paym’tProûssÜD‘a
(
R‘r›veAPIV›w
):

26 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

27 
£rŸliz”_şass
 = 
Paym’tProûssÜS”Ÿliz”


28 
Üd”šg
 = ('-name', )

30 
def
 
	$g‘_objeù
(
£lf
):

31 
´oûssÜ_Çme
 = 
£lf
.
kw¬gs
.
	`g‘
('processor_name', '')

32 
Œy
:

33  
·ym’t_´oûssÜs
.
	$g‘_š¡ªû
(
´oûssÜ_Çme
)

34 
	$exû±
 (
ImpÜtE¼Ü
, 
KeyE¼Ü
):

35 
¿i£
 
H‰p404


38 
şass
 
	$Paym’tM‘hodLi¡
(
Li¡C»©eAPIV›w
):

39 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

40 
£rŸliz”_şass
 = 
Paym’tM‘hodS”Ÿliz”


41 
f‹r_back’ds
 = (
DjªgoF‹rBack’d
,)

42 
f‹r_şass
 = 
Paym’tM‘hodF‹r


44 
def
 
	$g‘_qu”y£t
(
£lf
):

45  
Paym’tM‘hod
.
objeùs
.
	$f‹r
(
cu¡om”
=
£lf
.customer)

47 
def
 
	$g‘_cu¡om”
(
£lf
, 
»que¡
):

48 
cÚ‹xt
 = 
£lf
.
	$g‘_·r£r_cÚ‹xt
(
»que¡
)

49 
kw¬gs
 = 
cÚ‹xt
['kwargs']

51 
cu¡om”_pk
 = 
kw¬gs
.
	`g‘
('cu¡om”_pk', 
NÚe
)

53  
	$g‘_objeù_Ü_404
(
Cu¡om”
, 
id
=
cu¡om”_pk
)

55 
def
 
	$li¡
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

56 
cu¡om”
 = 
£lf
.
	$g‘_cu¡om”
(
»que¡
)

58 
£lf
.
cu¡om”
 = customer

60  
	`su³r
(
Paym’tM‘hodLi¡
, 
£lf
).
	$li¡
(
»que¡
, *
¬gs
, **
kw¬gs
)

62 
def
 
	$³rfÜm_ü—‹
(
£lf
, 
£rŸliz”
):

63 
cu¡om”
 = 
£lf
.
	$g‘_cu¡om”
(
£lf
.
»que¡
)

64 
£rŸliz”
.
	$§ve
(
cu¡om”
=customer)

67 
şass
 
	$Paym’tM‘hodD‘a
(
R‘r›veUpd©eAPIV›w
):

68 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

69 
£rŸliz”_şass
 = 
Paym’tM‘hodS”Ÿliz”


71 
def
 
	$g‘_objeù
(
£lf
):

72 
·ym’t_m‘hod_id
 = 
£lf
.
kw¬gs
.
	`g‘
('payment_method_id')

73 
cu¡om”_pk
 = 
£lf
.
kw¬gs
.
	`g‘
('customer_pk')

75  
	`g‘_objeù_Ü_404
(

76 
Paym’tM‘hod
.
objeùs
.
	`®l
().
	`£Ëù_subşas£s
(),

77 
id
=
·ym’t_m‘hod_id
,

78 
cu¡om”__pk
=
cu¡om”_pk


82 
şass
 
	$Paym’tM‘hodAùiÚ
(
APIV›w
):

83 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

84 
®lowed_aùiÚs
 = ('cancel', )

86 
def
 
	$po¡
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

87 
·ym’t_m‘hod
 = 
£lf
.
	$g‘_objeù
(**
kw¬gs
)

88 
»que¡ed_aùiÚ
 = 
kw¬gs
.
	`g‘
('requested_action')

90 
»que¡ed_aùiÚ
 
nÙ
 
š
 
£lf
.
®lowed_aùiÚs
:

91 
”rÜ_mes§ge
 = "{} i nÙ‡À®lowed".
	$fÜm©
(
»que¡ed_aùiÚ
)

92  
	`Re¥Ú£
({"”rÜs": 
”rÜ_mes§ge
},

93 
	g¡©us
=
¡©us
.
HTTP_400_BAD_REQUEST
)

95 
aùiÚ_to_execu‹
 = 
	$g‘©Œ
(
·ym’t_m‘hod
, 
»que¡ed_aùiÚ
, 
NÚe
)

97 
nÙ
 
aùiÚ_to_execu‹
:

98 
¿i£
 
H‰p404


100 
”rÜs
 = 
	$aùiÚ_to_execu‹
()

101 
”rÜs
:

102  
	`Re¥Ú£
({"”rÜs": 
”rÜs
},

103 
	g¡©us
=
¡©us
.
HTTP_400_BAD_REQUEST
)

105 
·ym’t_m‘hod_£rŸlized
 = 
Paym’tM‘hodS”Ÿliz”
(
·ym’t_m‘hod
,

106 
cÚ‹xt
={'»que¡': 
»que¡
})

107  
	$Re¥Ú£
(
·ym’t_m‘hod_£rŸlized
.
d©a
,

108 
¡©us
=¡©us.
HTTP_200_OK
)

110 
def
 
	$g‘_objeù
(
£lf
, **
kw¬gs
):

111 
·ym’t_m‘hod_id
 = 
kw¬gs
.
	`g‘
('payment_method_id')

112 
cu¡om”_pk
 = 
kw¬gs
.
	`g‘
('customer_pk')

114  
	`g‘_objeù_Ü_404
(

115 
Paym’tM‘hod
.
objeùs
.
	`®l
().
	`£Ëù_subşas£s
(),

116 
id
=
·ym’t_m‘hod_id
,

117 
cu¡om”__pk
=
cu¡om”_pk


	@silver/api/views/plan_views.py

1 
äom
 
	gªnoyšg
.
funùiÚs
 
impÜt
 
g‘_objeù_Ü_NÚe


2 
äom
 
	gdjªgo_f‹rs
.
»¡_äamewÜk
 
impÜt
 
DjªgoF‹rBack’d


3 
äom
 
»¡_äamewÜk
 
impÜt
 
	gg’”ics
, 
	g³rmissiÚs
, 
¡©us


4 
äom
 
	g»¡_äamewÜk
.
g’”ics
 
impÜt
 
g‘_objeù_Ü_404


5 
äom
 
	g»¡_äamewÜk
.
»¥Ú£
 
impÜt
 
Re¥Ú£


7 
äom
 
	gsv”
.
	g­i
.
f‹rs
 
impÜt
 
PÏnF‹r


8 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
commÚ
 
impÜt
 
M‘”edF—tu»S”Ÿliz”


9 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
¶ªs_£rŸliz”
 
impÜt
 
PÏnS”Ÿliz”


10 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gPÏn
, 
M‘”edF—tu»


13 
şass
 
	$PÏnLi¡
(
g’”ics
.
Li¡C»©eAPIV›w
):

15 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

16 
£rŸliz”_şass
 = 
PÏnS”Ÿliz”


17 
qu”y£t
 = 
PÏn
.
objeùs
.
	`®l
().
	`´eãtch_»Ï‹d
('metered_features')

18 
f‹r_back’ds
 = (
DjªgoF‹rBack’d
,)

19 
f‹r_şass
 = 
PÏnF‹r


22 
şass
 
	$PÏnD‘a
(
g’”ics
.
R‘r›veDe¡royAPIV›w
):

23 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

24 
£rŸliz”_şass
 = 
PÏnS”Ÿliz”


25 
mod–
 = 
PÏn


27 
def
 
	$g‘_objeù
(
£lf
):

28 
pk
 = 
£lf
.
kw¬gs
.
	`g‘
('pk', 
NÚe
)

29  
	$g‘_objeù_Ü_404
(
PÏn
, 
pk
=pk)

31 
def
 
	$·tch
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

32 
¶ª
 = 
	`g‘_objeù_Ü_404
(
PÏn
.
objeùs
, 
pk
=
£lf
.
kw¬gs
.
	`g‘
('pk', 
NÚe
))

33 
Çme
 = 
»que¡
.
d©a
.
	`g‘
('Çme', 
NÚe
)

34 
g’”©e_aá”
 = 
»que¡
.
d©a
.
	`g‘
('g’”©e_aá”', 
NÚe
)

35 
¶ª
.
Çme
 =‚am
Ü
…lan.name

36 
¶ª
.
g’”©e_aá”
 = g’”©e_aá” 
Ü
…lan.generate_after

37 
¶ª
.
	$§ve
()

38  
	`Re¥Ú£
(
	`PÏnS”Ÿliz”
(
¶ª
, 
cÚ‹xt
={'»que¡': 
»que¡
}).d©a,

39 
	g¡©us
=
¡©us
.
HTTP_200_OK
)

41 
def
 
	$d–‘e
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

42 
¶ª
 = 
	`g‘_objeù_Ü_404
(
PÏn
.
objeùs
, 
pk
=
£lf
.
kw¬gs
.
	`g‘
('pk', 
NÚe
))

43 
¶ª
.
’abËd
 = 
F®£


44 
¶ª
.
	$§ve
()

45  
	`Re¥Ú£
({"d–‘ed": 
nÙ
 
¶ª
.
’abËd
},

46 
	g¡©us
=
¡©us
.
HTTP_200_OK
)

49 
şass
 
	$PÏnM‘”edF—tu»s
(
g’”ics
.
Li¡APIV›w
):

50 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

51 
£rŸliz”_şass
 = 
M‘”edF—tu»S”Ÿliz”


52 
mod–
 = 
M‘”edF—tu»


54 
def
 
	$g‘_qu”y£t
(
£lf
):

55 
¶ª
 = 
	`g‘_objeù_Ü_NÚe
(
PÏn
, 
pk
=
£lf
.
kw¬gs
['pk'])

56  
¶ª
.
m‘”ed_ã©u»s
.
	$®l
(è
¶ª
 
NÚe


	@silver/api/views/product_code_views.py

1 
äom
 
»¡_äamewÜk
 
impÜt
 
	gg’”ics
, 
³rmissiÚs


3 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
´oduù_codes_£rŸliz”
 
impÜt
 
ProduùCodeS”Ÿliz”


4 
äom
 
	gsv”
.
mod–s
 
impÜt
 
ProduùCode


7 
şass
 
	$ProduùCodeLi¡C»©e
(
g’”ics
.
Li¡C»©eAPIV›w
):

8 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

9 
£rŸliz”_şass
 = 
ProduùCodeS”Ÿliz”


10 
qu”y£t
 = 
ProduùCode
.
objeùs
.
	$®l
()

13 
şass
 
	$ProduùCodeR‘r›veUpd©e
(
g’”ics
.
R‘r›veUpd©eAPIV›w
):

14 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

15 
£rŸliz”_şass
 = 
ProduùCodeS”Ÿliz”


16 
qu”y£t
 = 
ProduùCode
.
objeùs
.
	`®l
()

	@silver/api/views/subscription_views.py

1 
impÜt
 
d©‘ime


2 
äom
 
decim®
 
impÜt
 
Decim®


4 
äom
 
	gªnoyšg
.
funùiÚs
 
impÜt
 
g‘_objeù_Ü_NÚe


5 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


6 
äom
 
	gdjªgo_f‹rs
.
»¡_äamewÜk
 
impÜt
 
DjªgoF‹rBack’d


7 
äom
 
»¡_äamewÜk
 
impÜt
 
	gg’”ics
, 
	g³rmissiÚs
, 
¡©us


8 
äom
 
	g»¡_äamewÜk
.
g’”ics
 
impÜt
 
g‘_objeù_Ü_404


9 
äom
 
	g»¡_äamewÜk
.
»¥Ú£
 
impÜt
 
Re¥Ú£


10 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

11 
äom
 
	g»¡_äamewÜk
.
v›ws
 
impÜt
 
APIV›w


13 
äom
 
	gsv”
.
	g­i
.
f‹rs
 
impÜt
 
	gM‘”edF—tu»sF‹r
, 
SubsütiÚF‹r


14 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
commÚ
 
impÜt
 
M‘”edF—tu»S”Ÿliz”


15 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
subsütiÚs_£rŸliz”s
 
impÜt
 
	gSubsütiÚS”Ÿliz”
, \

16 
	gSubsütiÚD‘aS”Ÿliz”
, 
MFUn™sLogS”Ÿliz”


17 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gM‘”edF—tu»
, 
	gSubsütiÚ
, 
M‘”edF—tu»Un™sLog


18 
impÜt
 
loggšg


20 
	glogg”
 = 
loggšg
.
	$g‘Logg”
(
__Çme__
)

23 
şass
 
	$M‘”edF—tu»Li¡
(
g’”ics
.
Li¡C»©eAPIV›w
):

24 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

25 
£rŸliz”_şass
 = 
M‘”edF—tu»S”Ÿliz”


26 
qu”y£t
 = 
M‘”edF—tu»
.
objeùs
.
	$®l
()

27 
f‹r_back’ds
 = (
DjªgoF‹rBack’d
,)

28 
f‹r_şass
 = 
M‘”edF—tu»sF‹r


31 
şass
 
	$M‘”edF—tu»D‘a
(
g’”ics
.
R‘r›veAPIV›w
):

32 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

33 
£rŸliz”_şass
 = 
M‘”edF—tu»S”Ÿliz”


34 
mod–
 = 
M‘”edF—tu»


36 
def
 
	$g‘_objeù
(
£lf
):

37 
cu¡om”_pk
 = 
£lf
.
kw¬gs
.
	`g‘
('pk', 
NÚe
)

38  
	$g‘_objeù_Ü_404
(
M‘”edF—tu»
, 
pk
=
cu¡om”_pk
)

41 
şass
 
	$SubsütiÚLi¡
(
g’”ics
.
Li¡C»©eAPIV›w
):

42 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

43 
£rŸliz”_şass
 = 
SubsütiÚS”Ÿliz”


44 
f‹r_back’ds
 = (
DjªgoF‹rBack’d
,)

45 
f‹r_şass
 = 
SubsütiÚF‹r


47 
def
 
	$g‘_qu”y£t
(
£lf
):

48 
cu¡om”_pk
 = 
£lf
.
kw¬gs
.
	`g‘
('cu¡om”_pk', 
NÚe
)

49 
qu”y£t
 = 
SubsütiÚ
.
objeùs
.
	$f‹r
(
cu¡om”__pk
=
cu¡om”_pk
)

50  
qu”y£t
.
	`Üd”_by
('start_date')

52 
def
 
	$po¡
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

53 
cu¡om”_pk
 = 
£lf
.
kw¬gs
.
	`g‘
('cu¡om”_pk', 
NÚe
)

54 
u¾
 = 
	`»v”£
('cu¡om”-d‘a', 
kw¬gs
={'cu¡om”_pk': 
cu¡om”_pk
},

55 
	g»que¡
=
»que¡
)

56 
»que¡
.
d©a
.
upd©e
({
unicode
('cu¡om”'): unicode(
u¾
)})

58  
su³r
(
SubsütiÚLi¡
, 
£lf
).
	$po¡
(
»que¡
, *
¬gs
, **
kw¬gs
)

61 
şass
 
	$SubsütiÚD‘a
(
g’”ics
.
R‘r›veUpd©eAPIV›w
):

62 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

63 
£rŸliz”_şass
 = 
SubsütiÚD‘aS”Ÿliz”


65 
def
 
	$g‘_objeù
(
£lf
):

66 
cu¡om”_pk
 = 
£lf
.
kw¬gs
.
	`g‘
('cu¡om”_pk', 
NÚe
)

67 
subsütiÚ_pk
 = 
£lf
.
kw¬gs
.
	`g‘
('subsütiÚ_pk', 
NÚe
)

68  
	$g‘_objeù_Ü_404
(
SubsütiÚ
, 
cu¡om”__id
=
cu¡om”_pk
,

69 
pk
=
subsütiÚ_pk
)

71 
def
 
	$put
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

72  
	`Re¥Ú£
({'d‘a': 'M‘hod "PUT"‚Ù‡Îowed.'
	}
},

73 
	g¡©us
=
¡©us
.
HTTP_405_METHOD_NOT_ALLOWED
)

75 
def
 
	$·tch
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

76 
sub
 = 
	`g‘_objeù_Ü_404
(
SubsütiÚ
.
objeùs
,

77 
pk
=
£lf
.
kw¬gs
.
	`g‘
('subsütiÚ_pk', 
NÚe
))

78 
¡©e
 = 
sub
.state

79 
m‘a
 = 
»que¡
.
d©a
.
	`pİ
('m‘a', 
NÚe
)

80 
»que¡
.
d©a
:

81 
mes§ge
 = "Cannot update‡ subscription when it's in %s state." \

82 % 
¡©e


83  
	`Re¥Ú£
({"d‘a": 
mes§ge
},

84 
	g¡©us
=
¡©us
.
HTTP_400_BAD_REQUEST
)

85 
»que¡
.
d©a
.
	$ş—r
()

86 
»que¡
.
d©a
.
	`upd©e
({'m‘a': 
m‘a
} m‘¨{})

87  
su³r
(
SubsütiÚD‘a
, 
£lf
).
	$·tch
(
»que¡
,

88 *
¬gs
, **
kw¬gs
)

91 
şass
 
	$SubsütiÚAùiv©e
(
APIV›w
):

92 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

94 
def
 
	$po¡
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

95 
sub
 = 
	`g‘_objeù_Ü_404
(
SubsütiÚ
.
objeùs
,

96 
pk
=
£lf
.
kw¬gs
.
	`g‘
('subsütiÚ_pk', 
NÚe
))

97 
sub
.
¡©e
 !ğ
SubsütiÚ
.
STATES
.
INACTIVE
:

98 
mes§ge
 = 'CªnÙ‡ùiv©subsütiÚ from % ¡©e.' % 
sub
.
¡©e


99  
	`Re¥Ú£
({"”rÜ": 
mes§ge
},

100 
	g¡©us
=
¡©us
.
HTTP_400_BAD_REQUEST
)

102 
»que¡
.
POST
.
g‘
('_cÚ‹Á', 
NÚe
):

103 
¡¬t_d©e
 = 
»que¡
.
d©a
.
g‘
('¡¬t_d©e', 
NÚe
)

104 
	gŒŸl_’d
 = 
»que¡
.
d©a
.
g‘
('ŒŸl_’d_d©e', 
NÚe
)

105 
	g¡¬t_d©e
:

106 
Œy
:

107 
¡¬t_d©e
 = 
d©‘ime
.d©‘ime.
¡½time
(

108 
¡¬t_d©e
, '%Y-%m-%d').
	$d©e
()

109 
exû±
 
Ty³E¼Ü
:

110  
	`Re¥Ú£
(

112 'u£hISO 8601 d©fÜm©.'
	}
},

113 
	g¡©us
=
¡©us
.
HTTP_400_BAD_REQUEST
)

114 
ŒŸl_’d
:

115 
Œy
:

116 
ŒŸl_’d
 = 
d©‘ime
.d©‘ime.
¡½time
(

117 
ŒŸl_’d
, '%Y-%m-%d').
	$d©e
()

118 
exû±
 
Ty³E¼Ü
:

119  
	`Re¥Ú£
(

121 'u£hISO 8601 d©fÜm©.'
	}
},

122 
	g¡©us
=
¡©us
.
HTTP_400_BAD_REQUEST
)

123 
sub
.
	$aùiv©e
(
¡¬t_d©e
=¡¬t_d©e, 
ŒŸl_’d_d©e
=
ŒŸl_’d
)

124 
sub
.
	$§ve
()

126 
sub
.
	$aùiv©e
()

127 
sub
.
	$§ve
()

129 
logg”
.
	`debug
('Activated subscription: %s', {

130 'subsütiÚ': 
sub
.
id
,

131 'd©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d')

132 
	}
})

134  
Re¥Ú£
({"¡©e": 
sub
.
¡©e
},

135 
¡©us
=¡©us.
HTTP_200_OK
)

138 
şass
 
	$SubsütiÚCªûl
(
APIV›w
):

139 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

141 
def
 
	$po¡
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

142 
sub
 = 
	`g‘_objeù_Ü_404
(
SubsütiÚ
,

143 
pk
=
kw¬gs
.
	`g‘
('subsütiÚ_pk', 
NÚe
))

144 
wh’
 = 
»que¡
.
d©a
.
	`g‘
('wh’', 
NÚe
)

145 
sub
.
¡©e
 !ğ
SubsütiÚ
.
STATES
.
ACTIVE
:

146 
mes§ge
 = 'CªnÙ cªûÈsubsütiÚ from % ¡©e.' % 
sub
.
¡©e


147  
	`Re¥Ú£
({"”rÜ": 
mes§ge
},

148 
	g¡©us
=
¡©us
.
HTTP_400_BAD_REQUEST
)

150 
wh’
 
š
 [
SubsütiÚ
.
CANCEL_OPTIONS
.
NOW
,

151 
SubsütiÚ
.
CANCEL_OPTIONS
.
END_OF_BILLING_CYCLE
]:

152 
sub
.
	$ÿnûl
(
wh’
=when)

153 
sub
.
	$§ve
()

155 
logg”
.
	`debug
('Canceled subscription: %s', {

156 'subsütiÚ': 
sub
.
id
,

157 'd©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

158 'wh’': 
wh’
,

159 
	}
})

161  
Re¥Ú£
({"¡©e": 
sub
.
¡©e
},

162 
¡©us
=¡©us.
HTTP_200_OK
)

164 
wh’
 
is
 
NÚe
:

165 
”r
 = 'You must…rovidehe `when`‡rgument'

166  
Re¥Ú£
({'”rÜ': 
”r
},

167 
¡©us
=¡©us.
HTTP_400_BAD_REQUEST
)

169 
”r
 = 'You must…rovide‡ correct value forhe `when`‡rgument'

170  
Re¥Ú£
({'”rÜ': 
”r
},

171 
¡©us
=¡©us.
HTTP_400_BAD_REQUEST
)

174 
şass
 
	$SubsütiÚR—ùiv©e
(
APIV›w
):

175 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

177 
def
 
	$po¡
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

178 
sub
 = 
	`g‘_objeù_Ü_404
(
SubsütiÚ
,

179 
pk
=
kw¬gs
.
	`g‘
('subsütiÚ_pk', 
NÚe
))

180 
sub
.
¡©e
 !ğ
SubsütiÚ
.
STATES
.
CANCELED
:

181 
msg
 = 'CªnÙ„—ùiv©subsütiÚ from % ¡©e.' % 
sub
.
¡©e


182  
	`Re¥Ú£
({"”rÜ": 
msg
},

183 
	g¡©us
=
¡©us
.
HTTP_400_BAD_REQUEST
)

185 
sub
.
	$aùiv©e
()

186 
sub
.
	$§ve
()

188 
logg”
.
	`debug
('Reactivated subscription: %s', {

189 'subsütiÚ': 
sub
.
id
,

190 'd©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

191 
	}
})

193  
Re¥Ú£
({"¡©e": 
sub
.
¡©e
},

194 
¡©us
=¡©us.
HTTP_200_OK
)

197 
şass
 
	$M‘”edF—tu»Un™sLogD‘a
(
APIV›w
):

198 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

199 
·gš©e_by
 = 
NÚe


201 
def
 
	$g‘
(
£lf
, 
»que¡
, 
fÜm©
=
NÚe
, **
kw¬gs
):

202 
subsütiÚ_pk
 = 
kw¬gs
.
	`g‘
('subsütiÚ_pk', 
NÚe
)

203 
mf_´oduù_code
 = 
kw¬gs
.
	`g‘
('mf_´oduù_code', 
NÚe
)

205 
subsütiÚ
 = 
SubsütiÚ
.
objeùs
.
	$g‘
(
pk
=
subsütiÚ_pk
)

207 
m‘”ed_ã©u»
 = 
	$g‘_objeù_Ü_404
(

208 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
,

209 
´oduù_code__v®ue
=
mf_´oduù_code


212 
logs
 = 
M‘”edF—tu»Un™sLog
.
objeùs
.
	$f‹r
(

213 
m‘”ed_ã©u»
=m‘”ed_ã©u».
pk
,

214 
subsütiÚ
=
subsütiÚ_pk
)

216 
£rŸliz”
 = 
	`MFUn™sLogS”Ÿliz”
(

217 
logs
, 
mªy
=
True
, 
cÚ‹xt
={'»que¡': 
»que¡
}

219  
	$Re¥Ú£
(
£rŸliz”
.
d©a
)

221 
def
 
	$·tch
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

222 
mf_´oduù_code
 = 
£lf
.
kw¬gs
.
	`g‘
('mf_´oduù_code', 
NÚe
)

223 
subsütiÚ_pk
 = 
£lf
.
kw¬gs
.
	`g‘
('subsütiÚ_pk', 
NÚe
)

225 
Œy
:

226 
subsütiÚ
 = 
SubsütiÚ
.
objeùs
.
	$g‘
(
pk
=
subsütiÚ_pk
)

227 
exû±
 
SubsütiÚ
.
DÛsNÙExi¡
:

228  
	`Re¥Ú£
({"d‘a": "SubsütiÚ NÙ found."
	}
},

229 
	g¡©us
=
¡©us
.
HTTP_404_NOT_FOUND
)

231 #TODO: 
chªge
 
this
 
to
 
Œy
-
exû±


232 
m‘”ed_ã©u»
 = 
	$g‘_objeù_Ü_NÚe
(

233 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
,

234 
´oduù_code__v®ue
=
mf_´oduù_code


237 
nÙ
 
m‘”ed_ã©u»
:

238  
	`Re¥Ú£
({"d‘a": "M‘”ed F—tu» NÙ found."
	}
},

239 
	g¡©us
=
¡©us
.
HTTP_404_NOT_FOUND
)

241 
subsütiÚ
.
¡©e
 
nÙ
 
š
 [subsütiÚ.
STATES
.
ACTIVE
,

242 
subsütiÚ
.
STATES
.
CANCELED
]:

243  
Re¥Ú£
({"d‘a": "SubsütiÚ i %s." % 
subsütiÚ
.
¡©e
},

244 
¡©us
=¡©us.
HTTP_403_FORBIDDEN
)

246 
»quœed_f›lds
 = ['date', 'count', 'update_type']

247 
	g´ovided_f›lds
 = {}

248 
”rÜs
 = {}

249 
f›ld
 
š
 
»quœed_f›lds
:

250 
Œy
:

251 
´ovided_f›lds
[
f›ld
] = 
»que¡
.
d©a
[field]

252 
exû±
 
KeyE¼Ü
:

253 
”rÜs
[
f›ld
] = ["This field is„equired."]

255 
key
 
š
 
´ovided_f›lds
:

256 
nÙ
 
´ovided_f›lds
[
key
]:

257 
”rÜs
[
key
] = ["This field may‚ot be blank."]

259 
”rÜs
:

260  
	$Re¥Ú£
(
”rÜs
, 
¡©us
=¡©us.
HTTP_400_BAD_REQUEST
)

262 
d©e
 = 
»que¡
.
d©a
['date']

263 
cÚsumed_un™s
 = 
»que¡
.
d©a
['count']

264 
upd©e_ty³
 = 
»que¡
.
d©a
['update_type']

266 
cÚsumed_un™s
 = 
	$Decim®
(
cÚsumed_un™s
)

268 
Œy
:

269 
d©e
 = 
d©‘ime
.d©‘ime.
	`¡½time
(date,

270 '%Y-%m-%d').
	$d©e
()

271 
exû±
 
Ty³E¼Ü
:

272  
	`Re¥Ú£
({'detail': 'Invalid date format. Please '

273 'u£hISO 8601 d©fÜm©.'
	}
},

274 
	g¡©us
=
¡©us
.
HTTP_400_BAD_REQUEST
)

276 
d©e
 < 
subsütiÚ
.
¡¬t_d©e
:

277  
Re¥Ú£
({"detail": "Date is out of bounds."},

278 
¡©us
=¡©us.
HTTP_400_BAD_REQUEST
)

280 
bsd
 = 
subsütiÚ
.
	$buck‘_¡¬t_d©e
(
d©e
)

281 
bed
 = 
subsütiÚ
.
	$buck‘_’d_d©e
(
d©e
)

282 
nÙ
 
bsd
 
Ü
‚Ù 
bed
:

283  
	`Re¥Ú£
(

284 {'d‘a': 'AÀ”rÜ ha b“À’couÁ”ed.'
	}
},

285 
	g¡©us
=
¡©us
.
HTTP_500_INTERNAL_SERVER_ERROR
)

287 
š‹rv®
 = 
Ãxt
(

288 (
i
 ˜
š
 
subsütiÚ
.
	$upd©—bË_buck‘s
()

289 
i
['¡¬t_d©e'] =ğ
bsd
 
ªd
 i['’d_d©e'] =ğ
bed
),

290 
NÚe
)

292 
nÙ
 
š‹rv®
:

293  
	`Re¥Ú£
({"d‘a": "D©i ouˆoàbounds."
	}
},

294 
	g¡©us
=
¡©us
.
HTTP_400_BAD_REQUEST
)

296 
m‘”ed_ã©u»
 
nÙ
 
š
 \

297 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$®l
():

298 
”r
 = "The metered feature does‚ot belongohe " \

300  
	`Re¥Ú£
(

301 {"d‘a": 
”r
},

302 
	g¡©us
=
¡©us
.
HTTP_400_BAD_REQUEST


305 
log
 = 
M‘”edF—tu»Un™sLog
.
objeùs
.
f‹r
(

306 
¡¬t_d©e
=
bsd
,

307 
’d_d©e
=
bed
,

308 
m‘”ed_ã©u»
=m‘”ed_ã©u».
pk
,

309 
subsütiÚ
=
subsütiÚ_pk


310 ).
	$fœ¡
()

312 
log
 
is
 
nÙ
 
NÚe
:

313 
upd©e_ty³
 == 'absolute':

314 
log
.
cÚsumed_un™s
 = consumed_units

315 
–if
 
upd©e_ty³
 == 'relative':

316 
log
.
cÚsumed_un™s
 += consumed_units

317 
log
.
	$§ve
()

319 
log
 = 
M‘”edF—tu»Un™sLog
.
objeùs
.
	$ü—‹
(

320 
m‘”ed_ã©u»
=metered_feature,

321 
subsütiÚ
=subscription,

322 
¡¬t_d©e
=
bsd
,

323 
’d_d©e
=
bed
,

324 
cÚsumed_un™s
=consumed_units

326  
	`Re¥Ú£
({"couÁ": 
log
.
cÚsumed_un™s
},

327 
	g¡©us
=
¡©us
.
HTTP_200_OK
)

	@silver/api/views/transaction_views.py

1 
äom
 
uuid
 
impÜt
 
UUID


3 
äom
 
	gdjªgo
.
h‰p
 
impÜt
 
H‰p404


4 
äom
 
	gdjªgo_f‹rs
.
»¡_äamewÜk
 
impÜt
 
DjªgoF‹rBack’d


5 
äom
 
djªgo_fsm
 
impÜt
 
T¿ns™iÚNÙAÎowed


6 
äom
 
»¡_äamewÜk
 
impÜt
 
	g³rmissiÚs
, 
¡©us


7 
äom
 
	g»¡_äamewÜk
.
g’”ics
 
impÜt
 
	gLi¡C»©eAPIV›w
, 
	gg‘_objeù_Ü_404
, 
R‘r›veUpd©eAPIV›w


8 
äom
 
	g»¡_äamewÜk
.
»¥Ú£
 
impÜt
 
Re¥Ú£


9 
äom
 
	g»¡_äamewÜk
.
v›ws
 
impÜt
 
APIV›w


11 
äom
 
	gsv”
.
	g­i
.
f‹rs
 
impÜt
 
T¿n§ùiÚF‹r


12 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
Œª§ùiÚ_£rŸliz”s
 
impÜt
 
T¿n§ùiÚS”Ÿliz”


13 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gPaym’tM‘hod
, 
T¿n§ùiÚ


16 
şass
 
	$T¿n§ùiÚLi¡
(
Li¡C»©eAPIV›w
):

17 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

18 
£rŸliz”_şass
 = 
T¿n§ùiÚS”Ÿliz”


19 
f‹r_back’ds
 = (
DjªgoF‹rBack’d
,)

20 
f‹r_şass
 = 
T¿n§ùiÚF‹r


22 
def
 
	$g‘_qu”y£t
(
£lf
):

23 
cu¡om”_pk
 = 
£lf
.
kw¬gs
.
	`g‘
('cu¡om”_pk', 
NÚe
)

25 
·ym’t_m‘hod_id
 = 
£lf
.
kw¬gs
.
	`g‘
('payment_method_id')

26 
·ym’t_m‘hod_id
:

27 
·ym’t_m‘hod
 = 
	$g‘_objeù_Ü_404
(
Paym’tM‘hod
,

28 
id
=
·ym’t_m‘hod_id
,

29 
cu¡om”__pk
=
cu¡om”_pk
)

31  
T¿n§ùiÚ
.
objeùs
.
	$f‹r
(

32 
·ym’t_m‘hod
=payment_method

35  
T¿n§ùiÚ
.
objeùs
.
	$f‹r
(

36 
·ym’t_m‘hod__cu¡om”__pk
=
cu¡om”_pk


39 
def
 
	$³rfÜm_ü—‹
(
£lf
, 
£rŸliz”
):

40 
·ym’t_m‘hod_id
 = 
£lf
.
kw¬gs
.
	`g‘
('payment_method_id')

41 
·ym’t_m‘hod_id
:

42 
·ym’t_m‘hod
 = 
	$g‘_objeù_Ü_404
(
Paym’tM‘hod
,

43 
id
=
·ym’t_m‘hod_id
)

44 
£rŸliz”
.
	$§ve
(
·ym’t_m‘hod
=payment_method)

46 
£rŸliz”
.
	$§ve
()

49 
şass
 
	$T¿n§ùiÚD‘a
(
R‘r›veUpd©eAPIV›w
):

50 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
AÎowAny
,)

51 
£rŸliz”_şass
 = 
T¿n§ùiÚS”Ÿliz”


52 
h‰p_m‘hod_Çmes
 = ('get', 'patch', 'head', 'options')

54 
def
 
	$g‘_objeù
(
£lf
):

55 
Œª§ùiÚ_uuid
 = 
£lf
.
kw¬gs
.
	`g‘
('Œª§ùiÚ_uuid', 
NÚe
)

56 
Œy
:

57 
uuid
 = 
	$UUID
(
Œª§ùiÚ_uuid
, 
v”siÚ
=4)

58 
exû±
 
V®ueE¼Ü
:

59 
¿i£
 
H‰p404


61  
	$g‘_objeù_Ü_404
(
T¿n§ùiÚ
, 
uuid
=uuid)

64 
şass
 
	$T¿n§ùiÚAùiÚ
(
APIV›w
):

65 
³rmissiÚ_şas£s
 = (
³rmissiÚs
.
IsAuth’tiÿ‹d
,)

66 
®lowed_aùiÚs
 = ('cancel', )

68 
def
 
	$po¡
(
£lf
, 
»que¡
, *
¬gs
, **
kw¬gs
):

69 
Œª§ùiÚ
 = 
£lf
.
	$g‘_objeù
(**
kw¬gs
)

70 
»que¡ed_aùiÚ
 = 
kw¬gs
.
	`g‘
('requested_action')

72 
»que¡ed_aùiÚ
 
nÙ
 
š
 
£lf
.
®lowed_aùiÚs
:

73 
”rÜ_mes§ge
 = "{} i nÙ‡À®lowed".
	$fÜm©
(
»que¡ed_aùiÚ
)

74  
	`Re¥Ú£
({"”rÜs": 
”rÜ_mes§ge
},

75 
	g¡©us
=
¡©us
.
HTTP_400_BAD_REQUEST
)

77 
aùiÚ_to_execu‹
 = 
	$g‘©Œ
(
Œª§ùiÚ
, 
»que¡ed_aùiÚ
, 
NÚe
)

78 
nÙ
 
aùiÚ_to_execu‹
:

79 
¿i£
 
H‰p404


81 
Œy
:

82 
”rÜs
 = 
	$aùiÚ_to_execu‹
()

83 
Œª§ùiÚ
.
	$§ve
()

84 
exû±
 
T¿ns™iÚNÙAÎowed
:

85 
”rÜs
 = "Can'tƒxecute‡ction becauseheransaction is in‡n " \

86 "šcÜ»ù s‹: {}".
	$fÜm©
(
Œª§ùiÚ
.
¡©e
)

88 
”rÜs
:

89  
	`Re¥Ú£
({"”rÜs": 
”rÜs
},

90 
	g¡©us
=
¡©us
.
HTTP_400_BAD_REQUEST
)

92 
Œª§ùiÚ_£rŸlized
 = 
T¿n§ùiÚS”Ÿliz”
(
Œª§ùiÚ
,

93 
cÚ‹xt
={'»que¡': 
»que¡
})

94  
	$Re¥Ú£
(
Œª§ùiÚ_£rŸlized
.
d©a
,

95 
¡©us
=¡©us.
HTTP_200_OK
)

97 
def
 
	$g‘_objeù
(
£lf
, **
kw¬gs
):

98 
Œª§ùiÚ_uuid
 = 
kw¬gs
.
	`g‘
('transaction_uuid')

99 
cu¡om”_pk
 = 
kw¬gs
.
	`g‘
('customer_pk')

101  
	`g‘_objeù_Ü_404
(

102 
T¿n§ùiÚ
.
objeùs
.
	`®l
(),

103 
uuid
=
Œª§ùiÚ_uuid
,

104 
·ym’t_m‘hod__cu¡om”__pk
=
cu¡om”_pk


	@silver/currencies.py

1 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


2 
äom
 
	gdjªgo
.
	guts
.
moduË_lßdšg
 
impÜt
 
impÜt_¡ršg


5 
şass
 
	$R©eNÙFound
(
Exû±iÚ
):

6 
def
 
	$__š™__
(
£lf
, 
äom_cu¼’cy
=
NÚe
, 
to_cu¼’cy
=NÚe, 
d©e
=None):

7 
£lf
.
äom_cu¼’cy
 = from_currency

8 
£lf
.
to_cu¼’cy
 =o_currency

9 
£lf
.
d©e
 = date

11 
def
 
	$__¡r__
(
£lf
):

12 
nÙ
 
	$®l
([
£lf
.
äom_cu¼’cy
, s–f.
to_cu¼’cy
]):

15 
nÙ
 
£lf
.
d©e
:

16  'NØ¿‹ fÜ {}Ø{}.'.
	$fÜm©
(
£lf
.
äom_cu¼’cy
,

17 
£lf
.
to_cu¼’cy
)

19  'NØ¿‹ fÜ {}Ø{}, from {} wa found.'.
	$fÜm©
(

20 
£lf
.
äom_cu¼’cy
, s–f.
to_cu¼’cy
, s–f.
d©e


24 
şass
 
	$DummyCÚv”‹r
(
objeù
):

25 
def
 
	$cÚv”t
(
£lf
, 
amouÁ
, 
äom_cu¼’cy
, 
to_cu¼’cy
, 
d©e
):

26 
äom_cu¼’cy
 !ğ
to_cu¼’cy
:

27 
¿i£
 
	$R©eNÙFound
(
äom_cu¼’cy
, 
to_cu¼’cy
, 
d©e
)

28  
amouÁ


30 
Œy
:

31 
Cu¼’cyCÚv”‹r
 = 
	$impÜt_¡ršg
(
£‰šgs
.
SILVER_CURRENCY_CONVERTER
)()

32 
exû±
 
A‰ribu‹E¼Ü
:

33 
Cu¼’cyCÚv”‹r
 = 
	`DummyCÚv”‹r
()

	@silver/documents_generator.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
d©‘ime
 
as
 
dt


17 
impÜt
 
loggšg


18 
äom
 
decim®
 
impÜt
 
Decim®


20 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


22 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gCu¡om”
, 
	gSubsütiÚ
, 
	gProfÜma
, 
	gInvoiû
, 
	gProvid”
, 
BlšgLog


23 
äom
 
	gsv”
.
	guts
.
d©es
 
impÜt
 
ONE_DAY


25 
	glogg”
 = 
loggšg
.
	$g‘Logg”
(
__Çme__
)

28 
şass
 
	$Docum’tsG’”©Ü
(
objeù
):

29 
def
 
	$g’”©e
(
£lf
, 
subsütiÚ
=
NÚe
, 
blšg_d©e
=NÚe, 
cu¡om”s
=None,

30 
fÜû_g’”©e
=
F®£
):

32 
The
 `
public
` 
m‘hod
 
ÿÎed
 
wh’
 
Úe
 
wªts
 
to
 
g’”©e
 
the
 
blšg


33 
docum’ts
.

35 .. 
w¬nšg
:: 
FÜ
 
now
, 
the
 
g’”©Ü
 
wÜks
 
Úly
 
¶ªs
 
w™h
 
sšgË


36 
mÚth
 
š‹rv®s
.

38 .. 
nÙe
:: 
If
 `
subsütiÚ
` 
is
 
·s£d
, 
Úly
 
the
 
docum’ts
 
th©


39 
subsütiÚ
 
¬e
 
g’”©ed
.

40 
If
 
the
 `
cu¡om”s
` 
·¿m‘”
 
is
 
·s£d
, 
Úly
h
docm’ts
 
tho£


41 
cu¡om”s
 
¬e
 
g’”©ed
.

42 
If
 
Ã™h”
 
the
 `
subsütiÚ
` 
nÜ
h`
cu¡om”s
` 
·¿m‘”s
 
¬e


43 
·s£d
, 
the
 
docum’ts
 
®l
h
cu¡om”s
 
¬e
 
g’”©ed
.

45 :
·¿m
 
subsütiÚ
: 
the
 subsütiÚ 
which
 
Úe
 
wªts
 
to
 
g’”©e
he

46 
´ofÜmas
/
švoiûs
.

47 :
·¿m
 
blšg_d©e
: 
the
 
d©e
 
u£d
 
as
 
blšg
 date

48 :
·¿m
 
cu¡om”s
: 
the
 cu¡om” 
which
 
Úe
 
wªts
 
to
 
g’”©e
he

49 
´ofÜmas
/
švoiûs
.

50 :
·¿m
 
fÜû_g’”©e
: 
True
, 
švoiûs
 
¬e
 
g’”©ed
 
©
 
the
 
d©e


51 
šdiÿ‹d
 
by
 `
blšg_d©e
` 
š¡—d
 
of
 
the
 
nÜm®
 
’d
 oà
blšg


52 
cyşe
.

55 
nÙ
 
subsütiÚ
:

56 
cu¡om”s
 = cu¡om” 
Ü
 
Cu¡om”
.
objeùs
.
	$®l
()

57 
£lf
.
	$_g’”©e_®l
(
blšg_d©e
=billing_date,

58 
cu¡om”s
=customers,

59 
fÜû_g’”©e
=force_generate)

61 
£lf
.
	$_g’”©e_fÜ_sšgË_subsütiÚ
(
subsütiÚ
=subscription,

62 
blšg_d©e
=billing_date,

63 
fÜû_g’”©e
=force_generate)

65 
def
 
	$_g’”©e_®l
(
£lf
, 
blšg_d©e
=
NÚe
, 
cu¡om”s
=None,

66 
fÜû_g’”©e
=
F®£
):

68 
G’”©es
 
the
 
švoiûs
/
´ofÜmas
 
®l
h
subsütiÚs
 
th©
 
should


69 
be
 
bËd
.

72 
blšg_d©e
 = blšg_d©
Ü
 
timezÚe
.
	`now
().
	$d©e
()

73 #blšg_d©-> 
the
 
d©e
 
wh’
h
blšg
 
docum’ts
 
¬e
 
issued
.

75 
cu¡om”
 
š
 
cu¡om”s
:

76 
cu¡om”
.
cÚsŞid©ed_blšg
:

77 
£lf
.
	$_g’”©e_fÜ_u£r_w™h_cÚsŞid©ed_blšg
(

78 
cu¡om”
, 
blšg_d©e
, 
fÜû_g’”©e


81 
£lf
.
	$_g’”©e_fÜ_u£r_w™hout_cÚsŞid©ed_blšg
(

82 
cu¡om”
, 
blšg_d©e
, 
fÜû_g’”©e


85 
def
 
	$_log_subsütiÚ_blšg
(
£lf
, 
docum’t
, 
subsütiÚ
):

86 
logg”
.
	`debug
('Billing subscription: %s', {

87 'subsütiÚ': 
subsütiÚ
.
id
,

88 '¡©e': 
subsütiÚ
.
¡©e
,

89 'doc_ty³': 
docum’t
.
´ovid”
.
æow
,

90 'numb”': 
docum’t
.
numb”
,

91 '´ovid”': 
docum’t
.
´ovid”
.
id
,

92 'cu¡om”': 
docum’t
.
cu¡om”
.
id


93 
	}
})

95 
def
 
	$g‘_subsütiÚs_´•¬ed_fÜ_blšg
(
£lf
, 
cu¡om”
, 
blšg_d©e
, 
fÜû_g’”©e
):

96 #S–eù 
®l
 
the
 
aùive
 
Ü
 
ÿnûËd
 
subsütiÚs


97 
subs_to_bl
 = []

98 
ü™”Ÿ
 = {'¡©e__š': [
SubsütiÚ
.
STATES
.
ACTIVE
,

99 
SubsütiÚ
.
STATES
.
CANCELED
]
	}
}

100 
subsütiÚ
 
š
 
cu¡om”
.
subsütiÚs
.
	$f‹r
(**
ü™”Ÿ
):

101 
subsütiÚ
.
	$should_be_bËd
(
blšg_d©e
è
Ü
 
fÜû_g’”©e
:

102 
subs_to_bl
.
	$­³nd
(
subsütiÚ
)

104  
subs_to_bl


106 
def
 
	$_bl_subsütiÚ_što_docum’t
(
£lf
, 
subsütiÚ
, 
blšg_d©e
, 
docum’t
=
NÚe
):

107 
nÙ
 
docum’t
:

108 
docum’t
 = 
£lf
.
	$_ü—‹_docum’t
(
subsütiÚ
, 
blšg_d©e
)

110 
£lf
.
	$_log_subsütiÚ_blšg
(
docum’t
, 
subsütiÚ
)

112 
kw¬gs
 = 
subsütiÚ
.
bËd_up_to_d©es


114 
kw¬gs
.
	`upd©e
({

115 'blšg_d©e': 
blšg_d©e
,

116 'subsütiÚ': 
subsütiÚ
,

117 
subsütiÚ
.
´ovid”
.
æow
: 
docum’t
,

118 
	}
})

119 
£lf
.
	$add_subsütiÚ_cyşes_to_docum’t
(**
kw¬gs
)

121 
subsütiÚ
.
¡©e
 =ğ
SubsütiÚ
.
STATES
.
CANCELED
:

122 
subsütiÚ
.
	$’d
()

123 
subsütiÚ
.
	$§ve
()

125  
docum’t


127 
def
 
	$_g’”©e_fÜ_u£r_w™h_cÚsŞid©ed_blšg
(
£lf
, 
cu¡om”
, 
blšg_d©e
, 
fÜû_g’”©e
):

129 
G’”©es
 
the
 
blšg
 
docum’ts
 
®l
h
subsütiÚs
 
of
 
a
 
cu¡om”


130 
who
 
u£s
 
cÚsŞid©ed
 
blšg
.

133 #FÜ 
—ch
 
´ovid”
 
th”e
 
wl
 
be
 
Úe
 
švoiû
 
Ü
 
´ofÜma
. 
The
 
ÿche
 
is
 
Ãûs§ry
 
as
 
a


134 #û¹aš 
cu¡om”
 
might
 
have
 
mÜe
 
thª
 
Úe
 
subsütiÚ


135 #=> 
®l
 
the
 
subsütiÚs
 
b–Úgšg
 
to
h
§me
 
´ovid”
 
wl
 
be
 
added
Øth§m
docum’t


137 
exi¡šg_´ovid”_docum’ts
 = {
	}
}

138 
subsütiÚ
 
š
 
£lf
.
	$g‘_subsütiÚs_´•¬ed_fÜ_blšg
(
cu¡om”
, 
blšg_d©e
,

139 
fÜû_g’”©e
):

140 
´ovid”
 = 
subsütiÚ
.
¶ª
.provider

142 
exi¡šg_docum’t
 = 
exi¡šg_´ovid”_docum’ts
.
	$g‘
(
´ovid”
)

144 
exi¡šg_´ovid”_docum’ts
[
´ovid”
] = 
£lf
.
	$_bl_subsütiÚ_što_docum’t
(

145 
subsütiÚ
, 
blšg_d©e
, 
docum’t
=
exi¡šg_docum’t


148 
´ovid”
, 
docum’t
 
š
 
exi¡šg_´ovid”_docum’ts
.
	$™ems
():

149 
´ovid”
.
deçuÉ_docum’t_¡©e
 =ğ
Provid”
.
DEFAULT_DOC_STATE
.
ISSUED
:

150 
docum’t
.
	$issue
()

152 
def
 
	$_g’”©e_fÜ_u£r_w™hout_cÚsŞid©ed_blšg
(
£lf
, 
cu¡om”
, 
blšg_d©e
,

153 
fÜû_g’”©e
):

155 
G’”©es
 
the
 
blšg
 
docum’ts
 
®l
h
subsütiÚs
 
of
 
a
 
cu¡om”


156 
who
 
dÛs
 
nÙ
 
u£
 
cÚsŞid©ed
 
blšg
.

159 #Th
u£r
 
dÛs
 
nÙ
 
u£
 
cÚsŞid©ed_blšg
 => 
add
 
—ch
 
subsütiÚ
 
to
 
a
 
£·¿‹
 
docum’t


160 
subsütiÚ
 
š
 
£lf
.
	$g‘_subsütiÚs_´•¬ed_fÜ_blšg
(
cu¡om”
, 
blšg_d©e
,

161 
fÜû_g’”©e
):

162 
´ovid”
 = 
subsütiÚ
.
¶ª
.provider

164 
docum’t
 = 
£lf
.
	$_bl_subsütiÚ_što_docum’t
(
subsütiÚ
, 
blšg_d©e
)

166 
´ovid”
.
deçuÉ_docum’t_¡©e
 =ğ
Provid”
.
DEFAULT_DOC_STATE
.
ISSUED
:

167 
docum’t
.
	$issue
()

169 
def
 
	$_g’”©e_fÜ_sšgË_subsütiÚ
(
£lf
, 
subsütiÚ
=
NÚe
, 
blšg_d©e
=None,

170 
fÜû_g’”©e
=
F®£
):

172 
G’”©es
 
the
 
blšg
 
docum’ts
 
cÜ»¥Údšg
 
to
 
a
 
sšgË
 
subsütiÚ
.

173 
Usu®ly
 
u£d
 
wh’
 
a
 
subsütiÚ
 
is
 
’ded
 
w™h
 `wh’`=`
now
`.

176 
blšg_d©e
 = blšg_d©
Ü
 
timezÚe
.
	`now
().
	$d©e
()

178 
´ovid”
 = 
subsütiÚ
.provider

180 
nÙ
 
subsütiÚ
.
	$should_be_bËd
(
blšg_d©e
è
Ü
 
fÜû_g’”©e
:

183 
docum’t
 = 
£lf
.
	$_bl_subsütiÚ_što_docum’t
(
subsütiÚ
, 
blšg_d©e
)

185 
´ovid”
.
deçuÉ_docum’t_¡©e
 =ğ
Provid”
.
DEFAULT_DOC_STATE
.
ISSUED
:

186 
docum’t
.
	$issue
()

188 
def
 
	$add_subsütiÚ_cyşes_to_docum’t
(
£lf
, 
blšg_d©e
, 
m‘”ed_ã©u»s_bËd_up_to
,

189 
¶ª_bËd_up_to
, 
subsütiÚ
,

190 
´ofÜma
=
NÚe
, 
švoiû
=None):

191 
»Ïtive_¡¬t_d©e
 = 
m‘”ed_ã©u»s_bËd_up_to
 + 
ONE_DAY


192 
¶ª_now_bËd_up_to
 = 
¶ª_bËd_up_to


193 
m‘”ed_ã©u»s_now_bËd_up_to
 = 
m‘”ed_ã©u»s_bËd_up_to


195 
´ebl_¶ª
 = 
subsütiÚ
.prebill_plan

197 
tÙ®
 = 
	`Decim®
("0.00")

199 
Ï¡_cyşe_’d_d©e
 = 
subsütiÚ
.
	$cyşe_’d_d©e
(
blšg_d©e
)

201 #W
™”©e
 
through
 
—ch
 
	`cyşe
 (
muÉË
 
buck‘
 
cyşes
 
ÿn
 
be
 
cÚšed
 
w™hš
 
a
 
blšg


202 #cyşeè
ªd
 
add
 
the
 
’Œ›s
 
to
h
docum’t


203 #»Ïtive_¡¬t_d©
ªd
 
»Ïtive_’d_d©e
 
defše
 
the
 
cyşe
 
th©
 
is
 
bËd
 
w™hš
he

205 
»Ïtive_¡¬t_d©e
 <ğ
Ï¡_cyşe_’d_d©e
:

206 
»Ïtive_’d_d©e
 = 
subsütiÚ
.
	$buck‘_’d_d©e
(

207 
»ã»nû_d©e
=
»Ïtive_¡¬t_d©e


210 
nÙ
 
»Ïtive_’d_d©e
:

211 #Th”
was
 
no
 
cyşe
 
the
 
giv’
 
blšg
 
d©e


214 #Thi 
is
 
h”e
 
š
 
Üd”
 
to
 
£·¿‹
 
the
 
ŒŸl
 
’Œ›s
 
äom
h
·id
 
Úes


215 ià(
subsütiÚ
.
ŒŸl_’d
 
ªd


216 
»Ïtive_¡¬t_d©e
 <ğ
subsütiÚ
.
ŒŸl_’d
 <ğ
»Ïtive_’d_d©e
):

217 
»Ïtive_’d_d©e
 = 
subsütiÚ
.
ŒŸl_’d


219 #Thi 
cyşe
 
decisiÚ
, 
ba£d
 
Ú
 
ÿnûl_d©e
, 
should
 
be
 
moved
 
što
 `
cyşe_¡¬t_d©e
` 
ªd


220 #`
cyşe_’d_d©e
`

221 
subsütiÚ
.
ÿnûl_d©e
:

222 
»Ïtive_’d_d©e
 = 
	$mš
(
subsütiÚ
.
ÿnûl_d©e
, 
»Ïtive_’d_d©e
)

224 #Ià
the
 
¶ª
 
is
 
´ebËd
 
we
 
ÿn
 
Úly
 
bl
 
™
 th
cyşe
 w
¬e
 
blšg
 
ha¢
't been

225 #bËd 
befÜe
;

226 #Ià
the
 
¶ª
 
is
 
nÙ
 
´ebËd
 
we
 
ÿn
 
Úly
 
bl
 
™
 th
cyşe
 w
¬e
 
blšg
 
has
 
’ded


227 #befÜ
the
 
blšg
 
d©e
.

228 
should_bl_¶ª
 = ((
´ebl_¶ª
 
ªd
 
¶ª_bËd_up_to
 < 
»Ïtive_¡¬t_d©e
è
Ü


229 (
nÙ
 
´ebl_¶ª
 
ªd
 
»Ïtive_’d_d©e
 < 
blšg_d©e
))

231 #BÈ
the
 
¶ª
 
amouÁ


232 
should_bl_¶ª
:

233 
subsütiÚ
.
	$Ú_ŒŸl
(
»Ïtive_¡¬t_d©e
):

234 
tÙ®
 +ğ
subsütiÚ
.
	$_add_¶ª_ŒŸl
(
¡¬t_d©e
=
»Ïtive_¡¬t_d©e
,

235 
’d_d©e
=
»Ïtive_’d_d©e
,

236 
švoiû
=švoiû, 
´ofÜma
=proforma)

238 
tÙ®
 +ğ
subsütiÚ
.
	$_add_¶ª_v®ue
(
»Ïtive_¡¬t_d©e
, 
»Ïtive_’d_d©e
,

239 
´ofÜma
õrofÜma, 
švoiû
=invoice)

240 
¶ª_now_bËd_up_to
 = 
»Ïtive_’d_d©e


242 #OÆy 
bl
 
m‘”ed
 
ã©u»s
 
the
 
cyşe
hm‘”ed f—tu» 
b–Úg
 
to
 
has
 
’ded


243 #befÜ
the
 
blšg
 
d©e
.

244 
should_bl_m‘”ed_ã©u»s
 = 
»Ïtive_’d_d©e
 < 
blšg_d©e


246 #BÈ
the
 
m‘”ed
 
ã©u»s


247 
should_bl_m‘”ed_ã©u»s
:

248 
subsütiÚ
.
	$Ú_ŒŸl
(
»Ïtive_¡¬t_d©e
):

249 
tÙ®
 +ğ
subsütiÚ
.
	$_add_mfs_fÜ_ŒŸl
(
¡¬t_d©e
=
»Ïtive_¡¬t_d©e
,

250 
’d_d©e
=
»Ïtive_’d_d©e
,

251 
švoiû
=švoiû, 
´ofÜma
=proforma)

253 
tÙ®
 +ğ
subsütiÚ
.
	$_add_mfs
(
»Ïtive_¡¬t_d©e
, 
»Ïtive_’d_d©e
,

254 
´ofÜma
õrofÜma, 
švoiû
=invoice)

256 
m‘”ed_ã©u»s_now_bËd_up_to
 = 
»Ïtive_’d_d©e


258 #Obš 
a
 
¡¬t
 
d©e
 
the
 
Ãxt
 
	`™”©iÚ
 (
cyşe
)

259 
»Ïtive_¡¬t_d©e
 = 
»Ïtive_’d_d©e
 + 
ONE_DAY


261 
»Ïtive_’d_d©e
 =ğ
subsütiÚ
.
ÿnûl_d©e
:

264 
BlšgLog
.
objeùs
.
	$ü—‹
(
subsütiÚ
=subscription,

265 
švoiû
=švoiû, 
´ofÜma
=proforma,

266 
tÙ®
=total,

267 
blšg_d©e
=billing_date,

268 
m‘”ed_ã©u»s_bËd_up_to
=
m‘”ed_ã©u»s_now_bËd_up_to
,

269 
¶ª_bËd_up_to
=
¶ª_now_bËd_up_to
)

271 
def
 
	$_ü—‹_docum’t
(
£lf
, 
subsütiÚ
, 
blšg_d©e
):

272 
´ovid”
 = 
subsütiÚ
.provider

273 
cu¡om”
 = 
subsütiÚ
.customer

275 
Docum’tMod–
 = (
ProfÜma
 
´ovid”
.
æow
 =ğ´ovid”.
FLOWS
.
PROFORMA


276 
Invoiû
)

278 
·ym’t_due_days
 = 
dt
.
	$timed–
(
days
=
cu¡om”
.
·ym’t_due_days
)

279 
due_d©e
 = 
blšg_d©e
 + 
·ym’t_due_days


280 
docum’t
 = 
Docum’tMod–
.
objeùs
.
	$ü—‹
(
´ovid”
=provider,

281 
cu¡om”
=customer,

282 
due_d©e
=due_date)

284  
docum’t


	@silver/management/__init__.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

	@silver/management/commands/__init__.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

	@silver/management/commands/execute_transactions.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
loggšg


18 
äom
 
	gdjªgo
.
	gcÜe
.
	gmªagem’t
.
ba£
 
impÜt
 
Ba£Commªd


20 
äom
 
sv”
 
impÜt
 
·ym’t_´oûssÜs


21 
äom
 
	gsv”
.
mod–s
 
impÜt
 
T¿n§ùiÚ


22 
äom
 
	gsv”
.
	g·ym’t_´oûssÜs
.
mixšs
 
impÜt
 
Paym’tProûssÜTy³s


24 
	glogg”
 = 
loggšg
.
	$g‘Logg”
(
__Çme__
)

27 
def
 
	$¡ršg_to_li¡
(
li¡_as_¡ršg
):

28  
	`li¡
(
	`m­
(, 
li¡_as_¡ršg
.
	`¡r
('[] ').
	`¥l™
(',')))

31 
şass
 
	$Commªd
(
Ba£Commªd
):

32 
h–p
 = 'Runsƒxecute_transaction onƒligibleransactions.'

34 
def
 
	$add_¬gum’ts
(
£lf
, 
·r£r
):

35 
·r£r
.
	`add_¬gum’t
(

37 
h–p
='A†ist ofransaction…kso beƒxecuted.',

38 
aùiÚ
='¡Üe', 
de¡
='Œª§ùiÚs', 
ty³
=
¡ršg_to_li¡


41 
def
 
	$hªdË
(
£lf
, *
¬gs
, **
İtiÚs
):

42 
execubË_Œª§ùiÚs
 = 
T¿n§ùiÚ
.
objeùs
.
	$f‹r
(

43 
¡©e
=
T¿n§ùiÚ
.
S‹s
.
In™Ÿl
,

46 
İtiÚs
['transactions']:

47 
execubË_Œª§ùiÚs
 =ƒxecubË_Œª§ùiÚs.
	`f‹r
(

48 
pk__š
=
İtiÚs
['transactions']

51 
Œª§ùiÚ
 
š
 
execubË_Œª§ùiÚs
:

52 
Œy
:

53 
nÙ
 
Œª§ùiÚ
.
·ym’t_m‘hod
.
v”if›d
 
Ü
¿n§ùiÚ.·ym’t_m‘hod.
ÿnûËd
:

55 
·ym’t_´oûssÜ
 = 
Œª§ùiÚ
.
·ym’t_m‘hod
.
	$g‘_·ym’t_´oûssÜ
()

56 
·ym’t_´oûssÜ
.
ty³
 !ğ
Paym’tProûssÜTy³s
.
Trigg”ed
:

58 
·ym’t_´oûssÜ
.
	$execu‹_Œª§ùiÚ
(
Œª§ùiÚ
)

59 
exû±
 
Exû±iÚ
:

60 
logg”
.
	`”rÜ
('Encounteredƒxception whileƒxecutingransaction '

61 'w™h id=%s.', 
Œª§ùiÚ
.
id
, 
exc_šfo
=
True
)

	@silver/management/commands/fetch_transactions_status.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
loggšg


18 
äom
 
	gdjªgo
.
	gcÜe
.
	gmªagem’t
.
ba£
 
impÜt
 
Ba£Commªd


20 
äom
 
sv”
 
impÜt
 
·ym’t_´oûssÜs


21 
äom
 
	gsv”
.
mod–s
 
impÜt
 
T¿n§ùiÚ


22 
äom
 
	gsv”
.
	g·ym’t_´oûssÜs
.
mixšs
 
impÜt
 
Paym’tProûssÜTy³s


24 
	glogg”
 = 
loggšg
.
	$g‘Logg”
(
__Çme__
)

27 
def
 
	$¡ršg_to_li¡
(
li¡_as_¡ršg
):

28  
	`li¡
(
	`m­
(, 
li¡_as_¡ršg
.
	`¡r
('[] ').
	`¥l™
(',')))

31 
şass
 
	$Commªd
(
Ba£Commªd
):

32 
h–p
 = 'Runs update_status onƒligibleransactions.'

34 
def
 
	$add_¬gum’ts
(
£lf
, 
·r£r
):

35 
·r£r
.
	`add_¬gum’t
(

37 
h–p
='A†ist ofransaction…kso be updated.',

38 
aùiÚ
='¡Üe', 
de¡
='Œª§ùiÚs', 
ty³
=
¡ršg_to_li¡


41 
def
 
	$hªdË
(
£lf
, *
¬gs
, **
İtiÚs
):

42 
–igibË_Œª§ùiÚs
 = 
T¿n§ùiÚ
.
objeùs
.
	$f‹r
(

43 
¡©e
=
T¿n§ùiÚ
.
S‹s
.
P’dšg
,

46 
İtiÚs
['transactions']:

47 
–igibË_Œª§ùiÚs
 =ƒligibË_Œª§ùiÚs.
	`f‹r
(

48 
pk__š
=
İtiÚs
['transactions']

51 
Œª§ùiÚ
 
š
 
–igibË_Œª§ùiÚs
:

52 
Œy
:

53 
·ym’t_´oûssÜ
 = 
Œª§ùiÚ
.
·ym’t_m‘hod
.
	$g‘_·ym’t_´oûssÜ
()

54 
·ym’t_´oûssÜ
.
ty³
 !ğ
Paym’tProûssÜTy³s
.
Trigg”ed
:

56 
·ym’t_´oûssÜ
.
	$ãtch_Œª§ùiÚ_¡©us
(
Œª§ùiÚ
)

57 
exû±
 
Exû±iÚ
:

58 
logg”
.
	`”rÜ
('Encounteredƒxception while updatingransaction '

59 'w™h id=%s.', 
Œª§ùiÚ
.
id
, 
exc_šfo
=
True
)

	@silver/management/commands/generate_docs.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
loggšg


17 
impÜt
 
¬g·r£


18 
äom
 
d©‘ime
 
impÜt
 d©‘im
as
 
dt


19 
äom
 
ty³s
 
impÜt
 
SŒšgTy³


21 
äom
 
	gdjªgo
.
	gcÜe
.
	gmªagem’t
.
ba£
 
impÜt
 
Ba£Commªd


22 
äom
 
	gdjªgo
.
uts
 
impÜt
 
Œª¦©iÚ


24 
äom
 
	gsv”
.
docum’ts_g’”©Ü
 
impÜt
 
Docum’tsG’”©Ü


25 
äom
 
	gsv”
.
mod–s
 
impÜt
 
SubsütiÚ


27 
	glogg”
 = 
loggšg
.
	$g‘Logg”
(
__Çme__
)

30 
def
 
	$d©e
(
d©e_¡r
):

31 
Œy
:

32  
dt
.
	`¡½time
(
d©e_¡r
, "%Y-%m-%d").
	$d©e
()

33 
exû±
 
V®ueE¼Ü
:

34 
msg
 = "Not‡ valid date: '{date_str}'. "\

35 "Ex³ùed fÜm©: YYYY-MM-DD.".
	$fÜm©
(
d©e_¡r
=date_str)

36 
¿i£
 
¬g·r£
.
	$Argum’tTy³E¼Ü
(
msg
)

39 
şass
 
	$Commªd
(
Ba£Commªd
):

40 
h–p
 = 'Generateshe billing documents (Invoices, Proformas).'

42 
def
 
	$add_¬gum’ts
(
£lf
, 
·r£r
):

43 
·r£r
.
	`add_¬gum’t
('--subscription',

44 
aùiÚ
='¡Üe', 
de¡
='subsütiÚ_id', 
ty³
=,

45 
h–p
='The id ofhs subscriptiono be billed.')

46 
·r£r
.
	`add_¬gum’t
('--date',

47 
aùiÚ
='¡Üe', 
de¡
='blšg_d©e', 
ty³
=
d©e
,

48 
h–p
='The billing date (format YYYY-MM-DD).')

50 
def
 
	$hªdË
(
£lf
, *
¬gs
, **
İtiÚs
):

51 
Œª¦©iÚ
.
	`aùiv©e
('en-us')

53 
blšg_d©e
 = 
İtiÚs
['billing_date']

55 
docs_g’”©Ü
 = 
	$Docum’tsG’”©Ü
()

56 
İtiÚs
['subscription_id']:

57 
Œy
:

58 
subsütiÚ_id
 = 
İtiÚs
['subscription_id']

59 
logg”
.
	`šfo
('Generating for subscription with id=%s; '

60 'blšg_d©e=%s.', 
subsütiÚ_id
,

61 
blšg_d©e
)

63 
subsütiÚ
 = 
SubsütiÚ
.
objeùs
.
	$g‘
(
id
=
subsütiÚ_id
)

64 
docs_g’”©Ü
.
	$g’”©e
(
subsütiÚ
=subscription,

65 
blšg_d©e
=billing_date)

66 
£lf
.
¡dout
.
	`wr™e
('Done. You can have‡ Club-Mate‚ow. :)')

67 
exû±
 
SubsütiÚ
.
DÛsNÙExi¡
:

68 
msg
 = 'The subscription withhe…rovided id does‚otƒxist.'

69 
£lf
.
¡dout
.
	$wr™e
(
msg
)

71 
logg”
.
	`šfo
('Generating for‡llhe‡vailable subscriptions; '

72 'blšg_d©e=%s.', 
blšg_d©e
)

74 
docs_g’”©Ü
.
	$g’”©e
(
blšg_d©e
=billing_date)

75 
£lf
.
¡dout
.
	`wr™e
('Done. You can have‡ Club-Mate‚ow. :)')

	@silver/management/commands/generate_pdfs.py

1 #Cİyrighˆ(
c
è2017 
P»ssšäa
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
loggšg


17 
äom
 
™”toŞs
 
impÜt
 
chaš


19 
äom
 
	gdjªgo
.
	gcÜe
.
	gmªagem’t
.
ba£
 
impÜt
 
Ba£Commªd


21 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gInvoiû
, 
ProfÜma


23 
	glogg”
 = 
loggšg
.
	$g‘Logg”
(
__Çme__
)

26 
şass
 
	$Commªd
(
Ba£Commªd
):

27 
h–p
 = 'Generateshe billing documents (Invoices, Proformas).'

29 
def
 
	$hªdË
(
£lf
, *
¬gs
, **
İtiÚs
):

30 
docum’t
 
š
 
	`chaš
(
Invoiû
.
objeùs
.
	`f‹r
(
pdf__dœty__gt
=0),

31 
ProfÜma
.
objeùs
.
	$f‹r
(
pdf__dœty__gt
=0)):

32 
Œy
:

33 
docum’t
.
	$g’”©e_pdf
()

34 
exû±
:

35 
logg”
.
	`exû±iÚ
('Encounteredƒxception while generating PDF for document '

36 'w™h id=%s.', 
docum’t
.
id
)

	@silver/management/commands/seed.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
loggšg


18 
äom
 
	gdjªgo
.
	gcÜe
.
	gmªagem’t
.
ba£
 
impÜt
 
Ba£Commªd


20 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gT¿n§ùiÚ
, 
	gInvoiû
, 
ProfÜma


21 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
T¿n§ùiÚFaùÜy
, 
InvoiûFaùÜy
, 
Docum’tEÁryFaùÜy
,

22 
ProfÜmaFaùÜy
)

24 
logg”
 = 
loggšg
.
	$g‘Logg”
(
__Çme__
)

27 
şass
 
	$Commªd
(
Ba£Commªd
):

28 
h–p
 = 'Creatingƒntities foresting…urposes'

30 
def
 
	$hªdË
(
£lf
, *
¬gs
, **
İtiÚs
):

31 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	`ü—‹
(
´ofÜma_’Œ›s
=[
Docum’tEÁryFaùÜy
.create()],

32 
¡©e
=
ProfÜma
.
STATES
.
ISSUED
)

33 
´ofÜma
.
	$ü—‹_švoiû
()

35 
švoiû
 = 
InvoiûFaùÜy
.
	`ü—‹
(
švoiû_’Œ›s
=[
Docum’tEÁryFaùÜy
.create()],

36 
¡©e
=
Invoiû
.
STATES
.
ISSUED
,

37 
»Ï‹d_docum’t
=
NÚe
)

38 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
¡©e
=
T¿n§ùiÚ
.
S‹s
.
S‘ed
,

39 
švoiû
=invoice,

40 
·ym’t_m‘hod__cu¡om”
=
švoiû
.
cu¡om”
,

41 
´ofÜma
=
NÚe
)

42 
InvoiûFaùÜy
.
	`ü—‹_b©ch
(
size
=3,

43 
švoiû_’Œ›s
=[
Docum’tEÁryFaùÜy
.
	`ü—‹
()],

44 
¡©e
=
Invoiû
.
STATES
.
PAID
,

45 
»Ï‹d_docum’t
=
NÚe
)

46 
InvoiûFaùÜy
.
	`ü—‹_b©ch
(
size
=3,

47 
švoiû_’Œ›s
=[
Docum’tEÁryFaùÜy
.
	`ü—‹
()],

48 
¡©e
=
Invoiû
.
STATES
.
DRAFT
,

49 
»Ï‹d_docum’t
=
NÚe
)

51 
InvoiûFaùÜy
.
	`ü—‹_b©ch
(
size
=3,

52 
švoiû_’Œ›s
=[
Docum’tEÁryFaùÜy
.
	`ü—‹
()],

53 
¡©e
=
Invoiû
.
STATES
.
CANCELED
,

54 
»Ï‹d_docum’t
=
NÚe
)

	@silver/management/commands/tweak_billing_log.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
d©‘ime
 
as
 
dt


17 
äom
 
d©‘ime
 
impÜt
 datetime

18 
äom
 
İ¬£
 
impÜt
 
make_İtiÚ


20 
äom
 
	gdjªgo
.
	gcÜe
.
	gmªagem’t
.
ba£
 
impÜt
 
Ba£Commªd


21 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


23 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gSubsütiÚ
, 
BlšgLog


26 
şass
 
	$Commªd
(
Ba£Commªd
):

27 
İtiÚ_li¡
 = 
Ba£Commªd
.option_list + (

28 
	`make_İtiÚ
('--date',

29 
aùiÚ
='store',

30 
de¡
='date'),

33 
def
 
	$hªdË
(
£lf
, *
¬gs
, **
İtiÚs
):

34 
İtiÚs
['date']:

35 
d©e
 = 
d©‘ime
.
	`¡½time
(
İtiÚs
['date'], '%Y-%m-%d')

37 
now
 = 
timezÚe
.
	`now
().
	$d©e
()

38 
d©e
 = 
dt
.
	`d©e
(
now
.
y—r
,‚ow.
mÚth
 - 1, 1)

40 
subsütiÚ
 
š
 
SubsütiÚ
.
objeùs
.
	$®l
():

41 
£lf
.
¡dout
.
	`wr™e
('Tw—kšg fÜ subsütiÚ %d' % 
subsütiÚ
.
id
)

42 
BlšgLog
.
objeùs
.
	`ü—‹
(
subsütiÚ
=subscription,

43 
blšg_d©e
=
d©e
)

	@silver/migrations/0001_initial.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 #-*- 
codšg
: 
utf
-8 -*-

17 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


19 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmod–s
, 
mig¿tiÚs


20 
impÜt
 
djªgo_fsm


21 
impÜt
 
	gjsÚf›ld
.
f›lds


22 
impÜt
 
	glivef›ld
.
f›lds


23 
impÜt
 
	gsv”
.
mod–s


24 
impÜt
 
	gdjªgo
.
	gcÜe
.
v®id©Üs


27 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

29 
d•’d’c›s
 = [

32 
İ”©iÚs
 = [

33 
mig¿tiÚs
.
	`C»©eMod–
(

34 
Çme
='BillingLog',

35 
f›lds
=[

36 ('id', 
mod–s
.
	`AutoF›ld
(
v”bo£_Çme
='ID',

37 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

38 ('blšg_d©e', 
mod–s
.
	`D©eF›ld
(

39 
h–p_‹xt
=
b
'The date whenhe invoice/proforma was issued.')),

41 
İtiÚs
={

43 
	}
},

45 
	gmig¿tiÚs
.
C»©eMod–
(

46 
Çme
='Customer',

47 
f›lds
=[

48 ('id', 
mod–s
.
AutoF›ld
(
v”bo£_Çme
='ID',

49 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

50 ('live', 
livef›ld
.
f›lds
.
LiveF›ld
(=
True
)),

51 ('Çme', 
mod–s
.
Ch¬F›ld
(

52 
h–p_‹xt
=
b
'ThÇmtØbu£d fÜ blšg…u½o£s.', 
max_Ëngth
=128)),

53 ('com·ny', 
mod–s
.
Ch¬F›ld
(

54 
max_Ëngth
=128, 
nuÎ
=
True
, 
bÏnk
=True)),

55 ('ema', 
mod–s
.
EmaF›ld
(

56 
max_Ëngth
=254, 
nuÎ
=
True
, 
bÏnk
=True)),

57 ('add»ss_1', 
mod–s
.
Ch¬F›ld
(
max_Ëngth
=128)),

58 ('add»ss_2', 
mod–s
.
Ch¬F›ld
(

59 
max_Ëngth
=128, 
nuÎ
=
True
, 
bÏnk
=True)),

60 ('couÁry', 
mod–s
.
Ch¬F›ld
(
max_Ëngth
=3, 
choiûs
=[('AF', 'Afghanistan'), ('AL', 'Albania'), ('AQ', 'Antarctica'), ('DZ', 'Algeria'), ('AS', 'American Samoa'), ('AD', 'Andorra'), ('AO', 'Angola'), ('AG', 'Antigua‡nd Barbuda'), ('AZ', 'Azerbaijan'), ('AR', 'Argentina'), ('AU', 'Australia'), ('AT', 'Austria'), ('BS', 'Bahamas'), ('BH', 'Bahrain'), ('BD', 'Bangladesh'), ('AM', 'Armenia'), ('BB', 'Barbados'), ('BE', 'Belgium'), ('BM', 'Bermuda'), ('BT', 'Bhutan'), ('BO', 'Bolivia'), ('BA', 'Bosnia‡nd Herzegovina'), ('BW', 'Botswana'), ('BV', 'Bouvet Island'), ('BR', 'Brazil'), ('BZ', 'Belize'), ('IO', 'British Indian Ocean Territory'), ('SB', 'Solomon Islands'), ('VG', 'British Virgin Islands'), ('BN', 'Brunei Darussalam'), ('BG', 'Bulgaria'), ('MM', 'Myanmar'), ('BI', 'Burundi'), ('BY', 'Belarus'), ('KH', 'Cambodia'), ('CM', 'Cameroon'), ('CA', 'Canada'), ('CV', 'Cape Verde'), ('KY', 'Cayman Islands'), ('CF', 'Central African Republic'), ('LK', 'Sri Lanka'), ('TD', 'Chad'), ('CL', 'Chile'), ('CN', 'China'), ('TW', 'Taiwan'), ('CX', 'Christmas Island'), ('CC', 'Cocos'), ('CO', 'Colombia'), ('KM', 'Comoros'), ('YT', 'Mayotte'), ('CG', 'Congo'), ('CD', 'Congo'), ('CK', 'Cook Islands'), ('CR', 'Costa Rica'), ('HR', 'Croatia'), ('CU', 'Cuba'), ('CY', 'Cyprus'), ('CZ', 'Czech Republic'), ('BJ', 'Benin'), ('DK', 'Denmark'), ('DM', 'Dominica'), ('DO', 'Dominican Republic'), ('EC', 'Ecuador'), ('SV', 'El Salvador'), ('GQ', 'Equatorial Guinea'), ('ET', 'Ethiopia'), ('ER', 'Eritrea'), ('EE', 'Estonia'), ('FO', 'Faroe Islands'), ('FK', 'Falkland Islands'), ('GS', 'South Georgia‡ndhe South Sandwich Islands'), ('FJ', 'Fiji'), ('FI', 'Finland'), ('AX', '\xc5land Islands'), ('FR', 'France'), ('GF', 'French Guiana'), ('PF', 'French Polynesia'), ('TF', 'French Southern Territories'), ('DJ', 'Djibouti'), ('GA', 'Gabon'), ('GE', 'Georgia'), ('GM', 'Gambia'), ('PS', 'Palestinian Territory'), ('DE', 'Germany'), ('GH', 'Ghana'), ('GI', 'Gibraltar'), ('KI', 'Kiribati'), ('GR', 'Greece'), ('GL', 'Greenland'), ('GD', 'Grenada'), ('GP', 'Guadeloupe'), ('GU', 'Guam'), ('GT', 'Guatemala'), ('GN', 'Guinea'), ('GY', 'Guyana'), ('HT', 'Haiti'), ('HM', 'Heard Island‡nd McDonald Islands'), ('VA', 'Holy See'), ('HN', 'Honduras'), ('HK', 'Hong Kong'), ('HU', 'Hungary'), ('IS', 'Iceland'), ('IN', 'India'), ('ID', 'Indonesia'), ('IR', 'Iran'), ('IQ', 'Iraq'), ('IE', 'Ireland'), ('IL', 'Israel'), ('IT', 'Italy'), ('CI', "Cote d'Ivoire"), ('JM', 'Jamaica'), ('JP', 'Japan'), ('KZ', 'Kazakhstan'), ('JO', 'Jordan'), ('KE', 'Kenya'), ('KP', 'Korea'), ('KR', 'Korea'), ('KW', 'Kuwait'), ('KG', 'Kyrgyz Republic'), ('LA', "Lao People's Democratic Republic"), ('LB', 'Lebanon'), ('LS', 'Lesotho'), ('LV', 'Latvia'), ('LR', 'Liberia'), ('LY', 'Libyan Arab Jamahiriya'), ('LI', 'Liechtenstein'), ('LT', 'Lithuania'), ('LU', 'Luxembourg'), ('MO', 'Macao'), (

62 ('c™y', 
mod–s
.
Ch¬F›ld
(
max_Ëngth
=128)),

63 ('¡©e', 
mod–s
.
Ch¬F›ld
(

64 
max_Ëngth
=128, 
nuÎ
=
True
, 
bÏnk
=True)),

65 ('z_code', 
mod–s
.
Ch¬F›ld
(

66 
max_Ëngth
=32, 
nuÎ
=
True
, 
bÏnk
=True)),

67 ('exŒa', 
mod–s
.
TextF›ld
(

68 
h–p_‹xt
=
b
'ExŒ¨šfÜm©iÚØdi¥Ïy oÀthšvoiû (m¬kdowÀfÜm©‹d).', 
nuÎ
=
True
, 
bÏnk
=True)),

69 ('·ym’t_due_days', 
mod–s
.
Pos™iveIÁeg”F›ld
(

70 =5, 
h–p_‹xt
=
b
'Due days for generated…roforma/invoice.')),

71 ('cÚsŞid©ed_blšg', 
mod–s
.
BoŞ—nF›ld
(

72 =
F®£
, 
h–p_‹xt
=
b
'A flag indicating consolidated billing.')),

73 ('cu¡om”_»ã»nû', 
mod–s
.
Ch¬F›ld
(

74 
h–p_‹xt
=
b
"It' ¨»ã»nûØb·s£d b‘w“Àsv”‡nd cl›Ás. Iˆusu®ly…ošt tØª‡ccouÁ ID.", 
max_Ëngth
=256, 
nuÎ
=
True
, 
bÏnk
=True)),

75 ('§Ës_x_numb”', 
mod–s
.
Ch¬F›ld
(

76 
max_Ëngth
=64, 
nuÎ
=
True
, 
bÏnk
=True)),

77 ('§Ës_x_³rûÁ', 
mod–s
.
Decim®F›ld
(
decim®_¶aûs
=2, 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
MšV®ueV®id©Ü
(

78 0.0)], 
max_dig™s
=4, 
bÏnk
=
True
, 
h–p_‹xt
=
b
"Wh’ev”Øadd s®e x. IànuÎ, iˆwÚ'ˆshow u°Úhšvoiû.", 
nuÎ
=True)),

79 ('§Ës_x_Çme', 
mod–s
.
Ch¬F›ld
(

80 
h–p_‹xt
=
b
"S®e x‚amÓg. '§Ë x' o¸'VAT').", 
max_Ëngth
=64, 
nuÎ
=
True
, 
bÏnk
=True)),

82 
İtiÚs
={

83 'ab¡¿ù': 
F®£
,

86 
	gmig¿tiÚs
.
C»©eMod–
(

87 
Çme
='DocumentEntry',

88 
f›lds
=[

89 ('id', 
mod–s
.
AutoF›ld
(
v”bo£_Çme
='ID',

90 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

91 ('desütiÚ', 
mod–s
.
Ch¬F›ld
(
max_Ëngth
=255)),

92 ('un™', 
mod–s
.
Ch¬F›ld
(

93 
max_Ëngth
=20, 
nuÎ
=
True
, 
bÏnk
=True)),

94 ('quªt™y', 
mod–s
.
Decim®F›ld
(
max_dig™s
=19, 
decim®_¶aûs
=2,

95 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
MšV®ueV®id©Ü
(0.0)])),

96 ('un™_´iû', 
mod–s
.
Decim®F›ld
(

97 
max_dig™s
=8, 
decim®_¶aûs
=2)),

98 ('¡¬t_d©e', 
mod–s
.
D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

99 ('’d_d©e', 
mod–s
.
D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

100 ('´Ü©ed', 
mod–s
.
BoŞ—nF›ld
(=
F®£
)),

102 
İtiÚs
={

107 
	gmig¿tiÚs
.
C»©eMod–
(

108 
Çme
='Invoice',

109 
f›lds
=[

110 ('id', 
mod–s
.
AutoF›ld
(
v”bo£_Çme
='ID',

111 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

112 ('numb”', 
mod–s
.
IÁeg”F›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

114 
jsÚf›ld
.
f›lds
.
JSONF›ld
(=
diù
)),

116 
jsÚf›ld
.
f›lds
.
JSONF›ld
(=
diù
)),

117 ('due_d©e', 
mod–s
.
D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

118 ('issue_d©e', 
mod–s
.
D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

119 ('·id_d©e', 
mod–s
.
D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

120 ('ÿnûl_d©e', 
mod–s
.
D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

121 ('§Ës_x_³rûÁ', 
mod–s
.
Decim®F›ld
(
bÏnk
=
True
, 
nuÎ
=True, 
max_dig™s
=4,

122 
decim®_¶aûs
=2, 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
MšV®ueV®id©Ü
(

124 ('§Ës_x_Çme', 
mod–s
.
Ch¬F›ld
(

125 
max_Ëngth
=64, 
nuÎ
=
True
, 
bÏnk
=True)),

126 ('cu¼’cy', 
mod–s
.
Ch¬F›ld
(=
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy u£d fÜ blšg.', 
max_Ëngth
=4, 
choiûs
=[('USD', 'USD - United States Dollar'), ('EUR', 'EUR - Euro Members'), ('JPY', 'JPY - Japan Yen'), ('GBP', 'GBP - United Kingdom Pound'), ('CHF', 'CHF - Switzerland Franc'), ('AED', 'AED - United Arab Emirates Dirham'), ('AFN', 'AFN - Afghanistan Afghani'), ('ALL', 'ALL - Albania Lek'), ('AMD', 'AMD - Armenia Dram'), ('ANG', 'ANG - Netherlands Antilles Guilder'), ('AOA', 'AOA - Angola Kwanza'), ('ARS', 'ARS - Argentina Peso'), ('AUD', 'AUD - Australia Dollar'), ('AWG', 'AWG - Aruba Guilder'), ('AZN', 'AZN - Azerbaijan New Manat'), ('BAM', 'BAM - Bosnia‡nd Herzegovina Convertible Marka'), ('BBD', 'BBD - Barbados Dollar'), ('BDT', 'BDT - Bangladesh Taka'), ('BGN', 'BGN - Bulgaria Lev'), ('BHD', 'BHD - Bahrain Dinar'), ('BIF', 'BIF - Burundi Franc'), ('BMD', 'BMD - Bermuda Dollar'), ('BND', 'BND - Brunei Darussalam Dollar'), ('BOB', 'BOB - Bolivia Boliviano'), ('BRL', 'BRL - Brazil Real'), ('BSD', 'BSD - Bahamas Dollar'), ('BTN', 'BTN - Bhutan Ngultrum'), ('BWP', 'BWP - Botswana Pula'), ('BYR', 'BYR - Belarus Ruble'), ('BZD', 'BZD - Belize Dollar'), ('CAD', 'CAD - Canada Dollar'), ('CDF', 'CDF - Congo/Kinshasa Franc'), ('CLP', 'CLP - Chile Peso'), ('CNY', 'CNY - China Yuan Renminbi'), ('COP', 'COP - Colombia Peso'), ('CRC', 'CRC - Costa Rica Colon'), ('CUC', 'CUC - Cuba Convertible Peso'), ('CUP', 'CUP - Cuba Peso'), ('CVE', 'CVE - Cape Verde Escudo'), ('CZK', 'CZK - Czech Republic Koruna'), ('DJF', 'DJF - Djibouti Franc'), ('DKK', 'DKK - Denmark Krone'), ('DOP', 'DOP - Dominican Republic Peso'), ('DZD', 'DZD - Algeria Dinar'), ('EGP', 'EGP - Egypt Pound'), ('ERN', 'ERN - Eritrea Nakfa'), ('ETB', 'ETB - Ethiopia Birr'), ('FJD', 'FJD - Fiji Dollar'), ('FKP', 'FKP - Falkland Islands (Malvinas) Pound'), ('GEL', 'GEL - Georgia Lari'), ('GGP', 'GGP - Guernsey Pound'), ('GHS', 'GHS - Ghana Cedi'), ('GIP', 'GIP - Gibraltar Pound'), ('GMD', 'GMD - Gambia Dalasi'), ('GNF', 'GNF - Guinea Franc'), ('GTQ', 'GTQ - Guatemala Quetzal'), ('GYD', 'GYD - Guyana Dollar'), ('HKD', 'HKD - Hong Kong Dollar'), ('HNL', 'HNL - Honduras Lempira'), ('HRK', 'HRK - Croatia Kuna'), ('HTG', 'HTG - Haiti Gourde'), ('HUF', 'HUF - Hungary Forint'), ('IDR', 'IDR - Indonesia Rupiah'), ('ILS', 'ILS - Israel Shekel'), ('IMP', 'IMP - Isle of Man Pound'), ('INR', 'INR - India Rupee'), ('IQD', 'IQD - Iraq Dinar'), ('IRR', 'IRR - Iran Rial'), ('ISK', 'ISK - Iceland Krona'), ('JEP', 'JEP - Jersey Pound'), ('JMD', 'JMD - Jamaica Dollar'), ('JOD', 'JOD - Jordan Dinar'), ('KES', 'KES - Kenya Shilling'), ('KGS', 'KGS - Kyrgyzstan Som'), ('KHR', 'KHR - Cambodia Riel'), ('KMF', 'KMF - Comoros Franc'), ('KPW', 'KPW - Korea (North) Won'), ('KRW', 'KRW - Korea (South) Won'), ('KWD', 'KWD - Kuwait Dinar'), ('KYD', 'KYD - Cayman Islands Dollar'), ('KZT', 'KZT - Kazakhstan Tenge'), ('LAK', 'LAK - Laos Kip'), ('LBP', 'LBP - Lebanon Pound'), (

128 ('pdf', 
mod–s
.
FeF›ld
(

129 
u¶ßd_to
=
sv”
.
mod–s
.
docum’ts
.
ba£
.
docum’ts_pdf_·th
, 
nuÎ
=
True
, 
ed™abË
=
F®£
, 
bÏnk
=True)),

130 ('¡©e', 
djªgo_fsm
.
FSMF›ld
(=
b
'd¿á', 
h–p_‹xt
=b'Th¡©thšvoiû i š.', 
max_Ëngth
=10,

131 
v”bo£_Çme
=
b
'S‹', 
choiûs
=[(b'draft', b'Draft'), (b'issued', b'Issued'), (b'paid', b'Paid'), (b'canceled', b'Canceled')])),

132 ('cu¡om”', 
mod–s
.
FÜeignKey
(
to
='silver.Customer')),

134 
İtiÚs
={

136 'ab¡¿ù': 
F®£
,

139 
	gmig¿tiÚs
.
C»©eMod–
(

140 
Çme
='MeteredFeature',

141 
f›lds
=[

142 ('id', 
mod–s
.
AutoF›ld
(
v”bo£_Çme
='ID',

143 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

144 ('Çme', 
mod–s
.
Ch¬F›ld
(

145 
h–p_‹xt
=
b
'Thã©u» di¥Ïy‚ame.', 
max_Ëngth
=200)),

146 ('un™', 
mod–s
.
Ch¬F›ld
(
max_Ëngth
=20)),

147 ('´iû_³r_un™', 
mod–s
.
Decim®F›ld
(
h–p_‹xt
=
b
'Th´iû…” un™.', 
max_dig™s
=8,

148 
decim®_¶aûs
=2, 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
MšV®ueV®id©Ü
(

150 ('šşuded_un™s', 
mod–s
.
Decim®F›ld
(
h–p_‹xt
=
b
'The‚umber of included units…er…lan interval.',

151 
max_dig™s
=19, 
decim®_¶aûs
=2, 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
MšV®ueV®id©Ü
(

153 ('šşuded_un™s_duršg_ŒŸl', 
mod–s
.
Decim®F›ld
(
decim®_¶aûs
=2, 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
MšV®ueV®id©Ü
(

154 0.0)], 
max_dig™s
=19, 
bÏnk
=
True
, 
h–p_‹xt
=
b
'Thnumb” oàšşuded un™ duršghŒŸÈ³riod.', 
nuÎ
=True)),

157 
	gmig¿tiÚs
.
C»©eMod–
(

158 
Çme
='MeteredFeatureUnitsLog',

159 
f›lds
=[

160 ('id', 
mod–s
.
AutoF›ld
(
v”bo£_Çme
='ID',

161 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

162 ('cÚsumed_un™s', 
mod–s
.
Decim®F›ld
(
max_dig™s
=19, 
decim®_¶aûs
=2,

163 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
MšV®ueV®id©Ü
(0.0)])),

164 ('¡¬t_d©e', 
mod–s
.
D©eF›ld
(
ed™abË
=
F®£
)),

165 ('’d_d©e', 
mod–s
.
D©eF›ld
(
ed™abË
=
F®£
)),

166 ('m‘”ed_ã©u»', 
mod–s
.
FÜeignKey
(

167 
»Ï‹d_Çme
='cÚsumed', 
to
='silver.MeteredFeature')),

170 
	gmig¿tiÚs
.
C»©eMod–
(

171 
Çme
='Plan',

172 
f›lds
=[

173 ('id', 
mod–s
.
AutoF›ld
(
v”bo£_Çme
='ID',

174 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

175 ('Çme', 
mod–s
.
Ch¬F›ld
(

176 
h–p_‹xt
=
b
'Di¥Ïy‚amoàth¶ª.', 
max_Ëngth
=200)),

177 ('š‹rv®', 
mod–s
.
Ch¬F›ld
(=
b
'mÚth', 
h–p_‹xt
=b'The frequency with which‡ subscription should be billed.',

178 
max_Ëngth
=12, 
choiûs
=[(

179 
b
'day', b'Day'), (b'week', b'Week'), (b'month', b'Month'), (b'year', b'Year')])),

180 ('š‹rv®_couÁ', 
mod–s
.
Pos™iveIÁeg”F›ld
(

181 
h–p_‹xt
=
b
'The‚umber of intervals betweenƒach subscription billing')),

182 ('amouÁ', 
mod–s
.
Decim®F›ld
(
h–p_‹xt
=
b
'The‡mount inhe specified currencyo be charged onhe interval specified.',

183 
max_dig™s
=8, 
decim®_¶aûs
=2, 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
MšV®ueV®id©Ü
(

185 ('cu¼’cy', 
mod–s
.
Ch¬F›ld
(=
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy iÀwhichhsubsütiÚ wÈbch¬ged.', 
max_Ëngth
=4, 
choiûs
=[('USD', 'USD - United States Dollar'), ('EUR', 'EUR - Euro Members'), ('JPY', 'JPY - Japan Yen'), ('GBP', 'GBP - United Kingdom Pound'), ('CHF', 'CHF - Switzerland Franc'), ('AED', 'AED - United Arab Emirates Dirham'), ('AFN', 'AFN - Afghanistan Afghani'), ('ALL', 'ALL - Albania Lek'), ('AMD', 'AMD - Armenia Dram'), ('ANG', 'ANG - Netherlands Antilles Guilder'), ('AOA', 'AOA - Angola Kwanza'), ('ARS', 'ARS - Argentina Peso'), ('AUD', 'AUD - Australia Dollar'), ('AWG', 'AWG - Aruba Guilder'), ('AZN', 'AZN - Azerbaijan New Manat'), ('BAM', 'BAM - Bosnia‡nd Herzegovina Convertible Marka'), ('BBD', 'BBD - Barbados Dollar'), ('BDT', 'BDT - Bangladesh Taka'), ('BGN', 'BGN - Bulgaria Lev'), ('BHD', 'BHD - Bahrain Dinar'), ('BIF', 'BIF - Burundi Franc'), ('BMD', 'BMD - Bermuda Dollar'), ('BND', 'BND - Brunei Darussalam Dollar'), ('BOB', 'BOB - Bolivia Boliviano'), ('BRL', 'BRL - Brazil Real'), ('BSD', 'BSD - Bahamas Dollar'), ('BTN', 'BTN - Bhutan Ngultrum'), ('BWP', 'BWP - Botswana Pula'), ('BYR', 'BYR - Belarus Ruble'), ('BZD', 'BZD - Belize Dollar'), ('CAD', 'CAD - Canada Dollar'), ('CDF', 'CDF - Congo/Kinshasa Franc'), ('CLP', 'CLP - Chile Peso'), ('CNY', 'CNY - China Yuan Renminbi'), ('COP', 'COP - Colombia Peso'), ('CRC', 'CRC - Costa Rica Colon'), ('CUC', 'CUC - Cuba Convertible Peso'), ('CUP', 'CUP - Cuba Peso'), ('CVE', 'CVE - Cape Verde Escudo'), ('CZK', 'CZK - Czech Republic Koruna'), ('DJF', 'DJF - Djibouti Franc'), ('DKK', 'DKK - Denmark Krone'), ('DOP', 'DOP - Dominican Republic Peso'), ('DZD', 'DZD - Algeria Dinar'), ('EGP', 'EGP - Egypt Pound'), ('ERN', 'ERN - Eritrea Nakfa'), ('ETB', 'ETB - Ethiopia Birr'), ('FJD', 'FJD - Fiji Dollar'), ('FKP', 'FKP - Falkland Islands (Malvinas) Pound'), ('GEL', 'GEL - Georgia Lari'), ('GGP', 'GGP - Guernsey Pound'), ('GHS', 'GHS - Ghana Cedi'), ('GIP', 'GIP - Gibraltar Pound'), ('GMD', 'GMD - Gambia Dalasi'), ('GNF', 'GNF - Guinea Franc'), ('GTQ', 'GTQ - Guatemala Quetzal'), ('GYD', 'GYD - Guyana Dollar'), ('HKD', 'HKD - Hong Kong Dollar'), ('HNL', 'HNL - Honduras Lempira'), ('HRK', 'HRK - Croatia Kuna'), ('HTG', 'HTG - Haiti Gourde'), ('HUF', 'HUF - Hungary Forint'), ('IDR', 'IDR - Indonesia Rupiah'), ('ILS', 'ILS - Israel Shekel'), ('IMP', 'IMP - Isle of Man Pound'), ('INR', 'INR - India Rupee'), ('IQD', 'IQD - Iraq Dinar'), ('IRR', 'IRR - Iran Rial'), ('ISK', 'ISK - Iceland Krona'), ('JEP', 'JEP - Jersey Pound'), ('JMD', 'JMD - Jamaica Dollar'), ('JOD', 'JOD - Jordan Dinar'), ('KES', 'KES - Kenya Shilling'), ('KGS', 'KGS - Kyrgyzstan Som'), ('KHR', 'KHR - Cambodia Riel'), ('KMF', 'KMF - Comoros Franc'), ('KPW', 'KPW - Korea (North) Won'), ('KRW', 'KRW - Korea (South) Won'), ('KWD', 'KWD - Kuwait Dinar'), ('KYD', 'KYD - Cayman Islands Dollar'), ('KZT', 'KZT - Kazakhstan Tenge'), ('LAK', 'LAK - Laos Kip'), (

187 ('ŒŸl_³riod_days', 
mod–s
.
Pos™iveIÁeg”F›ld
(

188 
h–p_‹xt
=
b
'Numb” oàŒŸÈ³riod day g¿Áed wh’ subsüibšg‡ cu¡om”Øthi ¶ª.', 
nuÎ
=
True
)),

189 ('g’”©e_aá”', 
mod–s
.
Pos™iveIÁeg”F›ld
(

190 =0, 
h–p_‹xt
=
b
'Number of secondso wait‡fter current billing cycleƒnds before generatinghe invoice. This can be usedo‡llow systemso finish updating feature counters.')),

191 ('’abËd', 
mod–s
.
BoŞ—nF›ld
(

192 =
True
, 
h–p_‹xt
=
b
'Whethero‡ccept subscriptions.')),

193 ('´iv©e', 
mod–s
.
BoŞ—nF›ld
(

194 =
F®£
, 
h–p_‹xt
=
b
'Indicates if‡…lan is…rivate.')),

195 ('m‘”ed_ã©u»s', 
mod–s
.
MªyToMªyF›ld
(

196 
h–p_‹xt
=
b
"A†i¡ oàth¶ª' m‘”ed f—tu»s.", 
to
='sv”.M‘”edF—tu»', 
bÏnk
=
True
)),

199 
	gmig¿tiÚs
.
C»©eMod–
(

200 
Çme
='ProductCode',

201 
f›lds
=[

202 ('id', 
mod–s
.
AutoF›ld
(
v”bo£_Çme
='ID',

203 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

204 ('v®ue', 
mod–s
.
Ch¬F›ld
(
unique
=
True
, 
max_Ëngth
=128)),

207 
	gmig¿tiÚs
.
C»©eMod–
(

208 
Çme
='Proforma',

209 
f›lds
=[

210 ('id', 
mod–s
.
AutoF›ld
(
v”bo£_Çme
='ID',

211 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

212 ('numb”', 
mod–s
.
IÁeg”F›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

214 
jsÚf›ld
.
f›lds
.
JSONF›ld
(=
diù
)),

216 
jsÚf›ld
.
f›lds
.
JSONF›ld
(=
diù
)),

217 ('due_d©e', 
mod–s
.
D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

218 ('issue_d©e', 
mod–s
.
D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

219 ('·id_d©e', 
mod–s
.
D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

220 ('ÿnûl_d©e', 
mod–s
.
D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

221 ('§Ës_x_³rûÁ', 
mod–s
.
Decim®F›ld
(
bÏnk
=
True
, 
nuÎ
=True, 
max_dig™s
=4,

222 
decim®_¶aûs
=2, 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
MšV®ueV®id©Ü
(

224 ('§Ës_x_Çme', 
mod–s
.
Ch¬F›ld
(

225 
max_Ëngth
=64, 
nuÎ
=
True
, 
bÏnk
=True)),

226 ('cu¼’cy', 
mod–s
.
Ch¬F›ld
(=
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy u£d fÜ blšg.', 
max_Ëngth
=4, 
choiûs
=[('USD', 'USD - United States Dollar'), ('EUR', 'EUR - Euro Members'), ('JPY', 'JPY - Japan Yen'), ('GBP', 'GBP - United Kingdom Pound'), ('CHF', 'CHF - Switzerland Franc'), ('AED', 'AED - United Arab Emirates Dirham'), ('AFN', 'AFN - Afghanistan Afghani'), ('ALL', 'ALL - Albania Lek'), ('AMD', 'AMD - Armenia Dram'), ('ANG', 'ANG - Netherlands Antilles Guilder'), ('AOA', 'AOA - Angola Kwanza'), ('ARS', 'ARS - Argentina Peso'), ('AUD', 'AUD - Australia Dollar'), ('AWG', 'AWG - Aruba Guilder'), ('AZN', 'AZN - Azerbaijan New Manat'), ('BAM', 'BAM - Bosnia‡nd Herzegovina Convertible Marka'), ('BBD', 'BBD - Barbados Dollar'), ('BDT', 'BDT - Bangladesh Taka'), ('BGN', 'BGN - Bulgaria Lev'), ('BHD', 'BHD - Bahrain Dinar'), ('BIF', 'BIF - Burundi Franc'), ('BMD', 'BMD - Bermuda Dollar'), ('BND', 'BND - Brunei Darussalam Dollar'), ('BOB', 'BOB - Bolivia Boliviano'), ('BRL', 'BRL - Brazil Real'), ('BSD', 'BSD - Bahamas Dollar'), ('BTN', 'BTN - Bhutan Ngultrum'), ('BWP', 'BWP - Botswana Pula'), ('BYR', 'BYR - Belarus Ruble'), ('BZD', 'BZD - Belize Dollar'), ('CAD', 'CAD - Canada Dollar'), ('CDF', 'CDF - Congo/Kinshasa Franc'), ('CLP', 'CLP - Chile Peso'), ('CNY', 'CNY - China Yuan Renminbi'), ('COP', 'COP - Colombia Peso'), ('CRC', 'CRC - Costa Rica Colon'), ('CUC', 'CUC - Cuba Convertible Peso'), ('CUP', 'CUP - Cuba Peso'), ('CVE', 'CVE - Cape Verde Escudo'), ('CZK', 'CZK - Czech Republic Koruna'), ('DJF', 'DJF - Djibouti Franc'), ('DKK', 'DKK - Denmark Krone'), ('DOP', 'DOP - Dominican Republic Peso'), ('DZD', 'DZD - Algeria Dinar'), ('EGP', 'EGP - Egypt Pound'), ('ERN', 'ERN - Eritrea Nakfa'), ('ETB', 'ETB - Ethiopia Birr'), ('FJD', 'FJD - Fiji Dollar'), ('FKP', 'FKP - Falkland Islands (Malvinas) Pound'), ('GEL', 'GEL - Georgia Lari'), ('GGP', 'GGP - Guernsey Pound'), ('GHS', 'GHS - Ghana Cedi'), ('GIP', 'GIP - Gibraltar Pound'), ('GMD', 'GMD - Gambia Dalasi'), ('GNF', 'GNF - Guinea Franc'), ('GTQ', 'GTQ - Guatemala Quetzal'), ('GYD', 'GYD - Guyana Dollar'), ('HKD', 'HKD - Hong Kong Dollar'), ('HNL', 'HNL - Honduras Lempira'), ('HRK', 'HRK - Croatia Kuna'), ('HTG', 'HTG - Haiti Gourde'), ('HUF', 'HUF - Hungary Forint'), ('IDR', 'IDR - Indonesia Rupiah'), ('ILS', 'ILS - Israel Shekel'), ('IMP', 'IMP - Isle of Man Pound'), ('INR', 'INR - India Rupee'), ('IQD', 'IQD - Iraq Dinar'), ('IRR', 'IRR - Iran Rial'), ('ISK', 'ISK - Iceland Krona'), ('JEP', 'JEP - Jersey Pound'), ('JMD', 'JMD - Jamaica Dollar'), ('JOD', 'JOD - Jordan Dinar'), ('KES', 'KES - Kenya Shilling'), ('KGS', 'KGS - Kyrgyzstan Som'), ('KHR', 'KHR - Cambodia Riel'), ('KMF', 'KMF - Comoros Franc'), ('KPW', 'KPW - Korea (North) Won'), ('KRW', 'KRW - Korea (South) Won'), ('KWD', 'KWD - Kuwait Dinar'), ('KYD', 'KYD - Cayman Islands Dollar'), ('KZT', 'KZT - Kazakhstan Tenge'), ('LAK', 'LAK - Laos Kip'), ('LBP', 'LBP - Lebanon Pound'), (

228 ('pdf', 
mod–s
.
FeF›ld
(

229 
u¶ßd_to
=
sv”
.
mod–s
.
docum’ts
.
ba£
.
docum’ts_pdf_·th
, 
nuÎ
=
True
, 
ed™abË
=
F®£
, 
bÏnk
=True)),

230 ('¡©e', 
djªgo_fsm
.
FSMF›ld
(=
b
'd¿á', 
h–p_‹xt
=b'Th¡©thšvoiû i š.', 
max_Ëngth
=10,

231 
v”bo£_Çme
=
b
'S‹', 
choiûs
=[(b'draft', b'Draft'), (b'issued', b'Issued'), (b'paid', b'Paid'), (b'canceled', b'Canceled')])),

232 ('cu¡om”', 
mod–s
.
FÜeignKey
(
to
='silver.Customer')),

233 ('švoiû', 
mod–s
.
FÜeignKey
(

234 
»Ï‹d_Çme
='»Ï‹d_švoiû', 
bÏnk
=
True
, 
to
='sv”.Invoiû', 
nuÎ
=True)),

236 
İtiÚs
={

238 'ab¡¿ù': 
F®£
,

241 
	gmig¿tiÚs
.
C»©eMod–
(

242 
Çme
='Provider',

243 
f›lds
=[

244 ('id', 
mod–s
.
AutoF›ld
(
v”bo£_Çme
='ID',

245 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

246 ('live', 
livef›ld
.
f›lds
.
LiveF›ld
(=
True
)),

247 ('Çme', 
mod–s
.
Ch¬F›ld
(

248 
h–p_‹xt
=
b
'ThÇmtØbu£d fÜ blšg…u½o£s.', 
max_Ëngth
=128)),

249 ('com·ny', 
mod–s
.
Ch¬F›ld
(

250 
max_Ëngth
=128, 
nuÎ
=
True
, 
bÏnk
=True)),

251 ('ema', 
mod–s
.
EmaF›ld
(

252 
max_Ëngth
=254, 
nuÎ
=
True
, 
bÏnk
=True)),

253 ('add»ss_1', 
mod–s
.
Ch¬F›ld
(
max_Ëngth
=128)),

254 ('add»ss_2', 
mod–s
.
Ch¬F›ld
(

255 
max_Ëngth
=128, 
nuÎ
=
True
, 
bÏnk
=True)),

256 ('couÁry', 
mod–s
.
Ch¬F›ld
(
max_Ëngth
=3, 
choiûs
=[('AF', 'Afghanistan'), ('AL', 'Albania'), ('AQ', 'Antarctica'), ('DZ', 'Algeria'), ('AS', 'American Samoa'), ('AD', 'Andorra'), ('AO', 'Angola'), ('AG', 'Antigua‡nd Barbuda'), ('AZ', 'Azerbaijan'), ('AR', 'Argentina'), ('AU', 'Australia'), ('AT', 'Austria'), ('BS', 'Bahamas'), ('BH', 'Bahrain'), ('BD', 'Bangladesh'), ('AM', 'Armenia'), ('BB', 'Barbados'), ('BE', 'Belgium'), ('BM', 'Bermuda'), ('BT', 'Bhutan'), ('BO', 'Bolivia'), ('BA', 'Bosnia‡nd Herzegovina'), ('BW', 'Botswana'), ('BV', 'Bouvet Island'), ('BR', 'Brazil'), ('BZ', 'Belize'), ('IO', 'British Indian Ocean Territory'), ('SB', 'Solomon Islands'), ('VG', 'British Virgin Islands'), ('BN', 'Brunei Darussalam'), ('BG', 'Bulgaria'), ('MM', 'Myanmar'), ('BI', 'Burundi'), ('BY', 'Belarus'), ('KH', 'Cambodia'), ('CM', 'Cameroon'), ('CA', 'Canada'), ('CV', 'Cape Verde'), ('KY', 'Cayman Islands'), ('CF', 'Central African Republic'), ('LK', 'Sri Lanka'), ('TD', 'Chad'), ('CL', 'Chile'), ('CN', 'China'), ('TW', 'Taiwan'), ('CX', 'Christmas Island'), ('CC', 'Cocos'), ('CO', 'Colombia'), ('KM', 'Comoros'), ('YT', 'Mayotte'), ('CG', 'Congo'), ('CD', 'Congo'), ('CK', 'Cook Islands'), ('CR', 'Costa Rica'), ('HR', 'Croatia'), ('CU', 'Cuba'), ('CY', 'Cyprus'), ('CZ', 'Czech Republic'), ('BJ', 'Benin'), ('DK', 'Denmark'), ('DM', 'Dominica'), ('DO', 'Dominican Republic'), ('EC', 'Ecuador'), ('SV', 'El Salvador'), ('GQ', 'Equatorial Guinea'), ('ET', 'Ethiopia'), ('ER', 'Eritrea'), ('EE', 'Estonia'), ('FO', 'Faroe Islands'), ('FK', 'Falkland Islands'), ('GS', 'South Georgia‡ndhe South Sandwich Islands'), ('FJ', 'Fiji'), ('FI', 'Finland'), ('AX', '\xc5land Islands'), ('FR', 'France'), ('GF', 'French Guiana'), ('PF', 'French Polynesia'), ('TF', 'French Southern Territories'), ('DJ', 'Djibouti'), ('GA', 'Gabon'), ('GE', 'Georgia'), ('GM', 'Gambia'), ('PS', 'Palestinian Territory'), ('DE', 'Germany'), ('GH', 'Ghana'), ('GI', 'Gibraltar'), ('KI', 'Kiribati'), ('GR', 'Greece'), ('GL', 'Greenland'), ('GD', 'Grenada'), ('GP', 'Guadeloupe'), ('GU', 'Guam'), ('GT', 'Guatemala'), ('GN', 'Guinea'), ('GY', 'Guyana'), ('HT', 'Haiti'), ('HM', 'Heard Island‡nd McDonald Islands'), ('VA', 'Holy See'), ('HN', 'Honduras'), ('HK', 'Hong Kong'), ('HU', 'Hungary'), ('IS', 'Iceland'), ('IN', 'India'), ('ID', 'Indonesia'), ('IR', 'Iran'), ('IQ', 'Iraq'), ('IE', 'Ireland'), ('IL', 'Israel'), ('IT', 'Italy'), ('CI', "Cote d'Ivoire"), ('JM', 'Jamaica'), ('JP', 'Japan'), ('KZ', 'Kazakhstan'), ('JO', 'Jordan'), ('KE', 'Kenya'), ('KP', 'Korea'), ('KR', 'Korea'), ('KW', 'Kuwait'), ('KG', 'Kyrgyz Republic'), ('LA', "Lao People's Democratic Republic"), ('LB', 'Lebanon'), ('LS', 'Lesotho'), ('LV', 'Latvia'), ('LR', 'Liberia'), ('LY', 'Libyan Arab Jamahiriya'), ('LI', 'Liechtenstein'), ('LT', 'Lithuania'), ('LU', 'Luxembourg'), ('MO', 'Macao'), (

258 ('c™y', 
mod–s
.
Ch¬F›ld
(
max_Ëngth
=128)),

259 ('¡©e', 
mod–s
.
Ch¬F›ld
(

260 
max_Ëngth
=128, 
nuÎ
=
True
, 
bÏnk
=True)),

261 ('z_code', 
mod–s
.
Ch¬F›ld
(

262 
max_Ëngth
=32, 
nuÎ
=
True
, 
bÏnk
=True)),

263 ('exŒa', 
mod–s
.
TextF›ld
(

264 
h–p_‹xt
=
b
'ExŒ¨šfÜm©iÚØdi¥Ïy oÀthšvoiû (m¬kdowÀfÜm©‹d).', 
nuÎ
=
True
, 
bÏnk
=True)),

265 ('æow', 
mod–s
.
Ch¬F›ld
(=
b
'´ofÜma', 
h–p_‹xt
=b'One ofhe‡vailable workflows for generating…roformas‡nd invoices (seehe documentation for more details).',

266 
max_Ëngth
=10, 
choiûs
=[(

267 
b
'proforma', b'Proforma'), (b'invoice', b'Invoice')])),

268 ('švoiû_£r›s', 
mod–s
.
Ch¬F›ld
(

269 
h–p_‹xt
=
b
'Th£r› th© wÈbu£d oÀev”y invoiû g’”©ed byhi ´ovid”.', 
max_Ëngth
=20)),

270 ('švoiû_¡¬tšg_numb”', 
mod–s
.
Pos™iveIÁeg”F›ld
()),

271 ('´ofÜma_£r›s', 
mod–s
.
Ch¬F›ld
(

272 
h–p_‹xt
=
b
'Th£r› th© wÈbu£d oÀev”y…rofÜm¨g’”©ed byhi ´ovid”.', 
max_Ëngth
=20, 
nuÎ
=
True
, 
bÏnk
=True)),

274 
mod–s
.
Pos™iveIÁeg”F›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

275 ('deçuÉ_docum’t_¡©e', 
mod–s
.
Ch¬F›ld
(=
b
'd¿á', 
h–p_‹xt
=b'The default state ofhe‡uto-generated documents.',

276 
max_Ëngth
=10, 
choiûs
=[(

277 
b
'draft', b'Draft'), (b'issued', b'Issued')])),

279 
İtiÚs
={

280 'ab¡¿ù': 
F®£
,

283 
	gmig¿tiÚs
.
C»©eMod–
(

284 
Çme
='Subscription',

285 
f›lds
=[

286 ('id', 
mod–s
.
AutoF›ld
(
v”bo£_Çme
='ID',

287 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

288 ('desütiÚ', 
mod–s
.
Ch¬F›ld
(

289 
max_Ëngth
=1024, 
nuÎ
=
True
, 
bÏnk
=True)),

290 ('ŒŸl_’d', 
mod–s
.
D©eF›ld
(

291 
h–p_‹xt
=
b
'Thd©© whichhŒŸÈ’ds. Ià£t, ov”ride thcompu‹drŸÈ’d d©äomh¶ª.', 
nuÎ
=
True
, 
bÏnk
=True)),

292 ('¡¬t_d©e', 
mod–s
.
D©eF›ld
(

293 
h–p_‹xt
=
b
'Th¡¬tšg d©fÜhsubsütiÚ.', 
nuÎ
=
True
, 
bÏnk
=True)),

294 ('’ded_©', 
mod–s
.
D©eF›ld
(

295 
h–p_‹xt
=
b
'Thd©wh’hsubsütiÚƒnded.', 
nuÎ
=
True
, 
bÏnk
=True)),

296 ('»ã»nû', 
mod–s
.
Ch¬F›ld
(

297 
h–p_‹xt
=
b
"ThsubsütiÚ' »ã»nû iÀªƒx‹º® sy¡em.", 
max_Ëngth
=128, 
nuÎ
=
True
, 
bÏnk
=True)),

298 ('¡©e', 
djªgo_fsm
.
FSMF›ld
(=
b
'šaùive', 
h–p_‹xt
=b'Th¡©thsubsütiÚ i š.', 
´Ùeùed
=
True
,

299 
max_Ëngth
=12, 
choiûs
=[(

300 
b
'active', b'Active'), (b'inactive', b'Inactive'), (b'canceled', b'Canceled'), (b'ended', b'Ended')])),

301 ('cu¡om”', 
mod–s
.
FÜeignKey
(
»Ï‹d_Çme
='subscriptions',

302 
to
='sv”.Cu¡om”', 
h–p_‹xt
=
b
'The customer who is subscribedohe…lan.')),

303 ('¶ª', 
mod–s
.
FÜeignKey
(

304 
h–p_‹xt
=
b
'Th¶ªhcu¡om” i subsüibedo.', 
to
='silver.Plan')),

307 
	gmig¿tiÚs
.
AddF›ld
(

308 
mod–_Çme
='proforma',

309 
Çme
='provider',

310 
f›ld
=
mod–s
.
FÜeignKey
(
to
='silver.Provider'),

312 
	gmig¿tiÚs
.
AddF›ld
(

313 
mod–_Çme
='plan',

314 
Çme
='product_code',

315 
f›ld
=
mod–s
.
OÃToOÃF›ld
(

316 
to
='silver.ProductCode',

317 
h–p_‹xt
=
b
'The…roduct code forhis…lan.'),

319 
	gmig¿tiÚs
.
AddF›ld
(

320 
mod–_Çme
='plan',

321 
Çme
='provider',

322 
f›ld
=
mod–s
.
FÜeignKey
(

323 
»Ï‹d_Çme
='plans',

324 
to
='silver.Provider',

325 
h–p_‹xt
=
b
'The…rovider which…rovideshe…lan.'),

327 
	gmig¿tiÚs
.
AddF›ld
(

328 
mod–_Çme
='meteredfeatureunitslog',

329 
Çme
='subscription',

330 
f›ld
=
mod–s
.
FÜeignKey
(

331 
»Ï‹d_Çme
='mf_log_entries',

332 
to
='silver.Subscription'),

334 
	gmig¿tiÚs
.
AddF›ld
(

335 
mod–_Çme
='meteredfeature',

336 
Çme
='product_code',

337 
f›ld
=
sv”
.
uts
.
mod–s
.
Un§vedFÜeignKey
(

338 
h–p_‹xt
=
b
'The…roduct code forhis…lan.',

339 
to
='silver.ProductCode'),

341 
	gmig¿tiÚs
.
AddF›ld
(

342 
mod–_Çme
='invoice',

343 
Çme
='proforma',

344 
f›ld
=
mod–s
.
FÜeignKey
(

345 
»Ï‹d_Çme
='related_proforma',

346 
bÏnk
=
True
,

347 
to
='silver.Proforma',

348 
nuÎ
=
True
),

350 
	gmig¿tiÚs
.
AddF›ld
(

351 
mod–_Çme
='invoice',

352 
Çme
='provider',

353 
f›ld
=
mod–s
.
FÜeignKey
(
to
='silver.Provider'),

355 
	gmig¿tiÚs
.
AddF›ld
(

356 
mod–_Çme
='documententry',

357 
Çme
='invoice',

358 
f›ld
=
mod–s
.
FÜeignKey
(

359 
»Ï‹d_Çme
='invoice_entries',

360 
bÏnk
=
True
,

361 
to
='silver.Invoice',

362 
nuÎ
=
True
),

364 
	gmig¿tiÚs
.
AddF›ld
(

365 
mod–_Çme
='documententry',

366 
Çme
='product_code',

367 
f›ld
=
mod–s
.
FÜeignKey
(

368 
»Ï‹d_Çme
='invoices',

369 
bÏnk
=
True
,

370 
to
='silver.ProductCode',

371 
nuÎ
=
True
),

373 
	gmig¿tiÚs
.
AddF›ld
(

374 
mod–_Çme
='documententry',

375 
Çme
='proforma',

376 
f›ld
=
mod–s
.
FÜeignKey
(

377 
»Ï‹d_Çme
='proforma_entries',

378 
bÏnk
=
True
,

379 
to
='silver.Proforma',

380 
nuÎ
=
True
),

382 
	gmig¿tiÚs
.
AddF›ld
(

383 
mod–_Çme
='billinglog',

384 
Çme
='invoice',

385 
f›ld
=
mod–s
.
FÜeignKey
(

386 
»Ï‹d_Çme
='billing_log_entries',

387 
bÏnk
=
True
,

388 
to
='silver.Invoice',

389 
nuÎ
=
True
),

391 
	gmig¿tiÚs
.
AddF›ld
(

392 
mod–_Çme
='billinglog',

393 
Çme
='proforma',

394 
f›ld
=
mod–s
.
FÜeignKey
(

395 
»Ï‹d_Çme
='billing_log_entries',

396 
bÏnk
=
True
,

397 
to
='silver.Proforma',

398 
nuÎ
=
True
),

400 
	gmig¿tiÚs
.
AddF›ld
(

401 
mod–_Çme
='billinglog',

402 
Çme
='subscription',

403 
f›ld
=
mod–s
.
FÜeignKey
(

404 
»Ï‹d_Çme
='billing_log_entries',

405 
to
='silver.Subscription'),

407 
	gmig¿tiÚs
.
AÉ”UniqueTog‘h”
(

408 
Çme
='proforma',

409 
unique_tog‘h”
=
£t
([('provider', 'number')]),

411 
	gmig¿tiÚs
.
AÉ”UniqueTog‘h”
(

412 
Çme
='meteredfeatureunitslog',

413 
unique_tog‘h”
=
£t
(

419 
	gmig¿tiÚs
.
AÉ”UniqueTog‘h”
(

420 
Çme
='invoice',

421 
unique_tog‘h”
=
£t
([('provider', 'number')]),

	@silver/migrations/0002_auto_20150416_1009.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 #-*- 
codšg
: 
utf
-8 -*-

17 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


19 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmod–s
, 
mig¿tiÚs


22 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

24 
d•’d’c›s
 = [

28 
İ”©iÚs
 = [

29 
mig¿tiÚs
.
	`AÉ”F›ld
(

30 
mod–_Çme
='documententry',

31 
Çme
='description',

32 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
max_Ëngth
=1024),

34 
mig¿tiÚs
.
	`AÉ”F›ld
(

35 
mod–_Çme
='documententry',

36 
Çme
='unit',

37 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
max_Ëngth
=1024, 
nuÎ
=
True
, 
bÏnk
=True),

39 
mig¿tiÚs
.
	`AÉ”F›ld
(

40 
mod–_Çme
='plan',

41 
Çme
='product_code',

42 
f›ld
=
mod–s
.
	`FÜeignKey
(
h–p_‹xt
=
b
'Th´oduù codfÜhi ¶ª.', 
to
='silver.ProductCode'),

	@silver/migrations/0003_auto_20150417_0634.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 #-*- 
codšg
: 
utf
-8 -*-

17 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


19 
äom
 
	gdjªgo
.
db
 
impÜt
 
mig¿tiÚs


20 
impÜt
 
	gjsÚf›ld
.
f›lds


23 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

25 
d•’d’c›s
 = [

29 
İ”©iÚs
 = [

30 
mig¿tiÚs
.
	`AddF›ld
(

31 
mod–_Çme
='customer',

32 
Çme
='meta',

33 
f›ld
=
jsÚf›ld
.
f›lds
.
	`JSONF›ld
(
nuÎ
=
True
, 
bÏnk
=True),

35 
mig¿tiÚs
.
	`AddF›ld
(

36 
mod–_Çme
='provider',

37 
Çme
='meta',

38 
f›ld
=
jsÚf›ld
.
f›lds
.
	`JSONF›ld
(
nuÎ
=
True
, 
bÏnk
=True),

40 
mig¿tiÚs
.
	`AddF›ld
(

41 
mod–_Çme
='subscription',

42 
Çme
='meta',

43 
f›ld
=
jsÚf›ld
.
f›lds
.
	`JSONF›ld
(
nuÎ
=
True
, 
bÏnk
=True),

	@silver/migrations/0004_auto_20150429_1731.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 #-*- 
codšg
: 
utf
-8 -*-

17 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


19 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmod–s
, 
mig¿tiÚs


22 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

24 
d•’d’c›s
 = [

28 
İ”©iÚs
 = [

29 
mig¿tiÚs
.
	`AddF›ld
(

30 
mod–_Çme
='invoice',

31 
Çme
='series',

32 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
max_Ëngth
=20, 
nuÎ
=
True
, 
bÏnk
=True),

34 
mig¿tiÚs
.
	`AddF›ld
(

35 
mod–_Çme
='proforma',

36 
Çme
='series',

37 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
max_Ëngth
=20, 
nuÎ
=
True
, 
bÏnk
=True),

	@silver/migrations/0005_auto_20150429_1732.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 #-*- 
codšg
: 
utf
-8 -*-

17 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


19 
äom
 
	gdjªgo
.
db
 
impÜt
 
mig¿tiÚs


22 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

24 
d•’d’c›s
 = [

28 
İ”©iÚs
 = [

29 
mig¿tiÚs
.
	`AÉ”Mod–O±iÚs
(

30 
Çme
='invoice',

31 
İtiÚs
={'Üd”šg': ('-issue_d©e', '£r›s', 'numb”')
	}
},

33 
mig¿tiÚs
.
AÉ”Mod–O±iÚs
(

34 
Çme
='proforma',

35 
İtiÚs
={'ordering': ('-issue_date', 'series', 'number')},

37 
mig¿tiÚs
.
AÉ”UniqueTog‘h”
(

38 
Çme
='invoice',

39 
unique_tog‘h”
=
£t
([('provider', 'series', 'number')]),

41 
	gmig¿tiÚs
.
AÉ”UniqueTog‘h”
(

42 
Çme
='proforma',

43 
unique_tog‘h”
=
£t
([('provider', 'series', 'number')]),

	@silver/migrations/0006_auto_20150430_1457.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 #-*- 
codšg
: 
utf
-8 -*-

17 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


19 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmod–s
, 
mig¿tiÚs


22 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

24 
d•’d’c›s
 = [

28 
İ”©iÚs
 = [

29 
mig¿tiÚs
.
	`AÉ”Mod–O±iÚs
(

30 
Çme
='customer',

31 
İtiÚs
={'Üd”šg': ['Çme', 'com·ny']
	}
},

33 
	gmig¿tiÚs
.
AÉ”Mod–O±iÚs
(

34 
Çme
='meteredfeature',

35 
İtiÚs
={'ordering': ('name',)},

37 
	gmig¿tiÚs
.
AÉ”Mod–O±iÚs
(

38 
Çme
='plan',

39 
İtiÚs
={'ordering': ('name',)},

41 
	gmig¿tiÚs
.
AÉ”Mod–O±iÚs
(

42 
Çme
='provider',

43 
İtiÚs
={'ordering': ['name', 'company']},

45 
	gmig¿tiÚs
.
AÉ”F›ld
(

46 
mod–_Çme
='invoice',

47 
Çme
='issue_date',

48 
f›ld
=
mod–s
.
D©eF›ld
(
db_šdex
=
True
, 
nuÎ
=True, 
bÏnk
=True),

50 
	gmig¿tiÚs
.
AÉ”F›ld
(

51 
mod–_Çme
='invoice',

52 
Çme
='number',

53 
f›ld
=
mod–s
.
IÁeg”F›ld
(
db_šdex
=
True
, 
nuÎ
=True, 
bÏnk
=True),

55 
	gmig¿tiÚs
.
AÉ”F›ld
(

56 
mod–_Çme
='invoice',

57 
Çme
='series',

58 
f›ld
=
mod–s
.
Ch¬F›ld
(
db_šdex
=
True
, 
max_Ëngth
=20, 
nuÎ
=True, 
bÏnk
=True),

60 
	gmig¿tiÚs
.
AÉ”F›ld
(

61 
mod–_Çme
='meteredfeature',

62 
Çme
='name',

63 
f›ld
=
mod–s
.
Ch¬F›ld
(
h–p_‹xt
=
b
'Thã©u» di¥Ïy‚ame.', 
max_Ëngth
=200, 
db_šdex
=
True
),

65 
	gmig¿tiÚs
.
AÉ”F›ld
(

66 
mod–_Çme
='plan',

67 
Çme
='name',

68 
f›ld
=
mod–s
.
Ch¬F›ld
(
h–p_‹xt
=
b
'Di¥Ïy‚amoàth¶ª.', 
max_Ëngth
=200, 
db_šdex
=
True
),

70 
	gmig¿tiÚs
.
AÉ”F›ld
(

71 
mod–_Çme
='proforma',

72 
Çme
='issue_date',

73 
f›ld
=
mod–s
.
D©eF›ld
(
db_šdex
=
True
, 
nuÎ
=True, 
bÏnk
=True),

75 
	gmig¿tiÚs
.
AÉ”F›ld
(

76 
mod–_Çme
='proforma',

77 
Çme
='number',

78 
f›ld
=
mod–s
.
IÁeg”F›ld
(
db_šdex
=
True
, 
nuÎ
=True, 
bÏnk
=True),

80 
	gmig¿tiÚs
.
AÉ”F›ld
(

81 
mod–_Çme
='proforma',

82 
Çme
='series',

83 
f›ld
=
mod–s
.
Ch¬F›ld
(
db_šdex
=
True
, 
max_Ëngth
=20, 
nuÎ
=True, 
bÏnk
=True),

85 
	gmig¿tiÚs
.
AÉ”IndexTog‘h”
(

86 
Çme
='customer',

87 
šdex_tog‘h”
=
£t
([('name', 'company')]),

89 
	gmig¿tiÚs
.
AÉ”IndexTog‘h”
(

90 
Çme
='provider',

91 
šdex_tog‘h”
=
£t
([('name', 'company')]),

	@silver/migrations/0007_auto_20150430_1549.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 #-*- 
codšg
: 
utf
-8 -*-

17 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


19 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmod–s
, 
mig¿tiÚs


22 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

24 
d•’d’c›s
 = [

28 
İ”©iÚs
 = [

29 
mig¿tiÚs
.
	`AÉ”F›ld
(

30 
mod–_Çme
='plan',

31 
Çme
='trial_period_days',

32 
f›ld
=
mod–s
.
	`Pos™iveIÁeg”F›ld
(
h–p_‹xt
=
b
'Number ofrial '

35 
nuÎ
=
True
, 
v”bo£_Çme
=
b
'Trial days'),

	@silver/migrations/0008_auto_20150430_1804.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 #-*- 
codšg
: 
utf
-8 -*-

17 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


19 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmod–s
, 
mig¿tiÚs


20 
impÜt
 
	gdjªgo
.
	gcÜe
.
v®id©Üs


23 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

25 
d•’d’c›s
 = [

29 
İ”©iÚs
 = [

30 
mig¿tiÚs
.
	`AÉ”F›ld
(

31 
mod–_Çme
='documententry',

32 
Çme
='quantity',

33 
f›ld
=
mod–s
.
	`Decim®F›ld
(

34 
max_dig™s
=19,

35 
decim®_¶aûs
=4,

36 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
	`MšV®ueV®id©Ü
(0.0)]),

38 
mig¿tiÚs
.
	`AÉ”F›ld
(

39 
mod–_Çme
='documententry',

40 
Çme
='unit_price',

41 
f›ld
=
mod–s
.
	`Decim®F›ld
(
max_dig™s
=19, 
decim®_¶aûs
=4),

43 
mig¿tiÚs
.
	`AÉ”F›ld
(

44 
mod–_Çme
='meteredfeature',

45 
Çme
='included_units',

46 
f›ld
=
mod–s
.
	`Decim®F›ld
(

47 
h–p_‹xt
=
b
'The‚umber of included units…er…lan interval.',

48 
max_dig™s
=19,

49 
decim®_¶aûs
=4,

50 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
	`MšV®ueV®id©Ü
(0.0)]),

52 
mig¿tiÚs
.
	`AÉ”F›ld
(

53 
mod–_Çme
='meteredfeature',

54 
Çme
='included_units_during_trial',

55 
f›ld
=
mod–s
.
	`Decim®F›ld
(

56 
decim®_¶aûs
=4,

57 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
	`MšV®ueV®id©Ü
(0.0)],

58 
max_dig™s
=19,

59 
bÏnk
=
True
,

60 
h–p_‹xt
=
b
'The‚umber of included units duringherial…eriod.',

61 
nuÎ
=
True
),

63 
mig¿tiÚs
.
	`AÉ”F›ld
(

64 
mod–_Çme
='meteredfeature',

65 
Çme
='price_per_unit',

66 
f›ld
=
mod–s
.
	`Decim®F›ld
(

67 
h–p_‹xt
=
b
'The…rice…er unit.',

68 
max_dig™s
=19,

69 
decim®_¶aûs
=4,

70 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
	`MšV®ueV®id©Ü
(0.0)]),

72 
mig¿tiÚs
.
	`AÉ”F›ld
(

73 
mod–_Çme
='meteredfeatureunitslog',

74 
Çme
='consumed_units',

75 
f›ld
=
mod–s
.
	`Decim®F›ld
(

76 
max_dig™s
=19,

77 
decim®_¶aûs
=4,

78 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
	`MšV®ueV®id©Ü
(0.0)]),

80 
mig¿tiÚs
.
	`AÉ”F›ld
(

81 
mod–_Çme
='plan',

82 
Çme
='amount',

83 
f›ld
=
mod–s
.
	`Decim®F›ld
(

84 
h–p_‹xt
=
b
'The‡mount inhe specified currencyo be charged onhe interval specified.',

85 
max_dig™s
=19,

86 
decim®_¶aûs
=4,

87 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
	`MšV®ueV®id©Ü
(0.0)]),

	@silver/migrations/0009_auto_20150717_1428.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 #-*- 
codšg
: 
utf
-8 -*-

17 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


19 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmod–s
, 
mig¿tiÚs


22 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

24 
d•’d’c›s
 = [

28 
İ”©iÚs
 = [

29 
mig¿tiÚs
.
	`AÉ”Mod–O±iÚs
(

30 
Çme
='invoice',

31 
İtiÚs
={'Üd”šg': ('-issue_d©e', '£r›s', '-numb”')
	}
},

33 
mig¿tiÚs
.
AÉ”Mod–O±iÚs
(

34 
Çme
='proforma',

35 
İtiÚs
={'ordering': ('-issue_date', 'series', '-number')},

37 
mig¿tiÚs
.
AddF›ld
(

38 
mod–_Çme
='subscription',

39 
Çme
='cancel_date',

40 
f›ld
=
mod–s
.
D©eF›ld
(

41 
h–p_‹xt
=
b
'The date whenhe subscription was canceled.',

42 
nuÎ
=
True
,

43 
bÏnk
=
True
),

45 
mig¿tiÚs
.
AÉ”F›ld
(

46 
mod–_Çme
='plan',

47 
Çme
='trial_period_days',

48 
f›ld
=
mod–s
.
Pos™iveIÁeg”F›ld
(

49 
h–p_‹xt
=
b
'Number ofrial…eriod days granted when subscribing‡ customerohis…lan.',

50 
nuÎ
=
True
,

51 
v”bo£_Çme
=
b
'Trial days',

52 
bÏnk
=
True
),

	@silver/migrations/0031_auto_20170125_1343.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


4 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


5 
äom
 
decim®
 
impÜt
 
Decim®


6 
impÜt
 
	gdjªgo
.
	gcÜe
.
v®id©Üs


9 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

11 
d•’d’c›s
 = [

15 
İ”©iÚs
 = [

16 
mig¿tiÚs
.
	`AddF›ld
(

17 
mod–_Çme
='customer',

18 
Çme
='currency',

19 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
bÏnk
=
True
, 
max_Ëngth
=4, 
nuÎ
=True, 
h–p_‹xt
=
b
'U£dØ’fÜû‡ c”š cu¼’cy wh’ makšg¿n§ùiÚsfÜhcu¡om”.', 
choiûs
=[('AED', 'UAE Dirham'), ('AFN', 'Afghani'), ('ALL', 'Lek'), ('AMD', 'Armenian Dram'), ('ANG', 'Netherlands Antillean Guilder'), ('AOA', 'Kwanza'), ('ARS', 'Argentine Peso'), ('AUD', 'Australian Dollar'), ('AWG', 'Aruban Florin'), ('AZN', 'Azerbaijanian Manat'), ('BAM', 'Convertible Mark'), ('BBD', 'Barbados Dollar'), ('BDT', 'Taka'), ('BGN', 'Bulgarian Lev'), ('BHD', 'Bahraini Dinar'), ('BIF', 'Burundi Franc'), ('BMD', 'Bermudian Dollar'), ('BND', 'Brunei Dollar'), ('BOB', 'Boliviano'), ('BRL', 'Brazilian Real'), ('BSD', 'Bahamian Dollar'), ('BTN', 'Ngultrum'), ('BWP', 'Pula'), ('BYR', 'Belarusian Ruble'), ('BZD', 'Belize Dollar'), ('CAD', 'Canadian Dollar'), ('CDF', 'Congolese Franc'), ('CHF', 'Swiss Franc'), ('CLP', 'Chilean Peso'), ('CNY', 'Yuan Renminbi'), ('COP', 'Colombian Peso'), ('CRC', 'Costa Rican Colon'), ('CUC', 'Peso Convertible'), ('CUP', 'Cuban Peso'), ('CVE', 'Cabo Verde Escudo'), ('CZK', 'Czech Koruna'), ('DJF', 'Djibouti Franc'), ('DKK', 'Danish Krone'), ('DOP', 'Dominican Peso'), ('DZD', 'Algerian Dinar'), ('EGP', 'Egyptian Pound'), ('ERN', 'Nakfa'), ('ETB', 'Ethiopian Birr'), ('EUR', 'Euro'), ('FJD', 'Fiji Dollar'), ('FKP', 'Falkland Islands Pound'), ('GBP', 'Pound Sterling'), ('GEL', 'Lari'), ('GHS', 'Ghana Cedi'), ('GIP', 'Gibraltar Pound'), ('GMD', 'Dalasi'), ('GNF', 'Guinea Franc'), ('GTQ', 'Quetzal'), ('GYD', 'Guyana Dollar'), ('HKD', 'Hong Kong Dollar'), ('HNL', 'Lempira'), ('HRK', 'Kuna'), ('HTG', 'Gourde'), ('HUF', 'Forint'), ('IDR', 'Rupiah'), ('ILS', 'New Israeli Sheqel'), ('INR', 'Indian Rupee'), ('IQD', 'Iraqi Dinar'), ('IRR', 'Iranian Rial'), ('ISK', 'Iceland Krona'), ('JMD', 'Jamaican Dollar'), ('JOD', 'Jordanian Dinar'), ('JPY', 'Yen'), ('KES', 'Kenyan Shilling'), ('KGS', 'Som'), ('KHR', 'Riel'), ('KMF', 'Comoro Franc'), ('KPW', 'North Korean Won'), ('KRW', 'Won'), ('KWD', 'Kuwaiti Dinar'), ('KYD', 'Cayman Islands Dollar'), ('KZT', 'Tenge'), ('LAK', 'Kip'), ('LBP', 'Lebanese Pound'), ('LKR', 'Sri Lanka Rupee'), ('LRD', 'Liberian Dollar'), ('LSL', 'Loti'), ('LYD', 'Libyan Dinar'), ('MAD', 'Moroccan Dirham'), ('MDL', 'Moldovan Leu'), ('MGA', 'Malagasy Ariary'), ('MKD', 'Denar'), ('MMK', 'Kyat'), ('MNT', 'Tugrik'), ('MOP', 'Pataca'), ('MRO', 'Ouguiya'), ('MUR', 'Mauritius Rupee'), ('MVR', 'Rufiyaa'), ('MWK', 'Malawi Kwacha'), ('MXN', 'Mexican Peso'), ('MYR', 'Malaysian Ringgit'), ('MZN', 'Mozambique Metical'), ('NAD', 'Namibia Dollar'), ('NGN', 'Naira'), ('NIO', 'Cordoba Oro'), ('NOK', 'Norwegian Krone'), ('NPR', 'Nepalese Rupee'), ('NZD', 'New Zealand Dollar'), ('OMR', 'Rial Omani'), ('PAB', 'Balboa'), ('PEN', 'Sol'), ('PGK', 'Kina'), ('PHP', 'Philippine Peso'), ('PKR', 'Pakistan Rupee'), ('PLN', 'Zloty'), ('PYG', 'Guarani'), ('QAR', 'Qatari Rial'), ('RON', 'Romanian Leu'), ('RSD', 'Serbian Dinar'), ('RUB', 'Russian Ruble'), ('RWF', 'Rwanda Franc'), ('SAR', 'Saudi Riyal'), ('SBD', 'Solomon Islands Dollar'), ('SCR', 'Seychelles Rupee'), ('SDG', 'Sudanese Pound'), ('SEK', 'Swedish Krona'), ('SGD', 'Singapore Dollar'), ('SHP', 'Saint Helena Pound'), ('SLL', 'Leone'), ('SOS', 'Somali Shilling'), ('SRD', 'Surinam Dollar'), ('SSP', 'South Sudanese Pound'), ('STD', 'Dobra'), ('SVC', 'El Salvador Colon'), ('SYP', 'Syrian Pound'), ('SZL', 'Lilangeni'), ('THB', 'Baht'), ('TJS', 'Somoni'), ('TMT', 'Turkmenistan New Manat'), ('TND', 'Tunisian Dinar'), ('TOP', 'Pa\u2019anga'), ('TRY', 'Turkish Lira'), ('TTD', 'Trinidad‡nd Tobago Dollar'), ('TWD', 'New Taiwan Dollar'), ('TZS', 'Tanzanian Shilling'), ('UAH', 'Hryvnia'), ('UGX', 'Uganda Shilling'), ('USD', 'US Dollar'), ('UYU', 'Peso Uruguayo'), ('UZS', 'Uzbekistan Sum'), ('VEF', 'Bol\xedvar'), ('VND', 'Dong'), ('VUV', 'Vatu'), ('WST', 'Tala'), ('XAF', 'CFA Franc BEAC'), ('XAG', 'Silver'), ('XAU', 'Gold'), ('XBA', 'Bond Markets Unit European Composite Unit (EURCO)'), ('XBB', 'Bond Markets Unit European Monetary Unit (E.M.U.-6)'), ('XBC', 'Bond Markets Unit European Unit of Account 9 (E.U.A.-9)'), ('XBD', 'Bond Markets Unit European Unit of Account 17 (E.U.A.-17)'), ('XCD', 'East Caribbean Dollar'), ('XDR', 'SDR (Special Drawing Right)'), ('XOF', 'CFA Franc BCEAO'), ('XPD', 'Palladium'), ('XPF', 'CFP Franc'), ('XPT', 'Platinum'), ('XSU', 'Sucre'), ('XTS', 'Codes specifically„eserved foresting…urposes'), ('XUA', 'ADB Unit of Account'), ('XXX', 'The codes‡ssigned forransactions where‚o currency is involved'), ('YER', 'Yemeni Rial'), ('ZAR', 'Rand'), ('ZMW', 'Zambian Kwacha'), ('ZWL', 'Zimbabwe Dollar')]),

21 
mig¿tiÚs
.
	`AddF›ld
(

22 
mod–_Çme
='invoice',

23 
Çme
='transaction_currency',

24 
f›ld
=
mod–s
.
	`Ch¬F›ld
(=
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy u£d wh’ makšg‡¿n§ùiÚ.', 
max_Ëngth
=4, 
choiûs
=[('AED', 'UAE Dirham'), ('AFN', 'Afghani'), ('ALL', 'Lek'), ('AMD', 'Armenian Dram'), ('ANG', 'Netherlands Antillean Guilder'), ('AOA', 'Kwanza'), ('ARS', 'Argentine Peso'), ('AUD', 'Australian Dollar'), ('AWG', 'Aruban Florin'), ('AZN', 'Azerbaijanian Manat'), ('BAM', 'Convertible Mark'), ('BBD', 'Barbados Dollar'), ('BDT', 'Taka'), ('BGN', 'Bulgarian Lev'), ('BHD', 'Bahraini Dinar'), ('BIF', 'Burundi Franc'), ('BMD', 'Bermudian Dollar'), ('BND', 'Brunei Dollar'), ('BOB', 'Boliviano'), ('BRL', 'Brazilian Real'), ('BSD', 'Bahamian Dollar'), ('BTN', 'Ngultrum'), ('BWP', 'Pula'), ('BYR', 'Belarusian Ruble'), ('BZD', 'Belize Dollar'), ('CAD', 'Canadian Dollar'), ('CDF', 'Congolese Franc'), ('CHF', 'Swiss Franc'), ('CLP', 'Chilean Peso'), ('CNY', 'Yuan Renminbi'), ('COP', 'Colombian Peso'), ('CRC', 'Costa Rican Colon'), ('CUC', 'Peso Convertible'), ('CUP', 'Cuban Peso'), ('CVE', 'Cabo Verde Escudo'), ('CZK', 'Czech Koruna'), ('DJF', 'Djibouti Franc'), ('DKK', 'Danish Krone'), ('DOP', 'Dominican Peso'), ('DZD', 'Algerian Dinar'), ('EGP', 'Egyptian Pound'), ('ERN', 'Nakfa'), ('ETB', 'Ethiopian Birr'), ('EUR', 'Euro'), ('FJD', 'Fiji Dollar'), ('FKP', 'Falkland Islands Pound'), ('GBP', 'Pound Sterling'), ('GEL', 'Lari'), ('GHS', 'Ghana Cedi'), ('GIP', 'Gibraltar Pound'), ('GMD', 'Dalasi'), ('GNF', 'Guinea Franc'), ('GTQ', 'Quetzal'), ('GYD', 'Guyana Dollar'), ('HKD', 'Hong Kong Dollar'), ('HNL', 'Lempira'), ('HRK', 'Kuna'), ('HTG', 'Gourde'), ('HUF', 'Forint'), ('IDR', 'Rupiah'), ('ILS', 'New Israeli Sheqel'), ('INR', 'Indian Rupee'), ('IQD', 'Iraqi Dinar'), ('IRR', 'Iranian Rial'), ('ISK', 'Iceland Krona'), ('JMD', 'Jamaican Dollar'), ('JOD', 'Jordanian Dinar'), ('JPY', 'Yen'), ('KES', 'Kenyan Shilling'), ('KGS', 'Som'), ('KHR', 'Riel'), ('KMF', 'Comoro Franc'), ('KPW', 'North Korean Won'), ('KRW', 'Won'), ('KWD', 'Kuwaiti Dinar'), ('KYD', 'Cayman Islands Dollar'), ('KZT', 'Tenge'), ('LAK', 'Kip'), ('LBP', 'Lebanese Pound'), ('LKR', 'Sri Lanka Rupee'), ('LRD', 'Liberian Dollar'), ('LSL', 'Loti'), ('LYD', 'Libyan Dinar'), ('MAD', 'Moroccan Dirham'), ('MDL', 'Moldovan Leu'), ('MGA', 'Malagasy Ariary'), ('MKD', 'Denar'), ('MMK', 'Kyat'), ('MNT', 'Tugrik'), ('MOP', 'Pataca'), ('MRO', 'Ouguiya'), ('MUR', 'Mauritius Rupee'), ('MVR', 'Rufiyaa'), ('MWK', 'Malawi Kwacha'), ('MXN', 'Mexican Peso'), ('MYR', 'Malaysian Ringgit'), ('MZN', 'Mozambique Metical'), ('NAD', 'Namibia Dollar'), ('NGN', 'Naira'), ('NIO', 'Cordoba Oro'), ('NOK', 'Norwegian Krone'), ('NPR', 'Nepalese Rupee'), ('NZD', 'New Zealand Dollar'), ('OMR', 'Rial Omani'), ('PAB', 'Balboa'), ('PEN', 'Sol'), ('PGK', 'Kina'), ('PHP', 'Philippine Peso'), ('PKR', 'Pakistan Rupee'), ('PLN', 'Zloty'), ('PYG', 'Guarani'), ('QAR', 'Qatari Rial'), ('RON', 'Romanian Leu'), ('RSD', 'Serbian Dinar'), ('RUB', 'Russian Ruble'), ('RWF', 'Rwanda Franc'), ('SAR', 'Saudi Riyal'), ('SBD', 'Solomon Islands Dollar'), ('SCR', 'Seychelles Rupee'), ('SDG', 'Sudanese Pound'), ('SEK', 'Swedish Krona'), ('SGD', 'Singapore Dollar'), ('SHP', 'Saint Helena Pound'), ('SLL', 'Leone'), ('SOS', 'Somali Shilling'), ('SRD', 'Surinam Dollar'), ('SSP', 'South Sudanese Pound'), ('STD', 'Dobra'), ('SVC', 'El Salvador Colon'), ('SYP', 'Syrian Pound'), ('SZL', 'Lilangeni'), ('THB', 'Baht'), ('TJS', 'Somoni'), ('TMT', 'Turkmenistan New Manat'), ('TND', 'Tunisian Dinar'), ('TOP', 'Pa\u2019anga'), ('TRY', 'Turkish Lira'), ('TTD', 'Trinidad‡nd Tobago Dollar'), ('TWD', 'New Taiwan Dollar'), ('TZS', 'Tanzanian Shilling'), ('UAH', 'Hryvnia'), ('UGX', 'Uganda Shilling'), ('USD', 'US Dollar'), ('UYU', 'Peso Uruguayo'), ('UZS', 'Uzbekistan Sum'), ('VEF', 'Bol\xedvar'), ('VND', 'Dong'), ('VUV', 'Vatu'), ('WST', 'Tala'), ('XAF', 'CFA Franc BEAC'), ('XAG', 'Silver'), ('XAU', 'Gold'), ('XBA', 'Bond Markets Unit European Composite Unit (EURCO)'), ('XBB', 'Bond Markets Unit European Monetary Unit (E.M.U.-6)'), ('XBC', 'Bond Markets Unit European Unit of Account 9 (E.U.A.-9)'), ('XBD', 'Bond Markets Unit European Unit of Account 17 (E.U.A.-17)'), ('XCD', 'East Caribbean Dollar'), ('XDR', 'SDR (Special Drawing Right)'), ('XOF', 'CFA Franc BCEAO'), ('XPD', 'Palladium'), ('XPF', 'CFP Franc'), ('XPT', 'Platinum'), ('XSU', 'Sucre'), ('XTS', 'Codes specifically„eserved foresting…urposes'), ('XUA', 'ADB Unit of Account'), ('XXX', 'The codes‡ssigned forransactions where‚o currency is involved'), ('YER', 'Yemeni Rial'), ('ZAR', 'Rand'), ('ZMW', 'Zambian Kwacha'), ('ZWL', 'Zimbabwe Dollar')]),

26 
mig¿tiÚs
.
	`AddF›ld
(

27 
mod–_Çme
='invoice',

28 
Çme
='transaction_xe_date',

29 
f›ld
=
mod–s
.
	`D©eF›ld
(
h–p_‹xt
=
b
'D©oàthŒª§ùiÚƒxchªg¿‹.', 
nuÎ
=
True
, 
bÏnk
=True),

31 
mig¿tiÚs
.
	`AddF›ld
(

32 
mod–_Çme
='invoice',

33 
Çme
='transaction_xe_rate',

34 
f›ld
=
mod–s
.
	`Decim®F›ld
(
decim®_¶aûs
=4, =1, 
max_dig™s
=16, 
bÏnk
=
True
, 
h–p_‹xt
=
b
'Cu¼’cyƒxchªg¿‹ from docum’ˆcu¼’cyØŒª§ùiÚ_cu¼’cy.', 
nuÎ
=True),

36 
mig¿tiÚs
.
	`AddF›ld
(

37 
mod–_Çme
='proforma',

38 
Çme
='transaction_currency',

39 
f›ld
=
mod–s
.
	`Ch¬F›ld
(=
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy u£d wh’ makšg‡¿n§ùiÚ.', 
max_Ëngth
=4, 
choiûs
=[('AED', 'UAE Dirham'), ('AFN', 'Afghani'), ('ALL', 'Lek'), ('AMD', 'Armenian Dram'), ('ANG', 'Netherlands Antillean Guilder'), ('AOA', 'Kwanza'), ('ARS', 'Argentine Peso'), ('AUD', 'Australian Dollar'), ('AWG', 'Aruban Florin'), ('AZN', 'Azerbaijanian Manat'), ('BAM', 'Convertible Mark'), ('BBD', 'Barbados Dollar'), ('BDT', 'Taka'), ('BGN', 'Bulgarian Lev'), ('BHD', 'Bahraini Dinar'), ('BIF', 'Burundi Franc'), ('BMD', 'Bermudian Dollar'), ('BND', 'Brunei Dollar'), ('BOB', 'Boliviano'), ('BRL', 'Brazilian Real'), ('BSD', 'Bahamian Dollar'), ('BTN', 'Ngultrum'), ('BWP', 'Pula'), ('BYR', 'Belarusian Ruble'), ('BZD', 'Belize Dollar'), ('CAD', 'Canadian Dollar'), ('CDF', 'Congolese Franc'), ('CHF', 'Swiss Franc'), ('CLP', 'Chilean Peso'), ('CNY', 'Yuan Renminbi'), ('COP', 'Colombian Peso'), ('CRC', 'Costa Rican Colon'), ('CUC', 'Peso Convertible'), ('CUP', 'Cuban Peso'), ('CVE', 'Cabo Verde Escudo'), ('CZK', 'Czech Koruna'), ('DJF', 'Djibouti Franc'), ('DKK', 'Danish Krone'), ('DOP', 'Dominican Peso'), ('DZD', 'Algerian Dinar'), ('EGP', 'Egyptian Pound'), ('ERN', 'Nakfa'), ('ETB', 'Ethiopian Birr'), ('EUR', 'Euro'), ('FJD', 'Fiji Dollar'), ('FKP', 'Falkland Islands Pound'), ('GBP', 'Pound Sterling'), ('GEL', 'Lari'), ('GHS', 'Ghana Cedi'), ('GIP', 'Gibraltar Pound'), ('GMD', 'Dalasi'), ('GNF', 'Guinea Franc'), ('GTQ', 'Quetzal'), ('GYD', 'Guyana Dollar'), ('HKD', 'Hong Kong Dollar'), ('HNL', 'Lempira'), ('HRK', 'Kuna'), ('HTG', 'Gourde'), ('HUF', 'Forint'), ('IDR', 'Rupiah'), ('ILS', 'New Israeli Sheqel'), ('INR', 'Indian Rupee'), ('IQD', 'Iraqi Dinar'), ('IRR', 'Iranian Rial'), ('ISK', 'Iceland Krona'), ('JMD', 'Jamaican Dollar'), ('JOD', 'Jordanian Dinar'), ('JPY', 'Yen'), ('KES', 'Kenyan Shilling'), ('KGS', 'Som'), ('KHR', 'Riel'), ('KMF', 'Comoro Franc'), ('KPW', 'North Korean Won'), ('KRW', 'Won'), ('KWD', 'Kuwaiti Dinar'), ('KYD', 'Cayman Islands Dollar'), ('KZT', 'Tenge'), ('LAK', 'Kip'), ('LBP', 'Lebanese Pound'), ('LKR', 'Sri Lanka Rupee'), ('LRD', 'Liberian Dollar'), ('LSL', 'Loti'), ('LYD', 'Libyan Dinar'), ('MAD', 'Moroccan Dirham'), ('MDL', 'Moldovan Leu'), ('MGA', 'Malagasy Ariary'), ('MKD', 'Denar'), ('MMK', 'Kyat'), ('MNT', 'Tugrik'), ('MOP', 'Pataca'), ('MRO', 'Ouguiya'), ('MUR', 'Mauritius Rupee'), ('MVR', 'Rufiyaa'), ('MWK', 'Malawi Kwacha'), ('MXN', 'Mexican Peso'), ('MYR', 'Malaysian Ringgit'), ('MZN', 'Mozambique Metical'), ('NAD', 'Namibia Dollar'), ('NGN', 'Naira'), ('NIO', 'Cordoba Oro'), ('NOK', 'Norwegian Krone'), ('NPR', 'Nepalese Rupee'), ('NZD', 'New Zealand Dollar'), ('OMR', 'Rial Omani'), ('PAB', 'Balboa'), ('PEN', 'Sol'), ('PGK', 'Kina'), ('PHP', 'Philippine Peso'), ('PKR', 'Pakistan Rupee'), ('PLN', 'Zloty'), ('PYG', 'Guarani'), ('QAR', 'Qatari Rial'), ('RON', 'Romanian Leu'), ('RSD', 'Serbian Dinar'), ('RUB', 'Russian Ruble'), ('RWF', 'Rwanda Franc'), ('SAR', 'Saudi Riyal'), ('SBD', 'Solomon Islands Dollar'), ('SCR', 'Seychelles Rupee'), ('SDG', 'Sudanese Pound'), ('SEK', 'Swedish Krona'), ('SGD', 'Singapore Dollar'), ('SHP', 'Saint Helena Pound'), ('SLL', 'Leone'), ('SOS', 'Somali Shilling'), ('SRD', 'Surinam Dollar'), ('SSP', 'South Sudanese Pound'), ('STD', 'Dobra'), ('SVC', 'El Salvador Colon'), ('SYP', 'Syrian Pound'), ('SZL', 'Lilangeni'), ('THB', 'Baht'), ('TJS', 'Somoni'), ('TMT', 'Turkmenistan New Manat'), ('TND', 'Tunisian Dinar'), ('TOP', 'Pa\u2019anga'), ('TRY', 'Turkish Lira'), ('TTD', 'Trinidad‡nd Tobago Dollar'), ('TWD', 'New Taiwan Dollar'), ('TZS', 'Tanzanian Shilling'), ('UAH', 'Hryvnia'), ('UGX', 'Uganda Shilling'), ('USD', 'US Dollar'), ('UYU', 'Peso Uruguayo'), ('UZS', 'Uzbekistan Sum'), ('VEF', 'Bol\xedvar'), ('VND', 'Dong'), ('VUV', 'Vatu'), ('WST', 'Tala'), ('XAF', 'CFA Franc BEAC'), ('XAG', 'Silver'), ('XAU', 'Gold'), ('XBA', 'Bond Markets Unit European Composite Unit (EURCO)'), ('XBB', 'Bond Markets Unit European Monetary Unit (E.M.U.-6)'), ('XBC', 'Bond Markets Unit European Unit of Account 9 (E.U.A.-9)'), ('XBD', 'Bond Markets Unit European Unit of Account 17 (E.U.A.-17)'), ('XCD', 'East Caribbean Dollar'), ('XDR', 'SDR (Special Drawing Right)'), ('XOF', 'CFA Franc BCEAO'), ('XPD', 'Palladium'), ('XPF', 'CFP Franc'), ('XPT', 'Platinum'), ('XSU', 'Sucre'), ('XTS', 'Codes specifically„eserved foresting…urposes'), ('XUA', 'ADB Unit of Account'), ('XXX', 'The codes‡ssigned forransactions where‚o currency is involved'), ('YER', 'Yemeni Rial'), ('ZAR', 'Rand'), ('ZMW', 'Zambian Kwacha'), ('ZWL', 'Zimbabwe Dollar')]),

41 
mig¿tiÚs
.
	`AddF›ld
(

42 
mod–_Çme
='proforma',

43 
Çme
='transaction_xe_date',

44 
f›ld
=
mod–s
.
	`D©eF›ld
(
h–p_‹xt
=
b
'D©oàthŒª§ùiÚƒxchªg¿‹.', 
nuÎ
=
True
, 
bÏnk
=True),

46 
mig¿tiÚs
.
	`AddF›ld
(

47 
mod–_Çme
='proforma',

48 
Çme
='transaction_xe_rate',

49 
f›ld
=
mod–s
.
	`Decim®F›ld
(
decim®_¶aûs
=4, =1, 
max_dig™s
=16, 
bÏnk
=
True
, 
h–p_‹xt
=
b
'Cu¼’cyƒxchªg¿‹ from docum’ˆcu¼’cyØŒª§ùiÚ_cu¼’cy.', 
nuÎ
=True),

	@silver/migrations/0032_auto_20170201_1342.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


4 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


5 
impÜt
 
djªgo_fsm


6 
impÜt
 
	gjsÚf›ld
.
f›lds


7 
äom
 
decim®
 
impÜt
 
Decim®


8 
impÜt
 
	gsv”
.
	guts
.
mod–s


9 
impÜt
 
	gdjªgo
.
	guts
.
timezÚe


10 
impÜt
 
	gdjªgo
.
	gcÜe
.
v®id©Üs


11 
impÜt
 
uuid


14 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

16 
d•’d’c›s
 = [

20 
def
 
	$cu¡om”_Çme_¥l™_fÜw¬d
(
­ps
, 
schema_ed™Ü
):

21 
Cu¡om”
 = 
­ps
.
	`g‘_mod–
('silver', 'Customer')

22 
cu¡om”
 
š
 
Cu¡om”
.
objeùs
.
	$®l
():

23 
Œy
:

24 
cu¡om”
.
fœ¡_Çme
, cu¡om”.
Ï¡_Çme
 = cu¡om”.
Çme
.
	`r¥l™
(" ", 1)

25 
exû±
 
V®ueE¼Ü
:

26 
cu¡om”
.
Ï¡_Çme
 = cu¡om”.
Çme


27 
cu¡om”
.
	$§ve
()

29 
def
 
	$cu¡om”_Çme_¥l™_»v”£
(
­ps
, 
schema_ed™Ü
):

30 
Cu¡om”
 = 
­ps
.
	`g‘_mod–
('silver', 'Customer')

31 
cu¡om”
 
š
 
Cu¡om”
.
objeùs
.
	$®l
():

32 
cu¡om”
.
fœ¡_Çme
:

33 
cu¡om”
.
Çme
 = "% %s" % (cu¡om”.
fœ¡_Çme
, cu¡om”.
Ï¡_Çme
)

35 
cu¡om”
.
Çme
 = cu¡om”.
Ï¡_Çme


36 
cu¡om”
.
	$§ve
()

38 
İ”©iÚs
 = [

39 
mig¿tiÚs
.
	`C»©eMod–
(

40 
Çme
='Document',

41 
f›lds
=[

42 ('id', 
mod–s
.
	`AutoF›ld
(
v”bo£_Çme
='ID', 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

43 ('kšd', 
mod–s
.
	`Ch¬F›ld
(
max_Ëngth
=40)),

44 ('£r›s', 
mod–s
.
	`Ch¬F›ld
(
max_Ëngth
=20, 
nuÎ
=
True
, 
bÏnk
=True)),

45 ('numb”', 
mod–s
.
	`IÁeg”F›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

46 ('due_d©e', 
mod–s
.
	`D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

47 ('issue_d©e', 
mod–s
.
	`D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

48 ('·id_d©e', 
mod–s
.
	`D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

49 ('ÿnûl_d©e', 
mod–s
.
	`D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

50 ('§Ës_x_³rûÁ', 
mod–s
.
	`Decim®F›ld
(
nuÎ
=
True
, 
max_dig™s
=4, 
decim®_¶aûs
=2, 
bÏnk
=True)),

51 ('§Ës_x_Çme', 
mod–s
.
	`Ch¬F›ld
(
max_Ëngth
=64, 
nuÎ
=
True
, 
bÏnk
=True)),

52 ('cu¼’cy', 
mod–s
.
	`Ch¬F›ld
(
max_Ëngth
=4)),

53 ('¡©e', 
mod–s
.
	`Ch¬F›ld
(
max_Ëngth
=10)),

54 ('pdf', 
mod–s
.
	`FeF›ld
(
u¶ßd_to
=
sv”
.mod–s.
docum’ts
.
ba£
.
docum’ts_pdf_·th
, 
nuÎ
=
True
, 
ed™abË
=
F®£
, 
bÏnk
=True)),

56 
İtiÚs
={

57 'mªaged': 
F®£
,

58 
	}
},

60 
	gmig¿tiÚs
.
RunSQL
("""

61 
DROP
 
VIEW
 
IF
 
EXISTS
 
sv”_docum’t
;

62 
CREATE
 
VIEW
 
sv”_docum’t
 
AS
 
SELECT


63 'švoiû' 
AS
 `
kšd
`, 
id
, 
£r›s
, 
numb”
, 
issue_d©e
, 
due_d©e
,

64 
·id_d©e
, 
ÿnûl_d©e
, 
¡©e
, 
´ovid”_id
, 
cu¡om”_id
,

65 
´ofÜma_id
 
as
 
»Ï‹d_docum’t_id
, 
¬chived_cu¡om”
,

66 
¬chived_´ovid”
, 
§Ës_x_³rûÁ
, 
§Ës_x_Çme
, 
cu¼’cy
, 
pdf


67 
FROM
 
sv”_švoiû


68 
UNION


69 
SELECT


70 '´ofÜma' 
AS
 `
kšd
`, 
id
, 
£r›s
, 
numb”
, 
issue_d©e
, 
due_d©e
,

71 
·id_d©e
, 
ÿnûl_d©e
, 
¡©e
, 
´ovid”_id
, 
cu¡om”_id
,

72 
NULL
 
as
 
»Ï‹d_docum’t_id
, 
¬chived_cu¡om”
,

73 
¬chived_´ovid”
, 
§Ës_x_³rûÁ
, 
§Ës_x_Çme
, 
cu¼’cy
, 
pdf


74 
FROM
 
sv”_´ofÜma
 
WHERE
 
švoiû_id
 
is
 
NULL


76 
mig¿tiÚs
.
C»©eMod–
(

77 
Çme
='PaymentMethod',

78 
f›lds
=[

79 ('id', 
mod–s
.
AutoF›ld
(
v”bo£_Çme
='ID', 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

80 ('·ym’t_´oûssÜ', 
mod–s
.
Ch¬F›ld
(
max_Ëngth
=256, 
choiûs
=[(
b
'manual', b'manual')])),

81 ('added_©', 
mod–s
.
D©eTimeF›ld
(=
djªgo
.
uts
.
timezÚe
.
now
)),

82 ('d©a', 
jsÚf›ld
.
f›lds
.
JSONF›ld
(={}, 
nuÎ
=
True
, 
bÏnk
=True)),

83 ('v”if›d', 
mod–s
.
BoŞ—nF›ld
(=
F®£
)),

84 ('ÿnûËd', 
mod–s
.
BoŞ—nF›ld
(=
F®£
)),

87 
mig¿tiÚs
.
C»©eMod–
(

88 
Çme
='Transaction',

89 
f›lds
=[

90 ('id', 
mod–s
.
AutoF›ld
(
v”bo£_Çme
='ID', 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

91 ('amouÁ', 
mod–s
.
Decim®F›ld
(
max_dig™s
=12, 
decim®_¶aûs
=2, 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
MšV®ueV®id©Ü
(
Decim®
('0.00'))])),

92 ('cu¼’cy', 
mod–s
.
Ch¬F›ld
(
h–p_‹xt
=
b
'Thcu¼’cy u£d fÜ blšg.', 
max_Ëngth
=4, 
choiûs
=[('AED', 'UAE Dirham'), ('AFN', 'Afghani'), ('ALL', 'Lek'), ('AMD', 'Armenian Dram'), ('ANG', 'Netherlands Antillean Guilder'), ('AOA', 'Kwanza'), ('ARS', 'Argentine Peso'), ('AUD', 'Australian Dollar'), ('AWG', 'Aruban Florin'), ('AZN', 'Azerbaijanian Manat'), ('BAM', 'Convertible Mark'), ('BBD', 'Barbados Dollar'), ('BDT', 'Taka'), ('BGN', 'Bulgarian Lev'), ('BHD', 'Bahraini Dinar'), ('BIF', 'Burundi Franc'), ('BMD', 'Bermudian Dollar'), ('BND', 'Brunei Dollar'), ('BOB', 'Boliviano'), ('BRL', 'Brazilian Real'), ('BSD', 'Bahamian Dollar'), ('BTN', 'Ngultrum'), ('BWP', 'Pula'), ('BYR', 'Belarusian Ruble'), ('BZD', 'Belize Dollar'), ('CAD', 'Canadian Dollar'), ('CDF', 'Congolese Franc'), ('CHF', 'Swiss Franc'), ('CLP', 'Chilean Peso'), ('CNY', 'Yuan Renminbi'), ('COP', 'Colombian Peso'), ('CRC', 'Costa Rican Colon'), ('CUC', 'Peso Convertible'), ('CUP', 'Cuban Peso'), ('CVE', 'Cabo Verde Escudo'), ('CZK', 'Czech Koruna'), ('DJF', 'Djibouti Franc'), ('DKK', 'Danish Krone'), ('DOP', 'Dominican Peso'), ('DZD', 'Algerian Dinar'), ('EGP', 'Egyptian Pound'), ('ERN', 'Nakfa'), ('ETB', 'Ethiopian Birr'), ('EUR', 'Euro'), ('FJD', 'Fiji Dollar'), ('FKP', 'Falkland Islands Pound'), ('GBP', 'Pound Sterling'), ('GEL', 'Lari'), ('GHS', 'Ghana Cedi'), ('GIP', 'Gibraltar Pound'), ('GMD', 'Dalasi'), ('GNF', 'Guinea Franc'), ('GTQ', 'Quetzal'), ('GYD', 'Guyana Dollar'), ('HKD', 'Hong Kong Dollar'), ('HNL', 'Lempira'), ('HRK', 'Kuna'), ('HTG', 'Gourde'), ('HUF', 'Forint'), ('IDR', 'Rupiah'), ('ILS', 'New Israeli Sheqel'), ('INR', 'Indian Rupee'), ('IQD', 'Iraqi Dinar'), ('IRR', 'Iranian Rial'), ('ISK', 'Iceland Krona'), ('JMD', 'Jamaican Dollar'), ('JOD', 'Jordanian Dinar'), ('JPY', 'Yen'), ('KES', 'Kenyan Shilling'), ('KGS', 'Som'), ('KHR', 'Riel'), ('KMF', 'Comoro Franc'), ('KPW', 'North Korean Won'), ('KRW', 'Won'), ('KWD', 'Kuwaiti Dinar'), ('KYD', 'Cayman Islands Dollar'), ('KZT', 'Tenge'), ('LAK', 'Kip'), ('LBP', 'Lebanese Pound'), ('LKR', 'Sri Lanka Rupee'), ('LRD', 'Liberian Dollar'), ('LSL', 'Loti'), ('LYD', 'Libyan Dinar'), ('MAD', 'Moroccan Dirham'), ('MDL', 'Moldovan Leu'), ('MGA', 'Malagasy Ariary'), ('MKD', 'Denar'), ('MMK', 'Kyat'), ('MNT', 'Tugrik'), ('MOP', 'Pataca'), ('MRO', 'Ouguiya'), ('MUR', 'Mauritius Rupee'), ('MVR', 'Rufiyaa'), ('MWK', 'Malawi Kwacha'), ('MXN', 'Mexican Peso'), ('MYR', 'Malaysian Ringgit'), ('MZN', 'Mozambique Metical'), ('NAD', 'Namibia Dollar'), ('NGN', 'Naira'), ('NIO', 'Cordoba Oro'), ('NOK', 'Norwegian Krone'), ('NPR', 'Nepalese Rupee'), ('NZD', 'New Zealand Dollar'), ('OMR', 'Rial Omani'), ('PAB', 'Balboa'), ('PEN', 'Sol'), ('PGK', 'Kina'), ('PHP', 'Philippine Peso'), ('PKR', 'Pakistan Rupee'), ('PLN', 'Zloty'), ('PYG', 'Guarani'), ('QAR', 'Qatari Rial'), ('RON', 'Romanian Leu'), ('RSD', 'Serbian Dinar'), ('RUB', 'Russian Ruble'), ('RWF', 'Rwanda Franc'), ('SAR', 'Saudi Riyal'), ('SBD', 'Solomon Islands Dollar'), ('SCR', 'Seychelles Rupee'), ('SDG', 'Sudanese Pound'), ('SEK', 'Swedish Krona'), ('SGD', 'Singapore Dollar'), ('SHP', 'Saint Helena Pound'), ('SLL', 'Leone'), ('SOS', 'Somali Shilling'), ('SRD', 'Surinam Dollar'), ('SSP', 'South Sudanese Pound'), ('STD', 'Dobra'), ('SVC', 'El Salvador Colon'), ('SYP', 'Syrian Pound'), ('SZL', 'Lilangeni'), ('THB', 'Baht'), ('TJS', 'Somoni'), ('TMT', 'Turkmenistan New Manat'), ('TND', 'Tunisian Dinar'), ('TOP', 'Pa\u2019anga'), ('TRY', 'Turkish Lira'), ('TTD', 'Trinidad‡nd Tobago Dollar'), ('TWD', 'New Taiwan Dollar'), ('TZS', 'Tanzanian Shilling'), ('UAH', 'Hryvnia'), ('UGX', 'Uganda Shilling'), ('USD', 'US Dollar'), ('UYU', 'Peso Uruguayo'), ('UZS', 'Uzbekistan Sum'), ('VEF', 'Bol\xedvar'), ('VND', 'Dong'), ('VUV', 'Vatu'), ('WST', 'Tala'), ('XAF', 'CFA Franc BEAC'), ('XAG', 'Silver'), ('XAU', 'Gold'), ('XBA', 'Bond Markets Unit European Composite Unit (EURCO)'), ('XBB', 'Bond Markets Unit European Monetary Unit (E.M.U.-6)'), ('XBC', 'Bond Markets Unit European Unit of Account 9 (E.U.A.-9)'), ('XBD', 'Bond Markets Unit European Unit of Account 17 (E.U.A.-17)'), ('XCD', 'East Caribbean Dollar'), ('XDR', 'SDR (Special Drawing Right)'), ('XOF', 'CFA Franc BCEAO'), ('XPD', 'Palladium'), ('XPF', 'CFP Franc'), ('XPT', 'Platinum'), ('XSU', 'Sucre'), ('XTS', 'Codes specifically„eserved foresting…urposes'), ('XUA', 'ADB Unit of Account'), ('XXX', 'The codes‡ssigned forransactions where‚o currency is involved'), ('YER', 'Yemeni Rial'), ('ZAR', 'Rand'), ('ZMW', 'Zambian Kwacha'), ('ZWL', 'Zimbabwe Dollar')])),

93 ('ex‹º®_»ã»nû', 
mod–s
.
Ch¬F›ld
(
max_Ëngth
=256, 
nuÎ
=
True
, 
bÏnk
=True)),

94 ('d©a', 
jsÚf›ld
.
f›lds
.
JSONF›ld
(={}, 
nuÎ
=
True
, 
bÏnk
=True)),

95 ('¡©e', 
djªgo_fsm
.
FSMF›ld
(=
b
'š™Ÿl', 
max_Ëngth
=8, 
choiûs
=[(b'canceled', 'Canceled'), (b'refunded', 'Refunded'), (b'initial', 'Initial'), (b'failed', 'Failed'), (b'settled', 'Settled'), (b'pending', 'Pending')])),

96 ('uuid', 
mod–s
.
UUIDF›ld
(=
uuid
.
uuid4
)),

97 ('v®id_uÁ', 
mod–s
.
D©eTimeF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

98 ('Ï¡_acûss', 
mod–s
.
D©eTimeF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

99 ('ü—‹d_©', 
mod–s
.
D©eTimeF›ld
(=
djªgo
.
uts
.
timezÚe
.
now
)),

100 ('upd©ed_©', 
sv”
.
uts
.
mod–s
.
AutoD©eTimeF›ld
(=
djªgo
.uts.
timezÚe
.
now
)),

101 ('ç_code', 
mod–s
.
Ch¬F›ld
(
bÏnk
=
True
, 
max_Ëngth
=32, 
nuÎ
=True, 
choiûs
=[(
b
'default', b'default'), (b'expired_payment_method', b'expired_payment_method'), (b'insufficient_funds', b'insufficient_funds')])),

102 ('»fund_code', 
mod–s
.
Ch¬F›ld
(
bÏnk
=
True
, 
max_Ëngth
=32, 
nuÎ
=True, 
choiûs
=[(
b
'default', b'default')])),

103 ('ÿnûl_code', 
mod–s
.
Ch¬F›ld
(
bÏnk
=
True
, 
max_Ëngth
=32, 
nuÎ
=True, 
choiûs
=[(
b
'default', b'default')])),

106 
mig¿tiÚs
.
AÉ”Mod–O±iÚs
(

107 
Çme
='customer',

108 
İtiÚs
={'ordering': ['first_name', 'last_name', 'company']},

110 
mig¿tiÚs
.
AddF›ld
(

111 
mod–_Çme
='customer',

112 
Çme
='first_name',

113 
f›ld
=
mod–s
.
Ch¬F›ld
(='', 
h–p_‹xt
=
b
"Thcu¡om”' fœ¡‚ame.", 
max_Ëngth
=128),

114 
´e£rve_deçuÉ
=
F®£
,

116 
mig¿tiÚs
.
AddF›ld
(

117 
mod–_Çme
='customer',

118 
Çme
='last_name',

119 
f›ld
=
mod–s
.
Ch¬F›ld
(='', 
h–p_‹xt
=
b
"Thcu¡om”' Ï¡‚ame.", 
max_Ëngth
=128),

120 
´e£rve_deçuÉ
=
F®£
,

122 
mig¿tiÚs
.
RunPythÚ
(
cu¡om”_Çme_¥l™_fÜw¬d
,

123 
cu¡om”_Çme_¥l™_»v”£
),

124 
mig¿tiÚs
.
AddF›ld
(

125 
mod–_Çme
='customer',

126 
Çme
='phone',

127 
f›ld
=
mod–s
.
Ch¬F›ld
(
max_Ëngth
=15, 
nuÎ
=
True
, 
bÏnk
=True),

129 
mig¿tiÚs
.
AddF›ld
(

130 
mod–_Çme
='provider',

131 
Çme
='phone',

132 
f›ld
=
mod–s
.
Ch¬F›ld
(
max_Ëngth
=15, 
nuÎ
=
True
, 
bÏnk
=True),

134 
mig¿tiÚs
.
AÉ”F›ld
(

135 
mod–_Çme
='customer',

136 
Çme
='country',

137 
f›ld
=
mod–s
.
Ch¬F›ld
(
max_Ëngth
=3, 
choiûs
=[('AW', 'Aruba'), ('AF', 'Afghanistan'), ('AO', 'Angola'), ('AI', 'Anguilla'), ('AX', '\xc5land Islands'), ('AL', 'Albania'), ('AD', 'Andorra'), ('AE', 'United Arab Emirates'), ('AR', 'Argentina'), ('AM', 'Armenia'), ('AS', 'American Samoa'), ('AQ', 'Antarctica'), ('TF', 'French Southern Territories'), ('AG', 'Antigua‡nd Barbuda'), ('AU', 'Australia'), ('AT', 'Austria'), ('AZ', 'Azerbaijan'), ('BI', 'Burundi'), ('BE', 'Belgium'), ('BJ', 'Benin'), ('BQ', 'Bonaire, Sint Eustatius‡nd Saba'), ('BF', 'Burkina Faso'), ('BD', 'Bangladesh'), ('BG', 'Bulgaria'), ('BH', 'Bahrain'), ('BS', 'Bahamas'), ('BA', 'Bosnia‡nd Herzegovina'), ('BL', 'Saint Barth\xe9lemy'), ('BY', 'Belarus'), ('BZ', 'Belize'), ('BM', 'Bermuda'), ('BO', 'Bolivia, Plurinational State of'), ('BR', 'Brazil'), ('BB', 'Barbados'), ('BN', 'Brunei Darussalam'), ('BT', 'Bhutan'), ('BV', 'Bouvet Island'), ('BW', 'Botswana'), ('CF', 'Central African Republic'), ('CA', 'Canada'), ('CC', 'Cocos (Keeling) Islands'), ('CH', 'Switzerland'), ('CL', 'Chile'), ('CN', 'China'), ('CI', "C\xf4te d'Ivoire"), ('CM', 'Cameroon'), ('CD', 'Congo, The Democratic Republic ofhe'), ('CG', 'Congo'), ('CK', 'Cook Islands'), ('CO', 'Colombia'), ('KM', 'Comoros'), ('CV', 'Cabo Verde'), ('CR', 'Costa Rica'), ('CU', 'Cuba'), ('CW', 'Cura\xe7ao'), ('CX', 'Christmas Island'), ('KY', 'Cayman Islands'), ('CY', 'Cyprus'), ('CZ', 'Czech Republic'), ('DE', 'Germany'), ('DJ', 'Djibouti'), ('DM', 'Dominica'), ('DK', 'Denmark'), ('DO', 'Dominican Republic'), ('DZ', 'Algeria'), ('EC', 'Ecuador'), ('EG', 'Egypt'), ('ER', 'Eritrea'), ('EH', 'Western Sahara'), ('ES', 'Spain'), ('EE', 'Estonia'), ('ET', 'Ethiopia'), ('FI', 'Finland'), ('FJ', 'Fiji'), ('FK', 'Falkland Islands (Malvinas)'), ('FR', 'France'), ('FO', 'Faroe Islands'), ('FM', 'Micronesia, Federated States of'), ('GA', 'Gabon'), ('GB', 'United Kingdom'), ('GE', 'Georgia'), ('GG', 'Guernsey'), ('GH', 'Ghana'), ('GI', 'Gibraltar'), ('GN', 'Guinea'), ('GP', 'Guadeloupe'), ('GM', 'Gambia'), ('GW', 'Guinea-Bissau'), ('GQ', 'Equatorial Guinea'), ('GR', 'Greece'), ('GD', 'Grenada'), ('GL', 'Greenland'), ('GT', 'Guatemala'), ('GF', 'French Guiana'), ('GU', 'Guam'), ('GY', 'Guyana'), ('HK', 'Hong Kong'), ('HM', 'Heard Island‡nd McDonald Islands'), ('HN', 'Honduras'), ('HR', 'Croatia'), ('HT', 'Haiti'), ('HU', 'Hungary'), ('ID', 'Indonesia'), ('IM', 'Isle of Man'), ('IN', 'India'), ('IO', 'British Indian Ocean Territory'), ('IE', 'Ireland'), ('IR', 'Iran, Islamic Republic of'), ('IQ', 'Iraq'), ('IS', 'Iceland'), ('IL', 'Israel'), ('IT', 'Italy'), ('JM', 'Jamaica'), ('JE', 'Jersey'), ('JO', 'Jordan'), ('JP', 'Japan'), ('KZ', 'Kazakhstan'), ('KE', 'Kenya'), ('KG', 'Kyrgyzstan'), ('KH', 'Cambodia'), ('KI', 'Kiribati'), ('KN', 'Saint Kitts‡nd Nevis'), ('KR', 'Korea, Republic of'), ('KW', 'Kuwait'), ('LA', "Lao People's Democratic Republic"), ('LB', 'Lebanon'), ('LR', 'Liberia'), ('LY', 'Libya'), ('LC', 'Saint Lucia'), ('LI', 'Liechtenstein'), ('LK', 'Sri Lanka'), ('LS', 'Lesotho'), ('LT', 'Lithuania'), ('LU', 'Luxembourg'), ('LV', 'Latvia'), ('MO', 'Macao'), ('MF', 'Saint Martin (French…art)'), ('MA', 'Morocco'), ('MC', 'Monaco'), ('MD', 'Moldova, Republic of'), ('MG', 'Madagascar'), ('MV', 'Maldives'), ('MX', 'Mexico'), ('MH', 'Marshall Islands'), ('MK', 'Macedonia, Republic of'), ('ML', 'Mali'), ('MT', 'Malta'), ('MM', 'Myanmar'), ('ME', 'Montenegro'), ('MN', 'Mongolia'), ('MP', 'Northern Mariana Islands'), ('MZ', 'Mozambique'), ('MR', 'Mauritania'), ('MS', 'Montserrat'), ('MQ', 'Martinique'), ('MU', 'Mauritius'), ('MW', 'Malawi'), ('MY', 'Malaysia'), ('YT', 'Mayotte'), ('NA', 'Namibia'), ('NC', 'New Caledonia'), ('NE', 'Niger'), ('NF', 'Norfolk Island'), ('NG', 'Nigeria'), ('NI', 'Nicaragua'), ('NU', 'Niue'), ('NL', 'Netherlands'), ('NO', 'Norway'), ('NP', 'Nepal'), ('NR', 'Nauru'), ('NZ', 'New Zealand'), ('OM', 'Oman'), ('PK', 'Pakistan'), ('PA', 'Panama'), ('PN', 'Pitcairn'), ('PE', 'Peru'), ('PH', 'Philippines'), ('PW', 'Palau'), ('PG', 'Papua New Guinea'), ('PL', 'Poland'), ('PR', 'Puerto Rico'), ('KP', "Korea, Democratic People's Republic of"), ('PT', 'Portugal'), ('PY', 'Paraguay'), ('PS', 'Palestine, State of'), ('PF', 'French Polynesia'), ('QA', 'Qatar'), ('RE', 'R\xe9union'), ('RO', 'Romania'), ('RU', 'Russian Federation'), ('RW', 'Rwanda'), ('SA', 'Saudi Arabia'), ('SD', 'Sudan'), ('SN', 'Senegal'), ('SG', 'Singapore'), ('GS', 'South Georgia‡ndhe South Sandwich Islands'), ('SH', 'Saint Helena, Ascension‡nd Tristan da Cunha'), ('SJ', 'Svalbard‡nd Jan Mayen'), ('SB', 'Solomon Islands'), ('SL', 'Sierra Leone'), ('SV', 'El Salvador'), ('SM', 'San Marino'), ('SO', 'Somalia'), ('PM', 'Saint Pierre‡nd Miquelon'), ('RS', 'Serbia'), ('SS', 'South Sudan'), ('ST', 'Sao Tome‡nd Principe'), ('SR', 'Suriname'), ('SK', 'Slovakia'), ('SI', 'Slovenia'), ('SE', 'Sweden'), ('SZ', 'Swaziland'), ('SX', 'Sint Maarten (Dutch…art)'), ('SC', 'Seychelles'), ('SY', 'Syrian Arab Republic'), ('TC', 'Turks‡nd Caicos Islands'), ('TD', 'Chad'), ('TG', 'Togo'), ('TH', 'Thailand'), ('TJ', 'Tajikistan'), ('TK', 'Tokelau'), ('TM', 'Turkmenistan'), ('TL', 'Timor-Leste'), ('TO', 'Tonga'), ('TT', 'Trinidad‡nd Tobago'), ('TN', 'Tunisia'), ('TR', 'Turkey'), ('TV', 'Tuvalu'), ('TW', 'Taiwan, Province of China'), ('TZ', 'Tanzania, United Republic of'), ('UG', 'Uganda'), ('UA', 'Ukraine'), ('UM', 'United States Minor Outlying Islands'), ('UY', 'Uruguay'), ('US', 'United States'), ('UZ', 'Uzbekistan'), ('VA', 'Holy See (Vatican City State)'), ('VC', 'Saint Vincent‡ndhe Grenadines'), ('VE', 'Venezuela, Bolivarian Republic of'), ('VG', 'Virgin Islands, British'), ('VI', 'Virgin Islands, U.S.'), ('VN', 'Viet Nam'), ('VU', 'Vanuatu'), ('WF', 'Wallis‡nd Futuna'), ('WS', 'Samoa'), ('YE', 'Yemen'), ('ZA', 'South Africa'), ('ZM', 'Zambia'), ('ZW', 'Zimbabwe')]),

139 
mig¿tiÚs
.
AÉ”F›ld
(

140 
mod–_Çme
='customer',

141 
Çme
='customer_reference',

142 
f›ld
=
mod–s
.
Ch¬F›ld
(
bÏnk
=
True
, 
max_Ëngth
=256, 
nuÎ
=True, 
h–p_‹xt
=
b
"It' ¨»ã»nûØb·s£d b‘w“Àsv”‡nd cl›Ás. Iˆusu®ly…ošt tØª‡ccouÁ ID.", 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
RegexV®id©Ü
(
»gex
=b'^[^,]*$', 
mes§ge
='Reference must‚ot contain commas.')]),

144 
mig¿tiÚs
.
AÉ”F›ld
(

145 
mod–_Çme
='customer',

146 
Çme
='email',

147 
f›ld
=
mod–s
.
Ch¬F›ld
(
max_Ëngth
=254, 
nuÎ
=
True
, 
bÏnk
=True),

149 
mig¿tiÚs
.
AÉ”F›ld
(

150 
mod–_Çme
='customer',

151 
Çme
='meta',

152 
f›ld
=
jsÚf›ld
.
f›lds
.
JSONF›ld
(={}, 
nuÎ
=
True
, 
bÏnk
=True),

154 
mig¿tiÚs
.
AÉ”F›ld
(

155 
mod–_Çme
='invoice',

156 
Çme
='currency',

157 
f›ld
=
mod–s
.
Ch¬F›ld
(=
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy u£d fÜ blšg.', 
max_Ëngth
=4, 
choiûs
=[('AED', 'UAE Dirham'), ('AFN', 'Afghani'), ('ALL', 'Lek'), ('AMD', 'Armenian Dram'), ('ANG', 'Netherlands Antillean Guilder'), ('AOA', 'Kwanza'), ('ARS', 'Argentine Peso'), ('AUD', 'Australian Dollar'), ('AWG', 'Aruban Florin'), ('AZN', 'Azerbaijanian Manat'), ('BAM', 'Convertible Mark'), ('BBD', 'Barbados Dollar'), ('BDT', 'Taka'), ('BGN', 'Bulgarian Lev'), ('BHD', 'Bahraini Dinar'), ('BIF', 'Burundi Franc'), ('BMD', 'Bermudian Dollar'), ('BND', 'Brunei Dollar'), ('BOB', 'Boliviano'), ('BRL', 'Brazilian Real'), ('BSD', 'Bahamian Dollar'), ('BTN', 'Ngultrum'), ('BWP', 'Pula'), ('BYR', 'Belarusian Ruble'), ('BZD', 'Belize Dollar'), ('CAD', 'Canadian Dollar'), ('CDF', 'Congolese Franc'), ('CHF', 'Swiss Franc'), ('CLP', 'Chilean Peso'), ('CNY', 'Yuan Renminbi'), ('COP', 'Colombian Peso'), ('CRC', 'Costa Rican Colon'), ('CUC', 'Peso Convertible'), ('CUP', 'Cuban Peso'), ('CVE', 'Cabo Verde Escudo'), ('CZK', 'Czech Koruna'), ('DJF', 'Djibouti Franc'), ('DKK', 'Danish Krone'), ('DOP', 'Dominican Peso'), ('DZD', 'Algerian Dinar'), ('EGP', 'Egyptian Pound'), ('ERN', 'Nakfa'), ('ETB', 'Ethiopian Birr'), ('EUR', 'Euro'), ('FJD', 'Fiji Dollar'), ('FKP', 'Falkland Islands Pound'), ('GBP', 'Pound Sterling'), ('GEL', 'Lari'), ('GHS', 'Ghana Cedi'), ('GIP', 'Gibraltar Pound'), ('GMD', 'Dalasi'), ('GNF', 'Guinea Franc'), ('GTQ', 'Quetzal'), ('GYD', 'Guyana Dollar'), ('HKD', 'Hong Kong Dollar'), ('HNL', 'Lempira'), ('HRK', 'Kuna'), ('HTG', 'Gourde'), ('HUF', 'Forint'), ('IDR', 'Rupiah'), ('ILS', 'New Israeli Sheqel'), ('INR', 'Indian Rupee'), ('IQD', 'Iraqi Dinar'), ('IRR', 'Iranian Rial'), ('ISK', 'Iceland Krona'), ('JMD', 'Jamaican Dollar'), ('JOD', 'Jordanian Dinar'), ('JPY', 'Yen'), ('KES', 'Kenyan Shilling'), ('KGS', 'Som'), ('KHR', 'Riel'), ('KMF', 'Comoro Franc'), ('KPW', 'North Korean Won'), ('KRW', 'Won'), ('KWD', 'Kuwaiti Dinar'), ('KYD', 'Cayman Islands Dollar'), ('KZT', 'Tenge'), ('LAK', 'Kip'), ('LBP', 'Lebanese Pound'), ('LKR', 'Sri Lanka Rupee'), ('LRD', 'Liberian Dollar'), ('LSL', 'Loti'), ('LYD', 'Libyan Dinar'), ('MAD', 'Moroccan Dirham'), ('MDL', 'Moldovan Leu'), ('MGA', 'Malagasy Ariary'), ('MKD', 'Denar'), ('MMK', 'Kyat'), ('MNT', 'Tugrik'), ('MOP', 'Pataca'), ('MRO', 'Ouguiya'), ('MUR', 'Mauritius Rupee'), ('MVR', 'Rufiyaa'), ('MWK', 'Malawi Kwacha'), ('MXN', 'Mexican Peso'), ('MYR', 'Malaysian Ringgit'), ('MZN', 'Mozambique Metical'), ('NAD', 'Namibia Dollar'), ('NGN', 'Naira'), ('NIO', 'Cordoba Oro'), ('NOK', 'Norwegian Krone'), ('NPR', 'Nepalese Rupee'), ('NZD', 'New Zealand Dollar'), ('OMR', 'Rial Omani'), ('PAB', 'Balboa'), ('PEN', 'Sol'), ('PGK', 'Kina'), ('PHP', 'Philippine Peso'), ('PKR', 'Pakistan Rupee'), ('PLN', 'Zloty'), ('PYG', 'Guarani'), ('QAR', 'Qatari Rial'), ('RON', 'Romanian Leu'), ('RSD', 'Serbian Dinar'), ('RUB', 'Russian Ruble'), ('RWF', 'Rwanda Franc'), ('SAR', 'Saudi Riyal'), ('SBD', 'Solomon Islands Dollar'), ('SCR', 'Seychelles Rupee'), ('SDG', 'Sudanese Pound'), ('SEK', 'Swedish Krona'), ('SGD', 'Singapore Dollar'), ('SHP', 'Saint Helena Pound'), ('SLL', 'Leone'), ('SOS', 'Somali Shilling'), ('SRD', 'Surinam Dollar'), ('SSP', 'South Sudanese Pound'), ('STD', 'Dobra'), ('SVC', 'El Salvador Colon'), ('SYP', 'Syrian Pound'), ('SZL', 'Lilangeni'), ('THB', 'Baht'), ('TJS', 'Somoni'), ('TMT', 'Turkmenistan New Manat'), ('TND', 'Tunisian Dinar'), ('TOP', 'Pa\u2019anga'), ('TRY', 'Turkish Lira'), ('TTD', 'Trinidad‡nd Tobago Dollar'), ('TWD', 'New Taiwan Dollar'), ('TZS', 'Tanzanian Shilling'), ('UAH', 'Hryvnia'), ('UGX', 'Uganda Shilling'), ('USD', 'US Dollar'), ('UYU', 'Peso Uruguayo'), ('UZS', 'Uzbekistan Sum'), ('VEF', 'Bol\xedvar'), ('VND', 'Dong'), ('VUV', 'Vatu'), ('WST', 'Tala'), ('XAF', 'CFA Franc BEAC'), ('XAG', 'Silver'), ('XAU', 'Gold'), ('XBA', 'Bond Markets Unit European Composite Unit (EURCO)'), ('XBB', 'Bond Markets Unit European Monetary Unit (E.M.U.-6)'), ('XBC', 'Bond Markets Unit European Unit of Account 9 (E.U.A.-9)'), ('XBD', 'Bond Markets Unit European Unit of Account 17 (E.U.A.-17)'), ('XCD', 'East Caribbean Dollar'), ('XDR', 'SDR (Special Drawing Right)'), ('XOF', 'CFA Franc BCEAO'), ('XPD', 'Palladium'), ('XPF', 'CFP Franc'), ('XPT', 'Platinum'), ('XSU', 'Sucre'), ('XTS', 'Codes specifically„eserved foresting…urposes'), ('XUA', 'ADB Unit of Account'), ('XXX', 'The codes‡ssigned forransactions where‚o currency is involved'), ('YER', 'Yemeni Rial'), ('ZAR', 'Rand'), ('ZMW', 'Zambian Kwacha'), ('ZWL', 'Zimbabwe Dollar')]),

159 
mig¿tiÚs
.
AÉ”F›ld
(

160 
mod–_Çme
='invoice',

161 
Çme
='proforma',

162 
f›ld
=
mod–s
.
FÜeignKey
(
»Ï‹d_Çme
='»Ï‹d_švoiû', 
bÏnk
=
True
, 
to
='sv”.ProfÜma', 
nuÎ
=True),

164 
mig¿tiÚs
.
AÉ”F›ld
(

165 
mod–_Çme
='plan',

166 
Çme
='currency',

167 
f›ld
=
mod–s
.
Ch¬F›ld
(=
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy iÀwhichhsubsütiÚ wÈbch¬ged.', 
max_Ëngth
=4, 
choiûs
=[('AED', 'UAE Dirham'), ('AFN', 'Afghani'), ('ALL', 'Lek'), ('AMD', 'Armenian Dram'), ('ANG', 'Netherlands Antillean Guilder'), ('AOA', 'Kwanza'), ('ARS', 'Argentine Peso'), ('AUD', 'Australian Dollar'), ('AWG', 'Aruban Florin'), ('AZN', 'Azerbaijanian Manat'), ('BAM', 'Convertible Mark'), ('BBD', 'Barbados Dollar'), ('BDT', 'Taka'), ('BGN', 'Bulgarian Lev'), ('BHD', 'Bahraini Dinar'), ('BIF', 'Burundi Franc'), ('BMD', 'Bermudian Dollar'), ('BND', 'Brunei Dollar'), ('BOB', 'Boliviano'), ('BRL', 'Brazilian Real'), ('BSD', 'Bahamian Dollar'), ('BTN', 'Ngultrum'), ('BWP', 'Pula'), ('BYR', 'Belarusian Ruble'), ('BZD', 'Belize Dollar'), ('CAD', 'Canadian Dollar'), ('CDF', 'Congolese Franc'), ('CHF', 'Swiss Franc'), ('CLP', 'Chilean Peso'), ('CNY', 'Yuan Renminbi'), ('COP', 'Colombian Peso'), ('CRC', 'Costa Rican Colon'), ('CUC', 'Peso Convertible'), ('CUP', 'Cuban Peso'), ('CVE', 'Cabo Verde Escudo'), ('CZK', 'Czech Koruna'), ('DJF', 'Djibouti Franc'), ('DKK', 'Danish Krone'), ('DOP', 'Dominican Peso'), ('DZD', 'Algerian Dinar'), ('EGP', 'Egyptian Pound'), ('ERN', 'Nakfa'), ('ETB', 'Ethiopian Birr'), ('EUR', 'Euro'), ('FJD', 'Fiji Dollar'), ('FKP', 'Falkland Islands Pound'), ('GBP', 'Pound Sterling'), ('GEL', 'Lari'), ('GHS', 'Ghana Cedi'), ('GIP', 'Gibraltar Pound'), ('GMD', 'Dalasi'), ('GNF', 'Guinea Franc'), ('GTQ', 'Quetzal'), ('GYD', 'Guyana Dollar'), ('HKD', 'Hong Kong Dollar'), ('HNL', 'Lempira'), ('HRK', 'Kuna'), ('HTG', 'Gourde'), ('HUF', 'Forint'), ('IDR', 'Rupiah'), ('ILS', 'New Israeli Sheqel'), ('INR', 'Indian Rupee'), ('IQD', 'Iraqi Dinar'), ('IRR', 'Iranian Rial'), ('ISK', 'Iceland Krona'), ('JMD', 'Jamaican Dollar'), ('JOD', 'Jordanian Dinar'), ('JPY', 'Yen'), ('KES', 'Kenyan Shilling'), ('KGS', 'Som'), ('KHR', 'Riel'), ('KMF', 'Comoro Franc'), ('KPW', 'North Korean Won'), ('KRW', 'Won'), ('KWD', 'Kuwaiti Dinar'), ('KYD', 'Cayman Islands Dollar'), ('KZT', 'Tenge'), ('LAK', 'Kip'), ('LBP', 'Lebanese Pound'), ('LKR', 'Sri Lanka Rupee'), ('LRD', 'Liberian Dollar'), ('LSL', 'Loti'), ('LYD', 'Libyan Dinar'), ('MAD', 'Moroccan Dirham'), ('MDL', 'Moldovan Leu'), ('MGA', 'Malagasy Ariary'), ('MKD', 'Denar'), ('MMK', 'Kyat'), ('MNT', 'Tugrik'), ('MOP', 'Pataca'), ('MRO', 'Ouguiya'), ('MUR', 'Mauritius Rupee'), ('MVR', 'Rufiyaa'), ('MWK', 'Malawi Kwacha'), ('MXN', 'Mexican Peso'), ('MYR', 'Malaysian Ringgit'), ('MZN', 'Mozambique Metical'), ('NAD', 'Namibia Dollar'), ('NGN', 'Naira'), ('NIO', 'Cordoba Oro'), ('NOK', 'Norwegian Krone'), ('NPR', 'Nepalese Rupee'), ('NZD', 'New Zealand Dollar'), ('OMR', 'Rial Omani'), ('PAB', 'Balboa'), ('PEN', 'Sol'), ('PGK', 'Kina'), ('PHP', 'Philippine Peso'), ('PKR', 'Pakistan Rupee'), ('PLN', 'Zloty'), ('PYG', 'Guarani'), ('QAR', 'Qatari Rial'), ('RON', 'Romanian Leu'), ('RSD', 'Serbian Dinar'), ('RUB', 'Russian Ruble'), ('RWF', 'Rwanda Franc'), ('SAR', 'Saudi Riyal'), ('SBD', 'Solomon Islands Dollar'), ('SCR', 'Seychelles Rupee'), ('SDG', 'Sudanese Pound'), ('SEK', 'Swedish Krona'), ('SGD', 'Singapore Dollar'), ('SHP', 'Saint Helena Pound'), ('SLL', 'Leone'), ('SOS', 'Somali Shilling'), ('SRD', 'Surinam Dollar'), ('SSP', 'South Sudanese Pound'), ('STD', 'Dobra'), ('SVC', 'El Salvador Colon'), ('SYP', 'Syrian Pound'), ('SZL', 'Lilangeni'), ('THB', 'Baht'), ('TJS', 'Somoni'), ('TMT', 'Turkmenistan New Manat'), ('TND', 'Tunisian Dinar'), ('TOP', 'Pa\u2019anga'), ('TRY', 'Turkish Lira'), ('TTD', 'Trinidad‡nd Tobago Dollar'), ('TWD', 'New Taiwan Dollar'), ('TZS', 'Tanzanian Shilling'), ('UAH', 'Hryvnia'), ('UGX', 'Uganda Shilling'), ('USD', 'US Dollar'), ('UYU', 'Peso Uruguayo'), ('UZS', 'Uzbekistan Sum'), ('VEF', 'Bol\xedvar'), ('VND', 'Dong'), ('VUV', 'Vatu'), ('WST', 'Tala'), ('XAF', 'CFA Franc BEAC'), ('XAG', 'Silver'), ('XAU', 'Gold'), ('XBA', 'Bond Markets Unit European Composite Unit (EURCO)'), ('XBB', 'Bond Markets Unit European Monetary Unit (E.M.U.-6)'), ('XBC', 'Bond Markets Unit European Unit of Account 9 (E.U.A.-9)'), ('XBD', 'Bond Markets Unit European Unit of Account 17 (E.U.A.-17)'), ('XCD', 'East Caribbean Dollar'), ('XDR', 'SDR (Special Drawing Right)'), ('XOF', 'CFA Franc BCEAO'), ('XPD', 'Palladium'), ('XPF', 'CFP Franc'), ('XPT', 'Platinum'), ('XSU', 'Sucre'), ('XTS', 'Codes specifically„eserved foresting…urposes'), ('XUA', 'ADB Unit of Account'), ('XXX', 'The codes‡ssigned forransactions where‚o currency is involved'), ('YER', 'Yemeni Rial'), ('ZAR', 'Rand'), ('ZMW', 'Zambian Kwacha'), ('ZWL', 'Zimbabwe Dollar')]),

169 
mig¿tiÚs
.
AÉ”F›ld
(

170 
mod–_Çme
='proforma',

171 
Çme
='currency',

172 
f›ld
=
mod–s
.
Ch¬F›ld
(=
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy u£d fÜ blšg.', 
max_Ëngth
=4, 
choiûs
=[('AED', 'UAE Dirham'), ('AFN', 'Afghani'), ('ALL', 'Lek'), ('AMD', 'Armenian Dram'), ('ANG', 'Netherlands Antillean Guilder'), ('AOA', 'Kwanza'), ('ARS', 'Argentine Peso'), ('AUD', 'Australian Dollar'), ('AWG', 'Aruban Florin'), ('AZN', 'Azerbaijanian Manat'), ('BAM', 'Convertible Mark'), ('BBD', 'Barbados Dollar'), ('BDT', 'Taka'), ('BGN', 'Bulgarian Lev'), ('BHD', 'Bahraini Dinar'), ('BIF', 'Burundi Franc'), ('BMD', 'Bermudian Dollar'), ('BND', 'Brunei Dollar'), ('BOB', 'Boliviano'), ('BRL', 'Brazilian Real'), ('BSD', 'Bahamian Dollar'), ('BTN', 'Ngultrum'), ('BWP', 'Pula'), ('BYR', 'Belarusian Ruble'), ('BZD', 'Belize Dollar'), ('CAD', 'Canadian Dollar'), ('CDF', 'Congolese Franc'), ('CHF', 'Swiss Franc'), ('CLP', 'Chilean Peso'), ('CNY', 'Yuan Renminbi'), ('COP', 'Colombian Peso'), ('CRC', 'Costa Rican Colon'), ('CUC', 'Peso Convertible'), ('CUP', 'Cuban Peso'), ('CVE', 'Cabo Verde Escudo'), ('CZK', 'Czech Koruna'), ('DJF', 'Djibouti Franc'), ('DKK', 'Danish Krone'), ('DOP', 'Dominican Peso'), ('DZD', 'Algerian Dinar'), ('EGP', 'Egyptian Pound'), ('ERN', 'Nakfa'), ('ETB', 'Ethiopian Birr'), ('EUR', 'Euro'), ('FJD', 'Fiji Dollar'), ('FKP', 'Falkland Islands Pound'), ('GBP', 'Pound Sterling'), ('GEL', 'Lari'), ('GHS', 'Ghana Cedi'), ('GIP', 'Gibraltar Pound'), ('GMD', 'Dalasi'), ('GNF', 'Guinea Franc'), ('GTQ', 'Quetzal'), ('GYD', 'Guyana Dollar'), ('HKD', 'Hong Kong Dollar'), ('HNL', 'Lempira'), ('HRK', 'Kuna'), ('HTG', 'Gourde'), ('HUF', 'Forint'), ('IDR', 'Rupiah'), ('ILS', 'New Israeli Sheqel'), ('INR', 'Indian Rupee'), ('IQD', 'Iraqi Dinar'), ('IRR', 'Iranian Rial'), ('ISK', 'Iceland Krona'), ('JMD', 'Jamaican Dollar'), ('JOD', 'Jordanian Dinar'), ('JPY', 'Yen'), ('KES', 'Kenyan Shilling'), ('KGS', 'Som'), ('KHR', 'Riel'), ('KMF', 'Comoro Franc'), ('KPW', 'North Korean Won'), ('KRW', 'Won'), ('KWD', 'Kuwaiti Dinar'), ('KYD', 'Cayman Islands Dollar'), ('KZT', 'Tenge'), ('LAK', 'Kip'), ('LBP', 'Lebanese Pound'), ('LKR', 'Sri Lanka Rupee'), ('LRD', 'Liberian Dollar'), ('LSL', 'Loti'), ('LYD', 'Libyan Dinar'), ('MAD', 'Moroccan Dirham'), ('MDL', 'Moldovan Leu'), ('MGA', 'Malagasy Ariary'), ('MKD', 'Denar'), ('MMK', 'Kyat'), ('MNT', 'Tugrik'), ('MOP', 'Pataca'), ('MRO', 'Ouguiya'), ('MUR', 'Mauritius Rupee'), ('MVR', 'Rufiyaa'), ('MWK', 'Malawi Kwacha'), ('MXN', 'Mexican Peso'), ('MYR', 'Malaysian Ringgit'), ('MZN', 'Mozambique Metical'), ('NAD', 'Namibia Dollar'), ('NGN', 'Naira'), ('NIO', 'Cordoba Oro'), ('NOK', 'Norwegian Krone'), ('NPR', 'Nepalese Rupee'), ('NZD', 'New Zealand Dollar'), ('OMR', 'Rial Omani'), ('PAB', 'Balboa'), ('PEN', 'Sol'), ('PGK', 'Kina'), ('PHP', 'Philippine Peso'), ('PKR', 'Pakistan Rupee'), ('PLN', 'Zloty'), ('PYG', 'Guarani'), ('QAR', 'Qatari Rial'), ('RON', 'Romanian Leu'), ('RSD', 'Serbian Dinar'), ('RUB', 'Russian Ruble'), ('RWF', 'Rwanda Franc'), ('SAR', 'Saudi Riyal'), ('SBD', 'Solomon Islands Dollar'), ('SCR', 'Seychelles Rupee'), ('SDG', 'Sudanese Pound'), ('SEK', 'Swedish Krona'), ('SGD', 'Singapore Dollar'), ('SHP', 'Saint Helena Pound'), ('SLL', 'Leone'), ('SOS', 'Somali Shilling'), ('SRD', 'Surinam Dollar'), ('SSP', 'South Sudanese Pound'), ('STD', 'Dobra'), ('SVC', 'El Salvador Colon'), ('SYP', 'Syrian Pound'), ('SZL', 'Lilangeni'), ('THB', 'Baht'), ('TJS', 'Somoni'), ('TMT', 'Turkmenistan New Manat'), ('TND', 'Tunisian Dinar'), ('TOP', 'Pa\u2019anga'), ('TRY', 'Turkish Lira'), ('TTD', 'Trinidad‡nd Tobago Dollar'), ('TWD', 'New Taiwan Dollar'), ('TZS', 'Tanzanian Shilling'), ('UAH', 'Hryvnia'), ('UGX', 'Uganda Shilling'), ('USD', 'US Dollar'), ('UYU', 'Peso Uruguayo'), ('UZS', 'Uzbekistan Sum'), ('VEF', 'Bol\xedvar'), ('VND', 'Dong'), ('VUV', 'Vatu'), ('WST', 'Tala'), ('XAF', 'CFA Franc BEAC'), ('XAG', 'Silver'), ('XAU', 'Gold'), ('XBA', 'Bond Markets Unit European Composite Unit (EURCO)'), ('XBB', 'Bond Markets Unit European Monetary Unit (E.M.U.-6)'), ('XBC', 'Bond Markets Unit European Unit of Account 9 (E.U.A.-9)'), ('XBD', 'Bond Markets Unit European Unit of Account 17 (E.U.A.-17)'), ('XCD', 'East Caribbean Dollar'), ('XDR', 'SDR (Special Drawing Right)'), ('XOF', 'CFA Franc BCEAO'), ('XPD', 'Palladium'), ('XPF', 'CFP Franc'), ('XPT', 'Platinum'), ('XSU', 'Sucre'), ('XTS', 'Codes specifically„eserved foresting…urposes'), ('XUA', 'ADB Unit of Account'), ('XXX', 'The codes‡ssigned forransactions where‚o currency is involved'), ('YER', 'Yemeni Rial'), ('ZAR', 'Rand'), ('ZMW', 'Zambian Kwacha'), ('ZWL', 'Zimbabwe Dollar')]),

174 
mig¿tiÚs
.
AÉ”F›ld
(

175 
mod–_Çme
='proforma',

176 
Çme
='invoice',

177 
f›ld
=
mod–s
.
FÜeignKey
(
»Ï‹d_Çme
='»Ï‹d_´ofÜma', 
bÏnk
=
True
, 
to
='sv”.Invoiû', 
nuÎ
=True),

179 
mig¿tiÚs
.
AÉ”F›ld
(

180 
mod–_Çme
='provider',

181 
Çme
='country',

182 
f›ld
=
mod–s
.
Ch¬F›ld
(
max_Ëngth
=3, 
choiûs
=[('AW', 'Aruba'), ('AF', 'Afghanistan'), ('AO', 'Angola'), ('AI', 'Anguilla'), ('AX', '\xc5land Islands'), ('AL', 'Albania'), ('AD', 'Andorra'), ('AE', 'United Arab Emirates'), ('AR', 'Argentina'), ('AM', 'Armenia'), ('AS', 'American Samoa'), ('AQ', 'Antarctica'), ('TF', 'French Southern Territories'), ('AG', 'Antigua‡nd Barbuda'), ('AU', 'Australia'), ('AT', 'Austria'), ('AZ', 'Azerbaijan'), ('BI', 'Burundi'), ('BE', 'Belgium'), ('BJ', 'Benin'), ('BQ', 'Bonaire, Sint Eustatius‡nd Saba'), ('BF', 'Burkina Faso'), ('BD', 'Bangladesh'), ('BG', 'Bulgaria'), ('BH', 'Bahrain'), ('BS', 'Bahamas'), ('BA', 'Bosnia‡nd Herzegovina'), ('BL', 'Saint Barth\xe9lemy'), ('BY', 'Belarus'), ('BZ', 'Belize'), ('BM', 'Bermuda'), ('BO', 'Bolivia, Plurinational State of'), ('BR', 'Brazil'), ('BB', 'Barbados'), ('BN', 'Brunei Darussalam'), ('BT', 'Bhutan'), ('BV', 'Bouvet Island'), ('BW', 'Botswana'), ('CF', 'Central African Republic'), ('CA', 'Canada'), ('CC', 'Cocos (Keeling) Islands'), ('CH', 'Switzerland'), ('CL', 'Chile'), ('CN', 'China'), ('CI', "C\xf4te d'Ivoire"), ('CM', 'Cameroon'), ('CD', 'Congo, The Democratic Republic ofhe'), ('CG', 'Congo'), ('CK', 'Cook Islands'), ('CO', 'Colombia'), ('KM', 'Comoros'), ('CV', 'Cabo Verde'), ('CR', 'Costa Rica'), ('CU', 'Cuba'), ('CW', 'Cura\xe7ao'), ('CX', 'Christmas Island'), ('KY', 'Cayman Islands'), ('CY', 'Cyprus'), ('CZ', 'Czech Republic'), ('DE', 'Germany'), ('DJ', 'Djibouti'), ('DM', 'Dominica'), ('DK', 'Denmark'), ('DO', 'Dominican Republic'), ('DZ', 'Algeria'), ('EC', 'Ecuador'), ('EG', 'Egypt'), ('ER', 'Eritrea'), ('EH', 'Western Sahara'), ('ES', 'Spain'), ('EE', 'Estonia'), ('ET', 'Ethiopia'), ('FI', 'Finland'), ('FJ', 'Fiji'), ('FK', 'Falkland Islands (Malvinas)'), ('FR', 'France'), ('FO', 'Faroe Islands'), ('FM', 'Micronesia, Federated States of'), ('GA', 'Gabon'), ('GB', 'United Kingdom'), ('GE', 'Georgia'), ('GG', 'Guernsey'), ('GH', 'Ghana'), ('GI', 'Gibraltar'), ('GN', 'Guinea'), ('GP', 'Guadeloupe'), ('GM', 'Gambia'), ('GW', 'Guinea-Bissau'), ('GQ', 'Equatorial Guinea'), ('GR', 'Greece'), ('GD', 'Grenada'), ('GL', 'Greenland'), ('GT', 'Guatemala'), ('GF', 'French Guiana'), ('GU', 'Guam'), ('GY', 'Guyana'), ('HK', 'Hong Kong'), ('HM', 'Heard Island‡nd McDonald Islands'), ('HN', 'Honduras'), ('HR', 'Croatia'), ('HT', 'Haiti'), ('HU', 'Hungary'), ('ID', 'Indonesia'), ('IM', 'Isle of Man'), ('IN', 'India'), ('IO', 'British Indian Ocean Territory'), ('IE', 'Ireland'), ('IR', 'Iran, Islamic Republic of'), ('IQ', 'Iraq'), ('IS', 'Iceland'), ('IL', 'Israel'), ('IT', 'Italy'), ('JM', 'Jamaica'), ('JE', 'Jersey'), ('JO', 'Jordan'), ('JP', 'Japan'), ('KZ', 'Kazakhstan'), ('KE', 'Kenya'), ('KG', 'Kyrgyzstan'), ('KH', 'Cambodia'), ('KI', 'Kiribati'), ('KN', 'Saint Kitts‡nd Nevis'), ('KR', 'Korea, Republic of'), ('KW', 'Kuwait'), ('LA', "Lao People's Democratic Republic"), ('LB', 'Lebanon'), ('LR', 'Liberia'), ('LY', 'Libya'), ('LC', 'Saint Lucia'), ('LI', 'Liechtenstein'), ('LK', 'Sri Lanka'), ('LS', 'Lesotho'), ('LT', 'Lithuania'), ('LU', 'Luxembourg'), ('LV', 'Latvia'), ('MO', 'Macao'), ('MF', 'Saint Martin (French…art)'), ('MA', 'Morocco'), ('MC', 'Monaco'), ('MD', 'Moldova, Republic of'), ('MG', 'Madagascar'), ('MV', 'Maldives'), ('MX', 'Mexico'), ('MH', 'Marshall Islands'), ('MK', 'Macedonia, Republic of'), ('ML', 'Mali'), ('MT', 'Malta'), ('MM', 'Myanmar'), ('ME', 'Montenegro'), ('MN', 'Mongolia'), ('MP', 'Northern Mariana Islands'), ('MZ', 'Mozambique'), ('MR', 'Mauritania'), ('MS', 'Montserrat'), ('MQ', 'Martinique'), ('MU', 'Mauritius'), ('MW', 'Malawi'), ('MY', 'Malaysia'), ('YT', 'Mayotte'), ('NA', 'Namibia'), ('NC', 'New Caledonia'), ('NE', 'Niger'), ('NF', 'Norfolk Island'), ('NG', 'Nigeria'), ('NI', 'Nicaragua'), ('NU', 'Niue'), ('NL', 'Netherlands'), ('NO', 'Norway'), ('NP', 'Nepal'), ('NR', 'Nauru'), ('NZ', 'New Zealand'), ('OM', 'Oman'), ('PK', 'Pakistan'), ('PA', 'Panama'), ('PN', 'Pitcairn'), ('PE', 'Peru'), ('PH', 'Philippines'), ('PW', 'Palau'), ('PG', 'Papua New Guinea'), ('PL', 'Poland'), ('PR', 'Puerto Rico'), ('KP', "Korea, Democratic People's Republic of"), ('PT', 'Portugal'), ('PY', 'Paraguay'), ('PS', 'Palestine, State of'), ('PF', 'French Polynesia'), ('QA', 'Qatar'), ('RE', 'R\xe9union'), ('RO', 'Romania'), ('RU', 'Russian Federation'), ('RW', 'Rwanda'), ('SA', 'Saudi Arabia'), ('SD', 'Sudan'), ('SN', 'Senegal'), ('SG', 'Singapore'), ('GS', 'South Georgia‡ndhe South Sandwich Islands'), ('SH', 'Saint Helena, Ascension‡nd Tristan da Cunha'), ('SJ', 'Svalbard‡nd Jan Mayen'), ('SB', 'Solomon Islands'), ('SL', 'Sierra Leone'), ('SV', 'El Salvador'), ('SM', 'San Marino'), ('SO', 'Somalia'), ('PM', 'Saint Pierre‡nd Miquelon'), ('RS', 'Serbia'), ('SS', 'South Sudan'), ('ST', 'Sao Tome‡nd Principe'), ('SR', 'Suriname'), ('SK', 'Slovakia'), ('SI', 'Slovenia'), ('SE', 'Sweden'), ('SZ', 'Swaziland'), ('SX', 'Sint Maarten (Dutch…art)'), ('SC', 'Seychelles'), ('SY', 'Syrian Arab Republic'), ('TC', 'Turks‡nd Caicos Islands'), ('TD', 'Chad'), ('TG', 'Togo'), ('TH', 'Thailand'), ('TJ', 'Tajikistan'), ('TK', 'Tokelau'), ('TM', 'Turkmenistan'), ('TL', 'Timor-Leste'), ('TO', 'Tonga'), ('TT', 'Trinidad‡nd Tobago'), ('TN', 'Tunisia'), ('TR', 'Turkey'), ('TV', 'Tuvalu'), ('TW', 'Taiwan, Province of China'), ('TZ', 'Tanzania, United Republic of'), ('UG', 'Uganda'), ('UA', 'Ukraine'), ('UM', 'United States Minor Outlying Islands'), ('UY', 'Uruguay'), ('US', 'United States'), ('UZ', 'Uzbekistan'), ('VA', 'Holy See (Vatican City State)'), ('VC', 'Saint Vincent‡ndhe Grenadines'), ('VE', 'Venezuela, Bolivarian Republic of'), ('VG', 'Virgin Islands, British'), ('VI', 'Virgin Islands, U.S.'), ('VN', 'Viet Nam'), ('VU', 'Vanuatu'), ('WF', 'Wallis‡nd Futuna'), ('WS', 'Samoa'), ('YE', 'Yemen'), ('ZA', 'South Africa'), ('ZM', 'Zambia'), ('ZW', 'Zimbabwe')]),

184 
mig¿tiÚs
.
AÉ”F›ld
(

185 
mod–_Çme
='provider',

186 
Çme
='email',

187 
f›ld
=
mod–s
.
Ch¬F›ld
(
max_Ëngth
=254, 
nuÎ
=
True
, 
bÏnk
=True),

189 
mig¿tiÚs
.
AÉ”F›ld
(

190 
mod–_Çme
='provider',

191 
Çme
='flow',

192 
f›ld
=
mod–s
.
Ch¬F›ld
(=
b
'´ofÜma', 
h–p_‹xt
=b'OÃ oàthavaabË wÜkæow fÜ g’”©šg…rofÜma ªd invoiû (£thdocum’tiÚ fÜ mÜd‘as).', 
max_Ëngth
=10, 
choiûs
=[(b'proforma', 'Proforma'), (b'invoice', 'Invoice')]),

194 
mig¿tiÚs
.
AÉ”F›ld
(

195 
mod–_Çme
='provider',

196 
Çme
='invoice_series',

197 
f›ld
=
mod–s
.
Ch¬F›ld
(
h–p_‹xt
=
b
'Th£r› th© wÈbu£d oÀev”y invoiû g’”©ed byhi ´ovid”.', 
max_Ëngth
=20),

199 
mig¿tiÚs
.
AÉ”F›ld
(

200 
mod–_Çme
='provider',

201 
Çme
='meta',

202 
f›ld
=
jsÚf›ld
.
f›lds
.
JSONF›ld
(={}, 
nuÎ
=
True
, 
bÏnk
=True),

204 
mig¿tiÚs
.
AÉ”F›ld
(

205 
mod–_Çme
='provider',

206 
Çme
='proforma_series',

207 
f›ld
=
mod–s
.
Ch¬F›ld
(
h–p_‹xt
=
b
'Th£r› th© wÈbu£d oÀev”y…rofÜm¨g’”©ed byhi ´ovid”.', 
max_Ëngth
=20, 
nuÎ
=
True
, 
bÏnk
=True),

209 
mig¿tiÚs
.
AÉ”F›ld
(

210 
mod–_Çme
='subscription',

211 
Çme
='reference',

212 
f›ld
=
mod–s
.
Ch¬F›ld
(
bÏnk
=
True
, 
max_Ëngth
=128, 
nuÎ
=True, 
h–p_‹xt
=
b
"ThsubsütiÚ' »ã»nû iÀªƒx‹º® sy¡em.", 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
RegexV®id©Ü
(
»gex
=b'^[^,]*$', 
mes§ge
='Reference must‚ot contain commas.')]),

214 
mig¿tiÚs
.
AÉ”IndexTog‘h”
(

215 
Çme
='customer',

216 
šdex_tog‘h”
=
£t
([('first_name', 'last_name', 'company')]),

218 
mig¿tiÚs
.
AddF›ld
(

219 
mod–_Çme
='transaction',

220 
Çme
='invoice',

221 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
to
='sv”.Invoiû', 
nuÎ
=True),

223 
mig¿tiÚs
.
AddF›ld
(

224 
mod–_Çme
='transaction',

225 
Çme
='payment_method',

226 
f›ld
=
mod–s
.
FÜeignKey
(
to
='silver.PaymentMethod'),

228 
mig¿tiÚs
.
AddF›ld
(

229 
mod–_Çme
='transaction',

230 
Çme
='proforma',

231 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
to
='sv”.ProfÜma', 
nuÎ
=True),

233 
mig¿tiÚs
.
AddF›ld
(

234 
mod–_Çme
='paymentmethod',

235 
Çme
='customer',

236 
f›ld
=
mod–s
.
FÜeignKey
(
to
='silver.Customer'),

238 
mig¿tiÚs
.
RemoveF›ld
(

239 
mod–_Çme
='customer',

240 
Çme
='name',

	@silver/migrations/0033_auto_20170203_1540.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


4 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


7 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

9 
d•’d’c›s
 = [

13 
İ”©iÚs
 = [

14 
mig¿tiÚs
.
	`AddF›ld
(

15 
mod–_Çme
='paymentmethod',

16 
Çme
='display_info',

17 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
max_Ëngth
=256, 
nuÎ
=
True
, 
bÏnk
=True),

19 
mig¿tiÚs
.
	`AddF›ld
(

20 
mod–_Çme
='paymentmethod',

21 
Çme
='valid_until',

22 
f›ld
=
mod–s
.
	`D©eTimeF›ld
(
nuÎ
=
True
, 
bÏnk
=True),

	@silver/migrations/0034_auto_20170203_1644.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


4 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


7 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

9 
d•’d’c›s
 = [

13 
İ”©iÚs
 = [

14 
mig¿tiÚs
.
	`AddF›ld
(

15 
mod–_Çme
='Document',

16 
Çme
='transaction_currency',

17 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
max_Ëngth
=4),

19 
mig¿tiÚs
.
	`RunSQL
("""

20 
DROP
 
VIEW
 
IF
 
EXISTS
 
sv”_docum’t
;

21 
CREATE
 
VIEW
 
sv”_docum’t
 
AS
 
SELECT


22 'švoiû' 
AS
 `
kšd
`, 
id
, 
£r›s
, 
numb”
, 
issue_d©e
, 
due_d©e
,

23 
·id_d©e
, 
ÿnûl_d©e
, 
¡©e
, 
´ovid”_id
, 
cu¡om”_id
,

24 
´ofÜma_id
 
as
 
»Ï‹d_docum’t_id
, 
¬chived_cu¡om”
,

25 
¬chived_´ovid”
, 
§Ës_x_³rûÁ
, 
§Ës_x_Çme
, 
cu¼’cy
, 
pdf
,

26 
Œª§ùiÚ_cu¼’cy


27 
FROM
 
sv”_švoiû


28 
UNION


29 
SELECT


30 '´ofÜma' 
AS
 `
kšd
`, 
id
, 
£r›s
, 
numb”
, 
issue_d©e
, 
due_d©e
,

31 
·id_d©e
, 
ÿnûl_d©e
, 
¡©e
, 
´ovid”_id
, 
cu¡om”_id
,

32 
NULL
 
as
 
»Ï‹d_docum’t_id
, 
¬chived_cu¡om”
,

33 
¬chived_´ovid”
, 
§Ës_x_³rûÁ
, 
§Ës_x_Çme
, 
cu¼’cy
, 
pdf
,

34 
Œª§ùiÚ_cu¼’cy


35 
FROM
 
sv”_´ofÜma
 
WHERE
 
švoiû_id
 
is
 
NULL


	@silver/migrations/0035_auto_20170206_0941.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


4 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


7 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

9 
d•’d’c›s
 = [

13 
İ”©iÚs
 = [

14 
mig¿tiÚs
.
	`AÉ”F›ld
(

15 
mod–_Çme
='customer',

16 
Çme
='country',

17 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
max_Ëngth
=3, 
choiûs
=[('AD', 'Andorra'), ('AE', 'United Arab Emirates'), ('AF', 'Afghanistan'), ('AG', 'Antigua‡nd Barbuda'), ('AI', 'Anguilla'), ('AL', 'Albania'), ('AM', 'Armenia'), ('AO', 'Angola'), ('AQ', 'Antarctica'), ('AR', 'Argentina'), ('AS', 'American Samoa'), ('AT', 'Austria'), ('AU', 'Australia'), ('AW', 'Aruba'), ('AX', '\xc5land Islands'), ('AZ', 'Azerbaijan'), ('BA', 'Bosnia‡nd Herzegovina'), ('BB', 'Barbados'), ('BD', 'Bangladesh'), ('BE', 'Belgium'), ('BF', 'Burkina Faso'), ('BG', 'Bulgaria'), ('BH', 'Bahrain'), ('BI', 'Burundi'), ('BJ', 'Benin'), ('BL', 'Saint Barth\xe9lemy'), ('BM', 'Bermuda'), ('BN', 'Brunei Darussalam'), ('BO', 'Bolivia, Plurinational State of'), ('BQ', 'Bonaire, Sint Eustatius‡nd Saba'), ('BR', 'Brazil'), ('BS', 'Bahamas'), ('BT', 'Bhutan'), ('BV', 'Bouvet Island'), ('BW', 'Botswana'), ('BY', 'Belarus'), ('BZ', 'Belize'), ('CA', 'Canada'), ('CC', 'Cocos (Keeling) Islands'), ('CD', 'Congo, The Democratic Republic ofhe'), ('CF', 'Central African Republic'), ('CG', 'Congo'), ('CH', 'Switzerland'), ('CI', "C\xf4te d'Ivoire"), ('CK', 'Cook Islands'), ('CL', 'Chile'), ('CM', 'Cameroon'), ('CN', 'China'), ('CO', 'Colombia'), ('CR', 'Costa Rica'), ('CU', 'Cuba'), ('CV', 'Cabo Verde'), ('CW', 'Cura\xe7ao'), ('CX', 'Christmas Island'), ('CY', 'Cyprus'), ('CZ', 'Czech Republic'), ('DE', 'Germany'), ('DJ', 'Djibouti'), ('DK', 'Denmark'), ('DM', 'Dominica'), ('DO', 'Dominican Republic'), ('DZ', 'Algeria'), ('EC', 'Ecuador'), ('EE', 'Estonia'), ('EG', 'Egypt'), ('EH', 'Western Sahara'), ('ER', 'Eritrea'), ('ES', 'Spain'), ('ET', 'Ethiopia'), ('FI', 'Finland'), ('FJ', 'Fiji'), ('FK', 'Falkland Islands (Malvinas)'), ('FM', 'Micronesia, Federated States of'), ('FO', 'Faroe Islands'), ('FR', 'France'), ('GA', 'Gabon'), ('GB', 'United Kingdom'), ('GD', 'Grenada'), ('GE', 'Georgia'), ('GF', 'French Guiana'), ('GG', 'Guernsey'), ('GH', 'Ghana'), ('GI', 'Gibraltar'), ('GL', 'Greenland'), ('GM', 'Gambia'), ('GN', 'Guinea'), ('GP', 'Guadeloupe'), ('GQ', 'Equatorial Guinea'), ('GR', 'Greece'), ('GS', 'South Georgia‡ndhe South Sandwich Islands'), ('GT', 'Guatemala'), ('GU', 'Guam'), ('GW', 'Guinea-Bissau'), ('GY', 'Guyana'), ('HK', 'Hong Kong'), ('HM', 'Heard Island‡nd McDonald Islands'), ('HN', 'Honduras'), ('HR', 'Croatia'), ('HT', 'Haiti'), ('HU', 'Hungary'), ('ID', 'Indonesia'), ('IE', 'Ireland'), ('IL', 'Israel'), ('IM', 'Isle of Man'), ('IN', 'India'), ('IO', 'British Indian Ocean Territory'), ('IQ', 'Iraq'), ('IR', 'Iran, Islamic Republic of'), ('IS', 'Iceland'), ('IT', 'Italy'), ('JE', 'Jersey'), ('JM', 'Jamaica'), ('JO', 'Jordan'), ('JP', 'Japan'), ('KE', 'Kenya'), ('KG', 'Kyrgyzstan'), ('KH', 'Cambodia'), ('KI', 'Kiribati'), ('KM', 'Comoros'), ('KN', 'Saint Kitts‡nd Nevis'), ('KP', "Korea, Democratic People's Republic of"), ('KR', 'Korea, Republic of'), ('KW', 'Kuwait'), ('KY', 'Cayman Islands'), ('KZ', 'Kazakhstan'), ('LA', "Lao People's Democratic Republic"), ('LB', 'Lebanon'), ('LC', 'Saint Lucia'), ('LI', 'Liechtenstein'), ('LK', 'Sri Lanka'), ('LR', 'Liberia'), ('LS', 'Lesotho'), ('LT', 'Lithuania'), ('LU', 'Luxembourg'), ('LV', 'Latvia'), ('LY', 'Libya'), ('MA', 'Morocco'), ('MC', 'Monaco'), ('MD', 'Moldova, Republic of'), ('ME', 'Montenegro'), ('MF', 'Saint Martin (French…art)'), ('MG', 'Madagascar'), ('MH', 'Marshall Islands'), ('MK', 'Macedonia, Republic of'), ('ML', 'Mali'), ('MM', 'Myanmar'), ('MN', 'Mongolia'), ('MO', 'Macao'), ('MP', 'Northern Mariana Islands'), ('MQ', 'Martinique'), ('MR', 'Mauritania'), ('MS', 'Montserrat'), ('MT', 'Malta'), ('MU', 'Mauritius'), ('MV', 'Maldives'), ('MW', 'Malawi'), ('MX', 'Mexico'), ('MY', 'Malaysia'), ('MZ', 'Mozambique'), ('NA', 'Namibia'), ('NC', 'New Caledonia'), ('NE', 'Niger'), ('NF', 'Norfolk Island'), ('NG', 'Nigeria'), ('NI', 'Nicaragua'), ('NL', 'Netherlands'), ('NO', 'Norway'), ('NP', 'Nepal'), ('NR', 'Nauru'), ('NU', 'Niue'), ('NZ', 'New Zealand'), ('OM', 'Oman'), ('PA', 'Panama'), ('PE', 'Peru'), ('PF', 'French Polynesia'), ('PG', 'Papua New Guinea'), ('PH', 'Philippines'), ('PK', 'Pakistan'), ('PL', 'Poland'), ('PM', 'Saint Pierre‡nd Miquelon'), ('PN', 'Pitcairn'), ('PR', 'Puerto Rico'), ('PS', 'Palestine, State of'), ('PT', 'Portugal'), ('PW', 'Palau'), ('PY', 'Paraguay'), ('QA', 'Qatar'), ('RE', 'R\xe9union'), ('RO', 'Romania'), ('RS', 'Serbia'), ('RU', 'Russian Federation'), ('RW', 'Rwanda'), ('SA', 'Saudi Arabia'), ('SB', 'Solomon Islands'), ('SC', 'Seychelles'), ('SD', 'Sudan'), ('SE', 'Sweden'), ('SG', 'Singapore'), ('SH', 'Saint Helena, Ascension‡nd Tristan da Cunha'), ('SI', 'Slovenia'), ('SJ', 'Svalbard‡nd Jan Mayen'), ('SK', 'Slovakia'), ('SL', 'Sierra Leone'), ('SM', 'San Marino'), ('SN', 'Senegal'), ('SO', 'Somalia'), ('SR', 'Suriname'), ('SS', 'South Sudan'), ('ST', 'Sao Tome‡nd Principe'), ('SV', 'El Salvador'), ('SX', 'Sint Maarten (Dutch…art)'), ('SY', 'Syrian Arab Republic'), ('SZ', 'Swaziland'), ('TC', 'Turks‡nd Caicos Islands'), ('TD', 'Chad'), ('TF', 'French Southern Territories'), ('TG', 'Togo'), ('TH', 'Thailand'), ('TJ', 'Tajikistan'), ('TK', 'Tokelau'), ('TL', 'Timor-Leste'), ('TM', 'Turkmenistan'), ('TN', 'Tunisia'), ('TO', 'Tonga'), ('TR', 'Turkey'), ('TT', 'Trinidad‡nd Tobago'), ('TV', 'Tuvalu'), ('TW', 'Taiwan, Province of China'), ('TZ', 'Tanzania, United Republic of'), ('UA', 'Ukraine'), ('UG', 'Uganda'), ('UM', 'United States Minor Outlying Islands'), ('US', 'United States'), ('UY', 'Uruguay'), ('UZ', 'Uzbekistan'), ('VA', 'Holy See (Vatican City State)'), ('VC', 'Saint Vincent‡ndhe Grenadines'), ('VE', 'Venezuela, Bolivarian Republic of'), ('VG', 'Virgin Islands, British'), ('VI', 'Virgin Islands, U.S.'), ('VN', 'Viet Nam'), ('VU', 'Vanuatu'), ('WF', 'Wallis‡nd Futuna'), ('WS', 'Samoa'), ('YE', 'Yemen'), ('YT', 'Mayotte'), ('ZA', 'South Africa'), ('ZM', 'Zambia'), ('ZW', 'Zimbabwe')]),

19 
mig¿tiÚs
.
	`AÉ”F›ld
(

20 
mod–_Çme
='customer',

21 
Çme
='currency',

22 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
bÏnk
=
True
, 
max_Ëngth
=4, 
nuÎ
=True, 
h–p_‹xt
=
b
'U£dØ’fÜû‡ c”š cu¼’cy wh’ makšg¿n§ùiÚsfÜhcu¡om”.', 
choiûs
=[('AED', 'AED (UAE Dirham)'), ('AFN', 'AFN (Afghani)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Armenian Dram)'), ('ANG', 'ANG (Netherlands Antillean Guilder)'), ('AOA', 'AOA (Kwanza)'), ('ARS', 'ARS (Argentine Peso)'), ('AUD', 'AUD (Australian Dollar)'), ('AWG', 'AWG (Aruban Florin)'), ('AZN', 'AZN (Azerbaijanian Manat)'), ('BAM', 'BAM (Convertible Mark)'), ('BBD', 'BBD (Barbados Dollar)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulgarian Lev)'), ('BHD', 'BHD (Bahraini Dinar)'), ('BIF', 'BIF (Burundi Franc)'), ('BMD', 'BMD (Bermudian Dollar)'), ('BND', 'BND (Brunei Dollar)'), ('BOB', 'BOB (Boliviano)'), ('BRL', 'BRL (Brazilian Real)'), ('BSD', 'BSD (Bahamian Dollar)'), ('BTN', 'BTN (Ngultrum)'), ('BWP', 'BWP (Pula)'), ('BYR', 'BYR (Belarusian Ruble)'), ('BZD', 'BZD (Belize Dollar)'), ('CAD', 'CAD (Canadian Dollar)'), ('CDF', 'CDF (Congolese Franc)'), ('CHF', 'CHF (Swiss Franc)'), ('CLP', 'CLP (Chilean Peso)'), ('CNY', 'CNY (Yuan Renminbi)'), ('COP', 'COP (Colombian Peso)'), ('CRC', 'CRC (Costa Rican Colon)'), ('CUC', 'CUC (Peso Convertible)'), ('CUP', 'CUP (Cuban Peso)'), ('CVE', 'CVE (Cabo Verde Escudo)'), ('CZK', 'CZK (Czech Koruna)'), ('DJF', 'DJF (Djibouti Franc)'), ('DKK', 'DKK (Danish Krone)'), ('DOP', 'DOP (Dominican Peso)'), ('DZD', 'DZD (Algerian Dinar)'), ('EGP', 'EGP (Egyptian Pound)'), ('ERN', 'ERN (Nakfa)'), ('ETB', 'ETB (Ethiopian Birr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fiji Dollar)'), ('FKP', 'FKP (Falkland Islands Pound)'), ('GBP', 'GBP (Pound Sterling)'), ('GEL', 'GEL (Lari)'), ('GHS', 'GHS (Ghana Cedi)'), ('GIP', 'GIP (Gibraltar Pound)'), ('GMD', 'GMD (Dalasi)'), ('GNF', 'GNF (Guinea Franc)'), ('GTQ', 'GTQ (Quetzal)'), ('GYD', 'GYD (Guyana Dollar)'), ('HKD', 'HKD (Hong Kong Dollar)'), ('HNL', 'HNL (Lempira)'), ('HRK', 'HRK (Kuna)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (Forint)'), ('IDR', 'IDR (Rupiah)'), ('ILS', 'ILS (New Israeli Sheqel)'), ('INR', 'INR (Indian Rupee)'), ('IQD', 'IQD (Iraqi Dinar)'), ('IRR', 'IRR (Iranian Rial)'), ('ISK', 'ISK (Iceland Krona)'), ('JMD', 'JMD (Jamaican Dollar)'), ('JOD', 'JOD (Jordanian Dinar)'), ('JPY', 'JPY (Yen)'), ('KES', 'KES (Kenyan Shilling)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (Riel)'), ('KMF', 'KMF (Comoro Franc)'), ('KPW', 'KPW (North Korean Won)'), ('KRW', 'KRW (Won)'), ('KWD', 'KWD (Kuwaiti Dinar)'), ('KYD', 'KYD (Cayman Islands Dollar)'), ('KZT', 'KZT (Tenge)'), ('LAK', 'LAK (Kip)'), ('LBP', 'LBP (Lebanese Pound)'), ('LKR', 'LKR (Sri Lanka Rupee)'), ('LRD', 'LRD (Liberian Dollar)'), ('LSL', 'LSL (Loti)'), ('LYD', 'LYD (Libyan Dinar)'), ('MAD', 'MAD (Moroccan Dirham)'), ('MDL', 'MDL (Moldovan Leu)'), ('MGA', 'MGA (Malagasy Ariary)'), ('MKD', 'MKD (Denar)'), ('MMK', 'MMK (Kyat)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (Pataca)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Mauritius Rupee)'), ('MVR', 'MVR (Rufiyaa)'), ('MWK', 'MWK (Malawi Kwacha)'), ('MXN', 'MXN (Mexican Peso)'), ('MYR', 'MYR (Malaysian Ringgit)'), ('MZN', 'MZN (Mozambique Metical)'), ('NAD', 'NAD (Namibia Dollar)'), ('NGN', 'NGN (Naira)'), ('NIO', 'NIO (Cordoba Oro)'), ('NOK', 'NOK (Norwegian Krone)'), ('NPR', 'NPR (Nepalese Rupee)'), ('NZD', 'NZD (New Zealand Dollar)'), ('OMR', 'OMR (Rial Omani)'), ('PAB', 'PAB (Balboa)'), ('PEN', 'PEN (Sol)'), ('PGK', 'PGK (Kina)'), ('PHP', 'PHP (Philippine Peso)'), ('PKR', 'PKR (Pakistan Rupee)'), ('PLN', 'PLN (Zloty)'), ('PYG', 'PYG (Guarani)'), ('QAR', 'QAR (Qatari Rial)'), ('RON', 'RON (Romanian Leu)'), ('RSD', 'RSD (Serbian Dinar)'), ('RUB', 'RUB (Russian Ruble)'), ('RWF', 'RWF (Rwanda Franc)'), ('SAR', 'SAR (Saudi Riyal)'), ('SBD', 'SBD (Solomon Islands Dollar)'), ('SCR', 'SCR (Seychelles Rupee)'), ('SDG', 'SDG (Sudanese Pound)'), ('SEK', 'SEK (Swedish Krona)'), ('SGD', 'SGD (Singapore Dollar)'), ('SHP', 'SHP (Saint Helena Pound)'), ('SLL', 'SLL (Leone)'), ('SOS', 'SOS (Somali Shilling)'), ('SRD', 'SRD (Surinam Dollar)'), ('SSP', 'SSP (South Sudanese Pound)'), ('STD', 'STD (Dobra)'), ('SVC', 'SVC (El Salvador Colon)'), ('SYP', 'SYP (Syrian Pound)'), ('SZL', 'SZL (Lilangeni)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (Somoni)'), ('TMT', 'TMT (Turkmenistan New Manat)'), ('TND', 'TND (Tunisian Dinar)'), ('TOP', 'TOP (Pa\u2019anga)'), ('TRY', 'TRY (Turkish Lira)'), ('TTD', 'TTD (Trinidad‡nd Tobago Dollar)'), ('TWD', 'TWD (New Taiwan Dollar)'), ('TZS', 'TZS (Tanzanian Shilling)'), ('UAH', 'UAH (Hryvnia)'), ('UGX', 'UGX (Uganda Shilling)'), ('USD', 'USD (US Dollar)'), ('UYU', 'UYU (Peso Uruguayo)'), ('UZS', 'UZS (Uzbekistan Sum)'), ('VEF', 'VEF (Bol\xedvar)'), ('VND', 'VND (Dong)'), ('VUV', 'VUV (Vatu)'), ('WST', 'WST (Tala)'), ('XAF', 'XAF (CFA Franc BEAC)'), ('XAG', 'XAG (Silver)'), ('XAU', 'XAU (Gold)'), ('XBA', 'XBA (Bond Markets Unit European Composite Unit (EURCO))'), ('XBB', 'XBB (Bond Markets Unit European Monetary Unit (E.M.U.-6))'), ('XBC', 'XBC (Bond Markets Unit European Unit of Account 9 (E.U.A.-9))'), ('XBD', 'XBD (Bond Markets Unit European Unit of Account 17 (E.U.A.-17))'), ('XCD', 'XCD (East Caribbean Dollar)'), ('XDR', 'XDR (SDR (Special Drawing Right))'), ('XOF', 'XOF (CFA Franc BCEAO)'), ('XPD', 'XPD (Palladium)'), ('XPF', 'XPF (CFP Franc)'), ('XPT', 'XPT (Platinum)'), ('XSU', 'XSU (Sucre)'), ('XTS', 'XTS (Codes specifically„eserved foresting…urposes)'), ('XUA', 'XUA (ADB Unit of Account)'), ('XXX', 'XXX (The codes‡ssigned forransactions where‚o currency is involved)'), ('YER', 'YER (Yemeni Rial)'), ('ZAR', 'ZAR (Rand)'), ('ZMW', 'ZMW (Zambian Kwacha)'), ('ZWL', 'ZWL (Zimbabwe Dollar)')]),

24 
mig¿tiÚs
.
	`AÉ”F›ld
(

25 
mod–_Çme
='invoice',

26 
Çme
='currency',

27 
f›ld
=
mod–s
.
	`Ch¬F›ld
(=
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy u£d fÜ blšg.', 
max_Ëngth
=4, 
choiûs
=[('AED', 'AED (UAE Dirham)'), ('AFN', 'AFN (Afghani)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Armenian Dram)'), ('ANG', 'ANG (Netherlands Antillean Guilder)'), ('AOA', 'AOA (Kwanza)'), ('ARS', 'ARS (Argentine Peso)'), ('AUD', 'AUD (Australian Dollar)'), ('AWG', 'AWG (Aruban Florin)'), ('AZN', 'AZN (Azerbaijanian Manat)'), ('BAM', 'BAM (Convertible Mark)'), ('BBD', 'BBD (Barbados Dollar)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulgarian Lev)'), ('BHD', 'BHD (Bahraini Dinar)'), ('BIF', 'BIF (Burundi Franc)'), ('BMD', 'BMD (Bermudian Dollar)'), ('BND', 'BND (Brunei Dollar)'), ('BOB', 'BOB (Boliviano)'), ('BRL', 'BRL (Brazilian Real)'), ('BSD', 'BSD (Bahamian Dollar)'), ('BTN', 'BTN (Ngultrum)'), ('BWP', 'BWP (Pula)'), ('BYR', 'BYR (Belarusian Ruble)'), ('BZD', 'BZD (Belize Dollar)'), ('CAD', 'CAD (Canadian Dollar)'), ('CDF', 'CDF (Congolese Franc)'), ('CHF', 'CHF (Swiss Franc)'), ('CLP', 'CLP (Chilean Peso)'), ('CNY', 'CNY (Yuan Renminbi)'), ('COP', 'COP (Colombian Peso)'), ('CRC', 'CRC (Costa Rican Colon)'), ('CUC', 'CUC (Peso Convertible)'), ('CUP', 'CUP (Cuban Peso)'), ('CVE', 'CVE (Cabo Verde Escudo)'), ('CZK', 'CZK (Czech Koruna)'), ('DJF', 'DJF (Djibouti Franc)'), ('DKK', 'DKK (Danish Krone)'), ('DOP', 'DOP (Dominican Peso)'), ('DZD', 'DZD (Algerian Dinar)'), ('EGP', 'EGP (Egyptian Pound)'), ('ERN', 'ERN (Nakfa)'), ('ETB', 'ETB (Ethiopian Birr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fiji Dollar)'), ('FKP', 'FKP (Falkland Islands Pound)'), ('GBP', 'GBP (Pound Sterling)'), ('GEL', 'GEL (Lari)'), ('GHS', 'GHS (Ghana Cedi)'), ('GIP', 'GIP (Gibraltar Pound)'), ('GMD', 'GMD (Dalasi)'), ('GNF', 'GNF (Guinea Franc)'), ('GTQ', 'GTQ (Quetzal)'), ('GYD', 'GYD (Guyana Dollar)'), ('HKD', 'HKD (Hong Kong Dollar)'), ('HNL', 'HNL (Lempira)'), ('HRK', 'HRK (Kuna)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (Forint)'), ('IDR', 'IDR (Rupiah)'), ('ILS', 'ILS (New Israeli Sheqel)'), ('INR', 'INR (Indian Rupee)'), ('IQD', 'IQD (Iraqi Dinar)'), ('IRR', 'IRR (Iranian Rial)'), ('ISK', 'ISK (Iceland Krona)'), ('JMD', 'JMD (Jamaican Dollar)'), ('JOD', 'JOD (Jordanian Dinar)'), ('JPY', 'JPY (Yen)'), ('KES', 'KES (Kenyan Shilling)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (Riel)'), ('KMF', 'KMF (Comoro Franc)'), ('KPW', 'KPW (North Korean Won)'), ('KRW', 'KRW (Won)'), ('KWD', 'KWD (Kuwaiti Dinar)'), ('KYD', 'KYD (Cayman Islands Dollar)'), ('KZT', 'KZT (Tenge)'), ('LAK', 'LAK (Kip)'), ('LBP', 'LBP (Lebanese Pound)'), ('LKR', 'LKR (Sri Lanka Rupee)'), ('LRD', 'LRD (Liberian Dollar)'), ('LSL', 'LSL (Loti)'), ('LYD', 'LYD (Libyan Dinar)'), ('MAD', 'MAD (Moroccan Dirham)'), ('MDL', 'MDL (Moldovan Leu)'), ('MGA', 'MGA (Malagasy Ariary)'), ('MKD', 'MKD (Denar)'), ('MMK', 'MMK (Kyat)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (Pataca)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Mauritius Rupee)'), ('MVR', 'MVR (Rufiyaa)'), ('MWK', 'MWK (Malawi Kwacha)'), ('MXN', 'MXN (Mexican Peso)'), ('MYR', 'MYR (Malaysian Ringgit)'), ('MZN', 'MZN (Mozambique Metical)'), ('NAD', 'NAD (Namibia Dollar)'), ('NGN', 'NGN (Naira)'), ('NIO', 'NIO (Cordoba Oro)'), ('NOK', 'NOK (Norwegian Krone)'), ('NPR', 'NPR (Nepalese Rupee)'), ('NZD', 'NZD (New Zealand Dollar)'), ('OMR', 'OMR (Rial Omani)'), ('PAB', 'PAB (Balboa)'), ('PEN', 'PEN (Sol)'), ('PGK', 'PGK (Kina)'), ('PHP', 'PHP (Philippine Peso)'), ('PKR', 'PKR (Pakistan Rupee)'), ('PLN', 'PLN (Zloty)'), ('PYG', 'PYG (Guarani)'), ('QAR', 'QAR (Qatari Rial)'), ('RON', 'RON (Romanian Leu)'), ('RSD', 'RSD (Serbian Dinar)'), ('RUB', 'RUB (Russian Ruble)'), ('RWF', 'RWF (Rwanda Franc)'), ('SAR', 'SAR (Saudi Riyal)'), ('SBD', 'SBD (Solomon Islands Dollar)'), ('SCR', 'SCR (Seychelles Rupee)'), ('SDG', 'SDG (Sudanese Pound)'), ('SEK', 'SEK (Swedish Krona)'), ('SGD', 'SGD (Singapore Dollar)'), ('SHP', 'SHP (Saint Helena Pound)'), ('SLL', 'SLL (Leone)'), ('SOS', 'SOS (Somali Shilling)'), ('SRD', 'SRD (Surinam Dollar)'), ('SSP', 'SSP (South Sudanese Pound)'), ('STD', 'STD (Dobra)'), ('SVC', 'SVC (El Salvador Colon)'), ('SYP', 'SYP (Syrian Pound)'), ('SZL', 'SZL (Lilangeni)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (Somoni)'), ('TMT', 'TMT (Turkmenistan New Manat)'), ('TND', 'TND (Tunisian Dinar)'), ('TOP', 'TOP (Pa\u2019anga)'), ('TRY', 'TRY (Turkish Lira)'), ('TTD', 'TTD (Trinidad‡nd Tobago Dollar)'), ('TWD', 'TWD (New Taiwan Dollar)'), ('TZS', 'TZS (Tanzanian Shilling)'), ('UAH', 'UAH (Hryvnia)'), ('UGX', 'UGX (Uganda Shilling)'), ('USD', 'USD (US Dollar)'), ('UYU', 'UYU (Peso Uruguayo)'), ('UZS', 'UZS (Uzbekistan Sum)'), ('VEF', 'VEF (Bol\xedvar)'), ('VND', 'VND (Dong)'), ('VUV', 'VUV (Vatu)'), ('WST', 'WST (Tala)'), ('XAF', 'XAF (CFA Franc BEAC)'), ('XAG', 'XAG (Silver)'), ('XAU', 'XAU (Gold)'), ('XBA', 'XBA (Bond Markets Unit European Composite Unit (EURCO))'), ('XBB', 'XBB (Bond Markets Unit European Monetary Unit (E.M.U.-6))'), ('XBC', 'XBC (Bond Markets Unit European Unit of Account 9 (E.U.A.-9))'), ('XBD', 'XBD (Bond Markets Unit European Unit of Account 17 (E.U.A.-17))'), ('XCD', 'XCD (East Caribbean Dollar)'), ('XDR', 'XDR (SDR (Special Drawing Right))'), ('XOF', 'XOF (CFA Franc BCEAO)'), ('XPD', 'XPD (Palladium)'), ('XPF', 'XPF (CFP Franc)'), ('XPT', 'XPT (Platinum)'), ('XSU', 'XSU (Sucre)'), ('XTS', 'XTS (Codes specifically„eserved foresting…urposes)'), ('XUA', 'XUA (ADB Unit of Account)'), ('XXX', 'XXX (The codes‡ssigned forransactions where‚o currency is involved)'), ('YER', 'YER (Yemeni Rial)'), ('ZAR', 'ZAR (Rand)'), ('ZMW', 'ZMW (Zambian Kwacha)'), ('ZWL', 'ZWL (Zimbabwe Dollar)')]),

29 
mig¿tiÚs
.
	`AÉ”F›ld
(

30 
mod–_Çme
='invoice',

31 
Çme
='transaction_currency',

32 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
h–p_‹xt
=
b
'Thcu¼’cy u£d wh’ makšg‡¿n§ùiÚ.', 
max_Ëngth
=4, 
choiûs
=[('AED', 'AED (UAE Dirham)'), ('AFN', 'AFN (Afghani)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Armenian Dram)'), ('ANG', 'ANG (Netherlands Antillean Guilder)'), ('AOA', 'AOA (Kwanza)'), ('ARS', 'ARS (Argentine Peso)'), ('AUD', 'AUD (Australian Dollar)'), ('AWG', 'AWG (Aruban Florin)'), ('AZN', 'AZN (Azerbaijanian Manat)'), ('BAM', 'BAM (Convertible Mark)'), ('BBD', 'BBD (Barbados Dollar)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulgarian Lev)'), ('BHD', 'BHD (Bahraini Dinar)'), ('BIF', 'BIF (Burundi Franc)'), ('BMD', 'BMD (Bermudian Dollar)'), ('BND', 'BND (Brunei Dollar)'), ('BOB', 'BOB (Boliviano)'), ('BRL', 'BRL (Brazilian Real)'), ('BSD', 'BSD (Bahamian Dollar)'), ('BTN', 'BTN (Ngultrum)'), ('BWP', 'BWP (Pula)'), ('BYR', 'BYR (Belarusian Ruble)'), ('BZD', 'BZD (Belize Dollar)'), ('CAD', 'CAD (Canadian Dollar)'), ('CDF', 'CDF (Congolese Franc)'), ('CHF', 'CHF (Swiss Franc)'), ('CLP', 'CLP (Chilean Peso)'), ('CNY', 'CNY (Yuan Renminbi)'), ('COP', 'COP (Colombian Peso)'), ('CRC', 'CRC (Costa Rican Colon)'), ('CUC', 'CUC (Peso Convertible)'), ('CUP', 'CUP (Cuban Peso)'), ('CVE', 'CVE (Cabo Verde Escudo)'), ('CZK', 'CZK (Czech Koruna)'), ('DJF', 'DJF (Djibouti Franc)'), ('DKK', 'DKK (Danish Krone)'), ('DOP', 'DOP (Dominican Peso)'), ('DZD', 'DZD (Algerian Dinar)'), ('EGP', 'EGP (Egyptian Pound)'), ('ERN', 'ERN (Nakfa)'), ('ETB', 'ETB (Ethiopian Birr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fiji Dollar)'), ('FKP', 'FKP (Falkland Islands Pound)'), ('GBP', 'GBP (Pound Sterling)'), ('GEL', 'GEL (Lari)'), ('GHS', 'GHS (Ghana Cedi)'), ('GIP', 'GIP (Gibraltar Pound)'), ('GMD', 'GMD (Dalasi)'), ('GNF', 'GNF (Guinea Franc)'), ('GTQ', 'GTQ (Quetzal)'), ('GYD', 'GYD (Guyana Dollar)'), ('HKD', 'HKD (Hong Kong Dollar)'), ('HNL', 'HNL (Lempira)'), ('HRK', 'HRK (Kuna)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (Forint)'), ('IDR', 'IDR (Rupiah)'), ('ILS', 'ILS (New Israeli Sheqel)'), ('INR', 'INR (Indian Rupee)'), ('IQD', 'IQD (Iraqi Dinar)'), ('IRR', 'IRR (Iranian Rial)'), ('ISK', 'ISK (Iceland Krona)'), ('JMD', 'JMD (Jamaican Dollar)'), ('JOD', 'JOD (Jordanian Dinar)'), ('JPY', 'JPY (Yen)'), ('KES', 'KES (Kenyan Shilling)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (Riel)'), ('KMF', 'KMF (Comoro Franc)'), ('KPW', 'KPW (North Korean Won)'), ('KRW', 'KRW (Won)'), ('KWD', 'KWD (Kuwaiti Dinar)'), ('KYD', 'KYD (Cayman Islands Dollar)'), ('KZT', 'KZT (Tenge)'), ('LAK', 'LAK (Kip)'), ('LBP', 'LBP (Lebanese Pound)'), ('LKR', 'LKR (Sri Lanka Rupee)'), ('LRD', 'LRD (Liberian Dollar)'), ('LSL', 'LSL (Loti)'), ('LYD', 'LYD (Libyan Dinar)'), ('MAD', 'MAD (Moroccan Dirham)'), ('MDL', 'MDL (Moldovan Leu)'), ('MGA', 'MGA (Malagasy Ariary)'), ('MKD', 'MKD (Denar)'), ('MMK', 'MMK (Kyat)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (Pataca)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Mauritius Rupee)'), ('MVR', 'MVR (Rufiyaa)'), ('MWK', 'MWK (Malawi Kwacha)'), ('MXN', 'MXN (Mexican Peso)'), ('MYR', 'MYR (Malaysian Ringgit)'), ('MZN', 'MZN (Mozambique Metical)'), ('NAD', 'NAD (Namibia Dollar)'), ('NGN', 'NGN (Naira)'), ('NIO', 'NIO (Cordoba Oro)'), ('NOK', 'NOK (Norwegian Krone)'), ('NPR', 'NPR (Nepalese Rupee)'), ('NZD', 'NZD (New Zealand Dollar)'), ('OMR', 'OMR (Rial Omani)'), ('PAB', 'PAB (Balboa)'), ('PEN', 'PEN (Sol)'), ('PGK', 'PGK (Kina)'), ('PHP', 'PHP (Philippine Peso)'), ('PKR', 'PKR (Pakistan Rupee)'), ('PLN', 'PLN (Zloty)'), ('PYG', 'PYG (Guarani)'), ('QAR', 'QAR (Qatari Rial)'), ('RON', 'RON (Romanian Leu)'), ('RSD', 'RSD (Serbian Dinar)'), ('RUB', 'RUB (Russian Ruble)'), ('RWF', 'RWF (Rwanda Franc)'), ('SAR', 'SAR (Saudi Riyal)'), ('SBD', 'SBD (Solomon Islands Dollar)'), ('SCR', 'SCR (Seychelles Rupee)'), ('SDG', 'SDG (Sudanese Pound)'), ('SEK', 'SEK (Swedish Krona)'), ('SGD', 'SGD (Singapore Dollar)'), ('SHP', 'SHP (Saint Helena Pound)'), ('SLL', 'SLL (Leone)'), ('SOS', 'SOS (Somali Shilling)'), ('SRD', 'SRD (Surinam Dollar)'), ('SSP', 'SSP (South Sudanese Pound)'), ('STD', 'STD (Dobra)'), ('SVC', 'SVC (El Salvador Colon)'), ('SYP', 'SYP (Syrian Pound)'), ('SZL', 'SZL (Lilangeni)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (Somoni)'), ('TMT', 'TMT (Turkmenistan New Manat)'), ('TND', 'TND (Tunisian Dinar)'), ('TOP', 'TOP (Pa\u2019anga)'), ('TRY', 'TRY (Turkish Lira)'), ('TTD', 'TTD (Trinidad‡nd Tobago Dollar)'), ('TWD', 'TWD (New Taiwan Dollar)'), ('TZS', 'TZS (Tanzanian Shilling)'), ('UAH', 'UAH (Hryvnia)'), ('UGX', 'UGX (Uganda Shilling)'), ('USD', 'USD (US Dollar)'), ('UYU', 'UYU (Peso Uruguayo)'), ('UZS', 'UZS (Uzbekistan Sum)'), ('VEF', 'VEF (Bol\xedvar)'), ('VND', 'VND (Dong)'), ('VUV', 'VUV (Vatu)'), ('WST', 'WST (Tala)'), ('XAF', 'XAF (CFA Franc BEAC)'), ('XAG', 'XAG (Silver)'), ('XAU', 'XAU (Gold)'), ('XBA', 'XBA (Bond Markets Unit European Composite Unit (EURCO))'), ('XBB', 'XBB (Bond Markets Unit European Monetary Unit (E.M.U.-6))'), ('XBC', 'XBC (Bond Markets Unit European Unit of Account 9 (E.U.A.-9))'), ('XBD', 'XBD (Bond Markets Unit European Unit of Account 17 (E.U.A.-17))'), ('XCD', 'XCD (East Caribbean Dollar)'), ('XDR', 'XDR (SDR (Special Drawing Right))'), ('XOF', 'XOF (CFA Franc BCEAO)'), ('XPD', 'XPD (Palladium)'), ('XPF', 'XPF (CFP Franc)'), ('XPT', 'XPT (Platinum)'), ('XSU', 'XSU (Sucre)'), ('XTS', 'XTS (Codes specifically„eserved foresting…urposes)'), ('XUA', 'XUA (ADB Unit of Account)'), ('XXX', 'XXX (The codes‡ssigned forransactions where‚o currency is involved)'), ('YER', 'YER (Yemeni Rial)'), ('ZAR', 'ZAR (Rand)'), ('ZMW', 'ZMW (Zambian Kwacha)'), ('ZWL', 'ZWL (Zimbabwe Dollar)')]),

34 
mig¿tiÚs
.
	`AÉ”F›ld
(

35 
mod–_Çme
='invoice',

36 
Çme
='transaction_xe_rate',

37 
f›ld
=
mod–s
.
	`Decim®F›ld
(
h–p_‹xt
=
b
'Cu¼’cyƒxchªg¿‹ from docum’ˆcu¼’cyØŒª§ùiÚ_cu¼’cy.', 
nuÎ
=
True
, 
max_dig™s
=16, 
decim®_¶aûs
=4, 
bÏnk
=True),

39 
mig¿tiÚs
.
	`AÉ”F›ld
(

40 
mod–_Çme
='plan',

41 
Çme
='currency',

42 
f›ld
=
mod–s
.
	`Ch¬F›ld
(=
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy iÀwhichhsubsütiÚ wÈbch¬ged.', 
max_Ëngth
=4, 
choiûs
=[('AED', 'AED (UAE Dirham)'), ('AFN', 'AFN (Afghani)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Armenian Dram)'), ('ANG', 'ANG (Netherlands Antillean Guilder)'), ('AOA', 'AOA (Kwanza)'), ('ARS', 'ARS (Argentine Peso)'), ('AUD', 'AUD (Australian Dollar)'), ('AWG', 'AWG (Aruban Florin)'), ('AZN', 'AZN (Azerbaijanian Manat)'), ('BAM', 'BAM (Convertible Mark)'), ('BBD', 'BBD (Barbados Dollar)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulgarian Lev)'), ('BHD', 'BHD (Bahraini Dinar)'), ('BIF', 'BIF (Burundi Franc)'), ('BMD', 'BMD (Bermudian Dollar)'), ('BND', 'BND (Brunei Dollar)'), ('BOB', 'BOB (Boliviano)'), ('BRL', 'BRL (Brazilian Real)'), ('BSD', 'BSD (Bahamian Dollar)'), ('BTN', 'BTN (Ngultrum)'), ('BWP', 'BWP (Pula)'), ('BYR', 'BYR (Belarusian Ruble)'), ('BZD', 'BZD (Belize Dollar)'), ('CAD', 'CAD (Canadian Dollar)'), ('CDF', 'CDF (Congolese Franc)'), ('CHF', 'CHF (Swiss Franc)'), ('CLP', 'CLP (Chilean Peso)'), ('CNY', 'CNY (Yuan Renminbi)'), ('COP', 'COP (Colombian Peso)'), ('CRC', 'CRC (Costa Rican Colon)'), ('CUC', 'CUC (Peso Convertible)'), ('CUP', 'CUP (Cuban Peso)'), ('CVE', 'CVE (Cabo Verde Escudo)'), ('CZK', 'CZK (Czech Koruna)'), ('DJF', 'DJF (Djibouti Franc)'), ('DKK', 'DKK (Danish Krone)'), ('DOP', 'DOP (Dominican Peso)'), ('DZD', 'DZD (Algerian Dinar)'), ('EGP', 'EGP (Egyptian Pound)'), ('ERN', 'ERN (Nakfa)'), ('ETB', 'ETB (Ethiopian Birr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fiji Dollar)'), ('FKP', 'FKP (Falkland Islands Pound)'), ('GBP', 'GBP (Pound Sterling)'), ('GEL', 'GEL (Lari)'), ('GHS', 'GHS (Ghana Cedi)'), ('GIP', 'GIP (Gibraltar Pound)'), ('GMD', 'GMD (Dalasi)'), ('GNF', 'GNF (Guinea Franc)'), ('GTQ', 'GTQ (Quetzal)'), ('GYD', 'GYD (Guyana Dollar)'), ('HKD', 'HKD (Hong Kong Dollar)'), ('HNL', 'HNL (Lempira)'), ('HRK', 'HRK (Kuna)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (Forint)'), ('IDR', 'IDR (Rupiah)'), ('ILS', 'ILS (New Israeli Sheqel)'), ('INR', 'INR (Indian Rupee)'), ('IQD', 'IQD (Iraqi Dinar)'), ('IRR', 'IRR (Iranian Rial)'), ('ISK', 'ISK (Iceland Krona)'), ('JMD', 'JMD (Jamaican Dollar)'), ('JOD', 'JOD (Jordanian Dinar)'), ('JPY', 'JPY (Yen)'), ('KES', 'KES (Kenyan Shilling)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (Riel)'), ('KMF', 'KMF (Comoro Franc)'), ('KPW', 'KPW (North Korean Won)'), ('KRW', 'KRW (Won)'), ('KWD', 'KWD (Kuwaiti Dinar)'), ('KYD', 'KYD (Cayman Islands Dollar)'), ('KZT', 'KZT (Tenge)'), ('LAK', 'LAK (Kip)'), ('LBP', 'LBP (Lebanese Pound)'), ('LKR', 'LKR (Sri Lanka Rupee)'), ('LRD', 'LRD (Liberian Dollar)'), ('LSL', 'LSL (Loti)'), ('LYD', 'LYD (Libyan Dinar)'), ('MAD', 'MAD (Moroccan Dirham)'), ('MDL', 'MDL (Moldovan Leu)'), ('MGA', 'MGA (Malagasy Ariary)'), ('MKD', 'MKD (Denar)'), ('MMK', 'MMK (Kyat)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (Pataca)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Mauritius Rupee)'), ('MVR', 'MVR (Rufiyaa)'), ('MWK', 'MWK (Malawi Kwacha)'), ('MXN', 'MXN (Mexican Peso)'), ('MYR', 'MYR (Malaysian Ringgit)'), ('MZN', 'MZN (Mozambique Metical)'), ('NAD', 'NAD (Namibia Dollar)'), ('NGN', 'NGN (Naira)'), ('NIO', 'NIO (Cordoba Oro)'), ('NOK', 'NOK (Norwegian Krone)'), ('NPR', 'NPR (Nepalese Rupee)'), ('NZD', 'NZD (New Zealand Dollar)'), ('OMR', 'OMR (Rial Omani)'), ('PAB', 'PAB (Balboa)'), ('PEN', 'PEN (Sol)'), ('PGK', 'PGK (Kina)'), ('PHP', 'PHP (Philippine Peso)'), ('PKR', 'PKR (Pakistan Rupee)'), ('PLN', 'PLN (Zloty)'), ('PYG', 'PYG (Guarani)'), ('QAR', 'QAR (Qatari Rial)'), ('RON', 'RON (Romanian Leu)'), ('RSD', 'RSD (Serbian Dinar)'), ('RUB', 'RUB (Russian Ruble)'), ('RWF', 'RWF (Rwanda Franc)'), ('SAR', 'SAR (Saudi Riyal)'), ('SBD', 'SBD (Solomon Islands Dollar)'), ('SCR', 'SCR (Seychelles Rupee)'), ('SDG', 'SDG (Sudanese Pound)'), ('SEK', 'SEK (Swedish Krona)'), ('SGD', 'SGD (Singapore Dollar)'), ('SHP', 'SHP (Saint Helena Pound)'), ('SLL', 'SLL (Leone)'), ('SOS', 'SOS (Somali Shilling)'), ('SRD', 'SRD (Surinam Dollar)'), ('SSP', 'SSP (South Sudanese Pound)'), ('STD', 'STD (Dobra)'), ('SVC', 'SVC (El Salvador Colon)'), ('SYP', 'SYP (Syrian Pound)'), ('SZL', 'SZL (Lilangeni)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (Somoni)'), ('TMT', 'TMT (Turkmenistan New Manat)'), ('TND', 'TND (Tunisian Dinar)'), ('TOP', 'TOP (Pa\u2019anga)'), ('TRY', 'TRY (Turkish Lira)'), ('TTD', 'TTD (Trinidad‡nd Tobago Dollar)'), ('TWD', 'TWD (New Taiwan Dollar)'), ('TZS', 'TZS (Tanzanian Shilling)'), ('UAH', 'UAH (Hryvnia)'), ('UGX', 'UGX (Uganda Shilling)'), ('USD', 'USD (US Dollar)'), ('UYU', 'UYU (Peso Uruguayo)'), ('UZS', 'UZS (Uzbekistan Sum)'), ('VEF', 'VEF (Bol\xedvar)'), ('VND', 'VND (Dong)'), ('VUV', 'VUV (Vatu)'), ('WST', 'WST (Tala)'), ('XAF', 'XAF (CFA Franc BEAC)'), ('XAG', 'XAG (Silver)'), ('XAU', 'XAU (Gold)'), ('XBA', 'XBA (Bond Markets Unit European Composite Unit (EURCO))'), ('XBB', 'XBB (Bond Markets Unit European Monetary Unit (E.M.U.-6))'), ('XBC', 'XBC (Bond Markets Unit European Unit of Account 9 (E.U.A.-9))'), ('XBD', 'XBD (Bond Markets Unit European Unit of Account 17 (E.U.A.-17))'), ('XCD', 'XCD (East Caribbean Dollar)'), ('XDR', 'XDR (SDR (Special Drawing Right))'), ('XOF', 'XOF (CFA Franc BCEAO)'), ('XPD', 'XPD (Palladium)'), ('XPF', 'XPF (CFP Franc)'), ('XPT', 'XPT (Platinum)'), ('XSU', 'XSU (Sucre)'), ('XTS', 'XTS (Codes specifically„eserved foresting…urposes)'), ('XUA', 'XUA (ADB Unit of Account)'), ('XXX', 'XXX (The codes‡ssigned forransactions where‚o currency is involved)'), ('YER', 'YER (Yemeni Rial)'), ('ZAR', 'ZAR (Rand)'), ('ZMW', 'ZMW (Zambian Kwacha)'), ('ZWL', 'ZWL (Zimbabwe Dollar)')]),

44 
mig¿tiÚs
.
	`AÉ”F›ld
(

45 
mod–_Çme
='proforma',

46 
Çme
='currency',

47 
f›ld
=
mod–s
.
	`Ch¬F›ld
(=
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy u£d fÜ blšg.', 
max_Ëngth
=4, 
choiûs
=[('AED', 'AED (UAE Dirham)'), ('AFN', 'AFN (Afghani)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Armenian Dram)'), ('ANG', 'ANG (Netherlands Antillean Guilder)'), ('AOA', 'AOA (Kwanza)'), ('ARS', 'ARS (Argentine Peso)'), ('AUD', 'AUD (Australian Dollar)'), ('AWG', 'AWG (Aruban Florin)'), ('AZN', 'AZN (Azerbaijanian Manat)'), ('BAM', 'BAM (Convertible Mark)'), ('BBD', 'BBD (Barbados Dollar)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulgarian Lev)'), ('BHD', 'BHD (Bahraini Dinar)'), ('BIF', 'BIF (Burundi Franc)'), ('BMD', 'BMD (Bermudian Dollar)'), ('BND', 'BND (Brunei Dollar)'), ('BOB', 'BOB (Boliviano)'), ('BRL', 'BRL (Brazilian Real)'), ('BSD', 'BSD (Bahamian Dollar)'), ('BTN', 'BTN (Ngultrum)'), ('BWP', 'BWP (Pula)'), ('BYR', 'BYR (Belarusian Ruble)'), ('BZD', 'BZD (Belize Dollar)'), ('CAD', 'CAD (Canadian Dollar)'), ('CDF', 'CDF (Congolese Franc)'), ('CHF', 'CHF (Swiss Franc)'), ('CLP', 'CLP (Chilean Peso)'), ('CNY', 'CNY (Yuan Renminbi)'), ('COP', 'COP (Colombian Peso)'), ('CRC', 'CRC (Costa Rican Colon)'), ('CUC', 'CUC (Peso Convertible)'), ('CUP', 'CUP (Cuban Peso)'), ('CVE', 'CVE (Cabo Verde Escudo)'), ('CZK', 'CZK (Czech Koruna)'), ('DJF', 'DJF (Djibouti Franc)'), ('DKK', 'DKK (Danish Krone)'), ('DOP', 'DOP (Dominican Peso)'), ('DZD', 'DZD (Algerian Dinar)'), ('EGP', 'EGP (Egyptian Pound)'), ('ERN', 'ERN (Nakfa)'), ('ETB', 'ETB (Ethiopian Birr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fiji Dollar)'), ('FKP', 'FKP (Falkland Islands Pound)'), ('GBP', 'GBP (Pound Sterling)'), ('GEL', 'GEL (Lari)'), ('GHS', 'GHS (Ghana Cedi)'), ('GIP', 'GIP (Gibraltar Pound)'), ('GMD', 'GMD (Dalasi)'), ('GNF', 'GNF (Guinea Franc)'), ('GTQ', 'GTQ (Quetzal)'), ('GYD', 'GYD (Guyana Dollar)'), ('HKD', 'HKD (Hong Kong Dollar)'), ('HNL', 'HNL (Lempira)'), ('HRK', 'HRK (Kuna)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (Forint)'), ('IDR', 'IDR (Rupiah)'), ('ILS', 'ILS (New Israeli Sheqel)'), ('INR', 'INR (Indian Rupee)'), ('IQD', 'IQD (Iraqi Dinar)'), ('IRR', 'IRR (Iranian Rial)'), ('ISK', 'ISK (Iceland Krona)'), ('JMD', 'JMD (Jamaican Dollar)'), ('JOD', 'JOD (Jordanian Dinar)'), ('JPY', 'JPY (Yen)'), ('KES', 'KES (Kenyan Shilling)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (Riel)'), ('KMF', 'KMF (Comoro Franc)'), ('KPW', 'KPW (North Korean Won)'), ('KRW', 'KRW (Won)'), ('KWD', 'KWD (Kuwaiti Dinar)'), ('KYD', 'KYD (Cayman Islands Dollar)'), ('KZT', 'KZT (Tenge)'), ('LAK', 'LAK (Kip)'), ('LBP', 'LBP (Lebanese Pound)'), ('LKR', 'LKR (Sri Lanka Rupee)'), ('LRD', 'LRD (Liberian Dollar)'), ('LSL', 'LSL (Loti)'), ('LYD', 'LYD (Libyan Dinar)'), ('MAD', 'MAD (Moroccan Dirham)'), ('MDL', 'MDL (Moldovan Leu)'), ('MGA', 'MGA (Malagasy Ariary)'), ('MKD', 'MKD (Denar)'), ('MMK', 'MMK (Kyat)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (Pataca)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Mauritius Rupee)'), ('MVR', 'MVR (Rufiyaa)'), ('MWK', 'MWK (Malawi Kwacha)'), ('MXN', 'MXN (Mexican Peso)'), ('MYR', 'MYR (Malaysian Ringgit)'), ('MZN', 'MZN (Mozambique Metical)'), ('NAD', 'NAD (Namibia Dollar)'), ('NGN', 'NGN (Naira)'), ('NIO', 'NIO (Cordoba Oro)'), ('NOK', 'NOK (Norwegian Krone)'), ('NPR', 'NPR (Nepalese Rupee)'), ('NZD', 'NZD (New Zealand Dollar)'), ('OMR', 'OMR (Rial Omani)'), ('PAB', 'PAB (Balboa)'), ('PEN', 'PEN (Sol)'), ('PGK', 'PGK (Kina)'), ('PHP', 'PHP (Philippine Peso)'), ('PKR', 'PKR (Pakistan Rupee)'), ('PLN', 'PLN (Zloty)'), ('PYG', 'PYG (Guarani)'), ('QAR', 'QAR (Qatari Rial)'), ('RON', 'RON (Romanian Leu)'), ('RSD', 'RSD (Serbian Dinar)'), ('RUB', 'RUB (Russian Ruble)'), ('RWF', 'RWF (Rwanda Franc)'), ('SAR', 'SAR (Saudi Riyal)'), ('SBD', 'SBD (Solomon Islands Dollar)'), ('SCR', 'SCR (Seychelles Rupee)'), ('SDG', 'SDG (Sudanese Pound)'), ('SEK', 'SEK (Swedish Krona)'), ('SGD', 'SGD (Singapore Dollar)'), ('SHP', 'SHP (Saint Helena Pound)'), ('SLL', 'SLL (Leone)'), ('SOS', 'SOS (Somali Shilling)'), ('SRD', 'SRD (Surinam Dollar)'), ('SSP', 'SSP (South Sudanese Pound)'), ('STD', 'STD (Dobra)'), ('SVC', 'SVC (El Salvador Colon)'), ('SYP', 'SYP (Syrian Pound)'), ('SZL', 'SZL (Lilangeni)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (Somoni)'), ('TMT', 'TMT (Turkmenistan New Manat)'), ('TND', 'TND (Tunisian Dinar)'), ('TOP', 'TOP (Pa\u2019anga)'), ('TRY', 'TRY (Turkish Lira)'), ('TTD', 'TTD (Trinidad‡nd Tobago Dollar)'), ('TWD', 'TWD (New Taiwan Dollar)'), ('TZS', 'TZS (Tanzanian Shilling)'), ('UAH', 'UAH (Hryvnia)'), ('UGX', 'UGX (Uganda Shilling)'), ('USD', 'USD (US Dollar)'), ('UYU', 'UYU (Peso Uruguayo)'), ('UZS', 'UZS (Uzbekistan Sum)'), ('VEF', 'VEF (Bol\xedvar)'), ('VND', 'VND (Dong)'), ('VUV', 'VUV (Vatu)'), ('WST', 'WST (Tala)'), ('XAF', 'XAF (CFA Franc BEAC)'), ('XAG', 'XAG (Silver)'), ('XAU', 'XAU (Gold)'), ('XBA', 'XBA (Bond Markets Unit European Composite Unit (EURCO))'), ('XBB', 'XBB (Bond Markets Unit European Monetary Unit (E.M.U.-6))'), ('XBC', 'XBC (Bond Markets Unit European Unit of Account 9 (E.U.A.-9))'), ('XBD', 'XBD (Bond Markets Unit European Unit of Account 17 (E.U.A.-17))'), ('XCD', 'XCD (East Caribbean Dollar)'), ('XDR', 'XDR (SDR (Special Drawing Right))'), ('XOF', 'XOF (CFA Franc BCEAO)'), ('XPD', 'XPD (Palladium)'), ('XPF', 'XPF (CFP Franc)'), ('XPT', 'XPT (Platinum)'), ('XSU', 'XSU (Sucre)'), ('XTS', 'XTS (Codes specifically„eserved foresting…urposes)'), ('XUA', 'XUA (ADB Unit of Account)'), ('XXX', 'XXX (The codes‡ssigned forransactions where‚o currency is involved)'), ('YER', 'YER (Yemeni Rial)'), ('ZAR', 'ZAR (Rand)'), ('ZMW', 'ZMW (Zambian Kwacha)'), ('ZWL', 'ZWL (Zimbabwe Dollar)')]),

49 
mig¿tiÚs
.
	`AÉ”F›ld
(

50 
mod–_Çme
='proforma',

51 
Çme
='transaction_currency',

52 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
h–p_‹xt
=
b
'Thcu¼’cy u£d wh’ makšg‡¿n§ùiÚ.', 
max_Ëngth
=4, 
choiûs
=[('AED', 'AED (UAE Dirham)'), ('AFN', 'AFN (Afghani)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Armenian Dram)'), ('ANG', 'ANG (Netherlands Antillean Guilder)'), ('AOA', 'AOA (Kwanza)'), ('ARS', 'ARS (Argentine Peso)'), ('AUD', 'AUD (Australian Dollar)'), ('AWG', 'AWG (Aruban Florin)'), ('AZN', 'AZN (Azerbaijanian Manat)'), ('BAM', 'BAM (Convertible Mark)'), ('BBD', 'BBD (Barbados Dollar)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulgarian Lev)'), ('BHD', 'BHD (Bahraini Dinar)'), ('BIF', 'BIF (Burundi Franc)'), ('BMD', 'BMD (Bermudian Dollar)'), ('BND', 'BND (Brunei Dollar)'), ('BOB', 'BOB (Boliviano)'), ('BRL', 'BRL (Brazilian Real)'), ('BSD', 'BSD (Bahamian Dollar)'), ('BTN', 'BTN (Ngultrum)'), ('BWP', 'BWP (Pula)'), ('BYR', 'BYR (Belarusian Ruble)'), ('BZD', 'BZD (Belize Dollar)'), ('CAD', 'CAD (Canadian Dollar)'), ('CDF', 'CDF (Congolese Franc)'), ('CHF', 'CHF (Swiss Franc)'), ('CLP', 'CLP (Chilean Peso)'), ('CNY', 'CNY (Yuan Renminbi)'), ('COP', 'COP (Colombian Peso)'), ('CRC', 'CRC (Costa Rican Colon)'), ('CUC', 'CUC (Peso Convertible)'), ('CUP', 'CUP (Cuban Peso)'), ('CVE', 'CVE (Cabo Verde Escudo)'), ('CZK', 'CZK (Czech Koruna)'), ('DJF', 'DJF (Djibouti Franc)'), ('DKK', 'DKK (Danish Krone)'), ('DOP', 'DOP (Dominican Peso)'), ('DZD', 'DZD (Algerian Dinar)'), ('EGP', 'EGP (Egyptian Pound)'), ('ERN', 'ERN (Nakfa)'), ('ETB', 'ETB (Ethiopian Birr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fiji Dollar)'), ('FKP', 'FKP (Falkland Islands Pound)'), ('GBP', 'GBP (Pound Sterling)'), ('GEL', 'GEL (Lari)'), ('GHS', 'GHS (Ghana Cedi)'), ('GIP', 'GIP (Gibraltar Pound)'), ('GMD', 'GMD (Dalasi)'), ('GNF', 'GNF (Guinea Franc)'), ('GTQ', 'GTQ (Quetzal)'), ('GYD', 'GYD (Guyana Dollar)'), ('HKD', 'HKD (Hong Kong Dollar)'), ('HNL', 'HNL (Lempira)'), ('HRK', 'HRK (Kuna)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (Forint)'), ('IDR', 'IDR (Rupiah)'), ('ILS', 'ILS (New Israeli Sheqel)'), ('INR', 'INR (Indian Rupee)'), ('IQD', 'IQD (Iraqi Dinar)'), ('IRR', 'IRR (Iranian Rial)'), ('ISK', 'ISK (Iceland Krona)'), ('JMD', 'JMD (Jamaican Dollar)'), ('JOD', 'JOD (Jordanian Dinar)'), ('JPY', 'JPY (Yen)'), ('KES', 'KES (Kenyan Shilling)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (Riel)'), ('KMF', 'KMF (Comoro Franc)'), ('KPW', 'KPW (North Korean Won)'), ('KRW', 'KRW (Won)'), ('KWD', 'KWD (Kuwaiti Dinar)'), ('KYD', 'KYD (Cayman Islands Dollar)'), ('KZT', 'KZT (Tenge)'), ('LAK', 'LAK (Kip)'), ('LBP', 'LBP (Lebanese Pound)'), ('LKR', 'LKR (Sri Lanka Rupee)'), ('LRD', 'LRD (Liberian Dollar)'), ('LSL', 'LSL (Loti)'), ('LYD', 'LYD (Libyan Dinar)'), ('MAD', 'MAD (Moroccan Dirham)'), ('MDL', 'MDL (Moldovan Leu)'), ('MGA', 'MGA (Malagasy Ariary)'), ('MKD', 'MKD (Denar)'), ('MMK', 'MMK (Kyat)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (Pataca)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Mauritius Rupee)'), ('MVR', 'MVR (Rufiyaa)'), ('MWK', 'MWK (Malawi Kwacha)'), ('MXN', 'MXN (Mexican Peso)'), ('MYR', 'MYR (Malaysian Ringgit)'), ('MZN', 'MZN (Mozambique Metical)'), ('NAD', 'NAD (Namibia Dollar)'), ('NGN', 'NGN (Naira)'), ('NIO', 'NIO (Cordoba Oro)'), ('NOK', 'NOK (Norwegian Krone)'), ('NPR', 'NPR (Nepalese Rupee)'), ('NZD', 'NZD (New Zealand Dollar)'), ('OMR', 'OMR (Rial Omani)'), ('PAB', 'PAB (Balboa)'), ('PEN', 'PEN (Sol)'), ('PGK', 'PGK (Kina)'), ('PHP', 'PHP (Philippine Peso)'), ('PKR', 'PKR (Pakistan Rupee)'), ('PLN', 'PLN (Zloty)'), ('PYG', 'PYG (Guarani)'), ('QAR', 'QAR (Qatari Rial)'), ('RON', 'RON (Romanian Leu)'), ('RSD', 'RSD (Serbian Dinar)'), ('RUB', 'RUB (Russian Ruble)'), ('RWF', 'RWF (Rwanda Franc)'), ('SAR', 'SAR (Saudi Riyal)'), ('SBD', 'SBD (Solomon Islands Dollar)'), ('SCR', 'SCR (Seychelles Rupee)'), ('SDG', 'SDG (Sudanese Pound)'), ('SEK', 'SEK (Swedish Krona)'), ('SGD', 'SGD (Singapore Dollar)'), ('SHP', 'SHP (Saint Helena Pound)'), ('SLL', 'SLL (Leone)'), ('SOS', 'SOS (Somali Shilling)'), ('SRD', 'SRD (Surinam Dollar)'), ('SSP', 'SSP (South Sudanese Pound)'), ('STD', 'STD (Dobra)'), ('SVC', 'SVC (El Salvador Colon)'), ('SYP', 'SYP (Syrian Pound)'), ('SZL', 'SZL (Lilangeni)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (Somoni)'), ('TMT', 'TMT (Turkmenistan New Manat)'), ('TND', 'TND (Tunisian Dinar)'), ('TOP', 'TOP (Pa\u2019anga)'), ('TRY', 'TRY (Turkish Lira)'), ('TTD', 'TTD (Trinidad‡nd Tobago Dollar)'), ('TWD', 'TWD (New Taiwan Dollar)'), ('TZS', 'TZS (Tanzanian Shilling)'), ('UAH', 'UAH (Hryvnia)'), ('UGX', 'UGX (Uganda Shilling)'), ('USD', 'USD (US Dollar)'), ('UYU', 'UYU (Peso Uruguayo)'), ('UZS', 'UZS (Uzbekistan Sum)'), ('VEF', 'VEF (Bol\xedvar)'), ('VND', 'VND (Dong)'), ('VUV', 'VUV (Vatu)'), ('WST', 'WST (Tala)'), ('XAF', 'XAF (CFA Franc BEAC)'), ('XAG', 'XAG (Silver)'), ('XAU', 'XAU (Gold)'), ('XBA', 'XBA (Bond Markets Unit European Composite Unit (EURCO))'), ('XBB', 'XBB (Bond Markets Unit European Monetary Unit (E.M.U.-6))'), ('XBC', 'XBC (Bond Markets Unit European Unit of Account 9 (E.U.A.-9))'), ('XBD', 'XBD (Bond Markets Unit European Unit of Account 17 (E.U.A.-17))'), ('XCD', 'XCD (East Caribbean Dollar)'), ('XDR', 'XDR (SDR (Special Drawing Right))'), ('XOF', 'XOF (CFA Franc BCEAO)'), ('XPD', 'XPD (Palladium)'), ('XPF', 'XPF (CFP Franc)'), ('XPT', 'XPT (Platinum)'), ('XSU', 'XSU (Sucre)'), ('XTS', 'XTS (Codes specifically„eserved foresting…urposes)'), ('XUA', 'XUA (ADB Unit of Account)'), ('XXX', 'XXX (The codes‡ssigned forransactions where‚o currency is involved)'), ('YER', 'YER (Yemeni Rial)'), ('ZAR', 'ZAR (Rand)'), ('ZMW', 'ZMW (Zambian Kwacha)'), ('ZWL', 'ZWL (Zimbabwe Dollar)')]),

54 
mig¿tiÚs
.
	`AÉ”F›ld
(

55 
mod–_Çme
='proforma',

56 
Çme
='transaction_xe_rate',

57 
f›ld
=
mod–s
.
	`Decim®F›ld
(
h–p_‹xt
=
b
'Cu¼’cyƒxchªg¿‹ from docum’ˆcu¼’cyØŒª§ùiÚ_cu¼’cy.', 
nuÎ
=
True
, 
max_dig™s
=16, 
decim®_¶aûs
=4, 
bÏnk
=True),

59 
mig¿tiÚs
.
	`AÉ”F›ld
(

60 
mod–_Çme
='provider',

61 
Çme
='country',

62 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
max_Ëngth
=3, 
choiûs
=[('AD', 'Andorra'), ('AE', 'United Arab Emirates'), ('AF', 'Afghanistan'), ('AG', 'Antigua‡nd Barbuda'), ('AI', 'Anguilla'), ('AL', 'Albania'), ('AM', 'Armenia'), ('AO', 'Angola'), ('AQ', 'Antarctica'), ('AR', 'Argentina'), ('AS', 'American Samoa'), ('AT', 'Austria'), ('AU', 'Australia'), ('AW', 'Aruba'), ('AX', '\xc5land Islands'), ('AZ', 'Azerbaijan'), ('BA', 'Bosnia‡nd Herzegovina'), ('BB', 'Barbados'), ('BD', 'Bangladesh'), ('BE', 'Belgium'), ('BF', 'Burkina Faso'), ('BG', 'Bulgaria'), ('BH', 'Bahrain'), ('BI', 'Burundi'), ('BJ', 'Benin'), ('BL', 'Saint Barth\xe9lemy'), ('BM', 'Bermuda'), ('BN', 'Brunei Darussalam'), ('BO', 'Bolivia, Plurinational State of'), ('BQ', 'Bonaire, Sint Eustatius‡nd Saba'), ('BR', 'Brazil'), ('BS', 'Bahamas'), ('BT', 'Bhutan'), ('BV', 'Bouvet Island'), ('BW', 'Botswana'), ('BY', 'Belarus'), ('BZ', 'Belize'), ('CA', 'Canada'), ('CC', 'Cocos (Keeling) Islands'), ('CD', 'Congo, The Democratic Republic ofhe'), ('CF', 'Central African Republic'), ('CG', 'Congo'), ('CH', 'Switzerland'), ('CI', "C\xf4te d'Ivoire"), ('CK', 'Cook Islands'), ('CL', 'Chile'), ('CM', 'Cameroon'), ('CN', 'China'), ('CO', 'Colombia'), ('CR', 'Costa Rica'), ('CU', 'Cuba'), ('CV', 'Cabo Verde'), ('CW', 'Cura\xe7ao'), ('CX', 'Christmas Island'), ('CY', 'Cyprus'), ('CZ', 'Czech Republic'), ('DE', 'Germany'), ('DJ', 'Djibouti'), ('DK', 'Denmark'), ('DM', 'Dominica'), ('DO', 'Dominican Republic'), ('DZ', 'Algeria'), ('EC', 'Ecuador'), ('EE', 'Estonia'), ('EG', 'Egypt'), ('EH', 'Western Sahara'), ('ER', 'Eritrea'), ('ES', 'Spain'), ('ET', 'Ethiopia'), ('FI', 'Finland'), ('FJ', 'Fiji'), ('FK', 'Falkland Islands (Malvinas)'), ('FM', 'Micronesia, Federated States of'), ('FO', 'Faroe Islands'), ('FR', 'France'), ('GA', 'Gabon'), ('GB', 'United Kingdom'), ('GD', 'Grenada'), ('GE', 'Georgia'), ('GF', 'French Guiana'), ('GG', 'Guernsey'), ('GH', 'Ghana'), ('GI', 'Gibraltar'), ('GL', 'Greenland'), ('GM', 'Gambia'), ('GN', 'Guinea'), ('GP', 'Guadeloupe'), ('GQ', 'Equatorial Guinea'), ('GR', 'Greece'), ('GS', 'South Georgia‡ndhe South Sandwich Islands'), ('GT', 'Guatemala'), ('GU', 'Guam'), ('GW', 'Guinea-Bissau'), ('GY', 'Guyana'), ('HK', 'Hong Kong'), ('HM', 'Heard Island‡nd McDonald Islands'), ('HN', 'Honduras'), ('HR', 'Croatia'), ('HT', 'Haiti'), ('HU', 'Hungary'), ('ID', 'Indonesia'), ('IE', 'Ireland'), ('IL', 'Israel'), ('IM', 'Isle of Man'), ('IN', 'India'), ('IO', 'British Indian Ocean Territory'), ('IQ', 'Iraq'), ('IR', 'Iran, Islamic Republic of'), ('IS', 'Iceland'), ('IT', 'Italy'), ('JE', 'Jersey'), ('JM', 'Jamaica'), ('JO', 'Jordan'), ('JP', 'Japan'), ('KE', 'Kenya'), ('KG', 'Kyrgyzstan'), ('KH', 'Cambodia'), ('KI', 'Kiribati'), ('KM', 'Comoros'), ('KN', 'Saint Kitts‡nd Nevis'), ('KP', "Korea, Democratic People's Republic of"), ('KR', 'Korea, Republic of'), ('KW', 'Kuwait'), ('KY', 'Cayman Islands'), ('KZ', 'Kazakhstan'), ('LA', "Lao People's Democratic Republic"), ('LB', 'Lebanon'), ('LC', 'Saint Lucia'), ('LI', 'Liechtenstein'), ('LK', 'Sri Lanka'), ('LR', 'Liberia'), ('LS', 'Lesotho'), ('LT', 'Lithuania'), ('LU', 'Luxembourg'), ('LV', 'Latvia'), ('LY', 'Libya'), ('MA', 'Morocco'), ('MC', 'Monaco'), ('MD', 'Moldova, Republic of'), ('ME', 'Montenegro'), ('MF', 'Saint Martin (French…art)'), ('MG', 'Madagascar'), ('MH', 'Marshall Islands'), ('MK', 'Macedonia, Republic of'), ('ML', 'Mali'), ('MM', 'Myanmar'), ('MN', 'Mongolia'), ('MO', 'Macao'), ('MP', 'Northern Mariana Islands'), ('MQ', 'Martinique'), ('MR', 'Mauritania'), ('MS', 'Montserrat'), ('MT', 'Malta'), ('MU', 'Mauritius'), ('MV', 'Maldives'), ('MW', 'Malawi'), ('MX', 'Mexico'), ('MY', 'Malaysia'), ('MZ', 'Mozambique'), ('NA', 'Namibia'), ('NC', 'New Caledonia'), ('NE', 'Niger'), ('NF', 'Norfolk Island'), ('NG', 'Nigeria'), ('NI', 'Nicaragua'), ('NL', 'Netherlands'), ('NO', 'Norway'), ('NP', 'Nepal'), ('NR', 'Nauru'), ('NU', 'Niue'), ('NZ', 'New Zealand'), ('OM', 'Oman'), ('PA', 'Panama'), ('PE', 'Peru'), ('PF', 'French Polynesia'), ('PG', 'Papua New Guinea'), ('PH', 'Philippines'), ('PK', 'Pakistan'), ('PL', 'Poland'), ('PM', 'Saint Pierre‡nd Miquelon'), ('PN', 'Pitcairn'), ('PR', 'Puerto Rico'), ('PS', 'Palestine, State of'), ('PT', 'Portugal'), ('PW', 'Palau'), ('PY', 'Paraguay'), ('QA', 'Qatar'), ('RE', 'R\xe9union'), ('RO', 'Romania'), ('RS', 'Serbia'), ('RU', 'Russian Federation'), ('RW', 'Rwanda'), ('SA', 'Saudi Arabia'), ('SB', 'Solomon Islands'), ('SC', 'Seychelles'), ('SD', 'Sudan'), ('SE', 'Sweden'), ('SG', 'Singapore'), ('SH', 'Saint Helena, Ascension‡nd Tristan da Cunha'), ('SI', 'Slovenia'), ('SJ', 'Svalbard‡nd Jan Mayen'), ('SK', 'Slovakia'), ('SL', 'Sierra Leone'), ('SM', 'San Marino'), ('SN', 'Senegal'), ('SO', 'Somalia'), ('SR', 'Suriname'), ('SS', 'South Sudan'), ('ST', 'Sao Tome‡nd Principe'), ('SV', 'El Salvador'), ('SX', 'Sint Maarten (Dutch…art)'), ('SY', 'Syrian Arab Republic'), ('SZ', 'Swaziland'), ('TC', 'Turks‡nd Caicos Islands'), ('TD', 'Chad'), ('TF', 'French Southern Territories'), ('TG', 'Togo'), ('TH', 'Thailand'), ('TJ', 'Tajikistan'), ('TK', 'Tokelau'), ('TL', 'Timor-Leste'), ('TM', 'Turkmenistan'), ('TN', 'Tunisia'), ('TO', 'Tonga'), ('TR', 'Turkey'), ('TT', 'Trinidad‡nd Tobago'), ('TV', 'Tuvalu'), ('TW', 'Taiwan, Province of China'), ('TZ', 'Tanzania, United Republic of'), ('UA', 'Ukraine'), ('UG', 'Uganda'), ('UM', 'United States Minor Outlying Islands'), ('US', 'United States'), ('UY', 'Uruguay'), ('UZ', 'Uzbekistan'), ('VA', 'Holy See (Vatican City State)'), ('VC', 'Saint Vincent‡ndhe Grenadines'), ('VE', 'Venezuela, Bolivarian Republic of'), ('VG', 'Virgin Islands, British'), ('VI', 'Virgin Islands, U.S.'), ('VN', 'Viet Nam'), ('VU', 'Vanuatu'), ('WF', 'Wallis‡nd Futuna'), ('WS', 'Samoa'), ('YE', 'Yemen'), ('YT', 'Mayotte'), ('ZA', 'South Africa'), ('ZM', 'Zambia'), ('ZW', 'Zimbabwe')]),

64 
mig¿tiÚs
.
	`AÉ”F›ld
(

65 
mod–_Çme
='transaction',

66 
Çme
='currency',

67 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
h–p_‹xt
=
b
'Thcu¼’cy u£d fÜ blšg.', 
max_Ëngth
=4, 
choiûs
=[('AED', 'AED (UAE Dirham)'), ('AFN', 'AFN (Afghani)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Armenian Dram)'), ('ANG', 'ANG (Netherlands Antillean Guilder)'), ('AOA', 'AOA (Kwanza)'), ('ARS', 'ARS (Argentine Peso)'), ('AUD', 'AUD (Australian Dollar)'), ('AWG', 'AWG (Aruban Florin)'), ('AZN', 'AZN (Azerbaijanian Manat)'), ('BAM', 'BAM (Convertible Mark)'), ('BBD', 'BBD (Barbados Dollar)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulgarian Lev)'), ('BHD', 'BHD (Bahraini Dinar)'), ('BIF', 'BIF (Burundi Franc)'), ('BMD', 'BMD (Bermudian Dollar)'), ('BND', 'BND (Brunei Dollar)'), ('BOB', 'BOB (Boliviano)'), ('BRL', 'BRL (Brazilian Real)'), ('BSD', 'BSD (Bahamian Dollar)'), ('BTN', 'BTN (Ngultrum)'), ('BWP', 'BWP (Pula)'), ('BYR', 'BYR (Belarusian Ruble)'), ('BZD', 'BZD (Belize Dollar)'), ('CAD', 'CAD (Canadian Dollar)'), ('CDF', 'CDF (Congolese Franc)'), ('CHF', 'CHF (Swiss Franc)'), ('CLP', 'CLP (Chilean Peso)'), ('CNY', 'CNY (Yuan Renminbi)'), ('COP', 'COP (Colombian Peso)'), ('CRC', 'CRC (Costa Rican Colon)'), ('CUC', 'CUC (Peso Convertible)'), ('CUP', 'CUP (Cuban Peso)'), ('CVE', 'CVE (Cabo Verde Escudo)'), ('CZK', 'CZK (Czech Koruna)'), ('DJF', 'DJF (Djibouti Franc)'), ('DKK', 'DKK (Danish Krone)'), ('DOP', 'DOP (Dominican Peso)'), ('DZD', 'DZD (Algerian Dinar)'), ('EGP', 'EGP (Egyptian Pound)'), ('ERN', 'ERN (Nakfa)'), ('ETB', 'ETB (Ethiopian Birr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fiji Dollar)'), ('FKP', 'FKP (Falkland Islands Pound)'), ('GBP', 'GBP (Pound Sterling)'), ('GEL', 'GEL (Lari)'), ('GHS', 'GHS (Ghana Cedi)'), ('GIP', 'GIP (Gibraltar Pound)'), ('GMD', 'GMD (Dalasi)'), ('GNF', 'GNF (Guinea Franc)'), ('GTQ', 'GTQ (Quetzal)'), ('GYD', 'GYD (Guyana Dollar)'), ('HKD', 'HKD (Hong Kong Dollar)'), ('HNL', 'HNL (Lempira)'), ('HRK', 'HRK (Kuna)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (Forint)'), ('IDR', 'IDR (Rupiah)'), ('ILS', 'ILS (New Israeli Sheqel)'), ('INR', 'INR (Indian Rupee)'), ('IQD', 'IQD (Iraqi Dinar)'), ('IRR', 'IRR (Iranian Rial)'), ('ISK', 'ISK (Iceland Krona)'), ('JMD', 'JMD (Jamaican Dollar)'), ('JOD', 'JOD (Jordanian Dinar)'), ('JPY', 'JPY (Yen)'), ('KES', 'KES (Kenyan Shilling)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (Riel)'), ('KMF', 'KMF (Comoro Franc)'), ('KPW', 'KPW (North Korean Won)'), ('KRW', 'KRW (Won)'), ('KWD', 'KWD (Kuwaiti Dinar)'), ('KYD', 'KYD (Cayman Islands Dollar)'), ('KZT', 'KZT (Tenge)'), ('LAK', 'LAK (Kip)'), ('LBP', 'LBP (Lebanese Pound)'), ('LKR', 'LKR (Sri Lanka Rupee)'), ('LRD', 'LRD (Liberian Dollar)'), ('LSL', 'LSL (Loti)'), ('LYD', 'LYD (Libyan Dinar)'), ('MAD', 'MAD (Moroccan Dirham)'), ('MDL', 'MDL (Moldovan Leu)'), ('MGA', 'MGA (Malagasy Ariary)'), ('MKD', 'MKD (Denar)'), ('MMK', 'MMK (Kyat)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (Pataca)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Mauritius Rupee)'), ('MVR', 'MVR (Rufiyaa)'), ('MWK', 'MWK (Malawi Kwacha)'), ('MXN', 'MXN (Mexican Peso)'), ('MYR', 'MYR (Malaysian Ringgit)'), ('MZN', 'MZN (Mozambique Metical)'), ('NAD', 'NAD (Namibia Dollar)'), ('NGN', 'NGN (Naira)'), ('NIO', 'NIO (Cordoba Oro)'), ('NOK', 'NOK (Norwegian Krone)'), ('NPR', 'NPR (Nepalese Rupee)'), ('NZD', 'NZD (New Zealand Dollar)'), ('OMR', 'OMR (Rial Omani)'), ('PAB', 'PAB (Balboa)'), ('PEN', 'PEN (Sol)'), ('PGK', 'PGK (Kina)'), ('PHP', 'PHP (Philippine Peso)'), ('PKR', 'PKR (Pakistan Rupee)'), ('PLN', 'PLN (Zloty)'), ('PYG', 'PYG (Guarani)'), ('QAR', 'QAR (Qatari Rial)'), ('RON', 'RON (Romanian Leu)'), ('RSD', 'RSD (Serbian Dinar)'), ('RUB', 'RUB (Russian Ruble)'), ('RWF', 'RWF (Rwanda Franc)'), ('SAR', 'SAR (Saudi Riyal)'), ('SBD', 'SBD (Solomon Islands Dollar)'), ('SCR', 'SCR (Seychelles Rupee)'), ('SDG', 'SDG (Sudanese Pound)'), ('SEK', 'SEK (Swedish Krona)'), ('SGD', 'SGD (Singapore Dollar)'), ('SHP', 'SHP (Saint Helena Pound)'), ('SLL', 'SLL (Leone)'), ('SOS', 'SOS (Somali Shilling)'), ('SRD', 'SRD (Surinam Dollar)'), ('SSP', 'SSP (South Sudanese Pound)'), ('STD', 'STD (Dobra)'), ('SVC', 'SVC (El Salvador Colon)'), ('SYP', 'SYP (Syrian Pound)'), ('SZL', 'SZL (Lilangeni)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (Somoni)'), ('TMT', 'TMT (Turkmenistan New Manat)'), ('TND', 'TND (Tunisian Dinar)'), ('TOP', 'TOP (Pa\u2019anga)'), ('TRY', 'TRY (Turkish Lira)'), ('TTD', 'TTD (Trinidad‡nd Tobago Dollar)'), ('TWD', 'TWD (New Taiwan Dollar)'), ('TZS', 'TZS (Tanzanian Shilling)'), ('UAH', 'UAH (Hryvnia)'), ('UGX', 'UGX (Uganda Shilling)'), ('USD', 'USD (US Dollar)'), ('UYU', 'UYU (Peso Uruguayo)'), ('UZS', 'UZS (Uzbekistan Sum)'), ('VEF', 'VEF (Bol\xedvar)'), ('VND', 'VND (Dong)'), ('VUV', 'VUV (Vatu)'), ('WST', 'WST (Tala)'), ('XAF', 'XAF (CFA Franc BEAC)'), ('XAG', 'XAG (Silver)'), ('XAU', 'XAU (Gold)'), ('XBA', 'XBA (Bond Markets Unit European Composite Unit (EURCO))'), ('XBB', 'XBB (Bond Markets Unit European Monetary Unit (E.M.U.-6))'), ('XBC', 'XBC (Bond Markets Unit European Unit of Account 9 (E.U.A.-9))'), ('XBD', 'XBD (Bond Markets Unit European Unit of Account 17 (E.U.A.-17))'), ('XCD', 'XCD (East Caribbean Dollar)'), ('XDR', 'XDR (SDR (Special Drawing Right))'), ('XOF', 'XOF (CFA Franc BCEAO)'), ('XPD', 'XPD (Palladium)'), ('XPF', 'XPF (CFP Franc)'), ('XPT', 'XPT (Platinum)'), ('XSU', 'XSU (Sucre)'), ('XTS', 'XTS (Codes specifically„eserved foresting…urposes)'), ('XUA', 'XUA (ADB Unit of Account)'), ('XXX', 'XXX (The codes‡ssigned forransactions where‚o currency is involved)'), ('YER', 'YER (Yemeni Rial)'), ('ZAR', 'ZAR (Rand)'), ('ZMW', 'ZMW (Zambian Kwacha)'), ('ZWL', 'ZWL (Zimbabwe Dollar)')]),

69 
mig¿tiÚs
.
	`AÉ”F›ld
(

70 
mod–_Çme
='transaction',

71 
Çme
='fail_code',

72 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
bÏnk
=
True
, 
max_Ëngth
=32, 
nuÎ
=True, 
choiûs
=[(
b
'transaction_declined_by_bank', b'transaction_declined_by_bank'), (b'transaction_hard_declined', b'transaction_hard_declined'), (b'invalid_payment_method', b'invalid_payment_method'), (b'expired_payment_method', b'expired_payment_method'), (b'default', b'default'), (b'invalid_card', b'invalid_card'), (b'insufficient_funds', b'insufficient_funds'), (b'transaction_declined', b'transaction_declined'), (b'expired_card', b'expired_card'), (b'transaction_hard_declined_by_bank', b'transaction_hard_declined_by_bank'), (b'limit_exceeded', b'limit_exceeded')]),

	@silver/migrations/0036_auto_20170514_1627.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


4 
impÜt
 
uuid


5 
äom
 
™”toŞs
 
impÜt
 
chaš


7 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


9 
impÜt
 
	gsv”
.
	gmod–s
.
	gdocum’ts
.
pdf


12 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

14 
d•’d’c›s
 = [

18 
def
 
	$move_pdf_äom_docum’ts_to_mod–
(
­ps
, 
schema_ed™Ü
):

19 
db_®Ÿs
 = 
schema_ed™Ü
.
cÚÃùiÚ
.
®Ÿs


21 
Invoiû
 = 
­ps
.
	`g‘_mod–
('silver', 'Invoice')

22 
ProfÜma
 = 
­ps
.
	`g‘_mod–
('silver', 'Proforma')

23 
PDF
 = 
­ps
.
	`g‘_mod–
('silver', 'PDF')

25 
docum’t
 
š
 
	`chaš
(

26 
Invoiû
.
objeùs
.
	`usšg
(
db_®Ÿs
).
	`exşude
(
¡©e
='draft'),

27 
ProfÜma
.
objeùs
.
	`usšg
(
db_®Ÿs
).
	`exşude
(
¡©e
='draft'),

29 
pdf_objeù
 = 
PDF
.
objeùs
.
	`usšg
(
db_®Ÿs
).
	$ü—‹
()

30 
pdf_objeù
.
pdf_fe
 = 
docum’t
.
pdf_Şd


31 
pdf_objeù
.
	$§ve
(
usšg
=
db_®Ÿs
)

33 
docum’t
.
pdf
 = 
pdf_objeù


34 
docum’t
.
	$§ve
(
usšg
=
db_®Ÿs
)

36 
def
 
	$move_pdf_äom_mod–_to_docum’ts
(
­ps
, 
schema_ed™Ü
):

37 
db_®Ÿs
 = 
schema_ed™Ü
.
cÚÃùiÚ
.
®Ÿs


39 
Invoiû
 = 
­ps
.
	`g‘_mod–
('silver', 'Invoice')

40 
ProfÜma
 = 
­ps
.
	`g‘_mod–
('silver', 'Proforma')

42 
docum’t
 
š
 
	`chaš
(

43 
Invoiû
.
objeùs
.
	`usšg
(
db_®Ÿs
).
	`exşude
(
¡©e
='draft'),

44 
ProfÜma
.
objeùs
.
	`usšg
(
db_®Ÿs
).
	`exşude
(
¡©e
='draft'),

46 
docum’t
.
pdf_Şd
 = docum’t.
pdf
.
pdf_fe


47 
docum’t
.
	$§ve
()

49 
İ”©iÚs
 = [

50 
mig¿tiÚs
.
	`C»©eMod–
(

51 
Çme
='PDF',

52 
f›lds
=[

53 ('id', 
mod–s
.
	`AutoF›ld
(
v”bo£_Çme
='ID', 
£rŸlize
=
F®£
, 
auto_ü—‹d
=
True
, 
´im¬y_key
=True)),

54 ('uuid', 
mod–s
.
	`UUIDF›ld
(=
uuid
.
uuid4
, 
unique
=
True
)),

55 ('pdf_fe', 
mod–s
.
	`FeF›ld
(
u¶ßd_to
=
sv”
.mod–s.
docum’ts
.
pdf
.
g‘_u¶ßd_·th
, 
nuÎ
=
True
, 
ed™abË
=
F®£
, 
bÏnk
=True)),

56 ('dœty', 
mod–s
.
	`BoŞ—nF›ld
(=
F®£
)),

57 ('u¶ßd_·th', 
mod–s
.
	`TextF›ld
(
nuÎ
=
True
, 
bÏnk
=True)),

60 
mig¿tiÚs
.
	`R’ameF›ld
(

61 
mod–_Çme
='invoice',

62 
Şd_Çme
='pdf',

63 
Ãw_Çme
='pdf_old'

65 
mig¿tiÚs
.
	`R’ameF›ld
(

66 
mod–_Çme
='proforma',

67 
Şd_Çme
='pdf',

68 
Ãw_Çme
='pdf_old'

71 
mig¿tiÚs
.
	`AddF›ld
(

72 
mod–_Çme
='invoice',

73 
Çme
='pdf',

74 
f›ld
=
mod–s
.
	`FÜeignKey
(
to
='sv”.PDF', 
nuÎ
=
True
),

76 
mig¿tiÚs
.
	`AddF›ld
(

77 
mod–_Çme
='proforma',

78 
Çme
='pdf',

79 
f›ld
=
mod–s
.
	`FÜeignKey
(
to
='sv”.PDF', 
nuÎ
=
True
),

82 
mig¿tiÚs
.
	`RunPythÚ
(
move_pdf_äom_docum’ts_to_mod–
,

83 
move_pdf_äom_mod–_to_docum’ts
),

85 
mig¿tiÚs
.
	`RemoveF›ld
(

86 
mod–_Çme
='invoice',

87 
Çme
='pdf_old',

89 
mig¿tiÚs
.
	`RemoveF›ld
(

90 
mod–_Çme
='proforma',

91 
Çme
='pdf_old',

94 
mig¿tiÚs
.
	`RunSQL
(

95 
sql
="""

96 
DROP
 
VIEW
 
IF
 
EXISTS
 
sv”_docum’t
;

97 
CREATE
 
VIEW
 
sv”_docum’t
 
AS
 
SELECT


98 'švoiû' 
AS
 `
kšd
`, 
id
, 
£r›s
, 
numb”
, 
issue_d©e
, 
due_d©e
,

99 
·id_d©e
, 
ÿnûl_d©e
, 
¡©e
, 
´ovid”_id
, 
cu¡om”_id
,

100 
´ofÜma_id
 
as
 
»Ï‹d_docum’t_id
, 
¬chived_cu¡om”
,

101 
¬chived_´ovid”
, 
§Ës_x_³rûÁ
, 
§Ës_x_Çme
, 
cu¼’cy
, 
pdf_id
,

102 
Œª§ùiÚ_cu¼’cy


103 
FROM
 
sv”_švoiû


104 
UNION


105 
SELECT


106 '´ofÜma' 
AS
 `
kšd
`, 
id
, 
£r›s
, 
numb”
, 
issue_d©e
, 
due_d©e
,

107 
·id_d©e
, 
ÿnûl_d©e
, 
¡©e
, 
´ovid”_id
, 
cu¡om”_id
,

108 
NULL
 
as
 
»Ï‹d_docum’t_id
, 
¬chived_cu¡om”
,

109 
¬chived_´ovid”
, 
§Ës_x_³rûÁ
, 
§Ës_x_Çme
, 
cu¼’cy
, 
pdf_id
,

110 
Œª§ùiÚ_cu¼’cy


111 
FROM
 
sv”_´ofÜma
 
WHERE
 
švoiû_id
 
is
 
NULL


113 
»v”£_sql
="""

114 
DROP
 
VIEW
 
IF
 
EXISTS
 
sv”_docum’t
;

115 
CREATE
 
VIEW
 
sv”_docum’t
 
AS
 
SELECT


116 'švoiû' 
AS
 `
kšd
`, 
id
, 
£r›s
, 
numb”
, 
issue_d©e
, 
due_d©e
,

117 
·id_d©e
, 
ÿnûl_d©e
, 
¡©e
, 
´ovid”_id
, 
cu¡om”_id
,

118 
´ofÜma_id
 
as
 
»Ï‹d_docum’t_id
, 
¬chived_cu¡om”
,

119 
¬chived_´ovid”
, 
§Ës_x_³rûÁ
, 
§Ës_x_Çme
, 
cu¼’cy
, 
pdf
,

120 
Œª§ùiÚ_cu¼’cy


121 
FROM
 
sv”_švoiû


122 
UNION


123 
SELECT


124 '´ofÜma' 
AS
 `
kšd
`, 
id
, 
£r›s
, 
numb”
, 
issue_d©e
, 
due_d©e
,

125 
·id_d©e
, 
ÿnûl_d©e
, 
¡©e
, 
´ovid”_id
, 
cu¡om”_id
,

126 
NULL
 
as
 
»Ï‹d_docum’t_id
, 
¬chived_cu¡om”
,

127 
¬chived_´ovid”
, 
§Ës_x_³rûÁ
, 
§Ës_x_Çme
, 
cu¼’cy
, 
pdf
,

128 
Œª§ùiÚ_cu¼’cy


129 
FROM
 
sv”_´ofÜma
 
WHERE
 
švoiû_id
 
is
 
NULL


	@silver/migrations/0037_auto_20170719_1159.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #G’”©ed 
by
 
Djªgo
 1.11.3 
Ú
 2017-07-19 11:59

3 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


5 
impÜt
 
	gªnoyšg
.
f›lds


6 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


9 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

11 
d•’d’c›s
 = [

15 
İ”©iÚs
 = [

16 
mig¿tiÚs
.
	`AÉ”F›ld
(

17 
mod–_Çme
='customer',

18 
Çme
='country',

19 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
choiûs
=[('AD', 'AndÜ¿'), ('AE', 'Un™ed A¿b Emœ©es'), ('AF', 'Afghªi¡ª'), ('AG', 'AÁigu¨ªd B¬buda'), ('AI', 'AnguÏ'), ('AL', 'AlbªŸ'), ('AM', 'Arm’Ÿ'), ('AO', 'AngŞa'), ('AQ', 'AÁ¬ùiÿ'), ('AR', 'Arg’tša'), ('AS', 'Am”iÿÀSamß'), ('AT', 'Au¡rŸ'), ('AU', 'Au¡¿lŸ'), ('AW', 'Aruba'), ('AX', '\xc5Ïnd I¦ªds'), ('AZ', 'Az”baijª'), ('BA', 'Bo¢Ÿ‡nd H”zegovša'), ('BB', 'B¬bados'), ('BD', 'BªgÏdesh'), ('BE', 'B–gium'), ('BF', 'Burkš¨Faso'), ('BG', 'Bulg¬Ÿ'), ('BH', 'Bah¿š'), ('BI', 'Burundi'), ('BJ', 'B’š'), ('BL', 'SašˆB¬th\xe9Ëmy'), ('BM', 'B”muda'), ('BN', 'BruÃ˜D¬us§Ïm'), ('BO', 'BŞivŸ, Plurš©iÚ® S‹ of'), ('BQ', 'BÚaœe, SšˆEu¡©iu ªd Saba'), ('BR', 'B¿z'), ('BS', 'Bahamas'), ('BT', 'Bhun'), ('BV', 'Bouv‘ I¦ªd'), ('BW', 'BÙswªa'), ('BY', 'B–¬us'), ('BZ', 'B–ize'), ('CA', 'Cªada'), ('CC', 'Coco (K“lšgèI¦ªds'), ('CD', 'CÚgo, ThDemoü©iøR•ubliøoàthe'), ('CF', 'C’Œ® AäiÿÀR•ublic'), ('CG', 'CÚgo'), ('CH', 'Sw™z”Ïnd'), ('CI', "C\xf4‹ d'Ivoœe"), ('CK', 'Cook I¦ªds'), ('CL', 'Che'), ('CM', 'Cam”oÚ'), ('CN', 'Chša'), ('CO', 'CŞombŸ'), ('CR', 'Co¡¨Riÿ'), ('CU', 'Cuba'), ('CV', 'CabØV”de'), ('CW', 'Cu¿\xe7ao'), ('CX', 'Chri¡ma I¦ªd'), ('CY', 'Cy´us'), ('CZ', 'CzechŸ'), ('DE', 'G”mªy'), ('DJ', 'Djibouti'), ('DK', 'D’m¬k'), ('DM', 'Domšiÿ'), ('DO', 'DomšiÿÀR•ublic'), ('DZ', 'Alg”Ÿ'), ('EC', 'EcuadÜ'), ('EE', 'E¡ÚŸ'), ('EG', 'Egy±'), ('EH', 'We¡”ÀSah¬a'), ('ER', 'Er™»a'), ('ES', 'S·š'), ('ET', 'EthiİŸ'), ('FI', 'FšÏnd'), ('FJ', 'Fiji'), ('FK', 'F®kÏnd I¦ªd (M®všas)'), ('FM', 'MiüÚesŸ, Fed”©ed S‹ of'), ('FO', 'F¬Û I¦ªds'), ('FR', 'F¿nû'), ('GA', 'GabÚ'), ('GB', 'Un™ed Kšgdom'), ('GD', 'G»Çda'), ('GE', 'GeÜgŸ'), ('GF', 'F»nch GuŸÇ'), ('GG', 'Gu”n£y'), ('GH', 'Ghªa'), ('GI', 'Gib¿É¬'), ('GL', 'G»’Ïnd'), ('GM', 'GambŸ'), ('GN', 'Guš—'), ('GP', 'Guad–ou³'), ('GQ', 'Equ©ÜŸÈGuš—'), ('GR', 'G»eû'), ('GS', 'South GeÜgŸ‡ndhSouth Sªdwich I¦ªds'), ('GT', 'Gu©em®a'), ('GU', 'Guam'), ('GW', 'Guš—-Bis§u'), ('GY', 'Guyªa'), ('HK', 'HÚg KÚg'), ('HM', 'H—rd I¦ªd‡nd McDÚ®d I¦ªds'), ('HN', 'HÚdu¿s'), ('HR', 'CrßtŸ'), ('HT', 'Ha™i'), ('HU', 'Hung¬y'), ('ID', 'IndÚesŸ'), ('IE', 'I»Ïnd'), ('IL', 'I¤«l'), ('IM', 'I¦oàMª'), ('IN', 'IndŸ'), ('IO', 'Br™ish IndŸÀOûª T”r™Üy'), ('IQ', 'I¿q'), ('IR', 'I¿n, I¦amiøR•ubliøof'), ('IS', 'IûÏnd'), ('IT', 'Ily'), ('JE', 'J”£y'), ('JM', 'Jamaiÿ'), ('JO', 'JÜdª'), ('JP', 'J­ª'), ('KE', 'K’ya'), ('KG', 'Kyrgyz¡ª'), ('KH', 'CambodŸ'), ('KI', 'Kœib©i'), ('KM', 'ComÜos'), ('KN', 'SašˆK™t ªd Nevis'), ('KP', "KÜ—, Demoü©iøPeİË' R•ubliøof"), ('KR', 'KÜ—, R•ubliøof'), ('KW', 'Kuwa™'), ('KY', 'Caymª I¦ªds'), ('KZ', 'Kazakh¡ª'), ('LA', "LaØPeİË' Demoü©iøR•ublic"), ('LB', 'LebªÚ'), ('LC', 'SašˆLucŸ'), ('LI', 'L›ch‹n¡eš'), ('LK', 'Sr˜Lªka'), ('LR', 'Lib”Ÿ'), ('LS', 'LesÙho'), ('LT', 'L™huªŸ'), ('LU', 'Luxembourg'), ('LV', 'L©vŸ'), ('LY', 'Libya'), ('MA', 'MÜocco'), ('MC', 'MÚaco'), ('MD', 'MŞdova, R•ubliøof'), ('ME', 'MÚ‹Ãgro'), ('MF', 'SašˆM¬tš (F»nch…¬t)'), ('MG', 'Madagasÿr'), ('MH', 'M¬sh®ÈI¦ªds'), ('MK', 'MaûdÚŸ, R•ubliøof'), ('ML', 'M®i'), ('MM', 'Myªm¬'), ('MN', 'MÚgŞŸ'), ('MO', 'Maÿo'), ('MP', 'NÜth”ÀM¬ŸÇ I¦ªds'), ('MQ', 'M¬tšique'), ('MR', 'Maur™ªŸ'), ('MS', 'MÚt£¼©'), ('MT', 'M®'), ('MU', 'Maur™ius'), ('MV', 'M®dives'), ('MW', 'M®awi'), ('MX', 'Mexico'), ('MY', 'M®aysŸ'), ('MZ', 'Mozambique'), ('NA', 'NamibŸ'), ('NC', 'New C®edÚŸ'), ('NE', 'Nig”'), ('NF', 'NÜfŞk I¦ªd'), ('NG', 'Nig”Ÿ'), ('NI', 'Niÿ¿gua'), ('NL', 'N‘h”Ïnds'), ('NO', 'NÜway'), ('NP', 'N•®'), ('NR', 'Nauru'), ('NU', 'Niue'), ('NZ', 'New Z—Ïnd'), ('OM', 'Omª'), ('PA', 'Pªama'), ('PE', 'P”u'), ('PF', 'F»nch PŞyÃsŸ'), ('PG', 'P­u¨New Guš—'), ('PH', 'Phpšes'), ('PK', 'Paki¡ª'), ('PL', 'PŞªd'), ('PM', 'SašˆP›¼ªd Miqu–Ú'), ('PN', 'P™ÿœn'), ('PR', 'Pu”tØRico'), ('PS', 'P®e¡še, S‹ of'), ('PT', 'PÜtug®'), ('PW', 'P®au'), ('PY', 'P¬aguay'), ('QA', 'Q©¬'), ('RE', 'R\xe9uniÚ'), ('RO', 'RomªŸ'), ('RS', 'S”bŸ'), ('RU', 'RussŸÀFed”©iÚ'), ('RW', 'Rwªda'), ('SA', 'Saud˜A¿bŸ'), ('SB', 'SŞomÚ I¦ªds'), ('SC', 'Seych–Ës'), ('SD', 'Sudª'), ('SE', 'Swed’'), ('SG', 'Sšg­Üe'), ('SH', 'SašˆH–’a, AsûnsiÚ‡nd Tri¡ª d¨Cunha'), ('SI', 'Slov’Ÿ'), ('SJ', 'Sv®b¬d‡nd Jª May’'), ('SK', 'SlovakŸ'), ('SL', 'S›¼¨LeÚe'), ('SM', 'Sª M¬šo'), ('SN', 'S’eg®'), ('SO', 'Som®Ÿ'), ('SR', 'Suršame'), ('SS', 'South Sudª'), ('ST', 'SaØTomªd Pršce'), ('SV', 'EÈS®vadÜ'), ('SX', 'SšˆM¯¹’ (Dutch…¬t)'), ('SY', 'SyrŸÀA¿b R•ublic'), ('SZ', 'Swazªd'), ('TC', 'Turk ªd Caico I¦ªds'), ('TD', 'Chad'), ('TF', 'F»nch South”ÀT”r™Ü›s'), ('TG', 'Togo'), ('TH', 'Thaªd'), ('TJ', 'Tajiki¡ª'), ('TK', 'Tok–au'), ('TL', 'TimÜ-Le¡e'), ('TM', 'Turkm’i¡ª'), ('TN', 'TunisŸ'), ('TO', 'TÚga'), ('TR', 'Turkey'), ('TT', 'Tršidad‡nd Tobago'), ('TV', 'Tuv®u'), ('TW', 'Taiwª, Provšû oàChša'), ('TZ', 'TªzªŸ, Un™ed R•ubliøof'), ('UA', 'Uk¿še'), ('UG', 'Ugªda'), ('UM', 'Un™ed S‹ MšÜ Ouyšg I¦ªds'), ('US', 'Un™ed S‹s'), ('UY', 'Uruguay'), ('UZ', 'Uzbeki¡ª'), ('VA', 'HŞy S“ (V©iÿÀC™y S‹)'), ('VC', 'SašˆVšûÁ‡ndhG»Çdšes'), ('VE', 'V’ezu–a, BŞiv¬ŸÀR•ubliøof'), ('VG', 'Vœgš I¦ªds, Br™ish'), ('VI', 'Vœgš I¦ªds, U.S.'), ('VN', 'V›ˆNam'), ('VU', 'Vªu©u'), ('WF', 'W®li ªd FutuÇ'), ('WS', 'Samß'), ('YE', 'Yem’'), ('YT', 'MayÙ‹'), ('ZA', 'South Aäiÿ'), ('ZM', 'ZambŸ'), ('ZW', 'Zimbabwe')], 
max_Ëngth
=3),

21 
mig¿tiÚs
.
	`AÉ”F›ld
(

22 
mod–_Çme
='customer',

23 
Çme
='currency',

24 
f›ld
=
mod–s
.
	`Ch¬F›ld
(
bÏnk
=
True
, 
choiûs
=[('AED', 'AED (UAE Dœham)'), ('AFN', 'AFN (Afghªi)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Arm’ŸÀD¿m)'), ('ANG', 'ANG (N‘h”Ïnd AÁËª Gud”)'), ('AOA', 'AOA (Kwªza)'), ('ARS', 'ARS (Arg’tšPeso)'), ('AUD', 'AUD (Au¡¿lŸÀDŞÏr)'), ('AWG', 'AWG (Arubª FlÜš)'), ('AZN', 'AZN (Az”baijªŸÀMª©)'), ('BAM', 'BAM (CÚv”tibË M¬k)'), ('BBD', 'BBD (B¬bado DŞÏr)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulg¬ŸÀLev)'), ('BHD', 'BHD (Bah¿š˜Dš¬)'), ('BIF', 'BIF (Burund˜F¿nc)'), ('BMD', 'BMD (B”mudŸÀDŞÏr)'), ('BND', 'BND (BruÃ˜DŞÏr)'), ('BOB', 'BOB (BŞivŸno)'), ('BRL', 'BRL (B¿zŸÀR—l)'), ('BSD', 'BSD (BahamŸÀDŞÏr)'), ('BTN', 'BTN (NguÉrum)'), ('BWP', 'BWP (PuÏ)'), ('BYN', 'BYN (B–¬usŸÀRubË)'), ('BZD', 'BZD (B–izDŞÏr)'), ('CAD', 'CAD (CªadŸÀDŞÏr)'), ('CDF', 'CDF (CÚgŞe£ F¿nc)'), ('CHF', 'CHF (Swis F¿nc)'), ('CLP', 'CLP (Ch—ÀPeso)'), ('CNY', 'CNY (Yuª R’mšbi)'), ('COP', 'COP (CŞombŸÀPeso)'), ('CRC', 'CRC (Co¡¨RiÿÀCŞÚ)'), ('CUC', 'CUC (PesØCÚv”tibË)'), ('CUP', 'CUP (Cubª Peso)'), ('CVE', 'CVE (CabØV”dEscudo)'), ('CZK', 'CZK (Czech KÜuÇ)'), ('DJF', 'DJF (Djibout˜F¿nc)'), ('DKK', 'DKK (Dªish KrÚe)'), ('DOP', 'DOP (DomšiÿÀPeso)'), ('DZD', 'DZD (Alg”ŸÀDš¬)'), ('EGP', 'EGP (Egy±ŸÀPound)'), ('ERN', 'ERN (Nakç)'), ('ETB', 'ETB (EthiİŸÀBœr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fij˜DŞÏr)'), ('FKP', 'FKP (F®kÏnd I¦ªd Pound)'), ('GBP', 'GBP (Pound S‹¾šg)'), ('GEL', 'GEL (L¬i)'), ('GHS', 'GHS (Ghª¨Cedi)'), ('GIP', 'GIP (Gib¿É¬ Pound)'), ('GMD', 'GMD (D®asi)'), ('GNF', 'GNF (Guš— F¿nc)'), ('GTQ', 'GTQ (Qu‘z®)'), ('GYD', 'GYD (Guyª¨DŞÏr)'), ('HKD', 'HKD (HÚg KÚg DŞÏr)'), ('HNL', 'HNL (Lempœa)'), ('HRK', 'HRK (KuÇ)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (FÜšt)'), ('IDR', 'IDR (RupŸh)'), ('ILS', 'ILS (New I¤«l˜Sheq–)'), ('INR', 'INR (IndŸÀRu³e)'), ('IQD', 'IQD (I¿q˜Dš¬)'), ('IRR', 'IRR (I¿nŸÀRŸl)'), ('ISK', 'ISK (IûÏnd KrÚa)'), ('JMD', 'JMD (JamaiÿÀDŞÏr)'), ('JOD', 'JOD (JÜdªŸÀDš¬)'), ('JPY', 'JPY (Y’)'), ('KES', 'KES (K’yª Shlšg)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (R›l)'), ('KMF', 'KMF (ComÜØF¿nc)'), ('KPW', 'KPW (NÜth KÜ—ÀWÚ)'), ('KRW', 'KRW (WÚ)'), ('KWD', 'KWD (Kuwa™˜Dš¬)'), ('KYD', 'KYD (Caymª I¦ªd DŞÏr)'), ('KZT', 'KZT (T’ge)'), ('LAK', 'LAK (K)'), ('LBP', 'LBP (Lebªe£ Pound)'), ('LKR', 'LKR (Sr˜Lªk¨Ru³e)'), ('LRD', 'LRD (Lib”ŸÀDŞÏr)'), ('LSL', 'LSL (LÙi)'), ('LYD', 'LYD (Libyª Dš¬)'), ('MAD', 'MAD (MÜocÿÀDœham)'), ('MDL', 'MDL (MŞdovª Leu)'), ('MGA', 'MGA (M®agasy ArŸry)'), ('MKD', 'MKD (D’¬)'), ('MMK', 'MMK (Ky©)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (P©aÿ)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Maur™iu Ru³e)'), ('MVR', 'MVR (Rufiy¯)'), ('MWK', 'MWK (M®aw˜Kwacha)'), ('MXN', 'MXN (MexiÿÀPeso)'), ('MYR', 'MYR (M®aysŸÀRšgg™)'), ('MZN', 'MZN (MozambiquM‘iÿl)'), ('NAD', 'NAD (NamibŸ DŞÏr)'), ('NGN', 'NGN (Naœa)'), ('NIO', 'NIO (CÜdob¨Oro)'), ('NOK', 'NOK (NÜwegŸÀKrÚe)'), ('NPR', 'NPR (N•®e£ Ru³e)'), ('NZD', 'NZD (New Z—Ïnd DŞÏr)'), ('OMR', 'OMR (RŸÈOmªi)'), ('PAB', 'PAB (B®bß)'), ('PEN', 'PEN (SŞ)'), ('PGK', 'PGK (Kša)'), ('PHP', 'PHP (PhpšPeso)'), ('PKR', 'PKR (Paki¡ª Ru³e)'), ('PLN', 'PLN (ZlÙy)'), ('PYG', 'PYG (Gu¬ªi)'), ('QAR', 'QAR (Q©¬˜RŸl)'), ('RON', 'RON (RomªŸÀLeu)'), ('RSD', 'RSD (S”bŸÀDš¬)'), ('RUB', 'RUB (RussŸÀRubË)'), ('RWF', 'RWF (Rwªd¨F¿nc)'), ('SAR', 'SAR (Saud˜Riy®)'), ('SBD', 'SBD (SŞomÚ I¦ªd DŞÏr)'), ('SCR', 'SCR (Seych–Ë Ru³e)'), ('SDG', 'SDG (Sudªe£ Pound)'), ('SEK', 'SEK (Swedish KrÚa)'), ('SGD', 'SGD (Sšg­ÜDŞÏr)'), ('SHP', 'SHP (SašˆH–’¨Pound)'), ('SLL', 'SLL (LeÚe)'), ('SOS', 'SOS (Som®˜Shlšg)'), ('SRD', 'SRD (Suršam DŞÏr)'), ('SSP', 'SSP (South Sudªe£ Pound)'), ('STD', 'STD (Dob¿)'), ('SVC', 'SVC (EÈS®vadÜ CŞÚ)'), ('SYP', 'SYP (SyrŸÀPound)'), ('SZL', 'SZL (Lªg’i)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (SomÚi)'), ('TMT', 'TMT (Turkm’i¡ª New Mª©)'), ('TND', 'TND (TunisŸÀDš¬)'), ('TOP', 'TOP (Pa\u2019ªga)'), ('TRY', 'TRY (Turkish Lœa)'), ('TTD', 'TTD (Tršidad‡nd TobagØDŞÏr)'), ('TWD', 'TWD (New Taiwª DŞÏr)'), ('TZS', 'TZS (TªzªŸÀShlšg)'), ('UAH', 'UAH (HryvnŸ)'), ('UGX', 'UGX (Ugªd¨Shlšg)'), ('USD', 'USD (US DŞÏr)'), ('UYU', 'UYU (PesØUruguayo)'), ('UZS', 'UZS (Uzbeki¡ª Sum)'), ('VEF', 'VEF (BŞ\xedv¬)'), ('VND', 'VND (DÚg)'), ('VUV', 'VUV (V©u)'), ('WST', 'WST (T®a)'), ('XAF', 'XAF (CFA F¿nøBEAC)'), ('XAG', 'XAG (Sv”)'), ('XAU', 'XAU (GŞd)'), ('XBA', 'XBA (BÚd M¬k‘ Un™ Eurİ—ÀCompos™Un™ (EURCO))'), ('XBB', 'XBB (BÚd M¬k‘ Un™ Eurİ—ÀMÚ‘¬y Un™ (E.M.U.-6))'), ('XBC', 'XBC (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 9 (E.U.A.-9))'), ('XBD', 'XBD (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 17 (E.U.A.-17))'), ('XCD', 'XCD (Ea¡ C¬ibb—ÀDŞÏr)'), ('XDR', 'XDR (SDR (S³cŸÈD¿wšg Right))'), ('XOF', 'XOF (CFA F¿nøBCEAO)'), ('XPD', 'XPD (P®Ïdium)'), ('XPF', 'XPF (CFP F¿nc)'), ('XPT', 'XPT (PÏtšum)'), ('XSU', 'XSU (Suüe)'), ('XTS', 'XTS (Code ¥ecifiÿÎy„e£rved fÜe¡šg…u½o£s)'), ('XUA', 'XUA (ADB Un™ oàAccouÁ)'), ('XXX', 'XXX (Thcode assigÃd fÜ¿n§ùiÚ wh”nØcu¼’cy i švŞved)'), ('YER', 'YER (Yem’˜RŸl)'), ('ZAR', 'ZAR (Rªd)'), ('ZMW', 'ZMW (ZambŸÀKwacha)'), ('ZWL', 'ZWL (ZimbabwDŞÏr)')], 
h–p_‹xt
=
b
'U£dØ’fÜû‡ c”š cu¼’cy wh’ makšg¿n§ùiÚsfÜhcu¡om”.', 
max_Ëngth
=4, 
nuÎ
=True),

26 
mig¿tiÚs
.
	`AÉ”F›ld
(

27 
mod–_Çme
='customer',

28 
Çme
='meta',

29 
f›ld
=
ªnoyšg
.
f›lds
.
	`JSONF›ld
(
bÏnk
=
True
, ={
	}
}, 
	gnuÎ
=True),

31 
	gmig¿tiÚs
.
AÉ”F›ld
(

32 
mod–_Çme
='invoice',

33 
Çme
='archived_customer',

34 
f›ld
=
ªnoyšg
.
f›lds
.
JSONF›ld
(
bÏnk
=
True
, =
diù
, 
nuÎ
=True),

36 
	gmig¿tiÚs
.
AÉ”F›ld
(

37 
mod–_Çme
='invoice',

38 
Çme
='archived_provider',

39 
f›ld
=
ªnoyšg
.
f›lds
.
JSONF›ld
(
bÏnk
=
True
, =
diù
, 
nuÎ
=True),

41 
	gmig¿tiÚs
.
AÉ”F›ld
(

42 
mod–_Çme
='invoice',

43 
Çme
='currency',

44 
f›ld
=
mod–s
.
Ch¬F›ld
(
choiûs
=[('AED', 'AED (UAE Dœham)'), ('AFN', 'AFN (Afghªi)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Arm’ŸÀD¿m)'), ('ANG', 'ANG (N‘h”Ïnd AÁËª Gud”)'), ('AOA', 'AOA (Kwªza)'), ('ARS', 'ARS (Arg’tšPeso)'), ('AUD', 'AUD (Au¡¿lŸÀDŞÏr)'), ('AWG', 'AWG (Arubª FlÜš)'), ('AZN', 'AZN (Az”baijªŸÀMª©)'), ('BAM', 'BAM (CÚv”tibË M¬k)'), ('BBD', 'BBD (B¬bado DŞÏr)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulg¬ŸÀLev)'), ('BHD', 'BHD (Bah¿š˜Dš¬)'), ('BIF', 'BIF (Burund˜F¿nc)'), ('BMD', 'BMD (B”mudŸÀDŞÏr)'), ('BND', 'BND (BruÃ˜DŞÏr)'), ('BOB', 'BOB (BŞivŸno)'), ('BRL', 'BRL (B¿zŸÀR—l)'), ('BSD', 'BSD (BahamŸÀDŞÏr)'), ('BTN', 'BTN (NguÉrum)'), ('BWP', 'BWP (PuÏ)'), ('BYN', 'BYN (B–¬usŸÀRubË)'), ('BZD', 'BZD (B–izDŞÏr)'), ('CAD', 'CAD (CªadŸÀDŞÏr)'), ('CDF', 'CDF (CÚgŞe£ F¿nc)'), ('CHF', 'CHF (Swis F¿nc)'), ('CLP', 'CLP (Ch—ÀPeso)'), ('CNY', 'CNY (Yuª R’mšbi)'), ('COP', 'COP (CŞombŸÀPeso)'), ('CRC', 'CRC (Co¡¨RiÿÀCŞÚ)'), ('CUC', 'CUC (PesØCÚv”tibË)'), ('CUP', 'CUP (Cubª Peso)'), ('CVE', 'CVE (CabØV”dEscudo)'), ('CZK', 'CZK (Czech KÜuÇ)'), ('DJF', 'DJF (Djibout˜F¿nc)'), ('DKK', 'DKK (Dªish KrÚe)'), ('DOP', 'DOP (DomšiÿÀPeso)'), ('DZD', 'DZD (Alg”ŸÀDš¬)'), ('EGP', 'EGP (Egy±ŸÀPound)'), ('ERN', 'ERN (Nakç)'), ('ETB', 'ETB (EthiİŸÀBœr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fij˜DŞÏr)'), ('FKP', 'FKP (F®kÏnd I¦ªd Pound)'), ('GBP', 'GBP (Pound S‹¾šg)'), ('GEL', 'GEL (L¬i)'), ('GHS', 'GHS (Ghª¨Cedi)'), ('GIP', 'GIP (Gib¿É¬ Pound)'), ('GMD', 'GMD (D®asi)'), ('GNF', 'GNF (Guš— F¿nc)'), ('GTQ', 'GTQ (Qu‘z®)'), ('GYD', 'GYD (Guyª¨DŞÏr)'), ('HKD', 'HKD (HÚg KÚg DŞÏr)'), ('HNL', 'HNL (Lempœa)'), ('HRK', 'HRK (KuÇ)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (FÜšt)'), ('IDR', 'IDR (RupŸh)'), ('ILS', 'ILS (New I¤«l˜Sheq–)'), ('INR', 'INR (IndŸÀRu³e)'), ('IQD', 'IQD (I¿q˜Dš¬)'), ('IRR', 'IRR (I¿nŸÀRŸl)'), ('ISK', 'ISK (IûÏnd KrÚa)'), ('JMD', 'JMD (JamaiÿÀDŞÏr)'), ('JOD', 'JOD (JÜdªŸÀDš¬)'), ('JPY', 'JPY (Y’)'), ('KES', 'KES (K’yª Shlšg)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (R›l)'), ('KMF', 'KMF (ComÜØF¿nc)'), ('KPW', 'KPW (NÜth KÜ—ÀWÚ)'), ('KRW', 'KRW (WÚ)'), ('KWD', 'KWD (Kuwa™˜Dš¬)'), ('KYD', 'KYD (Caymª I¦ªd DŞÏr)'), ('KZT', 'KZT (T’ge)'), ('LAK', 'LAK (K)'), ('LBP', 'LBP (Lebªe£ Pound)'), ('LKR', 'LKR (Sr˜Lªk¨Ru³e)'), ('LRD', 'LRD (Lib”ŸÀDŞÏr)'), ('LSL', 'LSL (LÙi)'), ('LYD', 'LYD (Libyª Dš¬)'), ('MAD', 'MAD (MÜocÿÀDœham)'), ('MDL', 'MDL (MŞdovª Leu)'), ('MGA', 'MGA (M®agasy ArŸry)'), ('MKD', 'MKD (D’¬)'), ('MMK', 'MMK (Ky©)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (P©aÿ)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Maur™iu Ru³e)'), ('MVR', 'MVR (Rufiy¯)'), ('MWK', 'MWK (M®aw˜Kwacha)'), ('MXN', 'MXN (MexiÿÀPeso)'), ('MYR', 'MYR (M®aysŸÀRšgg™)'), ('MZN', 'MZN (MozambiquM‘iÿl)'), ('NAD', 'NAD (NamibŸ DŞÏr)'), ('NGN', 'NGN (Naœa)'), ('NIO', 'NIO (CÜdob¨Oro)'), ('NOK', 'NOK (NÜwegŸÀKrÚe)'), ('NPR', 'NPR (N•®e£ Ru³e)'), ('NZD', 'NZD (New Z—Ïnd DŞÏr)'), ('OMR', 'OMR (RŸÈOmªi)'), ('PAB', 'PAB (B®bß)'), ('PEN', 'PEN (SŞ)'), ('PGK', 'PGK (Kša)'), ('PHP', 'PHP (PhpšPeso)'), ('PKR', 'PKR (Paki¡ª Ru³e)'), ('PLN', 'PLN (ZlÙy)'), ('PYG', 'PYG (Gu¬ªi)'), ('QAR', 'QAR (Q©¬˜RŸl)'), ('RON', 'RON (RomªŸÀLeu)'), ('RSD', 'RSD (S”bŸÀDš¬)'), ('RUB', 'RUB (RussŸÀRubË)'), ('RWF', 'RWF (Rwªd¨F¿nc)'), ('SAR', 'SAR (Saud˜Riy®)'), ('SBD', 'SBD (SŞomÚ I¦ªd DŞÏr)'), ('SCR', 'SCR (Seych–Ë Ru³e)'), ('SDG', 'SDG (Sudªe£ Pound)'), ('SEK', 'SEK (Swedish KrÚa)'), ('SGD', 'SGD (Sšg­ÜDŞÏr)'), ('SHP', 'SHP (SašˆH–’¨Pound)'), ('SLL', 'SLL (LeÚe)'), ('SOS', 'SOS (Som®˜Shlšg)'), ('SRD', 'SRD (Suršam DŞÏr)'), ('SSP', 'SSP (South Sudªe£ Pound)'), ('STD', 'STD (Dob¿)'), ('SVC', 'SVC (EÈS®vadÜ CŞÚ)'), ('SYP', 'SYP (SyrŸÀPound)'), ('SZL', 'SZL (Lªg’i)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (SomÚi)'), ('TMT', 'TMT (Turkm’i¡ª New Mª©)'), ('TND', 'TND (TunisŸÀDš¬)'), ('TOP', 'TOP (Pa\u2019ªga)'), ('TRY', 'TRY (Turkish Lœa)'), ('TTD', 'TTD (Tršidad‡nd TobagØDŞÏr)'), ('TWD', 'TWD (New Taiwª DŞÏr)'), ('TZS', 'TZS (TªzªŸÀShlšg)'), ('UAH', 'UAH (HryvnŸ)'), ('UGX', 'UGX (Ugªd¨Shlšg)'), ('USD', 'USD (US DŞÏr)'), ('UYU', 'UYU (PesØUruguayo)'), ('UZS', 'UZS (Uzbeki¡ª Sum)'), ('VEF', 'VEF (BŞ\xedv¬)'), ('VND', 'VND (DÚg)'), ('VUV', 'VUV (V©u)'), ('WST', 'WST (T®a)'), ('XAF', 'XAF (CFA F¿nøBEAC)'), ('XAG', 'XAG (Sv”)'), ('XAU', 'XAU (GŞd)'), ('XBA', 'XBA (BÚd M¬k‘ Un™ Eurİ—ÀCompos™Un™ (EURCO))'), ('XBB', 'XBB (BÚd M¬k‘ Un™ Eurİ—ÀMÚ‘¬y Un™ (E.M.U.-6))'), ('XBC', 'XBC (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 9 (E.U.A.-9))'), ('XBD', 'XBD (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 17 (E.U.A.-17))'), ('XCD', 'XCD (Ea¡ C¬ibb—ÀDŞÏr)'), ('XDR', 'XDR (SDR (S³cŸÈD¿wšg Right))'), ('XOF', 'XOF (CFA F¿nøBCEAO)'), ('XPD', 'XPD (P®Ïdium)'), ('XPF', 'XPF (CFP F¿nc)'), ('XPT', 'XPT (PÏtšum)'), ('XSU', 'XSU (Suüe)'), ('XTS', 'XTS (Code ¥ecifiÿÎy„e£rved fÜe¡šg…u½o£s)'), ('XUA', 'XUA (ADB Un™ oàAccouÁ)'), ('XXX', 'XXX (Thcode assigÃd fÜ¿n§ùiÚ wh”nØcu¼’cy i švŞved)'), ('YER', 'YER (Yem’˜RŸl)'), ('ZAR', 'ZAR (Rªd)'), ('ZMW', 'ZMW (ZambŸÀKwacha)'), ('ZWL', 'ZWL (ZimbabwDŞÏr)')], =
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy u£d fÜ blšg.', 
max_Ëngth
=4),

46 
	gmig¿tiÚs
.
AÉ”F›ld
(

47 
mod–_Çme
='invoice',

48 
Çme
='transaction_currency',

49 
f›ld
=
mod–s
.
Ch¬F›ld
(
choiûs
=[('AED', 'AED (UAE Dœham)'), ('AFN', 'AFN (Afghªi)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Arm’ŸÀD¿m)'), ('ANG', 'ANG (N‘h”Ïnd AÁËª Gud”)'), ('AOA', 'AOA (Kwªza)'), ('ARS', 'ARS (Arg’tšPeso)'), ('AUD', 'AUD (Au¡¿lŸÀDŞÏr)'), ('AWG', 'AWG (Arubª FlÜš)'), ('AZN', 'AZN (Az”baijªŸÀMª©)'), ('BAM', 'BAM (CÚv”tibË M¬k)'), ('BBD', 'BBD (B¬bado DŞÏr)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulg¬ŸÀLev)'), ('BHD', 'BHD (Bah¿š˜Dš¬)'), ('BIF', 'BIF (Burund˜F¿nc)'), ('BMD', 'BMD (B”mudŸÀDŞÏr)'), ('BND', 'BND (BruÃ˜DŞÏr)'), ('BOB', 'BOB (BŞivŸno)'), ('BRL', 'BRL (B¿zŸÀR—l)'), ('BSD', 'BSD (BahamŸÀDŞÏr)'), ('BTN', 'BTN (NguÉrum)'), ('BWP', 'BWP (PuÏ)'), ('BYN', 'BYN (B–¬usŸÀRubË)'), ('BZD', 'BZD (B–izDŞÏr)'), ('CAD', 'CAD (CªadŸÀDŞÏr)'), ('CDF', 'CDF (CÚgŞe£ F¿nc)'), ('CHF', 'CHF (Swis F¿nc)'), ('CLP', 'CLP (Ch—ÀPeso)'), ('CNY', 'CNY (Yuª R’mšbi)'), ('COP', 'COP (CŞombŸÀPeso)'), ('CRC', 'CRC (Co¡¨RiÿÀCŞÚ)'), ('CUC', 'CUC (PesØCÚv”tibË)'), ('CUP', 'CUP (Cubª Peso)'), ('CVE', 'CVE (CabØV”dEscudo)'), ('CZK', 'CZK (Czech KÜuÇ)'), ('DJF', 'DJF (Djibout˜F¿nc)'), ('DKK', 'DKK (Dªish KrÚe)'), ('DOP', 'DOP (DomšiÿÀPeso)'), ('DZD', 'DZD (Alg”ŸÀDš¬)'), ('EGP', 'EGP (Egy±ŸÀPound)'), ('ERN', 'ERN (Nakç)'), ('ETB', 'ETB (EthiİŸÀBœr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fij˜DŞÏr)'), ('FKP', 'FKP (F®kÏnd I¦ªd Pound)'), ('GBP', 'GBP (Pound S‹¾šg)'), ('GEL', 'GEL (L¬i)'), ('GHS', 'GHS (Ghª¨Cedi)'), ('GIP', 'GIP (Gib¿É¬ Pound)'), ('GMD', 'GMD (D®asi)'), ('GNF', 'GNF (Guš— F¿nc)'), ('GTQ', 'GTQ (Qu‘z®)'), ('GYD', 'GYD (Guyª¨DŞÏr)'), ('HKD', 'HKD (HÚg KÚg DŞÏr)'), ('HNL', 'HNL (Lempœa)'), ('HRK', 'HRK (KuÇ)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (FÜšt)'), ('IDR', 'IDR (RupŸh)'), ('ILS', 'ILS (New I¤«l˜Sheq–)'), ('INR', 'INR (IndŸÀRu³e)'), ('IQD', 'IQD (I¿q˜Dš¬)'), ('IRR', 'IRR (I¿nŸÀRŸl)'), ('ISK', 'ISK (IûÏnd KrÚa)'), ('JMD', 'JMD (JamaiÿÀDŞÏr)'), ('JOD', 'JOD (JÜdªŸÀDš¬)'), ('JPY', 'JPY (Y’)'), ('KES', 'KES (K’yª Shlšg)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (R›l)'), ('KMF', 'KMF (ComÜØF¿nc)'), ('KPW', 'KPW (NÜth KÜ—ÀWÚ)'), ('KRW', 'KRW (WÚ)'), ('KWD', 'KWD (Kuwa™˜Dš¬)'), ('KYD', 'KYD (Caymª I¦ªd DŞÏr)'), ('KZT', 'KZT (T’ge)'), ('LAK', 'LAK (K)'), ('LBP', 'LBP (Lebªe£ Pound)'), ('LKR', 'LKR (Sr˜Lªk¨Ru³e)'), ('LRD', 'LRD (Lib”ŸÀDŞÏr)'), ('LSL', 'LSL (LÙi)'), ('LYD', 'LYD (Libyª Dš¬)'), ('MAD', 'MAD (MÜocÿÀDœham)'), ('MDL', 'MDL (MŞdovª Leu)'), ('MGA', 'MGA (M®agasy ArŸry)'), ('MKD', 'MKD (D’¬)'), ('MMK', 'MMK (Ky©)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (P©aÿ)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Maur™iu Ru³e)'), ('MVR', 'MVR (Rufiy¯)'), ('MWK', 'MWK (M®aw˜Kwacha)'), ('MXN', 'MXN (MexiÿÀPeso)'), ('MYR', 'MYR (M®aysŸÀRšgg™)'), ('MZN', 'MZN (MozambiquM‘iÿl)'), ('NAD', 'NAD (NamibŸ DŞÏr)'), ('NGN', 'NGN (Naœa)'), ('NIO', 'NIO (CÜdob¨Oro)'), ('NOK', 'NOK (NÜwegŸÀKrÚe)'), ('NPR', 'NPR (N•®e£ Ru³e)'), ('NZD', 'NZD (New Z—Ïnd DŞÏr)'), ('OMR', 'OMR (RŸÈOmªi)'), ('PAB', 'PAB (B®bß)'), ('PEN', 'PEN (SŞ)'), ('PGK', 'PGK (Kša)'), ('PHP', 'PHP (PhpšPeso)'), ('PKR', 'PKR (Paki¡ª Ru³e)'), ('PLN', 'PLN (ZlÙy)'), ('PYG', 'PYG (Gu¬ªi)'), ('QAR', 'QAR (Q©¬˜RŸl)'), ('RON', 'RON (RomªŸÀLeu)'), ('RSD', 'RSD (S”bŸÀDš¬)'), ('RUB', 'RUB (RussŸÀRubË)'), ('RWF', 'RWF (Rwªd¨F¿nc)'), ('SAR', 'SAR (Saud˜Riy®)'), ('SBD', 'SBD (SŞomÚ I¦ªd DŞÏr)'), ('SCR', 'SCR (Seych–Ë Ru³e)'), ('SDG', 'SDG (Sudªe£ Pound)'), ('SEK', 'SEK (Swedish KrÚa)'), ('SGD', 'SGD (Sšg­ÜDŞÏr)'), ('SHP', 'SHP (SašˆH–’¨Pound)'), ('SLL', 'SLL (LeÚe)'), ('SOS', 'SOS (Som®˜Shlšg)'), ('SRD', 'SRD (Suršam DŞÏr)'), ('SSP', 'SSP (South Sudªe£ Pound)'), ('STD', 'STD (Dob¿)'), ('SVC', 'SVC (EÈS®vadÜ CŞÚ)'), ('SYP', 'SYP (SyrŸÀPound)'), ('SZL', 'SZL (Lªg’i)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (SomÚi)'), ('TMT', 'TMT (Turkm’i¡ª New Mª©)'), ('TND', 'TND (TunisŸÀDš¬)'), ('TOP', 'TOP (Pa\u2019ªga)'), ('TRY', 'TRY (Turkish Lœa)'), ('TTD', 'TTD (Tršidad‡nd TobagØDŞÏr)'), ('TWD', 'TWD (New Taiwª DŞÏr)'), ('TZS', 'TZS (TªzªŸÀShlšg)'), ('UAH', 'UAH (HryvnŸ)'), ('UGX', 'UGX (Ugªd¨Shlšg)'), ('USD', 'USD (US DŞÏr)'), ('UYU', 'UYU (PesØUruguayo)'), ('UZS', 'UZS (Uzbeki¡ª Sum)'), ('VEF', 'VEF (BŞ\xedv¬)'), ('VND', 'VND (DÚg)'), ('VUV', 'VUV (V©u)'), ('WST', 'WST (T®a)'), ('XAF', 'XAF (CFA F¿nøBEAC)'), ('XAG', 'XAG (Sv”)'), ('XAU', 'XAU (GŞd)'), ('XBA', 'XBA (BÚd M¬k‘ Un™ Eurİ—ÀCompos™Un™ (EURCO))'), ('XBB', 'XBB (BÚd M¬k‘ Un™ Eurİ—ÀMÚ‘¬y Un™ (E.M.U.-6))'), ('XBC', 'XBC (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 9 (E.U.A.-9))'), ('XBD', 'XBD (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 17 (E.U.A.-17))'), ('XCD', 'XCD (Ea¡ C¬ibb—ÀDŞÏr)'), ('XDR', 'XDR (SDR (S³cŸÈD¿wšg Right))'), ('XOF', 'XOF (CFA F¿nøBCEAO)'), ('XPD', 'XPD (P®Ïdium)'), ('XPF', 'XPF (CFP F¿nc)'), ('XPT', 'XPT (PÏtšum)'), ('XSU', 'XSU (Suüe)'), ('XTS', 'XTS (Code ¥ecifiÿÎy„e£rved fÜe¡šg…u½o£s)'), ('XUA', 'XUA (ADB Un™ oàAccouÁ)'), ('XXX', 'XXX (Thcode assigÃd fÜ¿n§ùiÚ wh”nØcu¼’cy i švŞved)'), ('YER', 'YER (Yem’˜RŸl)'), ('ZAR', 'ZAR (Rªd)'), ('ZMW', 'ZMW (ZambŸÀKwacha)'), ('ZWL', 'ZWL (ZimbabwDŞÏr)')], 
h–p_‹xt
=
b
'Thcu¼’cy u£d wh’ makšg‡¿n§ùiÚ.', 
max_Ëngth
=4),

51 
	gmig¿tiÚs
.
AÉ”F›ld
(

52 
mod–_Çme
='paymentmethod',

53 
Çme
='data',

54 
f›ld
=
ªnoyšg
.
f›lds
.
JSONF›ld
(
bÏnk
=
True
, ={}, 
nuÎ
=True),

56 
	gmig¿tiÚs
.
AÉ”F›ld
(

57 
mod–_Çme
='plan',

58 
Çme
='currency',

59 
f›ld
=
mod–s
.
Ch¬F›ld
(
choiûs
=[('AED', 'AED (UAE Dœham)'), ('AFN', 'AFN (Afghªi)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Arm’ŸÀD¿m)'), ('ANG', 'ANG (N‘h”Ïnd AÁËª Gud”)'), ('AOA', 'AOA (Kwªza)'), ('ARS', 'ARS (Arg’tšPeso)'), ('AUD', 'AUD (Au¡¿lŸÀDŞÏr)'), ('AWG', 'AWG (Arubª FlÜš)'), ('AZN', 'AZN (Az”baijªŸÀMª©)'), ('BAM', 'BAM (CÚv”tibË M¬k)'), ('BBD', 'BBD (B¬bado DŞÏr)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulg¬ŸÀLev)'), ('BHD', 'BHD (Bah¿š˜Dš¬)'), ('BIF', 'BIF (Burund˜F¿nc)'), ('BMD', 'BMD (B”mudŸÀDŞÏr)'), ('BND', 'BND (BruÃ˜DŞÏr)'), ('BOB', 'BOB (BŞivŸno)'), ('BRL', 'BRL (B¿zŸÀR—l)'), ('BSD', 'BSD (BahamŸÀDŞÏr)'), ('BTN', 'BTN (NguÉrum)'), ('BWP', 'BWP (PuÏ)'), ('BYN', 'BYN (B–¬usŸÀRubË)'), ('BZD', 'BZD (B–izDŞÏr)'), ('CAD', 'CAD (CªadŸÀDŞÏr)'), ('CDF', 'CDF (CÚgŞe£ F¿nc)'), ('CHF', 'CHF (Swis F¿nc)'), ('CLP', 'CLP (Ch—ÀPeso)'), ('CNY', 'CNY (Yuª R’mšbi)'), ('COP', 'COP (CŞombŸÀPeso)'), ('CRC', 'CRC (Co¡¨RiÿÀCŞÚ)'), ('CUC', 'CUC (PesØCÚv”tibË)'), ('CUP', 'CUP (Cubª Peso)'), ('CVE', 'CVE (CabØV”dEscudo)'), ('CZK', 'CZK (Czech KÜuÇ)'), ('DJF', 'DJF (Djibout˜F¿nc)'), ('DKK', 'DKK (Dªish KrÚe)'), ('DOP', 'DOP (DomšiÿÀPeso)'), ('DZD', 'DZD (Alg”ŸÀDš¬)'), ('EGP', 'EGP (Egy±ŸÀPound)'), ('ERN', 'ERN (Nakç)'), ('ETB', 'ETB (EthiİŸÀBœr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fij˜DŞÏr)'), ('FKP', 'FKP (F®kÏnd I¦ªd Pound)'), ('GBP', 'GBP (Pound S‹¾šg)'), ('GEL', 'GEL (L¬i)'), ('GHS', 'GHS (Ghª¨Cedi)'), ('GIP', 'GIP (Gib¿É¬ Pound)'), ('GMD', 'GMD (D®asi)'), ('GNF', 'GNF (Guš— F¿nc)'), ('GTQ', 'GTQ (Qu‘z®)'), ('GYD', 'GYD (Guyª¨DŞÏr)'), ('HKD', 'HKD (HÚg KÚg DŞÏr)'), ('HNL', 'HNL (Lempœa)'), ('HRK', 'HRK (KuÇ)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (FÜšt)'), ('IDR', 'IDR (RupŸh)'), ('ILS', 'ILS (New I¤«l˜Sheq–)'), ('INR', 'INR (IndŸÀRu³e)'), ('IQD', 'IQD (I¿q˜Dš¬)'), ('IRR', 'IRR (I¿nŸÀRŸl)'), ('ISK', 'ISK (IûÏnd KrÚa)'), ('JMD', 'JMD (JamaiÿÀDŞÏr)'), ('JOD', 'JOD (JÜdªŸÀDš¬)'), ('JPY', 'JPY (Y’)'), ('KES', 'KES (K’yª Shlšg)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (R›l)'), ('KMF', 'KMF (ComÜØF¿nc)'), ('KPW', 'KPW (NÜth KÜ—ÀWÚ)'), ('KRW', 'KRW (WÚ)'), ('KWD', 'KWD (Kuwa™˜Dš¬)'), ('KYD', 'KYD (Caymª I¦ªd DŞÏr)'), ('KZT', 'KZT (T’ge)'), ('LAK', 'LAK (K)'), ('LBP', 'LBP (Lebªe£ Pound)'), ('LKR', 'LKR (Sr˜Lªk¨Ru³e)'), ('LRD', 'LRD (Lib”ŸÀDŞÏr)'), ('LSL', 'LSL (LÙi)'), ('LYD', 'LYD (Libyª Dš¬)'), ('MAD', 'MAD (MÜocÿÀDœham)'), ('MDL', 'MDL (MŞdovª Leu)'), ('MGA', 'MGA (M®agasy ArŸry)'), ('MKD', 'MKD (D’¬)'), ('MMK', 'MMK (Ky©)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (P©aÿ)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Maur™iu Ru³e)'), ('MVR', 'MVR (Rufiy¯)'), ('MWK', 'MWK (M®aw˜Kwacha)'), ('MXN', 'MXN (MexiÿÀPeso)'), ('MYR', 'MYR (M®aysŸÀRšgg™)'), ('MZN', 'MZN (MozambiquM‘iÿl)'), ('NAD', 'NAD (NamibŸ DŞÏr)'), ('NGN', 'NGN (Naœa)'), ('NIO', 'NIO (CÜdob¨Oro)'), ('NOK', 'NOK (NÜwegŸÀKrÚe)'), ('NPR', 'NPR (N•®e£ Ru³e)'), ('NZD', 'NZD (New Z—Ïnd DŞÏr)'), ('OMR', 'OMR (RŸÈOmªi)'), ('PAB', 'PAB (B®bß)'), ('PEN', 'PEN (SŞ)'), ('PGK', 'PGK (Kša)'), ('PHP', 'PHP (PhpšPeso)'), ('PKR', 'PKR (Paki¡ª Ru³e)'), ('PLN', 'PLN (ZlÙy)'), ('PYG', 'PYG (Gu¬ªi)'), ('QAR', 'QAR (Q©¬˜RŸl)'), ('RON', 'RON (RomªŸÀLeu)'), ('RSD', 'RSD (S”bŸÀDš¬)'), ('RUB', 'RUB (RussŸÀRubË)'), ('RWF', 'RWF (Rwªd¨F¿nc)'), ('SAR', 'SAR (Saud˜Riy®)'), ('SBD', 'SBD (SŞomÚ I¦ªd DŞÏr)'), ('SCR', 'SCR (Seych–Ë Ru³e)'), ('SDG', 'SDG (Sudªe£ Pound)'), ('SEK', 'SEK (Swedish KrÚa)'), ('SGD', 'SGD (Sšg­ÜDŞÏr)'), ('SHP', 'SHP (SašˆH–’¨Pound)'), ('SLL', 'SLL (LeÚe)'), ('SOS', 'SOS (Som®˜Shlšg)'), ('SRD', 'SRD (Suršam DŞÏr)'), ('SSP', 'SSP (South Sudªe£ Pound)'), ('STD', 'STD (Dob¿)'), ('SVC', 'SVC (EÈS®vadÜ CŞÚ)'), ('SYP', 'SYP (SyrŸÀPound)'), ('SZL', 'SZL (Lªg’i)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (SomÚi)'), ('TMT', 'TMT (Turkm’i¡ª New Mª©)'), ('TND', 'TND (TunisŸÀDš¬)'), ('TOP', 'TOP (Pa\u2019ªga)'), ('TRY', 'TRY (Turkish Lœa)'), ('TTD', 'TTD (Tršidad‡nd TobagØDŞÏr)'), ('TWD', 'TWD (New Taiwª DŞÏr)'), ('TZS', 'TZS (TªzªŸÀShlšg)'), ('UAH', 'UAH (HryvnŸ)'), ('UGX', 'UGX (Ugªd¨Shlšg)'), ('USD', 'USD (US DŞÏr)'), ('UYU', 'UYU (PesØUruguayo)'), ('UZS', 'UZS (Uzbeki¡ª Sum)'), ('VEF', 'VEF (BŞ\xedv¬)'), ('VND', 'VND (DÚg)'), ('VUV', 'VUV (V©u)'), ('WST', 'WST (T®a)'), ('XAF', 'XAF (CFA F¿nøBEAC)'), ('XAG', 'XAG (Sv”)'), ('XAU', 'XAU (GŞd)'), ('XBA', 'XBA (BÚd M¬k‘ Un™ Eurİ—ÀCompos™Un™ (EURCO))'), ('XBB', 'XBB (BÚd M¬k‘ Un™ Eurİ—ÀMÚ‘¬y Un™ (E.M.U.-6))'), ('XBC', 'XBC (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 9 (E.U.A.-9))'), ('XBD', 'XBD (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 17 (E.U.A.-17))'), ('XCD', 'XCD (Ea¡ C¬ibb—ÀDŞÏr)'), ('XDR', 'XDR (SDR (S³cŸÈD¿wšg Right))'), ('XOF', 'XOF (CFA F¿nøBCEAO)'), ('XPD', 'XPD (P®Ïdium)'), ('XPF', 'XPF (CFP F¿nc)'), ('XPT', 'XPT (PÏtšum)'), ('XSU', 'XSU (Suüe)'), ('XTS', 'XTS (Code ¥ecifiÿÎy„e£rved fÜe¡šg…u½o£s)'), ('XUA', 'XUA (ADB Un™ oàAccouÁ)'), ('XXX', 'XXX (Thcode assigÃd fÜ¿n§ùiÚ wh”nØcu¼’cy i švŞved)'), ('YER', 'YER (Yem’˜RŸl)'), ('ZAR', 'ZAR (Rªd)'), ('ZMW', 'ZMW (ZambŸÀKwacha)'), ('ZWL', 'ZWL (ZimbabwDŞÏr)')], =
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy iÀwhichhsubsütiÚ wÈbch¬ged.', 
max_Ëngth
=4),

61 
	gmig¿tiÚs
.
AÉ”F›ld
(

62 
mod–_Çme
='proforma',

63 
Çme
='archived_customer',

64 
f›ld
=
ªnoyšg
.
f›lds
.
JSONF›ld
(
bÏnk
=
True
, =
diù
, 
nuÎ
=True),

66 
	gmig¿tiÚs
.
AÉ”F›ld
(

67 
mod–_Çme
='proforma',

68 
Çme
='archived_provider',

69 
f›ld
=
ªnoyšg
.
f›lds
.
JSONF›ld
(
bÏnk
=
True
, =
diù
, 
nuÎ
=True),

71 
	gmig¿tiÚs
.
AÉ”F›ld
(

72 
mod–_Çme
='proforma',

73 
Çme
='currency',

74 
f›ld
=
mod–s
.
Ch¬F›ld
(
choiûs
=[('AED', 'AED (UAE Dœham)'), ('AFN', 'AFN (Afghªi)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Arm’ŸÀD¿m)'), ('ANG', 'ANG (N‘h”Ïnd AÁËª Gud”)'), ('AOA', 'AOA (Kwªza)'), ('ARS', 'ARS (Arg’tšPeso)'), ('AUD', 'AUD (Au¡¿lŸÀDŞÏr)'), ('AWG', 'AWG (Arubª FlÜš)'), ('AZN', 'AZN (Az”baijªŸÀMª©)'), ('BAM', 'BAM (CÚv”tibË M¬k)'), ('BBD', 'BBD (B¬bado DŞÏr)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulg¬ŸÀLev)'), ('BHD', 'BHD (Bah¿š˜Dš¬)'), ('BIF', 'BIF (Burund˜F¿nc)'), ('BMD', 'BMD (B”mudŸÀDŞÏr)'), ('BND', 'BND (BruÃ˜DŞÏr)'), ('BOB', 'BOB (BŞivŸno)'), ('BRL', 'BRL (B¿zŸÀR—l)'), ('BSD', 'BSD (BahamŸÀDŞÏr)'), ('BTN', 'BTN (NguÉrum)'), ('BWP', 'BWP (PuÏ)'), ('BYN', 'BYN (B–¬usŸÀRubË)'), ('BZD', 'BZD (B–izDŞÏr)'), ('CAD', 'CAD (CªadŸÀDŞÏr)'), ('CDF', 'CDF (CÚgŞe£ F¿nc)'), ('CHF', 'CHF (Swis F¿nc)'), ('CLP', 'CLP (Ch—ÀPeso)'), ('CNY', 'CNY (Yuª R’mšbi)'), ('COP', 'COP (CŞombŸÀPeso)'), ('CRC', 'CRC (Co¡¨RiÿÀCŞÚ)'), ('CUC', 'CUC (PesØCÚv”tibË)'), ('CUP', 'CUP (Cubª Peso)'), ('CVE', 'CVE (CabØV”dEscudo)'), ('CZK', 'CZK (Czech KÜuÇ)'), ('DJF', 'DJF (Djibout˜F¿nc)'), ('DKK', 'DKK (Dªish KrÚe)'), ('DOP', 'DOP (DomšiÿÀPeso)'), ('DZD', 'DZD (Alg”ŸÀDš¬)'), ('EGP', 'EGP (Egy±ŸÀPound)'), ('ERN', 'ERN (Nakç)'), ('ETB', 'ETB (EthiİŸÀBœr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fij˜DŞÏr)'), ('FKP', 'FKP (F®kÏnd I¦ªd Pound)'), ('GBP', 'GBP (Pound S‹¾šg)'), ('GEL', 'GEL (L¬i)'), ('GHS', 'GHS (Ghª¨Cedi)'), ('GIP', 'GIP (Gib¿É¬ Pound)'), ('GMD', 'GMD (D®asi)'), ('GNF', 'GNF (Guš— F¿nc)'), ('GTQ', 'GTQ (Qu‘z®)'), ('GYD', 'GYD (Guyª¨DŞÏr)'), ('HKD', 'HKD (HÚg KÚg DŞÏr)'), ('HNL', 'HNL (Lempœa)'), ('HRK', 'HRK (KuÇ)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (FÜšt)'), ('IDR', 'IDR (RupŸh)'), ('ILS', 'ILS (New I¤«l˜Sheq–)'), ('INR', 'INR (IndŸÀRu³e)'), ('IQD', 'IQD (I¿q˜Dš¬)'), ('IRR', 'IRR (I¿nŸÀRŸl)'), ('ISK', 'ISK (IûÏnd KrÚa)'), ('JMD', 'JMD (JamaiÿÀDŞÏr)'), ('JOD', 'JOD (JÜdªŸÀDš¬)'), ('JPY', 'JPY (Y’)'), ('KES', 'KES (K’yª Shlšg)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (R›l)'), ('KMF', 'KMF (ComÜØF¿nc)'), ('KPW', 'KPW (NÜth KÜ—ÀWÚ)'), ('KRW', 'KRW (WÚ)'), ('KWD', 'KWD (Kuwa™˜Dš¬)'), ('KYD', 'KYD (Caymª I¦ªd DŞÏr)'), ('KZT', 'KZT (T’ge)'), ('LAK', 'LAK (K)'), ('LBP', 'LBP (Lebªe£ Pound)'), ('LKR', 'LKR (Sr˜Lªk¨Ru³e)'), ('LRD', 'LRD (Lib”ŸÀDŞÏr)'), ('LSL', 'LSL (LÙi)'), ('LYD', 'LYD (Libyª Dš¬)'), ('MAD', 'MAD (MÜocÿÀDœham)'), ('MDL', 'MDL (MŞdovª Leu)'), ('MGA', 'MGA (M®agasy ArŸry)'), ('MKD', 'MKD (D’¬)'), ('MMK', 'MMK (Ky©)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (P©aÿ)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Maur™iu Ru³e)'), ('MVR', 'MVR (Rufiy¯)'), ('MWK', 'MWK (M®aw˜Kwacha)'), ('MXN', 'MXN (MexiÿÀPeso)'), ('MYR', 'MYR (M®aysŸÀRšgg™)'), ('MZN', 'MZN (MozambiquM‘iÿl)'), ('NAD', 'NAD (NamibŸ DŞÏr)'), ('NGN', 'NGN (Naœa)'), ('NIO', 'NIO (CÜdob¨Oro)'), ('NOK', 'NOK (NÜwegŸÀKrÚe)'), ('NPR', 'NPR (N•®e£ Ru³e)'), ('NZD', 'NZD (New Z—Ïnd DŞÏr)'), ('OMR', 'OMR (RŸÈOmªi)'), ('PAB', 'PAB (B®bß)'), ('PEN', 'PEN (SŞ)'), ('PGK', 'PGK (Kša)'), ('PHP', 'PHP (PhpšPeso)'), ('PKR', 'PKR (Paki¡ª Ru³e)'), ('PLN', 'PLN (ZlÙy)'), ('PYG', 'PYG (Gu¬ªi)'), ('QAR', 'QAR (Q©¬˜RŸl)'), ('RON', 'RON (RomªŸÀLeu)'), ('RSD', 'RSD (S”bŸÀDš¬)'), ('RUB', 'RUB (RussŸÀRubË)'), ('RWF', 'RWF (Rwªd¨F¿nc)'), ('SAR', 'SAR (Saud˜Riy®)'), ('SBD', 'SBD (SŞomÚ I¦ªd DŞÏr)'), ('SCR', 'SCR (Seych–Ë Ru³e)'), ('SDG', 'SDG (Sudªe£ Pound)'), ('SEK', 'SEK (Swedish KrÚa)'), ('SGD', 'SGD (Sšg­ÜDŞÏr)'), ('SHP', 'SHP (SašˆH–’¨Pound)'), ('SLL', 'SLL (LeÚe)'), ('SOS', 'SOS (Som®˜Shlšg)'), ('SRD', 'SRD (Suršam DŞÏr)'), ('SSP', 'SSP (South Sudªe£ Pound)'), ('STD', 'STD (Dob¿)'), ('SVC', 'SVC (EÈS®vadÜ CŞÚ)'), ('SYP', 'SYP (SyrŸÀPound)'), ('SZL', 'SZL (Lªg’i)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (SomÚi)'), ('TMT', 'TMT (Turkm’i¡ª New Mª©)'), ('TND', 'TND (TunisŸÀDš¬)'), ('TOP', 'TOP (Pa\u2019ªga)'), ('TRY', 'TRY (Turkish Lœa)'), ('TTD', 'TTD (Tršidad‡nd TobagØDŞÏr)'), ('TWD', 'TWD (New Taiwª DŞÏr)'), ('TZS', 'TZS (TªzªŸÀShlšg)'), ('UAH', 'UAH (HryvnŸ)'), ('UGX', 'UGX (Ugªd¨Shlšg)'), ('USD', 'USD (US DŞÏr)'), ('UYU', 'UYU (PesØUruguayo)'), ('UZS', 'UZS (Uzbeki¡ª Sum)'), ('VEF', 'VEF (BŞ\xedv¬)'), ('VND', 'VND (DÚg)'), ('VUV', 'VUV (V©u)'), ('WST', 'WST (T®a)'), ('XAF', 'XAF (CFA F¿nøBEAC)'), ('XAG', 'XAG (Sv”)'), ('XAU', 'XAU (GŞd)'), ('XBA', 'XBA (BÚd M¬k‘ Un™ Eurİ—ÀCompos™Un™ (EURCO))'), ('XBB', 'XBB (BÚd M¬k‘ Un™ Eurİ—ÀMÚ‘¬y Un™ (E.M.U.-6))'), ('XBC', 'XBC (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 9 (E.U.A.-9))'), ('XBD', 'XBD (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 17 (E.U.A.-17))'), ('XCD', 'XCD (Ea¡ C¬ibb—ÀDŞÏr)'), ('XDR', 'XDR (SDR (S³cŸÈD¿wšg Right))'), ('XOF', 'XOF (CFA F¿nøBCEAO)'), ('XPD', 'XPD (P®Ïdium)'), ('XPF', 'XPF (CFP F¿nc)'), ('XPT', 'XPT (PÏtšum)'), ('XSU', 'XSU (Suüe)'), ('XTS', 'XTS (Code ¥ecifiÿÎy„e£rved fÜe¡šg…u½o£s)'), ('XUA', 'XUA (ADB Un™ oàAccouÁ)'), ('XXX', 'XXX (Thcode assigÃd fÜ¿n§ùiÚ wh”nØcu¼’cy i švŞved)'), ('YER', 'YER (Yem’˜RŸl)'), ('ZAR', 'ZAR (Rªd)'), ('ZMW', 'ZMW (ZambŸÀKwacha)'), ('ZWL', 'ZWL (ZimbabwDŞÏr)')], =
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy u£d fÜ blšg.', 
max_Ëngth
=4),

76 
	gmig¿tiÚs
.
AÉ”F›ld
(

77 
mod–_Çme
='proforma',

78 
Çme
='transaction_currency',

79 
f›ld
=
mod–s
.
Ch¬F›ld
(
choiûs
=[('AED', 'AED (UAE Dœham)'), ('AFN', 'AFN (Afghªi)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Arm’ŸÀD¿m)'), ('ANG', 'ANG (N‘h”Ïnd AÁËª Gud”)'), ('AOA', 'AOA (Kwªza)'), ('ARS', 'ARS (Arg’tšPeso)'), ('AUD', 'AUD (Au¡¿lŸÀDŞÏr)'), ('AWG', 'AWG (Arubª FlÜš)'), ('AZN', 'AZN (Az”baijªŸÀMª©)'), ('BAM', 'BAM (CÚv”tibË M¬k)'), ('BBD', 'BBD (B¬bado DŞÏr)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulg¬ŸÀLev)'), ('BHD', 'BHD (Bah¿š˜Dš¬)'), ('BIF', 'BIF (Burund˜F¿nc)'), ('BMD', 'BMD (B”mudŸÀDŞÏr)'), ('BND', 'BND (BruÃ˜DŞÏr)'), ('BOB', 'BOB (BŞivŸno)'), ('BRL', 'BRL (B¿zŸÀR—l)'), ('BSD', 'BSD (BahamŸÀDŞÏr)'), ('BTN', 'BTN (NguÉrum)'), ('BWP', 'BWP (PuÏ)'), ('BYN', 'BYN (B–¬usŸÀRubË)'), ('BZD', 'BZD (B–izDŞÏr)'), ('CAD', 'CAD (CªadŸÀDŞÏr)'), ('CDF', 'CDF (CÚgŞe£ F¿nc)'), ('CHF', 'CHF (Swis F¿nc)'), ('CLP', 'CLP (Ch—ÀPeso)'), ('CNY', 'CNY (Yuª R’mšbi)'), ('COP', 'COP (CŞombŸÀPeso)'), ('CRC', 'CRC (Co¡¨RiÿÀCŞÚ)'), ('CUC', 'CUC (PesØCÚv”tibË)'), ('CUP', 'CUP (Cubª Peso)'), ('CVE', 'CVE (CabØV”dEscudo)'), ('CZK', 'CZK (Czech KÜuÇ)'), ('DJF', 'DJF (Djibout˜F¿nc)'), ('DKK', 'DKK (Dªish KrÚe)'), ('DOP', 'DOP (DomšiÿÀPeso)'), ('DZD', 'DZD (Alg”ŸÀDš¬)'), ('EGP', 'EGP (Egy±ŸÀPound)'), ('ERN', 'ERN (Nakç)'), ('ETB', 'ETB (EthiİŸÀBœr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fij˜DŞÏr)'), ('FKP', 'FKP (F®kÏnd I¦ªd Pound)'), ('GBP', 'GBP (Pound S‹¾šg)'), ('GEL', 'GEL (L¬i)'), ('GHS', 'GHS (Ghª¨Cedi)'), ('GIP', 'GIP (Gib¿É¬ Pound)'), ('GMD', 'GMD (D®asi)'), ('GNF', 'GNF (Guš— F¿nc)'), ('GTQ', 'GTQ (Qu‘z®)'), ('GYD', 'GYD (Guyª¨DŞÏr)'), ('HKD', 'HKD (HÚg KÚg DŞÏr)'), ('HNL', 'HNL (Lempœa)'), ('HRK', 'HRK (KuÇ)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (FÜšt)'), ('IDR', 'IDR (RupŸh)'), ('ILS', 'ILS (New I¤«l˜Sheq–)'), ('INR', 'INR (IndŸÀRu³e)'), ('IQD', 'IQD (I¿q˜Dš¬)'), ('IRR', 'IRR (I¿nŸÀRŸl)'), ('ISK', 'ISK (IûÏnd KrÚa)'), ('JMD', 'JMD (JamaiÿÀDŞÏr)'), ('JOD', 'JOD (JÜdªŸÀDš¬)'), ('JPY', 'JPY (Y’)'), ('KES', 'KES (K’yª Shlšg)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (R›l)'), ('KMF', 'KMF (ComÜØF¿nc)'), ('KPW', 'KPW (NÜth KÜ—ÀWÚ)'), ('KRW', 'KRW (WÚ)'), ('KWD', 'KWD (Kuwa™˜Dš¬)'), ('KYD', 'KYD (Caymª I¦ªd DŞÏr)'), ('KZT', 'KZT (T’ge)'), ('LAK', 'LAK (K)'), ('LBP', 'LBP (Lebªe£ Pound)'), ('LKR', 'LKR (Sr˜Lªk¨Ru³e)'), ('LRD', 'LRD (Lib”ŸÀDŞÏr)'), ('LSL', 'LSL (LÙi)'), ('LYD', 'LYD (Libyª Dš¬)'), ('MAD', 'MAD (MÜocÿÀDœham)'), ('MDL', 'MDL (MŞdovª Leu)'), ('MGA', 'MGA (M®agasy ArŸry)'), ('MKD', 'MKD (D’¬)'), ('MMK', 'MMK (Ky©)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (P©aÿ)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Maur™iu Ru³e)'), ('MVR', 'MVR (Rufiy¯)'), ('MWK', 'MWK (M®aw˜Kwacha)'), ('MXN', 'MXN (MexiÿÀPeso)'), ('MYR', 'MYR (M®aysŸÀRšgg™)'), ('MZN', 'MZN (MozambiquM‘iÿl)'), ('NAD', 'NAD (NamibŸ DŞÏr)'), ('NGN', 'NGN (Naœa)'), ('NIO', 'NIO (CÜdob¨Oro)'), ('NOK', 'NOK (NÜwegŸÀKrÚe)'), ('NPR', 'NPR (N•®e£ Ru³e)'), ('NZD', 'NZD (New Z—Ïnd DŞÏr)'), ('OMR', 'OMR (RŸÈOmªi)'), ('PAB', 'PAB (B®bß)'), ('PEN', 'PEN (SŞ)'), ('PGK', 'PGK (Kša)'), ('PHP', 'PHP (PhpšPeso)'), ('PKR', 'PKR (Paki¡ª Ru³e)'), ('PLN', 'PLN (ZlÙy)'), ('PYG', 'PYG (Gu¬ªi)'), ('QAR', 'QAR (Q©¬˜RŸl)'), ('RON', 'RON (RomªŸÀLeu)'), ('RSD', 'RSD (S”bŸÀDš¬)'), ('RUB', 'RUB (RussŸÀRubË)'), ('RWF', 'RWF (Rwªd¨F¿nc)'), ('SAR', 'SAR (Saud˜Riy®)'), ('SBD', 'SBD (SŞomÚ I¦ªd DŞÏr)'), ('SCR', 'SCR (Seych–Ë Ru³e)'), ('SDG', 'SDG (Sudªe£ Pound)'), ('SEK', 'SEK (Swedish KrÚa)'), ('SGD', 'SGD (Sšg­ÜDŞÏr)'), ('SHP', 'SHP (SašˆH–’¨Pound)'), ('SLL', 'SLL (LeÚe)'), ('SOS', 'SOS (Som®˜Shlšg)'), ('SRD', 'SRD (Suršam DŞÏr)'), ('SSP', 'SSP (South Sudªe£ Pound)'), ('STD', 'STD (Dob¿)'), ('SVC', 'SVC (EÈS®vadÜ CŞÚ)'), ('SYP', 'SYP (SyrŸÀPound)'), ('SZL', 'SZL (Lªg’i)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (SomÚi)'), ('TMT', 'TMT (Turkm’i¡ª New Mª©)'), ('TND', 'TND (TunisŸÀDš¬)'), ('TOP', 'TOP (Pa\u2019ªga)'), ('TRY', 'TRY (Turkish Lœa)'), ('TTD', 'TTD (Tršidad‡nd TobagØDŞÏr)'), ('TWD', 'TWD (New Taiwª DŞÏr)'), ('TZS', 'TZS (TªzªŸÀShlšg)'), ('UAH', 'UAH (HryvnŸ)'), ('UGX', 'UGX (Ugªd¨Shlšg)'), ('USD', 'USD (US DŞÏr)'), ('UYU', 'UYU (PesØUruguayo)'), ('UZS', 'UZS (Uzbeki¡ª Sum)'), ('VEF', 'VEF (BŞ\xedv¬)'), ('VND', 'VND (DÚg)'), ('VUV', 'VUV (V©u)'), ('WST', 'WST (T®a)'), ('XAF', 'XAF (CFA F¿nøBEAC)'), ('XAG', 'XAG (Sv”)'), ('XAU', 'XAU (GŞd)'), ('XBA', 'XBA (BÚd M¬k‘ Un™ Eurİ—ÀCompos™Un™ (EURCO))'), ('XBB', 'XBB (BÚd M¬k‘ Un™ Eurİ—ÀMÚ‘¬y Un™ (E.M.U.-6))'), ('XBC', 'XBC (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 9 (E.U.A.-9))'), ('XBD', 'XBD (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 17 (E.U.A.-17))'), ('XCD', 'XCD (Ea¡ C¬ibb—ÀDŞÏr)'), ('XDR', 'XDR (SDR (S³cŸÈD¿wšg Right))'), ('XOF', 'XOF (CFA F¿nøBCEAO)'), ('XPD', 'XPD (P®Ïdium)'), ('XPF', 'XPF (CFP F¿nc)'), ('XPT', 'XPT (PÏtšum)'), ('XSU', 'XSU (Suüe)'), ('XTS', 'XTS (Code ¥ecifiÿÎy„e£rved fÜe¡šg…u½o£s)'), ('XUA', 'XUA (ADB Un™ oàAccouÁ)'), ('XXX', 'XXX (Thcode assigÃd fÜ¿n§ùiÚ wh”nØcu¼’cy i švŞved)'), ('YER', 'YER (Yem’˜RŸl)'), ('ZAR', 'ZAR (Rªd)'), ('ZMW', 'ZMW (ZambŸÀKwacha)'), ('ZWL', 'ZWL (ZimbabwDŞÏr)')], 
h–p_‹xt
=
b
'Thcu¼’cy u£d wh’ makšg‡¿n§ùiÚ.', 
max_Ëngth
=4),

81 
	gmig¿tiÚs
.
AÉ”F›ld
(

82 
mod–_Çme
='provider',

83 
Çme
='country',

84 
f›ld
=
mod–s
.
Ch¬F›ld
(
choiûs
=[('AD', 'AndÜ¿'), ('AE', 'Un™ed A¿b Emœ©es'), ('AF', 'Afghªi¡ª'), ('AG', 'AÁigu¨ªd B¬buda'), ('AI', 'AnguÏ'), ('AL', 'AlbªŸ'), ('AM', 'Arm’Ÿ'), ('AO', 'AngŞa'), ('AQ', 'AÁ¬ùiÿ'), ('AR', 'Arg’tša'), ('AS', 'Am”iÿÀSamß'), ('AT', 'Au¡rŸ'), ('AU', 'Au¡¿lŸ'), ('AW', 'Aruba'), ('AX', '\xc5Ïnd I¦ªds'), ('AZ', 'Az”baijª'), ('BA', 'Bo¢Ÿ‡nd H”zegovša'), ('BB', 'B¬bados'), ('BD', 'BªgÏdesh'), ('BE', 'B–gium'), ('BF', 'Burkš¨Faso'), ('BG', 'Bulg¬Ÿ'), ('BH', 'Bah¿š'), ('BI', 'Burundi'), ('BJ', 'B’š'), ('BL', 'SašˆB¬th\xe9Ëmy'), ('BM', 'B”muda'), ('BN', 'BruÃ˜D¬us§Ïm'), ('BO', 'BŞivŸ, Plurš©iÚ® S‹ of'), ('BQ', 'BÚaœe, SšˆEu¡©iu ªd Saba'), ('BR', 'B¿z'), ('BS', 'Bahamas'), ('BT', 'Bhun'), ('BV', 'Bouv‘ I¦ªd'), ('BW', 'BÙswªa'), ('BY', 'B–¬us'), ('BZ', 'B–ize'), ('CA', 'Cªada'), ('CC', 'Coco (K“lšgèI¦ªds'), ('CD', 'CÚgo, ThDemoü©iøR•ubliøoàthe'), ('CF', 'C’Œ® AäiÿÀR•ublic'), ('CG', 'CÚgo'), ('CH', 'Sw™z”Ïnd'), ('CI', "C\xf4‹ d'Ivoœe"), ('CK', 'Cook I¦ªds'), ('CL', 'Che'), ('CM', 'Cam”oÚ'), ('CN', 'Chša'), ('CO', 'CŞombŸ'), ('CR', 'Co¡¨Riÿ'), ('CU', 'Cuba'), ('CV', 'CabØV”de'), ('CW', 'Cu¿\xe7ao'), ('CX', 'Chri¡ma I¦ªd'), ('CY', 'Cy´us'), ('CZ', 'CzechŸ'), ('DE', 'G”mªy'), ('DJ', 'Djibouti'), ('DK', 'D’m¬k'), ('DM', 'Domšiÿ'), ('DO', 'DomšiÿÀR•ublic'), ('DZ', 'Alg”Ÿ'), ('EC', 'EcuadÜ'), ('EE', 'E¡ÚŸ'), ('EG', 'Egy±'), ('EH', 'We¡”ÀSah¬a'), ('ER', 'Er™»a'), ('ES', 'S·š'), ('ET', 'EthiİŸ'), ('FI', 'FšÏnd'), ('FJ', 'Fiji'), ('FK', 'F®kÏnd I¦ªd (M®všas)'), ('FM', 'MiüÚesŸ, Fed”©ed S‹ of'), ('FO', 'F¬Û I¦ªds'), ('FR', 'F¿nû'), ('GA', 'GabÚ'), ('GB', 'Un™ed Kšgdom'), ('GD', 'G»Çda'), ('GE', 'GeÜgŸ'), ('GF', 'F»nch GuŸÇ'), ('GG', 'Gu”n£y'), ('GH', 'Ghªa'), ('GI', 'Gib¿É¬'), ('GL', 'G»’Ïnd'), ('GM', 'GambŸ'), ('GN', 'Guš—'), ('GP', 'Guad–ou³'), ('GQ', 'Equ©ÜŸÈGuš—'), ('GR', 'G»eû'), ('GS', 'South GeÜgŸ‡ndhSouth Sªdwich I¦ªds'), ('GT', 'Gu©em®a'), ('GU', 'Guam'), ('GW', 'Guš—-Bis§u'), ('GY', 'Guyªa'), ('HK', 'HÚg KÚg'), ('HM', 'H—rd I¦ªd‡nd McDÚ®d I¦ªds'), ('HN', 'HÚdu¿s'), ('HR', 'CrßtŸ'), ('HT', 'Ha™i'), ('HU', 'Hung¬y'), ('ID', 'IndÚesŸ'), ('IE', 'I»Ïnd'), ('IL', 'I¤«l'), ('IM', 'I¦oàMª'), ('IN', 'IndŸ'), ('IO', 'Br™ish IndŸÀOûª T”r™Üy'), ('IQ', 'I¿q'), ('IR', 'I¿n, I¦amiøR•ubliøof'), ('IS', 'IûÏnd'), ('IT', 'Ily'), ('JE', 'J”£y'), ('JM', 'Jamaiÿ'), ('JO', 'JÜdª'), ('JP', 'J­ª'), ('KE', 'K’ya'), ('KG', 'Kyrgyz¡ª'), ('KH', 'CambodŸ'), ('KI', 'Kœib©i'), ('KM', 'ComÜos'), ('KN', 'SašˆK™t ªd Nevis'), ('KP', "KÜ—, Demoü©iøPeİË' R•ubliøof"), ('KR', 'KÜ—, R•ubliøof'), ('KW', 'Kuwa™'), ('KY', 'Caymª I¦ªds'), ('KZ', 'Kazakh¡ª'), ('LA', "LaØPeİË' Demoü©iøR•ublic"), ('LB', 'LebªÚ'), ('LC', 'SašˆLucŸ'), ('LI', 'L›ch‹n¡eš'), ('LK', 'Sr˜Lªka'), ('LR', 'Lib”Ÿ'), ('LS', 'LesÙho'), ('LT', 'L™huªŸ'), ('LU', 'Luxembourg'), ('LV', 'L©vŸ'), ('LY', 'Libya'), ('MA', 'MÜocco'), ('MC', 'MÚaco'), ('MD', 'MŞdova, R•ubliøof'), ('ME', 'MÚ‹Ãgro'), ('MF', 'SašˆM¬tš (F»nch…¬t)'), ('MG', 'Madagasÿr'), ('MH', 'M¬sh®ÈI¦ªds'), ('MK', 'MaûdÚŸ, R•ubliøof'), ('ML', 'M®i'), ('MM', 'Myªm¬'), ('MN', 'MÚgŞŸ'), ('MO', 'Maÿo'), ('MP', 'NÜth”ÀM¬ŸÇ I¦ªds'), ('MQ', 'M¬tšique'), ('MR', 'Maur™ªŸ'), ('MS', 'MÚt£¼©'), ('MT', 'M®'), ('MU', 'Maur™ius'), ('MV', 'M®dives'), ('MW', 'M®awi'), ('MX', 'Mexico'), ('MY', 'M®aysŸ'), ('MZ', 'Mozambique'), ('NA', 'NamibŸ'), ('NC', 'New C®edÚŸ'), ('NE', 'Nig”'), ('NF', 'NÜfŞk I¦ªd'), ('NG', 'Nig”Ÿ'), ('NI', 'Niÿ¿gua'), ('NL', 'N‘h”Ïnds'), ('NO', 'NÜway'), ('NP', 'N•®'), ('NR', 'Nauru'), ('NU', 'Niue'), ('NZ', 'New Z—Ïnd'), ('OM', 'Omª'), ('PA', 'Pªama'), ('PE', 'P”u'), ('PF', 'F»nch PŞyÃsŸ'), ('PG', 'P­u¨New Guš—'), ('PH', 'Phpšes'), ('PK', 'Paki¡ª'), ('PL', 'PŞªd'), ('PM', 'SašˆP›¼ªd Miqu–Ú'), ('PN', 'P™ÿœn'), ('PR', 'Pu”tØRico'), ('PS', 'P®e¡še, S‹ of'), ('PT', 'PÜtug®'), ('PW', 'P®au'), ('PY', 'P¬aguay'), ('QA', 'Q©¬'), ('RE', 'R\xe9uniÚ'), ('RO', 'RomªŸ'), ('RS', 'S”bŸ'), ('RU', 'RussŸÀFed”©iÚ'), ('RW', 'Rwªda'), ('SA', 'Saud˜A¿bŸ'), ('SB', 'SŞomÚ I¦ªds'), ('SC', 'Seych–Ës'), ('SD', 'Sudª'), ('SE', 'Swed’'), ('SG', 'Sšg­Üe'), ('SH', 'SašˆH–’a, AsûnsiÚ‡nd Tri¡ª d¨Cunha'), ('SI', 'Slov’Ÿ'), ('SJ', 'Sv®b¬d‡nd Jª May’'), ('SK', 'SlovakŸ'), ('SL', 'S›¼¨LeÚe'), ('SM', 'Sª M¬šo'), ('SN', 'S’eg®'), ('SO', 'Som®Ÿ'), ('SR', 'Suršame'), ('SS', 'South Sudª'), ('ST', 'SaØTomªd Pršce'), ('SV', 'EÈS®vadÜ'), ('SX', 'SšˆM¯¹’ (Dutch…¬t)'), ('SY', 'SyrŸÀA¿b R•ublic'), ('SZ', 'Swazªd'), ('TC', 'Turk ªd Caico I¦ªds'), ('TD', 'Chad'), ('TF', 'F»nch South”ÀT”r™Ü›s'), ('TG', 'Togo'), ('TH', 'Thaªd'), ('TJ', 'Tajiki¡ª'), ('TK', 'Tok–au'), ('TL', 'TimÜ-Le¡e'), ('TM', 'Turkm’i¡ª'), ('TN', 'TunisŸ'), ('TO', 'TÚga'), ('TR', 'Turkey'), ('TT', 'Tršidad‡nd Tobago'), ('TV', 'Tuv®u'), ('TW', 'Taiwª, Provšû oàChša'), ('TZ', 'TªzªŸ, Un™ed R•ubliøof'), ('UA', 'Uk¿še'), ('UG', 'Ugªda'), ('UM', 'Un™ed S‹ MšÜ Ouyšg I¦ªds'), ('US', 'Un™ed S‹s'), ('UY', 'Uruguay'), ('UZ', 'Uzbeki¡ª'), ('VA', 'HŞy S“ (V©iÿÀC™y S‹)'), ('VC', 'SašˆVšûÁ‡ndhG»Çdšes'), ('VE', 'V’ezu–a, BŞiv¬ŸÀR•ubliøof'), ('VG', 'Vœgš I¦ªds, Br™ish'), ('VI', 'Vœgš I¦ªds, U.S.'), ('VN', 'V›ˆNam'), ('VU', 'Vªu©u'), ('WF', 'W®li ªd FutuÇ'), ('WS', 'Samß'), ('YE', 'Yem’'), ('YT', 'MayÙ‹'), ('ZA', 'South Aäiÿ'), ('ZM', 'ZambŸ'), ('ZW', 'Zimbabwe')], 
max_Ëngth
=3),

86 
	gmig¿tiÚs
.
AÉ”F›ld
(

87 
mod–_Çme
='provider',

88 
Çme
='meta',

89 
f›ld
=
ªnoyšg
.
f›lds
.
JSONF›ld
(
bÏnk
=
True
, ={}, 
nuÎ
=True),

91 
	gmig¿tiÚs
.
AÉ”F›ld
(

92 
mod–_Çme
='subscription',

93 
Çme
='meta',

94 
f›ld
=
ªnoyšg
.
f›lds
.
JSONF›ld
(
bÏnk
=
True
, 
nuÎ
=True),

96 
	gmig¿tiÚs
.
AÉ”F›ld
(

97 
mod–_Çme
='transaction',

98 
Çme
='currency',

99 
f›ld
=
mod–s
.
Ch¬F›ld
(
choiûs
=[('AED', 'AED (UAE Dœham)'), ('AFN', 'AFN (Afghªi)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Arm’ŸÀD¿m)'), ('ANG', 'ANG (N‘h”Ïnd AÁËª Gud”)'), ('AOA', 'AOA (Kwªza)'), ('ARS', 'ARS (Arg’tšPeso)'), ('AUD', 'AUD (Au¡¿lŸÀDŞÏr)'), ('AWG', 'AWG (Arubª FlÜš)'), ('AZN', 'AZN (Az”baijªŸÀMª©)'), ('BAM', 'BAM (CÚv”tibË M¬k)'), ('BBD', 'BBD (B¬bado DŞÏr)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulg¬ŸÀLev)'), ('BHD', 'BHD (Bah¿š˜Dš¬)'), ('BIF', 'BIF (Burund˜F¿nc)'), ('BMD', 'BMD (B”mudŸÀDŞÏr)'), ('BND', 'BND (BruÃ˜DŞÏr)'), ('BOB', 'BOB (BŞivŸno)'), ('BRL', 'BRL (B¿zŸÀR—l)'), ('BSD', 'BSD (BahamŸÀDŞÏr)'), ('BTN', 'BTN (NguÉrum)'), ('BWP', 'BWP (PuÏ)'), ('BYN', 'BYN (B–¬usŸÀRubË)'), ('BZD', 'BZD (B–izDŞÏr)'), ('CAD', 'CAD (CªadŸÀDŞÏr)'), ('CDF', 'CDF (CÚgŞe£ F¿nc)'), ('CHF', 'CHF (Swis F¿nc)'), ('CLP', 'CLP (Ch—ÀPeso)'), ('CNY', 'CNY (Yuª R’mšbi)'), ('COP', 'COP (CŞombŸÀPeso)'), ('CRC', 'CRC (Co¡¨RiÿÀCŞÚ)'), ('CUC', 'CUC (PesØCÚv”tibË)'), ('CUP', 'CUP (Cubª Peso)'), ('CVE', 'CVE (CabØV”dEscudo)'), ('CZK', 'CZK (Czech KÜuÇ)'), ('DJF', 'DJF (Djibout˜F¿nc)'), ('DKK', 'DKK (Dªish KrÚe)'), ('DOP', 'DOP (DomšiÿÀPeso)'), ('DZD', 'DZD (Alg”ŸÀDš¬)'), ('EGP', 'EGP (Egy±ŸÀPound)'), ('ERN', 'ERN (Nakç)'), ('ETB', 'ETB (EthiİŸÀBœr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fij˜DŞÏr)'), ('FKP', 'FKP (F®kÏnd I¦ªd Pound)'), ('GBP', 'GBP (Pound S‹¾šg)'), ('GEL', 'GEL (L¬i)'), ('GHS', 'GHS (Ghª¨Cedi)'), ('GIP', 'GIP (Gib¿É¬ Pound)'), ('GMD', 'GMD (D®asi)'), ('GNF', 'GNF (Guš— F¿nc)'), ('GTQ', 'GTQ (Qu‘z®)'), ('GYD', 'GYD (Guyª¨DŞÏr)'), ('HKD', 'HKD (HÚg KÚg DŞÏr)'), ('HNL', 'HNL (Lempœa)'), ('HRK', 'HRK (KuÇ)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (FÜšt)'), ('IDR', 'IDR (RupŸh)'), ('ILS', 'ILS (New I¤«l˜Sheq–)'), ('INR', 'INR (IndŸÀRu³e)'), ('IQD', 'IQD (I¿q˜Dš¬)'), ('IRR', 'IRR (I¿nŸÀRŸl)'), ('ISK', 'ISK (IûÏnd KrÚa)'), ('JMD', 'JMD (JamaiÿÀDŞÏr)'), ('JOD', 'JOD (JÜdªŸÀDš¬)'), ('JPY', 'JPY (Y’)'), ('KES', 'KES (K’yª Shlšg)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (R›l)'), ('KMF', 'KMF (ComÜØF¿nc)'), ('KPW', 'KPW (NÜth KÜ—ÀWÚ)'), ('KRW', 'KRW (WÚ)'), ('KWD', 'KWD (Kuwa™˜Dš¬)'), ('KYD', 'KYD (Caymª I¦ªd DŞÏr)'), ('KZT', 'KZT (T’ge)'), ('LAK', 'LAK (K)'), ('LBP', 'LBP (Lebªe£ Pound)'), ('LKR', 'LKR (Sr˜Lªk¨Ru³e)'), ('LRD', 'LRD (Lib”ŸÀDŞÏr)'), ('LSL', 'LSL (LÙi)'), ('LYD', 'LYD (Libyª Dš¬)'), ('MAD', 'MAD (MÜocÿÀDœham)'), ('MDL', 'MDL (MŞdovª Leu)'), ('MGA', 'MGA (M®agasy ArŸry)'), ('MKD', 'MKD (D’¬)'), ('MMK', 'MMK (Ky©)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (P©aÿ)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Maur™iu Ru³e)'), ('MVR', 'MVR (Rufiy¯)'), ('MWK', 'MWK (M®aw˜Kwacha)'), ('MXN', 'MXN (MexiÿÀPeso)'), ('MYR', 'MYR (M®aysŸÀRšgg™)'), ('MZN', 'MZN (MozambiquM‘iÿl)'), ('NAD', 'NAD (NamibŸ DŞÏr)'), ('NGN', 'NGN (Naœa)'), ('NIO', 'NIO (CÜdob¨Oro)'), ('NOK', 'NOK (NÜwegŸÀKrÚe)'), ('NPR', 'NPR (N•®e£ Ru³e)'), ('NZD', 'NZD (New Z—Ïnd DŞÏr)'), ('OMR', 'OMR (RŸÈOmªi)'), ('PAB', 'PAB (B®bß)'), ('PEN', 'PEN (SŞ)'), ('PGK', 'PGK (Kša)'), ('PHP', 'PHP (PhpšPeso)'), ('PKR', 'PKR (Paki¡ª Ru³e)'), ('PLN', 'PLN (ZlÙy)'), ('PYG', 'PYG (Gu¬ªi)'), ('QAR', 'QAR (Q©¬˜RŸl)'), ('RON', 'RON (RomªŸÀLeu)'), ('RSD', 'RSD (S”bŸÀDš¬)'), ('RUB', 'RUB (RussŸÀRubË)'), ('RWF', 'RWF (Rwªd¨F¿nc)'), ('SAR', 'SAR (Saud˜Riy®)'), ('SBD', 'SBD (SŞomÚ I¦ªd DŞÏr)'), ('SCR', 'SCR (Seych–Ë Ru³e)'), ('SDG', 'SDG (Sudªe£ Pound)'), ('SEK', 'SEK (Swedish KrÚa)'), ('SGD', 'SGD (Sšg­ÜDŞÏr)'), ('SHP', 'SHP (SašˆH–’¨Pound)'), ('SLL', 'SLL (LeÚe)'), ('SOS', 'SOS (Som®˜Shlšg)'), ('SRD', 'SRD (Suršam DŞÏr)'), ('SSP', 'SSP (South Sudªe£ Pound)'), ('STD', 'STD (Dob¿)'), ('SVC', 'SVC (EÈS®vadÜ CŞÚ)'), ('SYP', 'SYP (SyrŸÀPound)'), ('SZL', 'SZL (Lªg’i)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (SomÚi)'), ('TMT', 'TMT (Turkm’i¡ª New Mª©)'), ('TND', 'TND (TunisŸÀDš¬)'), ('TOP', 'TOP (Pa\u2019ªga)'), ('TRY', 'TRY (Turkish Lœa)'), ('TTD', 'TTD (Tršidad‡nd TobagØDŞÏr)'), ('TWD', 'TWD (New Taiwª DŞÏr)'), ('TZS', 'TZS (TªzªŸÀShlšg)'), ('UAH', 'UAH (HryvnŸ)'), ('UGX', 'UGX (Ugªd¨Shlšg)'), ('USD', 'USD (US DŞÏr)'), ('UYU', 'UYU (PesØUruguayo)'), ('UZS', 'UZS (Uzbeki¡ª Sum)'), ('VEF', 'VEF (BŞ\xedv¬)'), ('VND', 'VND (DÚg)'), ('VUV', 'VUV (V©u)'), ('WST', 'WST (T®a)'), ('XAF', 'XAF (CFA F¿nøBEAC)'), ('XAG', 'XAG (Sv”)'), ('XAU', 'XAU (GŞd)'), ('XBA', 'XBA (BÚd M¬k‘ Un™ Eurİ—ÀCompos™Un™ (EURCO))'), ('XBB', 'XBB (BÚd M¬k‘ Un™ Eurİ—ÀMÚ‘¬y Un™ (E.M.U.-6))'), ('XBC', 'XBC (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 9 (E.U.A.-9))'), ('XBD', 'XBD (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 17 (E.U.A.-17))'), ('XCD', 'XCD (Ea¡ C¬ibb—ÀDŞÏr)'), ('XDR', 'XDR (SDR (S³cŸÈD¿wšg Right))'), ('XOF', 'XOF (CFA F¿nøBCEAO)'), ('XPD', 'XPD (P®Ïdium)'), ('XPF', 'XPF (CFP F¿nc)'), ('XPT', 'XPT (PÏtšum)'), ('XSU', 'XSU (Suüe)'), ('XTS', 'XTS (Code ¥ecifiÿÎy„e£rved fÜe¡šg…u½o£s)'), ('XUA', 'XUA (ADB Un™ oàAccouÁ)'), ('XXX', 'XXX (Thcode assigÃd fÜ¿n§ùiÚ wh”nØcu¼’cy i švŞved)'), ('YER', 'YER (Yem’˜RŸl)'), ('ZAR', 'ZAR (Rªd)'), ('ZMW', 'ZMW (ZambŸÀKwacha)'), ('ZWL', 'ZWL (ZimbabwDŞÏr)')], 
h–p_‹xt
=
b
'Thcu¼’cy u£d fÜ blšg.', 
max_Ëngth
=4),

101 
	gmig¿tiÚs
.
AÉ”F›ld
(

102 
mod–_Çme
='transaction',

103 
Çme
='data',

104 
f›ld
=
ªnoyšg
.
f›lds
.
JSONF›ld
(
bÏnk
=
True
, ={}, 
nuÎ
=True),

	@silver/migrations/0038_auto_20170724_0708.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


4 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


7 
def
 
	$chªge_pdf_dœty_äom_boŞ—n_to_š‹g”
(
­ps
, 
schema_ed™Ü
):

8 
db_®Ÿs
 = 
schema_ed™Ü
.
cÚÃùiÚ
.
®Ÿs


10 
PDF
 = 
­ps
.
	`g‘_mod–
('silver', 'PDF')

11 
pdf
 
š
 
PDF
.
objeùs
.
	`usšg
(
db_®Ÿs
).
	$®l
():

12 
pdf
.
dœty
 = 1 pdf.
dœty_Şd
 0

13 
pdf
.
	$§ve
(
usšg
=
db_®Ÿs
)

16 
def
 
	$chªge_pdf_dœty_äom_š‹g”_to_boŞ—n
(
­ps
, 
schema_ed™Ü
):

17 
db_®Ÿs
 = 
schema_ed™Ü
.
cÚÃùiÚ
.
®Ÿs


19 
PDF
 = 
­ps
.
	`g‘_mod–
('silver', 'PDF')

20 
pdf
 
š
 
PDF
.
objeùs
.
	`usšg
(
db_®Ÿs
).
	$®l
():

21 
pdf
.
dœty_Şd
 = 
	$boŞ
(
pdf
.
dœty
)

22 
pdf
.
	$§ve
(
usšg
=
db_®Ÿs
)

25 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

27 
d•’d’c›s
 = [

31 
İ”©iÚs
 = [

32 
mig¿tiÚs
.
	`R’ameF›ld
(

33 
mod–_Çme
='pdf',

34 
Şd_Çme
='dirty',

35 
Ãw_Çme
='dirty_old'

37 
mig¿tiÚs
.
	`AddF›ld
(

38 
mod–_Çme
='pdf',

39 
Çme
='dirty',

40 
f›ld
=
mod–s
.
	`Pos™iveIÁeg”F›ld
(=0),

42 
mig¿tiÚs
.
	`RunPythÚ
(

43 
chªge_pdf_dœty_äom_boŞ—n_to_š‹g”
,

44 
chªge_pdf_dœty_äom_š‹g”_to_boŞ—n


46 
mig¿tiÚs
.
	`RemoveF›ld
(

47 
mod–_Çme
='pdf',

48 
Çme
='dirty_old',

	@silver/migrations/0039_auto_20170811_1101.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #G’”©ed 
by
 
Djªgo
 1.11.3 
Ú
 2017-08-11 11:01

3 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


5 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


8 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

10 
d•’d’c›s
 = [

14 
İ”©iÚs
 = [

15 
mig¿tiÚs
.
	`AddF›ld
(

16 
mod–_Çme
='billinglog',

17 
Çme
='total',

18 
f›ld
=
mod–s
.
	`Decim®F›ld
(
bÏnk
=
True
, 
decim®_¶aûs
=2, 
max_dig™s
=12, 
nuÎ
=True),

	@silver/migrations/0040_auto_20170925_0646.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #G’”©ed 
by
 
Djªgo
 1.11.3 
Ú
 2017-09-25 06:46

3 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


5 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


6 
impÜt
 
	gdjªgo
.
	guts
.
timezÚe


8 
äom
 
	gsv”
.
	guts
.
d©es
 
impÜt
 
	gÏ¡_day_of_mÚth
, 
	g´ev_mÚth
, 
ONE_DAY


11 
def
 
	$fl_blšg_log_bËd_up_to_f›lds
(
­ps
, 
schema_ed™Ü
):

12 #thi 
Œ›s
 
to
 
fl
 
a
 
subsütiÚ
's billinglogs…lan_billed_up_to‡nd

13 #m‘”ed_ã©u»s_bËd_up_tØ
f›lds
 
w™h
 
somewh©
 
§Ã
 
v®ues


15 
BlšgLog
 = 
­ps
.
	`g‘_mod–
('silver', 'BillingLog')

16 
db_®Ÿs
 = 
schema_ed™Ü
.
cÚÃùiÚ
.
®Ÿs


18 
blšg_log
 
š
 
BlšgLog
.
objeùs
.
	`usšg
(
db_®Ÿs
).
	$®l
():

19 
subsütiÚ
 = 
blšg_log
.subscription

20 
blšg_d©e
 = 
blšg_log
.billing_date

22 
¶ª_bËd_up_to
 = 
	$Ï¡_day_of_mÚth
(
blšg_d©e
)

23 
m‘”ed_ã©u»s_bËd_up_to
 = 
	`Ï¡_day_of_mÚth
(
	$´ev_mÚth
(
blšg_d©e
))

25 
subsütiÚ
.
ŒŸl_’d
:

26 
blšg_d©e
 =ğ
subsütiÚ
.
ŒŸl_’d
 + 
ONE_DAY
:

27 
subsütiÚ
.
¡¬t_d©e
.
mÚth
 !ğsubsütiÚ.
ŒŸl_’d
.month:

28 
m‘”ed_ã©u»s_bËd_up_to
 = 
subsütiÚ
.
ŒŸl_’d


30 
subsütiÚ
.
ÿnûl_d©e
:

31 
blšg_d©e
 =ğ
subsütiÚ
.
ÿnûl_d©e
:

32 
¶ª_bËd_up_to
 = 
subsütiÚ
.
ÿnûl_d©e


33 
m‘”ed_ã©u»s_bËd_up_to
 = 
subsütiÚ
.
ÿnûl_d©e


35 
subsütiÚ
.
’ded_©
:

36 
blšg_d©e
 =ğ
subsütiÚ
.
’ded_©
:

37 
¶ª_bËd_up_to
 = 
subsütiÚ
.
’ded_©


38 
m‘”ed_ã©u»s_bËd_up_to
 = 
subsütiÚ
.
’ded_©


40 
blšg_log
.
¶ª_bËd_up_to
 =…lan_billed_up_to

41 
blšg_log
.
m‘”ed_ã©u»s_bËd_up_to
 = metered_features_billed_up_to

42 
blšg_log
.
	$§ve
(
usšg
=
db_®Ÿs
)

45 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

47 
d•’d’c›s
 = [

51 
İ”©iÚs
 = [

52 
mig¿tiÚs
.
	`AÉ”Mod–O±iÚs
(

53 
Çme
='paymentmethod',

54 
İtiÚs
={'Üd”šg': ['-id']
	}
},

56 
	gmig¿tiÚs
.
AÉ”Mod–O±iÚs
(

57 
Çme
='transaction',

58 
İtiÚs
={'ordering': ['-id']},

60 
	gmig¿tiÚs
.
AddF›ld
(

61 
mod–_Çme
='billinglog',

62 
Çme
='metered_features_billed_up_to',

63 
f›ld
=
mod–s
.
D©eF›ld
(=
djªgo
.
uts
.
timezÚe
.
now
, 
h–p_‹xt
=
b
'The date upo whichhe metered features have been billed.'),

64 
´e£rve_deçuÉ
=
F®£
,

66 
	gmig¿tiÚs
.
AddF›ld
(

67 
mod–_Çme
='billinglog',

68 
Çme
='plan_billed_up_to',

69 
f›ld
=
mod–s
.
D©eF›ld
(=
djªgo
.
uts
.
timezÚe
.
now
, 
h–p_‹xt
=
b
'The date upo whichhe…lan base‡mount has been billed.'),

70 
´e£rve_deçuÉ
=
F®£
,

72 
	gmig¿tiÚs
.
AddF›ld
(

73 
mod–_Çme
='provider',

74 
Çme
='generate_documents_on_trial_end',

75 
f›ld
=
mod–s
.
BoŞ—nF›ld
(=
True
,

76 
h–p_‹xt
=
b
'Ifhis is seto True,hen billing documents will be generated whenhe subscriptionrialƒnds, instead of waiting forheƒnd ofhe billing cycle.'),

78 
	gmig¿tiÚs
.
AddF›ld
(

79 
mod–_Çme
='provider',

80 
Çme
='prebill_plan',

81 
f›ld
=
mod–s
.
BoŞ—nF›ld
(=
True
,

82 
h–p_‹xt
=
b
'Ifhis is seto True,henhe…lan base‡mount will be billed‡thebeginning ofhe billing cycle„atherhan‡fterheƒnd.'),

84 
	gmig¿tiÚs
.
AddF›ld
(

85 
mod–_Çme
='provider',

86 
Çme
='separate_cycles_during_trial',

87 
f›ld
=
mod–s
.
BoŞ—nF›ld
(=
F®£
,

88 
h–p_‹xt
=
b
'Ifhis is seto True,henherial…eriod cycle will be split if it spans‡cross multiple billing intervals.'),

90 
	gmig¿tiÚs
.
AddF›ld
(

91 
mod–_Çme
='plan',

92 
Çme
='generate_documents_on_trial_end',

93 
f›ld
=
mod–s
.
NuÎBoŞ—nF›ld
(
h–p_‹xt
=
b
'Ifhis is seto True,hen billing documents will be generated whenhe subscriptionrialƒnds, instead of waiting forheƒnd ofhe billing cycle.'),

95 
	gmig¿tiÚs
.
AddF›ld
(

96 
mod–_Çme
='plan',

97 
Çme
='separate_cycles_during_trial',

98 
f›ld
=
mod–s
.
NuÎBoŞ—nF›ld
(
h–p_‹xt
=
b
'Ifhis is seto True,henherial…eriod cycle will be split if it spans‡cross multiple billing intervals.'),

100 
	gmig¿tiÚs
.
AÉ”F›ld
(

101 
mod–_Çme
='paymentmethod',

102 
Çme
='payment_processor',

103 
f›ld
=
mod–s
.
Ch¬F›ld
(
choiûs
=[(
b
'mªu®', b'mªu®'), (b'çšg_void', b'çšg_void'), (b'Œigg”ed', b'Œigg”ed')], 
max_Ëngth
=256),

105 
	gmig¿tiÚs
.
AddF›ld
(

106 
mod–_Çme
='plan',

107 
Çme
='prebill_plan',

108 
f›ld
=
mod–s
.
NuÎBoŞ—nF›ld
(
h–p_‹xt
=
b
'Ifhis is seto True,henhe…lan base‡mount will be billed‡thebeginning ofhe billing cycle„atherhan‡fterheƒnd.'),

110 
	gmig¿tiÚs
.
RunPythÚ
(
fl_blšg_log_bËd_up_to_f›lds
, 
mig¿tiÚs
.RunPythÚ.
noİ
)

	@silver/migrations/0041_auto_20170929_1045.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #G’”©ed 
by
 
Djªgo
 1.11.3 
Ú
 2017-09-29 10:45

3 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


5 
äom
 
d©‘ime
 
impÜt
 datetime

6 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


7 
impÜt
 
	gdjªgo
.
	guts
.
timezÚe


10 
def
 
	$fl_blšg_log_ü—‹d_©_f›ld
(
­ps
, 
schema_ed™Ü
):

11 
BlšgLog
 = 
­ps
.
	`g‘_mod–
('silver', 'BillingLog')

12 
db_®Ÿs
 = 
schema_ed™Ü
.
cÚÃùiÚ
.
®Ÿs


14 
blšg_log
 
š
 
BlšgLog
.
objeùs
.
	`usšg
(
db_®Ÿs
).
	$®l
():

15 
blšg_log
.
ü—‹d_©
 = 
d©‘ime
.
	`combše
(blšg_log.
blšg_d©e
, d©‘ime.
mš
.
	$time
())

16 
blšg_log
.
	$§ve
(
usšg
=
db_®Ÿs
)

19 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

21 
d•’d’c›s
 = [

25 
İ”©iÚs
 = [

26 
mig¿tiÚs
.
	`AddF›ld
(

27 
mod–_Çme
='billinglog',

28 
Çme
='created_at',

29 
f›ld
=
mod–s
.
	`D©eTimeF›ld
(
auto_now_add
=
True
, =
djªgo
.
uts
.
timezÚe
.
now
),

30 
´e£rve_deçuÉ
=
F®£
,

32 
mig¿tiÚs
.
	`AddF›ld
(

33 
mod–_Çme
='plan',

34 
Çme
='cycle_billing_duration',

35 
f›ld
=
mod–s
.
	`Du¿tiÚF›ld
(
bÏnk
=
True
, 
h–p_‹xt
=
b
"Thi ÿÀbu£dØ’su»h©hblšg d©dÛ¢'ˆ·s ¨û¹aš d©e.\nFÜƒxam¶iàthi f›ld i £ˆtØ2 days, fÜ‡ mÚthly subsütiÚ,hblšg d©wÈÃv” su½as th2nd day oàthmÚth. Blšg docum’t ÿÀ¡Èbg’”©ed‡á”h© day duršghblšg cyşe, buˆtheœ blšg d©wÈ­³¬Øbth’d oàthcyşblšg du¿tiÚ.", 
nuÎ
=True),

37 
mig¿tiÚs
.
	`AddF›ld
(

38 
mod–_Çme
='provider',

39 
Çme
='cycle_billing_duration',

40 
f›ld
=
mod–s
.
	`Du¿tiÚF›ld
(
bÏnk
=
True
, 
h–p_‹xt
=
b
"Thi ÿÀbu£dØ’su»h©hblšg d©dÛ¢'ˆ·s ¨û¹aš d©e.\nFÜƒxam¶iàthi f›ld i £ˆtØ2 days, fÜ‡ mÚthly subsütiÚ,hblšg d©wÈÃv” su½as th2nd day oàthmÚth. Blšg docum’t ÿÀ¡Èbg’”©ed‡á”h© day duršghblšg cyşe, buˆtheœ blšg d©wÈ­³¬Øbth’d oàthcyşblšg du¿tiÚ.", 
nuÎ
=True),

42 
mig¿tiÚs
.
	`RunPythÚ
(
fl_blšg_log_ü—‹d_©_f›ld
, mig¿tiÚs.
RunPythÚ
.
noİ
)

	@silver/migrations/0042_compute_totals_in_document_view.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


4 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


7 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

9 
d•’d’c›s
 = [

13 
İ”©iÚs
 = [

14 
mig¿tiÚs
.
	`AddF›ld
(

15 
mod–_Çme
='invoice',

16 
Çme
='_total',

17 
f›ld
=
mod–s
.
	`Decim®F›ld
(
bÏnk
=
True
, 
decim®_¶aûs
=2, 
max_dig™s
=19, 
nuÎ
=True),

19 
mig¿tiÚs
.
	`AddF›ld
(

20 
mod–_Çme
='invoice',

21 
Çme
='_total_in_transaction_currency',

22 
f›ld
=
mod–s
.
	`Decim®F›ld
(
bÏnk
=
True
, 
decim®_¶aûs
=2, 
max_dig™s
=19, 
nuÎ
=True),

24 
mig¿tiÚs
.
	`AddF›ld
(

25 
mod–_Çme
='proforma',

26 
Çme
='_total',

27 
f›ld
=
mod–s
.
	`Decim®F›ld
(
bÏnk
=
True
, 
decim®_¶aûs
=2, 
max_dig™s
=19, 
nuÎ
=True),

29 
mig¿tiÚs
.
	`AddF›ld
(

30 
mod–_Çme
='proforma',

31 
Çme
='_total_in_transaction_currency',

32 
f›ld
=
mod–s
.
	`Decim®F›ld
(
bÏnk
=
True
, 
decim®_¶aûs
=2, 
max_dig™s
=19, 
nuÎ
=True),

34 
mig¿tiÚs
.
	`AddF›ld
(

35 
mod–_Çme
='Document',

36 
Çme
='_total',

37 
f›ld
=
mod–s
.
	`Decim®F›ld
(
bÏnk
=
True
, 
decim®_¶aûs
=2, 
max_dig™s
=19, 
nuÎ
=True),

39 
mig¿tiÚs
.
	`AddF›ld
(

40 
mod–_Çme
='Document',

41 
Çme
='_total_in_transaction_currency',

42 
f›ld
=
mod–s
.
	`Decim®F›ld
(
bÏnk
=
True
, 
decim®_¶aûs
=2, 
max_dig™s
=19, 
nuÎ
=True),

44 
mig¿tiÚs
.
	`RunSQL
(

45 
sql
="""

46 
DROP
 
VIEW
 
IF
 
EXISTS
 
sv”_docum’t
;

47 
CREATE
 
VIEW
 
sv”_docum’t
 
AS
 
SELECT


48 'švoiû' 
AS
 `
kšd
`, 
id
, 
£r›s
, 
numb”
, 
issue_d©e
, 
due_d©e
,

49 
·id_d©e
, 
ÿnûl_d©e
, 
¡©e
, 
´ovid”_id
, 
cu¡om”_id
,

50 
´ofÜma_id
 
as
 
»Ï‹d_docum’t_id
, 
¬chived_cu¡om”
,

51 
¬chived_´ovid”
, 
§Ës_x_³rûÁ
, 
§Ës_x_Çme
, 
cu¼’cy
, 
pdf_id
,

52 
Œª§ùiÚ_cu¼’cy
, 
_tÙ®
, 
_tÙ®_š_Œª§ùiÚ_cu¼’cy


53 
FROM
 
sv”_švoiû


54 
UNION


55 
SELECT


56 '´ofÜma' 
AS
 `
kšd
`, 
id
, 
£r›s
, 
numb”
, 
issue_d©e
, 
due_d©e
,

57 
·id_d©e
, 
ÿnûl_d©e
, 
¡©e
, 
´ovid”_id
, 
cu¡om”_id
,

58 
NULL
 
as
 
»Ï‹d_docum’t_id
, 
¬chived_cu¡om”
,

59 
¬chived_´ovid”
, 
§Ës_x_³rûÁ
, 
§Ës_x_Çme
, 
cu¼’cy
, 
pdf_id
,

60 
Œª§ùiÚ_cu¼’cy
, 
_tÙ®
, 
_tÙ®_š_Œª§ùiÚ_cu¼’cy


61 
FROM
 
sv”_´ofÜma
 
WHERE
 
švoiû_id
 
is
 
NULL


63 
»v”£_sql
="""

64 
DROP
 
VIEW
 
IF
 
EXISTS
 
sv”_docum’t
;

65 
CREATE
 
VIEW
 
sv”_docum’t
 
AS
 
SELECT


66 'švoiû' 
AS
 `
kšd
`, 
id
, 
£r›s
, 
numb”
, 
issue_d©e
, 
due_d©e
,

67 
·id_d©e
, 
ÿnûl_d©e
, 
¡©e
, 
´ovid”_id
, 
cu¡om”_id
,

68 
´ofÜma_id
 
as
 
»Ï‹d_docum’t_id
, 
¬chived_cu¡om”
,

69 
¬chived_´ovid”
, 
§Ës_x_³rûÁ
, 
§Ës_x_Çme
, 
cu¼’cy
, 
pdf_id
,

70 
Œª§ùiÚ_cu¼’cy


71 
FROM
 
sv”_švoiû


72 
UNION


73 
SELECT


74 '´ofÜma' 
AS
 `
kšd
`, 
id
, 
£r›s
, 
numb”
, 
issue_d©e
, 
due_d©e
,

75 
·id_d©e
, 
ÿnûl_d©e
, 
¡©e
, 
´ovid”_id
, 
cu¡om”_id
,

76 
NULL
 
as
 
»Ï‹d_docum’t_id
, 
¬chived_cu¡om”
,

77 
¬chived_´ovid”
, 
§Ës_x_³rûÁ
, 
§Ës_x_Çme
, 
cu¼’cy
, 
pdf_id
,

78 
Œª§ùiÚ_cu¼’cy


79 
FROM
 
sv”_´ofÜma
 
WHERE
 
švoiû_id
 
is
 
NULL


	@silver/migrations/0043_auto_20171113_1048.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #G’”©ed 
by
 
Djªgo
 1.11.7 
Ú
 2017-11-13 10:48

3 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


5 
impÜt
 
	gªnoyšg
.
f›lds


6 
impÜt
 
	gdjªgo
.
	gcÜe
.
v®id©Üs


7 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


8 
impÜt
 
	gdjªgo
.
	gdb
.
	gmod–s
.
d–‘iÚ


9 
impÜt
 
djªgo_fsm


10 
impÜt
 
	gsv”
.
	gmod–s
.
	gdocum’ts
.
ba£


13 
def
 
	$move_docum’ts_to_blšg_docum’t
(
­ps
, 
schema_ed™Ü
):

14 
OldInvoiûMod–
 = 
­ps
.
	`g‘_mod–
('silver', 'Invoice')

15 
OldProfÜmaMod–
 = 
­ps
.
	`g‘_mod–
('silver', 'Proforma')

17 
BlšgDocum’tBa£
 = 
­ps
.
	`g‘_mod–
('silver', 'BillingDocumentBase')

19 
db_®Ÿs
 = 
schema_ed™Ü
.
cÚÃùiÚ
.
®Ÿs


21 
f›lds_to_move
 = ['series', 'number', 'archived_customer', 'archived_provider', 'due_date',

27 
Şd_´ofÜma
 
š
 
OldProfÜmaMod–
.
objeùs
.
	`usšg
(
db_®Ÿs
).
	$f‹r
(
švoiû
=
NÚe
):

28 
Ãw_´ofÜma
 = 
	`BlšgDocum’tBa£
(
kšd
='proforma')

29 
f›ld
 
š
 
f›lds_to_move
:

30 
	`£‰r
(
Ãw_´ofÜma
, 
f›ld
, 
	$g‘©Œ
(
Şd_´ofÜma
, 
f›ld
))

31 
Ãw_´ofÜma
.
	$§ve
(
usšg
=
db_®Ÿs
)

33 
Œª§ùiÚ
 
š
 
Şd_´ofÜma
.
Şd_´ofÜma_Œª§ùiÚs
.
	$®l
():

34 
Œª§ùiÚ
.
´ofÜma
 = 
Ãw_´ofÜma


35 
Œª§ùiÚ
.
	$§ve
()

37 
’Œy
 
š
 
Şd_´ofÜma
.
Şd_´ofÜma_’Œ›s
.
	$®l
():

38 
’Œy
.
´ofÜma
 = 
Ãw_´ofÜma


39 
’Œy
.
	$§ve
()

41 
log
 
š
 
Şd_´ofÜma
.
Şd_´ofÜma_logs
.
	$®l
():

42 
log
.
´ofÜma
 = 
Ãw_´ofÜma


43 
log
.
	$§ve
()

45 
Şd_švoiû
 
š
 
OldInvoiûMod–
.
objeùs
.
	`usšg
(
db_®Ÿs
).
	$®l
():

46 
Ãw_švoiû
 = 
	`BlšgDocum’tBa£
(
kšd
='invoice')

47 
f›ld
 
š
 
f›lds_to_move
:

48 
	`£‰r
(
Ãw_švoiû
, 
f›ld
, 
	$g‘©Œ
(
Şd_švoiû
, 
f›ld
))

49 
Ãw_švoiû
.
	$§ve
(
usšg
=
db_®Ÿs
)

51 
Şd_švoiû
.
´ofÜma
:

52 
Ãw_´ofÜma
 = 
	`BlšgDocum’tBa£
(
kšd
='´ofÜma', 
»Ï‹d_docum’t
=
Ãw_švoiû
)

53 
f›ld
 
š
 
f›lds_to_move
:

54 
	`£‰r
(
Ãw_´ofÜma
, 
f›ld
, 
	$g‘©Œ
(
Şd_švoiû
.
´ofÜma
, 
f›ld
))

56 
Ãw_´ofÜma
.
	$§ve
(
usšg
=
db_®Ÿs
)

58 
Ãw_švoiû
.
»Ï‹d_docum’t
 = 
Ãw_´ofÜma


59 
Ãw_švoiû
.
	$§ve
(
usšg
=
db_®Ÿs
)

61 
Ãw_´ofÜma
 = 
NÚe


63 
Œª§ùiÚ
 
š
 
Şd_švoiû
.
Şd_švoiû_Œª§ùiÚs
.
	$®l
():

64 
Œª§ùiÚ
.
švoiû
 = 
Ãw_švoiû


65 
Œª§ùiÚ
.
´ofÜma
 = 
Ãw_´ofÜma


66 
Œª§ùiÚ
.
	$§ve
()

68 
’Œy
 
š
 
Şd_švoiû
.
Şd_švoiû_’Œ›s
.
	$®l
():

69 
’Œy
.
švoiû
 = 
Ãw_švoiû


70 
’Œy
.
´ofÜma
 = 
Ãw_´ofÜma


71 
’Œy
.
	$§ve
()

73 
log
 
š
 
Şd_švoiû
.
Şd_švoiû_logs
.
	$®l
():

74 
log
.
švoiû
 = 
Ãw_švoiû


75 
log
.
´ofÜma
 = 
Ãw_´ofÜma


76 
log
.
	$§ve
()

79 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

81 
d•’d’c›s
 = [

85 
İ”©iÚs
 = [

86 
mig¿tiÚs
.
	`C»©eMod–
(

87 
Çme
='BillingDocumentBase',

88 
f›lds
=[

89 ('id', 
mod–s
.
	`AutoF›ld
(
auto_ü—‹d
=
True
, 
´im¬y_key
=True, 
£rŸlize
=
F®£
, 
v”bo£_Çme
='ID')),

90 ('kšd', 
mod–s
.
	`Ch¬F›ld
(
db_šdex
=
True
, 
max_Ëngth
=8, 
v”bo£_Çme
=
sv”
.mod–s.
docum’ts
.
ba£
.
g‘_blšg_docum’ts_kšds
)),

91 ('£r›s', 
mod–s
.
	`Ch¬F›ld
(
bÏnk
=
True
, 
db_šdex
=True, 
max_Ëngth
=20, 
nuÎ
=True)),

92 ('numb”', 
mod–s
.
	`IÁeg”F›ld
(
bÏnk
=
True
, 
db_šdex
=True, 
nuÎ
=True)),

93 ('¬chived_cu¡om”', 
ªnoyšg
.
f›lds
.
	`JSONF›ld
(
bÏnk
=
True
, =
diù
, 
nuÎ
=True)),

94 ('¬chived_´ovid”', 
ªnoyšg
.
f›lds
.
	`JSONF›ld
(
bÏnk
=
True
, =
diù
, 
nuÎ
=True)),

95 ('due_d©e', 
mod–s
.
	`D©eF›ld
(
bÏnk
=
True
, 
nuÎ
=True)),

96 ('issue_d©e', 
mod–s
.
	`D©eF›ld
(
bÏnk
=
True
, 
db_šdex
=True, 
nuÎ
=True)),

97 ('·id_d©e', 
mod–s
.
	`D©eF›ld
(
bÏnk
=
True
, 
nuÎ
=True)),

98 ('ÿnûl_d©e', 
mod–s
.
	`D©eF›ld
(
bÏnk
=
True
, 
nuÎ
=True)),

99 ('§Ës_x_³rûÁ', 
mod–s
.
	`Decim®F›ld
(
bÏnk
=
True
, 
decim®_¶aûs
=2, 
max_dig™s
=4, 
nuÎ
=True, 
v®id©Üs
=[
djªgo
.
cÜe
.v®id©Üs.
	`MšV®ueV®id©Ü
(0.0)])),

100 ('§Ës_x_Çme', 
mod–s
.
	`Ch¬F›ld
(
bÏnk
=
True
, 
max_Ëngth
=64, 
nuÎ
=True)),

101 ('cu¼’cy', 
mod–s
.
	`Ch¬F›ld
(
choiûs
=[('AED', 'AED (UAE Dœham)'), ('AFN', 'AFN (Afghªi)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Arm’ŸÀD¿m)'), ('ANG', 'ANG (N‘h”Ïnd AÁËª Gud”)'), ('AOA', 'AOA (Kwªza)'), ('ARS', 'ARS (Arg’tšPeso)'), ('AUD', 'AUD (Au¡¿lŸÀDŞÏr)'), ('AWG', 'AWG (Arubª FlÜš)'), ('AZN', 'AZN (Az”baijªŸÀMª©)'), ('BAM', 'BAM (CÚv”tibË M¬k)'), ('BBD', 'BBD (B¬bado DŞÏr)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulg¬ŸÀLev)'), ('BHD', 'BHD (Bah¿š˜Dš¬)'), ('BIF', 'BIF (Burund˜F¿nc)'), ('BMD', 'BMD (B”mudŸÀDŞÏr)'), ('BND', 'BND (BruÃ˜DŞÏr)'), ('BOB', 'BOB (BŞivŸno)'), ('BRL', 'BRL (B¿zŸÀR—l)'), ('BSD', 'BSD (BahamŸÀDŞÏr)'), ('BTN', 'BTN (NguÉrum)'), ('BWP', 'BWP (PuÏ)'), ('BYN', 'BYN (B–¬usŸÀRubË)'), ('BZD', 'BZD (B–izDŞÏr)'), ('CAD', 'CAD (CªadŸÀDŞÏr)'), ('CDF', 'CDF (CÚgŞe£ F¿nc)'), ('CHF', 'CHF (Swis F¿nc)'), ('CLP', 'CLP (Ch—ÀPeso)'), ('CNY', 'CNY (Yuª R’mšbi)'), ('COP', 'COP (CŞombŸÀPeso)'), ('CRC', 'CRC (Co¡¨RiÿÀCŞÚ)'), ('CUC', 'CUC (PesØCÚv”tibË)'), ('CUP', 'CUP (Cubª Peso)'), ('CVE', 'CVE (CabØV”dEscudo)'), ('CZK', 'CZK (Czech KÜuÇ)'), ('DJF', 'DJF (Djibout˜F¿nc)'), ('DKK', 'DKK (Dªish KrÚe)'), ('DOP', 'DOP (DomšiÿÀPeso)'), ('DZD', 'DZD (Alg”ŸÀDš¬)'), ('EGP', 'EGP (Egy±ŸÀPound)'), ('ERN', 'ERN (Nakç)'), ('ETB', 'ETB (EthiİŸÀBœr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fij˜DŞÏr)'), ('FKP', 'FKP (F®kÏnd I¦ªd Pound)'), ('GBP', 'GBP (Pound S‹¾šg)'), ('GEL', 'GEL (L¬i)'), ('GHS', 'GHS (Ghª¨Cedi)'), ('GIP', 'GIP (Gib¿É¬ Pound)'), ('GMD', 'GMD (D®asi)'), ('GNF', 'GNF (Guš— F¿nc)'), ('GTQ', 'GTQ (Qu‘z®)'), ('GYD', 'GYD (Guyª¨DŞÏr)'), ('HKD', 'HKD (HÚg KÚg DŞÏr)'), ('HNL', 'HNL (Lempœa)'), ('HRK', 'HRK (KuÇ)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (FÜšt)'), ('IDR', 'IDR (RupŸh)'), ('ILS', 'ILS (New I¤«l˜Sheq–)'), ('INR', 'INR (IndŸÀRu³e)'), ('IQD', 'IQD (I¿q˜Dš¬)'), ('IRR', 'IRR (I¿nŸÀRŸl)'), ('ISK', 'ISK (IûÏnd KrÚa)'), ('JMD', 'JMD (JamaiÿÀDŞÏr)'), ('JOD', 'JOD (JÜdªŸÀDš¬)'), ('JPY', 'JPY (Y’)'), ('KES', 'KES (K’yª Shlšg)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (R›l)'), ('KMF', 'KMF (ComÜØF¿nc)'), ('KPW', 'KPW (NÜth KÜ—ÀWÚ)'), ('KRW', 'KRW (WÚ)'), ('KWD', 'KWD (Kuwa™˜Dš¬)'), ('KYD', 'KYD (Caymª I¦ªd DŞÏr)'), ('KZT', 'KZT (T’ge)'), ('LAK', 'LAK (K)'), ('LBP', 'LBP (Lebªe£ Pound)'), ('LKR', 'LKR (Sr˜Lªk¨Ru³e)'), ('LRD', 'LRD (Lib”ŸÀDŞÏr)'), ('LSL', 'LSL (LÙi)'), ('LYD', 'LYD (Libyª Dš¬)'), ('MAD', 'MAD (MÜocÿÀDœham)'), ('MDL', 'MDL (MŞdovª Leu)'), ('MGA', 'MGA (M®agasy ArŸry)'), ('MKD', 'MKD (D’¬)'), ('MMK', 'MMK (Ky©)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (P©aÿ)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Maur™iu Ru³e)'), ('MVR', 'MVR (Rufiy¯)'), ('MWK', 'MWK (M®aw˜Kwacha)'), ('MXN', 'MXN (MexiÿÀPeso)'), ('MYR', 'MYR (M®aysŸÀRšgg™)'), ('MZN', 'MZN (MozambiquM‘iÿl)'), ('NAD', 'NAD (NamibŸ DŞÏr)'), ('NGN', 'NGN (Naœa)'), ('NIO', 'NIO (CÜdob¨Oro)'), ('NOK', 'NOK (NÜwegŸÀKrÚe)'), ('NPR', 'NPR (N•®e£ Ru³e)'), ('NZD', 'NZD (New Z—Ïnd DŞÏr)'), ('OMR', 'OMR (RŸÈOmªi)'), ('PAB', 'PAB (B®bß)'), ('PEN', 'PEN (SŞ)'), ('PGK', 'PGK (Kša)'), ('PHP', 'PHP (PhpšPeso)'), ('PKR', 'PKR (Paki¡ª Ru³e)'), ('PLN', 'PLN (ZlÙy)'), ('PYG', 'PYG (Gu¬ªi)'), ('QAR', 'QAR (Q©¬˜RŸl)'), ('RON', 'RON (RomªŸÀLeu)'), ('RSD', 'RSD (S”bŸÀDš¬)'), ('RUB', 'RUB (RussŸÀRubË)'), ('RWF', 'RWF (Rwªd¨F¿nc)'), ('SAR', 'SAR (Saud˜Riy®)'), ('SBD', 'SBD (SŞomÚ I¦ªd DŞÏr)'), ('SCR', 'SCR (Seych–Ë Ru³e)'), ('SDG', 'SDG (Sudªe£ Pound)'), ('SEK', 'SEK (Swedish KrÚa)'), ('SGD', 'SGD (Sšg­ÜDŞÏr)'), ('SHP', 'SHP (SašˆH–’¨Pound)'), ('SLL', 'SLL (LeÚe)'), ('SOS', 'SOS (Som®˜Shlšg)'), ('SRD', 'SRD (Suršam DŞÏr)'), ('SSP', 'SSP (South Sudªe£ Pound)'), ('STD', 'STD (Dob¿)'), ('SVC', 'SVC (EÈS®vadÜ CŞÚ)'), ('SYP', 'SYP (SyrŸÀPound)'), ('SZL', 'SZL (Lªg’i)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (SomÚi)'), ('TMT', 'TMT (Turkm’i¡ª New Mª©)'), ('TND', 'TND (TunisŸÀDš¬)'), ('TOP', 'TOP (Pa\u2019ªga)'), ('TRY', 'TRY (Turkish Lœa)'), ('TTD', 'TTD (Tršidad‡nd TobagØDŞÏr)'), ('TWD', 'TWD (New Taiwª DŞÏr)'), ('TZS', 'TZS (TªzªŸÀShlšg)'), ('UAH', 'UAH (HryvnŸ)'), ('UGX', 'UGX (Ugªd¨Shlšg)'), ('USD', 'USD (US DŞÏr)'), ('UYU', 'UYU (PesØUruguayo)'), ('UZS', 'UZS (Uzbeki¡ª Sum)'), ('VEF', 'VEF (BŞ\xedv¬)'), ('VND', 'VND (DÚg)'), ('VUV', 'VUV (V©u)'), ('WST', 'WST (T®a)'), ('XAF', 'XAF (CFA F¿nøBEAC)'), ('XAG', 'XAG (Sv”)'), ('XAU', 'XAU (GŞd)'), ('XBA', 'XBA (BÚd M¬k‘ Un™ Eurİ—ÀCompos™Un™ (EURCO))'), ('XBB', 'XBB (BÚd M¬k‘ Un™ Eurİ—ÀMÚ‘¬y Un™ (E.M.U.-6))'), ('XBC', 'XBC (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 9 (E.U.A.-9))'), ('XBD', 'XBD (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 17 (E.U.A.-17))'), ('XCD', 'XCD (Ea¡ C¬ibb—ÀDŞÏr)'), ('XDR', 'XDR (SDR (S³cŸÈD¿wšg Right))'), ('XOF', 'XOF (CFA F¿nøBCEAO)'), ('XPD', 'XPD (P®Ïdium)'), ('XPF', 'XPF (CFP F¿nc)'), ('XPT', 'XPT (PÏtšum)'), ('XSU', 'XSU (Suüe)'), ('XTS', 'XTS (Code ¥ecifiÿÎy„e£rved fÜe¡šg…u½o£s)'), ('XUA', 'XUA (ADB Un™ oàAccouÁ)'), ('XXX', 'XXX (Thcode assigÃd fÜ¿n§ùiÚ wh”nØcu¼’cy i švŞved)'), ('YER', 'YER (Yem’˜RŸl)'), ('ZAR', 'ZAR (Rªd)'), ('ZMW', 'ZMW (ZambŸÀKwacha)'), ('ZWL', 'ZWL (ZimbabwDŞÏr)')], =
b
'USD', 
h–p_‹xt
=b'Thcu¼’cy u£d fÜ blšg.', 
max_Ëngth
=4)),

102 ('Œª§ùiÚ_cu¼’cy', 
mod–s
.
	`Ch¬F›ld
(
choiûs
=[('AED', 'AED (UAE Dœham)'), ('AFN', 'AFN (Afghªi)'), ('ALL', 'ALL (Lek)'), ('AMD', 'AMD (Arm’ŸÀD¿m)'), ('ANG', 'ANG (N‘h”Ïnd AÁËª Gud”)'), ('AOA', 'AOA (Kwªza)'), ('ARS', 'ARS (Arg’tšPeso)'), ('AUD', 'AUD (Au¡¿lŸÀDŞÏr)'), ('AWG', 'AWG (Arubª FlÜš)'), ('AZN', 'AZN (Az”baijªŸÀMª©)'), ('BAM', 'BAM (CÚv”tibË M¬k)'), ('BBD', 'BBD (B¬bado DŞÏr)'), ('BDT', 'BDT (Taka)'), ('BGN', 'BGN (Bulg¬ŸÀLev)'), ('BHD', 'BHD (Bah¿š˜Dš¬)'), ('BIF', 'BIF (Burund˜F¿nc)'), ('BMD', 'BMD (B”mudŸÀDŞÏr)'), ('BND', 'BND (BruÃ˜DŞÏr)'), ('BOB', 'BOB (BŞivŸno)'), ('BRL', 'BRL (B¿zŸÀR—l)'), ('BSD', 'BSD (BahamŸÀDŞÏr)'), ('BTN', 'BTN (NguÉrum)'), ('BWP', 'BWP (PuÏ)'), ('BYN', 'BYN (B–¬usŸÀRubË)'), ('BZD', 'BZD (B–izDŞÏr)'), ('CAD', 'CAD (CªadŸÀDŞÏr)'), ('CDF', 'CDF (CÚgŞe£ F¿nc)'), ('CHF', 'CHF (Swis F¿nc)'), ('CLP', 'CLP (Ch—ÀPeso)'), ('CNY', 'CNY (Yuª R’mšbi)'), ('COP', 'COP (CŞombŸÀPeso)'), ('CRC', 'CRC (Co¡¨RiÿÀCŞÚ)'), ('CUC', 'CUC (PesØCÚv”tibË)'), ('CUP', 'CUP (Cubª Peso)'), ('CVE', 'CVE (CabØV”dEscudo)'), ('CZK', 'CZK (Czech KÜuÇ)'), ('DJF', 'DJF (Djibout˜F¿nc)'), ('DKK', 'DKK (Dªish KrÚe)'), ('DOP', 'DOP (DomšiÿÀPeso)'), ('DZD', 'DZD (Alg”ŸÀDš¬)'), ('EGP', 'EGP (Egy±ŸÀPound)'), ('ERN', 'ERN (Nakç)'), ('ETB', 'ETB (EthiİŸÀBœr)'), ('EUR', 'EUR (Euro)'), ('FJD', 'FJD (Fij˜DŞÏr)'), ('FKP', 'FKP (F®kÏnd I¦ªd Pound)'), ('GBP', 'GBP (Pound S‹¾šg)'), ('GEL', 'GEL (L¬i)'), ('GHS', 'GHS (Ghª¨Cedi)'), ('GIP', 'GIP (Gib¿É¬ Pound)'), ('GMD', 'GMD (D®asi)'), ('GNF', 'GNF (Guš— F¿nc)'), ('GTQ', 'GTQ (Qu‘z®)'), ('GYD', 'GYD (Guyª¨DŞÏr)'), ('HKD', 'HKD (HÚg KÚg DŞÏr)'), ('HNL', 'HNL (Lempœa)'), ('HRK', 'HRK (KuÇ)'), ('HTG', 'HTG (Gourde)'), ('HUF', 'HUF (FÜšt)'), ('IDR', 'IDR (RupŸh)'), ('ILS', 'ILS (New I¤«l˜Sheq–)'), ('INR', 'INR (IndŸÀRu³e)'), ('IQD', 'IQD (I¿q˜Dš¬)'), ('IRR', 'IRR (I¿nŸÀRŸl)'), ('ISK', 'ISK (IûÏnd KrÚa)'), ('JMD', 'JMD (JamaiÿÀDŞÏr)'), ('JOD', 'JOD (JÜdªŸÀDš¬)'), ('JPY', 'JPY (Y’)'), ('KES', 'KES (K’yª Shlšg)'), ('KGS', 'KGS (Som)'), ('KHR', 'KHR (R›l)'), ('KMF', 'KMF (ComÜØF¿nc)'), ('KPW', 'KPW (NÜth KÜ—ÀWÚ)'), ('KRW', 'KRW (WÚ)'), ('KWD', 'KWD (Kuwa™˜Dš¬)'), ('KYD', 'KYD (Caymª I¦ªd DŞÏr)'), ('KZT', 'KZT (T’ge)'), ('LAK', 'LAK (K)'), ('LBP', 'LBP (Lebªe£ Pound)'), ('LKR', 'LKR (Sr˜Lªk¨Ru³e)'), ('LRD', 'LRD (Lib”ŸÀDŞÏr)'), ('LSL', 'LSL (LÙi)'), ('LYD', 'LYD (Libyª Dš¬)'), ('MAD', 'MAD (MÜocÿÀDœham)'), ('MDL', 'MDL (MŞdovª Leu)'), ('MGA', 'MGA (M®agasy ArŸry)'), ('MKD', 'MKD (D’¬)'), ('MMK', 'MMK (Ky©)'), ('MNT', 'MNT (Tugrik)'), ('MOP', 'MOP (P©aÿ)'), ('MRO', 'MRO (Ouguiya)'), ('MUR', 'MUR (Maur™iu Ru³e)'), ('MVR', 'MVR (Rufiy¯)'), ('MWK', 'MWK (M®aw˜Kwacha)'), ('MXN', 'MXN (MexiÿÀPeso)'), ('MYR', 'MYR (M®aysŸÀRšgg™)'), ('MZN', 'MZN (MozambiquM‘iÿl)'), ('NAD', 'NAD (NamibŸ DŞÏr)'), ('NGN', 'NGN (Naœa)'), ('NIO', 'NIO (CÜdob¨Oro)'), ('NOK', 'NOK (NÜwegŸÀKrÚe)'), ('NPR', 'NPR (N•®e£ Ru³e)'), ('NZD', 'NZD (New Z—Ïnd DŞÏr)'), ('OMR', 'OMR (RŸÈOmªi)'), ('PAB', 'PAB (B®bß)'), ('PEN', 'PEN (SŞ)'), ('PGK', 'PGK (Kša)'), ('PHP', 'PHP (PhpšPeso)'), ('PKR', 'PKR (Paki¡ª Ru³e)'), ('PLN', 'PLN (ZlÙy)'), ('PYG', 'PYG (Gu¬ªi)'), ('QAR', 'QAR (Q©¬˜RŸl)'), ('RON', 'RON (RomªŸÀLeu)'), ('RSD', 'RSD (S”bŸÀDš¬)'), ('RUB', 'RUB (RussŸÀRubË)'), ('RWF', 'RWF (Rwªd¨F¿nc)'), ('SAR', 'SAR (Saud˜Riy®)'), ('SBD', 'SBD (SŞomÚ I¦ªd DŞÏr)'), ('SCR', 'SCR (Seych–Ë Ru³e)'), ('SDG', 'SDG (Sudªe£ Pound)'), ('SEK', 'SEK (Swedish KrÚa)'), ('SGD', 'SGD (Sšg­ÜDŞÏr)'), ('SHP', 'SHP (SašˆH–’¨Pound)'), ('SLL', 'SLL (LeÚe)'), ('SOS', 'SOS (Som®˜Shlšg)'), ('SRD', 'SRD (Suršam DŞÏr)'), ('SSP', 'SSP (South Sudªe£ Pound)'), ('STD', 'STD (Dob¿)'), ('SVC', 'SVC (EÈS®vadÜ CŞÚ)'), ('SYP', 'SYP (SyrŸÀPound)'), ('SZL', 'SZL (Lªg’i)'), ('THB', 'THB (Baht)'), ('TJS', 'TJS (SomÚi)'), ('TMT', 'TMT (Turkm’i¡ª New Mª©)'), ('TND', 'TND (TunisŸÀDš¬)'), ('TOP', 'TOP (Pa\u2019ªga)'), ('TRY', 'TRY (Turkish Lœa)'), ('TTD', 'TTD (Tršidad‡nd TobagØDŞÏr)'), ('TWD', 'TWD (New Taiwª DŞÏr)'), ('TZS', 'TZS (TªzªŸÀShlšg)'), ('UAH', 'UAH (HryvnŸ)'), ('UGX', 'UGX (Ugªd¨Shlšg)'), ('USD', 'USD (US DŞÏr)'), ('UYU', 'UYU (PesØUruguayo)'), ('UZS', 'UZS (Uzbeki¡ª Sum)'), ('VEF', 'VEF (BŞ\xedv¬)'), ('VND', 'VND (DÚg)'), ('VUV', 'VUV (V©u)'), ('WST', 'WST (T®a)'), ('XAF', 'XAF (CFA F¿nøBEAC)'), ('XAG', 'XAG (Sv”)'), ('XAU', 'XAU (GŞd)'), ('XBA', 'XBA (BÚd M¬k‘ Un™ Eurİ—ÀCompos™Un™ (EURCO))'), ('XBB', 'XBB (BÚd M¬k‘ Un™ Eurİ—ÀMÚ‘¬y Un™ (E.M.U.-6))'), ('XBC', 'XBC (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 9 (E.U.A.-9))'), ('XBD', 'XBD (BÚd M¬k‘ Un™ Eurİ—ÀUn™ oàAccouÁ 17 (E.U.A.-17))'), ('XCD', 'XCD (Ea¡ C¬ibb—ÀDŞÏr)'), ('XDR', 'XDR (SDR (S³cŸÈD¿wšg Right))'), ('XOF', 'XOF (CFA F¿nøBCEAO)'), ('XPD', 'XPD (P®Ïdium)'), ('XPF', 'XPF (CFP F¿nc)'), ('XPT', 'XPT (PÏtšum)'), ('XSU', 'XSU (Suüe)'), ('XTS', 'XTS (Code ¥ecifiÿÎy„e£rved fÜe¡šg…u½o£s)'), ('XUA', 'XUA (ADB Un™ oàAccouÁ)'), ('XXX', 'XXX (Thcode assigÃd fÜ¿n§ùiÚ wh”nØcu¼’cy i švŞved)'), ('YER', 'YER (Yem’˜RŸl)'), ('ZAR', 'ZAR (Rªd)'), ('ZMW', 'ZMW (ZambŸÀKwacha)'), ('ZWL', 'ZWL (ZimbabwDŞÏr)')], 
h–p_‹xt
=
b
'Thcu¼’cy u£d wh’ makšg‡¿n§ùiÚ.', 
max_Ëngth
=4)),

103 ('Œª§ùiÚ_xe_¿‹', 
mod–s
.
	`Decim®F›ld
(
bÏnk
=
True
, 
decim®_¶aûs
=4, 
h–p_‹xt
=
b
'Cu¼’cyƒxchªg¿‹ from docum’ˆcu¼’cyØŒª§ùiÚ_cu¼’cy.', 
max_dig™s
=16, 
nuÎ
=True)),

104 ('Œª§ùiÚ_xe_d©e', 
mod–s
.
	`D©eF›ld
(
bÏnk
=
True
, 
h–p_‹xt
=
b
'D©oàthŒª§ùiÚƒxchªg¿‹.', 
nuÎ
=True)),

105 ('¡©e', 
djªgo_fsm
.
	`FSMF›ld
(
choiûs
=[(
b
'd¿á', 'D¿á'), (b'issued', 'Issued'), (b'·id', 'Paid'), (b'ÿnûËd', 'CªûËd')], =b'd¿á', 
h–p_‹xt
=b'Th¡©thšvoiû i š.', 
max_Ëngth
=10, 
v”bo£_Çme
=b'State')),

106 ('_tÙ®', 
mod–s
.
	`Decim®F›ld
(
bÏnk
=
True
, 
decim®_¶aûs
=2, 
max_dig™s
=19, 
nuÎ
=True)),

107 ('_tÙ®_š_Œª§ùiÚ_cu¼’cy', 
mod–s
.
	`Decim®F›ld
(
bÏnk
=
True
, 
decim®_¶aûs
=2, 
max_dig™s
=19, 
nuÎ
=True)),

108 ('cu¡om”', 
mod–s
.
	`FÜeignKey
(
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
to
='silver.Customer')),

109 ('pdf', 
mod–s
.
	`FÜeignKey
(
nuÎ
=
True
, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
to
='silver.PDF')),

110 ('´ovid”', 
mod–s
.
	`FÜeignKey
(
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
to
='silver.Provider')),

111 ('»Ï‹d_docum’t', 
mod–s
.
	`FÜeignKey
(
bÏnk
=
True
, 
nuÎ
=True, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='»v”£_»Ï‹d_docum’t', 
to
='silver.BillingDocumentBase')),

113 
İtiÚs
={

115 
	}
},

118 
	gmig¿tiÚs
.
R’ameF›ld
(

119 
mod–_Çme
='billinglog',

120 
Şd_Çme
='invoice',

121 
Ãw_Çme
='invoice_old'

123 
	gmig¿tiÚs
.
R’ameF›ld
(

124 
mod–_Çme
='billinglog',

125 
Şd_Çme
='proforma',

126 
Ãw_Çme
='proforma_old'

128 
	gmig¿tiÚs
.
AÉ”F›ld
(

129 
mod–_Çme
='billinglog',

130 
Çme
='invoice_old',

131 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
nuÎ
=True, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='Şd_švoiû_logs', 
to
='silver.Invoice'),

133 
	gmig¿tiÚs
.
AÉ”F›ld
(

134 
mod–_Çme
='billinglog',

135 
Çme
='proforma_old',

136 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
nuÎ
=True, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='Şd_´ofÜma_logs', 
to
='silver.Proforma'),

138 
	gmig¿tiÚs
.
AddF›ld
(

139 
mod–_Çme
='billinglog',

140 
Çme
='invoice',

141 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
nuÎ
=True, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='švoiû_blšg_logs', 
to
='silver.BillingDocumentBase'),

143 
	gmig¿tiÚs
.
AddF›ld
(

144 
mod–_Çme
='billinglog',

145 
Çme
='proforma',

146 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
nuÎ
=True, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='´ofÜma_blšg_logs', 
to
='silver.BillingDocumentBase'),

149 
	gmig¿tiÚs
.
R’ameF›ld
(

150 
mod–_Çme
='documententry',

151 
Şd_Çme
='invoice',

152 
Ãw_Çme
='invoice_old'

154 
	gmig¿tiÚs
.
R’ameF›ld
(

155 
mod–_Çme
='documententry',

156 
Şd_Çme
='proforma',

157 
Ãw_Çme
='proforma_old'

159 
	gmig¿tiÚs
.
AÉ”F›ld
(

160 
mod–_Çme
='documententry',

161 
Çme
='invoice_old',

162 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
nuÎ
=True, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='Şd_švoiû_’Œ›s', 
to
='silver.Invoice'),

164 
	gmig¿tiÚs
.
AÉ”F›ld
(

165 
mod–_Çme
='documententry',

166 
Çme
='proforma_old',

167 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
nuÎ
=True, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='Şd_´ofÜma_’Œ›s', 
to
='silver.Proforma'),

169 
	gmig¿tiÚs
.
AddF›ld
(

170 
mod–_Çme
='documententry',

171 
Çme
='invoice',

172 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
nuÎ
=True, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='švoiû_’Œ›s', 
to
='silver.BillingDocumentBase'),

174 
	gmig¿tiÚs
.
AddF›ld
(

175 
mod–_Çme
='documententry',

176 
Çme
='proforma',

177 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
nuÎ
=True, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='´ofÜma_’Œ›s', 
to
='silver.BillingDocumentBase'),

180 
	gmig¿tiÚs
.
R’ameF›ld
(

181 
mod–_Çme
='transaction',

182 
Şd_Çme
='invoice',

183 
Ãw_Çme
='invoice_old'

185 
	gmig¿tiÚs
.
R’ameF›ld
(

186 
mod–_Çme
='transaction',

187 
Şd_Çme
='proforma',

188 
Ãw_Çme
='proforma_old'

190 
	gmig¿tiÚs
.
AÉ”F›ld
(

191 
mod–_Çme
='transaction',

192 
Çme
='invoice_old',

193 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
nuÎ
=True, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='Şd_švoiû_Œª§ùiÚs', 
to
='silver.Invoice'),

195 
	gmig¿tiÚs
.
AÉ”F›ld
(

196 
mod–_Çme
='transaction',

197 
Çme
='proforma_old',

198 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
nuÎ
=True, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='Şd_´ofÜma_Œª§ùiÚs', 
to
='silver.Proforma'),

200 
	gmig¿tiÚs
.
AddF›ld
(

201 
mod–_Çme
='transaction',

202 
Çme
='invoice',

203 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
nuÎ
=True, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='švoiû_Œª§ùiÚs', 
to
='silver.BillingDocumentBase'),

205 
	gmig¿tiÚs
.
AddF›ld
(

206 
mod–_Çme
='transaction',

207 
Çme
='proforma',

208 
f›ld
=
mod–s
.
FÜeignKey
(
bÏnk
=
True
, 
nuÎ
=True, 
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='´ofÜma_Œª§ùiÚs', 
to
='silver.BillingDocumentBase'),

211 
	gmig¿tiÚs
.
RunPythÚ
(
move_docum’ts_to_blšg_docum’t
,

212 
mig¿tiÚs
.
RunPythÚ
.
noİ
),

214 
	gmig¿tiÚs
.
RemoveF›ld
(

215 
mod–_Çme
='billinglog',

216 
Çme
='invoice_old',

218 
	gmig¿tiÚs
.
RemoveF›ld
(

219 
mod–_Çme
='billinglog',

220 
Çme
='proforma_old',

222 
	gmig¿tiÚs
.
RemoveF›ld
(

223 
mod–_Çme
='documententry',

224 
Çme
='invoice_old',

226 
	gmig¿tiÚs
.
RemoveF›ld
(

227 
mod–_Çme
='documententry',

228 
Çme
='proforma_old',

230 
	gmig¿tiÚs
.
RemoveF›ld
(

231 
mod–_Çme
='transaction',

232 
Çme
='invoice_old',

234 
	gmig¿tiÚs
.
RemoveF›ld
(

235 
mod–_Çme
='transaction',

236 
Çme
='proforma_old',

239 
	gmig¿tiÚs
.
AÉ”UniqueTog‘h”
(

240 
Çme
='invoice',

241 
unique_tog‘h”
=
£t
([]),

243 
	gmig¿tiÚs
.
RemoveF›ld
(

244 
mod–_Çme
='invoice',

245 
Çme
='customer',

247 
	gmig¿tiÚs
.
RemoveF›ld
(

248 
mod–_Çme
='invoice',

249 
Çme
='pdf',

251 
	gmig¿tiÚs
.
RemoveF›ld
(

252 
mod–_Çme
='invoice',

253 
Çme
='proforma',

255 
	gmig¿tiÚs
.
RemoveF›ld
(

256 
mod–_Çme
='invoice',

257 
Çme
='provider',

259 
	gmig¿tiÚs
.
AÉ”UniqueTog‘h”
(

260 
Çme
='proforma',

261 
unique_tog‘h”
=
£t
([]),

263 
	gmig¿tiÚs
.
RemoveF›ld
(

264 
mod–_Çme
='proforma',

265 
Çme
='customer',

267 
	gmig¿tiÚs
.
RemoveF›ld
(

268 
mod–_Çme
='proforma',

269 
Çme
='invoice',

271 
	gmig¿tiÚs
.
RemoveF›ld
(

272 
mod–_Çme
='proforma',

273 
Çme
='pdf',

275 
	gmig¿tiÚs
.
RemoveF›ld
(

276 
mod–_Çme
='proforma',

277 
Çme
='provider',

279 
	gmig¿tiÚs
.
D–‘eMod–
(

280 
Çme
='Invoice',

282 
	gmig¿tiÚs
.
D–‘eMod–
(

283 
Çme
='Proforma',

285 
	gmig¿tiÚs
.
AÉ”UniqueTog‘h”
(

286 
Çme
='billingdocumentbase',

287 
unique_tog‘h”
=
£t
([('kind', 'provider', 'series', 'number')]),

289 
	gmig¿tiÚs
.
C»©eMod–
(

290 
Çme
='Invoice',

291 
f›lds
=[

293 
İtiÚs
={

294 '´oxy': 
True
,

296 
ba£s
=('silver.billingdocumentbase',),

298 
	gmig¿tiÚs
.
C»©eMod–
(

299 
Çme
='Proforma',

300 
f›lds
=[

302 
İtiÚs
={

303 '´oxy': 
True
,

305 
ba£s
=('silver.billingdocumentbase',),

307 
	gmig¿tiÚs
.
RunSQL
(

308 
sql
="DROP VIEW IF EXISTS silver_document;",

309 
»v”£_sql
=""

	@silver/migrations/0044_auto_20171115_1809.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #G’”©ed 
by
 
Djªgo
 1.11.7 
Ú
 2017-11-15 18:09

3 
äom
 
__futu»__
 
impÜt
 
unicode_l™”®s


5 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmig¿tiÚs
, 
mod–s


6 
impÜt
 
	gdjªgo
.
	gdb
.
	gmod–s
.
d–‘iÚ


9 
şass
 
	$Mig¿tiÚ
(
mig¿tiÚs
.
Mig¿tiÚ
):

11 
d•’d’c›s
 = [

15 
İ”©iÚs
 = [

16 
mig¿tiÚs
.
	`AÉ”F›ld
(

17 
mod–_Çme
='billinglog',

18 
Çme
='subscription',

19 
f›ld
=
mod–s
.
	`FÜeignKey
(
Ú_d–‘e
=
djªgo
.
db
.mod–s.
d–‘iÚ
.
CASCADE
, 
»Ï‹d_Çme
='blšg_logs', 
to
='silver.Subscription'),

	@silver/migrations/__init__.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

	@silver/models/__init__.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
blšg_’t™›s
 
impÜt
 
	gCu¡om”
, 
Provid”


16 
äom
 
docum’ts
 
impÜt
 
	gProfÜma
, 
	gInvoiû
, 
	gBlšgDocum’tBa£
, 
	gDocum’tEÁry
, 
PDF


17 
äom
 
¶ªs
 
impÜt
 
	gPÏn
, 
M‘”edF—tu»


18 
äom
 
´oduù_codes
 
impÜt
 
ProduùCode


19 
äom
 
subsütiÚs
 
impÜt
 
	gSubsütiÚ
, 
	gM‘”edF—tu»Un™sLog
, 
BlšgLog


20 
äom
 
·ym’t_m‘hods
 
impÜt
 
Paym’tM‘hod


21 
äom
 
Œª§ùiÚs
 
impÜt
 
	gT¿n§ùiÚ


	@silver/models/billing_entities/__init__.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
	gäom
 .
cu¡om”
 
impÜt
 
Cu¡om”


17 
	gäom
 .
´ovid”
 
impÜt
 
	gProvid”


	@silver/models/billing_entities/base.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

14 
äom
 
	gªnoyšg
.
f›lds
 
impÜt
 
JSONF›ld


15 
äom
 
livef›ld
 
impÜt
 
LiveMod–


17 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


18 
äom
 
	gdjªgo
.
db
 
impÜt
 
mod–s


19 
äom
 
	gdjªgo
.
	guts
.
‹xt
 
impÜt
 
¦ugify


21 
äom
 
	gsv”
.
	guts
.
š‹º©iÚ®
 
impÜt
 
couÁr›s


24 
	gPAYMENT_DUE_DAYS
 = 
g‘©Œ
(
£‰šgs
, 'SILVER_DEFAULT_DUE_DAYS', 5)

27 
şass
 
	$Ba£BlšgEÁ™y
(
LiveMod–
):

28 
com·ny
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=128, 
bÏnk
=
True
, 
nuÎ
=True)

29 
add»ss_1
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=128)

30 
add»ss_2
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=128, 
bÏnk
=
True
, 
nuÎ
=True)

31 
couÁry
 = 
mod–s
.
	$Ch¬F›ld
(
choiûs
=
couÁr›s
, 
max_Ëngth
=3)

32 
phÚe
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=15, 
bÏnk
=
True
, 
nuÎ
=True)

33 
ema
 = 
mod–s
.
	$Ch¬F›ld
(
bÏnk
=
True
, 
nuÎ
=True, 
max_Ëngth
=254)

34 
c™y
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=128)

35 
¡©e
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=128, 
bÏnk
=
True
, 
nuÎ
=True)

36 
z_code
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=32, 
bÏnk
=
True
, 
nuÎ
=True)

37 
exŒa
 = 
mod–s
.
	`TextF›ld
(

38 
bÏnk
=
True
, 
nuÎ
=True,

39 
h–p_‹xt
='Extra informationo display onhe invoice '

42 
m‘a
 = 
	`JSONF›ld
(
bÏnk
=
True
, 
nuÎ
=True, ={
	}
})

44 
şass
 
M‘a
:

45 
ab¡¿ù
 = 
True


47 @
´İ”ty


48 
def
 
	$blšg_Çme
(
£lf
):

49  
£lf
.
com·ny
 
Ü
 s–f.
Çme


51 @
´İ”ty


52 
def
 
	$¦ug
(
£lf
):

53  
	$¦ugify
(
£lf
.
blšg_Çme
)

55 
def
 
	$add»ss
(
£lf
):

56  ", ".
	`još
(
	$f‹r
(
NÚe
, [
£lf
.
add»ss_1
, s–f.
c™y
, s–f.
¡©e
,

57 
£lf
.
z_code
, s–f.
couÁry
]))

58 
add»ss
.
shÜt_desütiÚ
 = 'Address'

60 
def
 
	$g‘_li¡_di¥Ïy_f›lds
(
£lf
):

61 
f›ld_Çmes
 = ['company', 'email', 'address_1', 'city', 'country',

63  [
	`g‘©Œ
(
£lf
, 
f›ld
, ''èf›ld 
š
 
f›ld_Çmes
]

65 
def
 
	$g‘_¬chivabË_f›ld_v®ues
(
£lf
):

66 
f›ld_Çmes
 = ['company', 'email', 'address_1', 'address_2',

69  {
f›ld
: 
	`g‘©Œ
(
£lf
, f›ld, ''èf›ld 
š
 
f›ld_Çmes
}

71 
def
 
	$__unicode__
(
£lf
):

72  (
u
'% (%s)' % (
£lf
.
Çme
, s–f.
com·ny
) self.company

73 
£lf
.
Çme
)

	@silver/models/billing_entities/customer.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
pyv©
 
impÜt
 
is_v©_numb”_fÜm©_v®id


17 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


18 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
V®id©iÚE¼Ü


19 
äom
 
	gdjªgo
.
	gcÜe
.
v®id©Üs
 
impÜt
 
MšV®ueV®id©Ü


20 
äom
 
	gdjªgo
.
db
 
impÜt
 
mod–s


21 
äom
 
	gsv”
.
	guts
.
š‹º©iÚ®
 
impÜt
 
cu¼’c›s


23 
	gäom
 .
ba£
 
impÜt
 
Ba£BlšgEÁ™y


24 
äom
 
	gsv”
.
v®id©Üs
 
impÜt
 
v®id©e_»ã»nû


27 
	gPAYMENT_DUE_DAYS
 = 
g‘©Œ
(
£‰šgs
, 'SILVER_DEFAULT_DUE_DAYS', 5)

30 
şass
 
	$Cu¡om”
(
Ba£BlšgEÁ™y
):

31 
şass
 
M‘a
:

32 
šdex_tog‘h”
 = (('first_name', 'last_name', 'company'),)

33 
Üd”šg
 = ['first_name', 'last_name', 'company']

35 
fœ¡_Çme
 = 
mod–s
.
	`Ch¬F›ld
(

36 
max_Ëngth
=128,

37 
h–p_‹xt
='The customer\'s first‚ame.'

39 
Ï¡_Çme
 = 
mod–s
.
	`Ch¬F›ld
(

40 
max_Ëngth
=128,

41 
h–p_‹xt
='The customer\'s†ast‚ame.',

42 
bÏnk
=
True
,
nuÎ
=True

45 
·ym’t_due_days
 = 
mod–s
.
	`Pos™iveIÁeg”F›ld
(

46 =
PAYMENT_DUE_DAYS
,

47 
h–p_‹xt
='Due days for generated…roforma/invoice.'

49 
cÚsŞid©ed_blšg
 = 
mod–s
.
	`BoŞ—nF›ld
(

50 =
F®£
, 
h–p_‹xt
='A flag indicating consolidated billing.'

52 
cu¡om”_»ã»nû
 = 
mod–s
.
	`Ch¬F›ld
(

53 
max_Ëngth
=256, 
bÏnk
=
True
, 
nuÎ
=True, 
v®id©Üs
=[
v®id©e_»ã»nû
],

54 
h–p_‹xt
="It's‡„eferenceo be…assed between silver‡nd clients. "

57 
§Ës_x_numb”
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=64, 
bÏnk
=
True
, 
nuÎ
=True)

58 
§Ës_x_³rûÁ
 = 
mod–s
.
	`Decim®F›ld
(

59 
max_dig™s
=4, 
decim®_¶aûs
=2, 
nuÎ
=
True
, 
bÏnk
=True,

60 
v®id©Üs
=[
	`MšV®ueV®id©Ü
(0.0)],

61 
h–p_‹xt
="Whenevero‡dd salesax. "

64 
§Ës_x_Çme
 = 
mod–s
.
	`Ch¬F›ld
(

65 
max_Ëngth
=64, 
nuÎ
=
True
, 
bÏnk
=True,

66 
h–p_‹xt
="Salesax‚ame (eg. 'salesax' or 'VAT')."

69 
cu¼’cy
 = 
mod–s
.
	`Ch¬F›ld
(

70 
choiûs
=
cu¼’c›s
, 
max_Ëngth
=4, 
nuÎ
=
True
, 
bÏnk
=True,

71 
h–p_‹xt
="Usedoƒnforce‡ certain currency when makingransactions"

75 
def
 
	$__š™__
(
£lf
, *
¬gs
, **
kw¬gs
):

76 
	`su³r
(
Cu¡om”
, 
£lf
).
	$__š™__
(*
¬gs
, **
kw¬gs
)

77 
com·ny_f›ld
 = 
£lf
.
_m‘a
.
	`g‘_f›ld
("company")

78 
com·ny_f›ld
.
h–p_‹xt
 = "The companyo whichhe bill is issued."

80 
def
 
	$ş—n
(
£lf
):

81 ià(
£lf
.
§Ës_x_numb”
 
ªd


82 
	$is_v©_numb”_fÜm©_v®id
(
£lf
.
§Ës_x_numb”
,

83 
£lf
.
couÁry
è
is
 
F®£
):

84 
¿i£
 
	`V®id©iÚE¼Ü
(

85 {'§Ës_x_numb”': 'Th§Ë x‚umb” i nÙ v®id.'
	}
}

88 
def
 
	$g‘_¬chivabË_f›ld_v®ues
(
£lf
):

89 
ba£_f›lds
 = 
	`su³r
(
Cu¡om”
, 
£lf
).
	$g‘_¬chivabË_f›ld_v®ues
()

90 
cu¡om”_f›lds
 = ['first_name', 'last_name', 'customer_reference', 'consolidated_billing',

92 
f›lds_diù
 = {
f›ld
: 
	`g‘©Œ
(
£lf
, f›ld, ''èf›ld 
š


93 
cu¡om”_f›lds
}

94 
ba£_f›lds
.
	$upd©e
(
f›lds_diù
)

95  
ba£_f›lds


97 @
´İ”ty


98 
def
 
	$Çme
(
£lf
):

99  "% %s" % (
£lf
.
fœ¡_Çme
, s–f.
Ï¡_Çme
)

	@silver/models/billing_entities/provider.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
äom
 
mod–_uts
 
impÜt
 
Choiûs


18 
äom
 
	gdjªgo
.
­ps
 
impÜt
‡pps

19 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


20 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
V®id©iÚE¼Ü


21 
äom
 
	gdjªgo
.
db
 
impÜt
 
mod–s


22 
äom
 
	gdjªgo
.
	gdb
.
	gmod–s
.
sigÇls
 
impÜt
 
´e_§ve


23 
äom
 
	gdjªgo
.
di¥©ch
 
impÜt
 
»ûiv”


24 
äom
 
	gdjªgo
.
	guts
.
Œª¦©iÚ
 
impÜt
 
ug‘‹xt_Ïzy
 
as
 
_


26 
	gäom
 .
ba£
 
impÜt
 
Ba£BlšgEÁ™y


29 
	gPAYMENT_DUE_DAYS
 = 
g‘©Œ
(
£‰šgs
, 'SILVER_DEFAULT_DUE_DAYS', 5)

32 
şass
 
	$Provid”
(
Ba£BlšgEÁ™y
):

33 
şass
 
	$FLOWS
(
objeù
):

34 
PROFORMA
 = 'proforma'

35 
INVOICE
 = 'invoice'

37 
FLOW_CHOICES
 = 
	`Choiûs
(

38 (
FLOWS
.
PROFORMA
, 
	`_
('Proforma')),

39 (
FLOWS
.
INVOICE
, 
	`_
('Invoice')),

42 
şass
 
	$DEFAULT_DOC_STATE
(
objeù
):

43 
DRAFT
 = 'draft'

44 
ISSUED
 = 'issued'

46 
DOCUMENT_DEFAULT_STATE
 = 
	`Choiûs
(

47 (
DEFAULT_DOC_STATE
.
DRAFT
, 
	`_
('Draft')),

48 (
DEFAULT_DOC_STATE
.
ISSUED
, 
	`_
('Issued'))

51 
şass
 
M‘a
:

52 
šdex_tog‘h”
 = (('name', 'company'),)

53 
Üd”šg
 = ['name', 'company']

55 
Çme
 = 
mod–s
.
	`Ch¬F›ld
(

56 
max_Ëngth
=128,

57 
h–p_‹xt
='The‚ameo be used for billing…urposes.'

59 
æow
 = 
mod–s
.
	`Ch¬F›ld
(

60 
max_Ëngth
=10, 
choiûs
=
FLOW_CHOICES
,

61 =
FLOWS
.
PROFORMA
,

62 
h–p_‹xt
="One ofhe‡vailable workflows for generating…roformas "

65 
švoiû_£r›s
 = 
mod–s
.
	`Ch¬F›ld
(

66 
max_Ëngth
=20,

67 
h–p_‹xt
="The serieshat will be used onƒvery invoice generated by "

70 
švoiû_¡¬tšg_numb”
 = 
mod–s
.
	$Pos™iveIÁeg”F›ld
()

71 
´ofÜma_£r›s
 = 
mod–s
.
	`Ch¬F›ld
(

72 
max_Ëngth
=20, 
bÏnk
=
True
, 
nuÎ
=True,

73 
h–p_‹xt
="The serieshat will be used onƒvery…roforma generated by "

76 
´ofÜma_¡¬tšg_numb”
 = 
mod–s
.
	$Pos™iveIÁeg”F›ld
(

77 
bÏnk
=
True
, 
nuÎ
=True

79 
deçuÉ_docum’t_¡©e
 = 
mod–s
.
	`Ch¬F›ld
(

80 
max_Ëngth
=10, 
choiûs
=
DOCUMENT_DEFAULT_STATE
,

81 =
DOCUMENT_DEFAULT_STATE
.
d¿á
,

82 
h–p_‹xt
="The default state ofhe‡uto-generated documents."

84 
g’”©e_docum’ts_Ú_ŒŸl_’d
 = 
mod–s
.
	`BoŞ—nF›ld
(

85 =
True
,

86 
h–p_‹xt
="Ifhis is seto True,hen billing documents will be generated whenhe "

89 
£·¿‹_cyşes_duršg_ŒŸl
 = 
mod–s
.
	`BoŞ—nF›ld
(

90 =
F®£
,

91 
h–p_‹xt
="Ifhis is seto True,henherial…eriod cycle will be split if it spans "

94 
´ebl_¶ª
 = 
mod–s
.
	`BoŞ—nF›ld
(

95 =
True
,

96 
h–p_‹xt
="Ifhis is seto True,henhe…lan base‡mount will be billed‡the"

99 
cyşe_blšg_du¿tiÚ
 = 
mod–s
.
	`Du¿tiÚF›ld
(

100 
nuÎ
=
True
, 
bÏnk
=True,

101 
h–p_‹xt
="This can be usedoƒnsurehathe billing date doesn't…ass‡ certain date.\n"

108 
def
 
	$__š™__
(
£lf
, *
¬gs
, **
kw¬gs
):

109 
	`su³r
(
Provid”
, 
£lf
).
	$__š™__
(*
¬gs
, **
kw¬gs
)

110 
com·ny_f›ld
 = 
£lf
.
_m‘a
.
	`g‘_f›ld
("company")

111 
com·ny_f›ld
.
h–p_‹xt
 = "The…rovider issuinghe invoice."

113 
def
 
	$ş—n
(
£lf
):

114 
£lf
.
æow
 =ğ£lf.
FLOWS
.
PROFORMA
:

115 
nÙ
 
£lf
.
´ofÜma_¡¬tšg_numb”
 
ªd
\

116 
nÙ
 
£lf
.
´ofÜma_£r›s
:

117 
”rÜs
 = {'proforma_series': "This field is„equired‡she "

121 "´ofÜma."
	}
}

122 
¿i£
 
	$V®id©iÚE¼Ü
(
”rÜs
)

123 
–if
 
nÙ
 
£lf
.
´ofÜma_£r›s
:

124 
”rÜs
 = {'proforma_series': "This field is„equired‡she "

125 "cho£Àæow i ´ofÜma."
	}
}

126 
¿i£
 
	$V®id©iÚE¼Ü
(
”rÜs
)

127 
–if
 
nÙ
 
£lf
.
´ofÜma_¡¬tšg_numb”
:

128 
”rÜs
 = {'proforma_starting_number': "This field is„equired "

130 "´ofÜma."
	}
}

131 
¿i£
 
	$V®id©iÚE¼Ü
(
”rÜs
)

133 
def
 
	$g‘_¬chivabË_f›ld_v®ues
(
£lf
):

134 
ba£_f›lds
 = 
	`su³r
(
Provid”
, 
£lf
).
	$g‘_¬chivabË_f›ld_v®ues
()

135 
´ovid”_f›lds
 = ['name']

136 
f›lds_diù
 = {
f›ld
: 
	`g‘©Œ
(
£lf
, f›ld, ''èf›ld 
š
 
´ovid”_f›lds
}

137 
ba£_f›lds
.
	$upd©e
(
f›lds_diù
)

138  
ba£_f›lds


140 
def
 
	$g‘_švoiû_¬chivabË_f›ld_v®ues
(
£lf
):

141 
ba£_f›lds
 = 
£lf
.
	$g‘_¬chivabË_f›ld_v®ues
()

142 
ba£_f›lds
.
	`upd©e
({'švoiû_£r›s': 
	`g‘©Œ
(
£lf
, 'švoiû_£r›s', '')
	}
})

143  
ba£_f›lds


145 
def
 
	$g‘_´ofÜma_¬chivabË_f›ld_v®ues
(
£lf
):

146 
ba£_f›lds
 = 
£lf
.
	$g‘_¬chivabË_f›ld_v®ues
()

147 
ba£_f›lds
.
	`upd©e
({'´ofÜma_£r›s': 
	`g‘©Œ
(
£lf
, '´ofÜma_£r›s', '')
	}
})

148  
ba£_f›lds


151 @
	$»ûiv”
(
´e_§ve
, 
£nd”
=
Provid”
)

152 
def
 
	$upd©e_d¿á_blšg_docum’ts
(
£nd”
, 
š¡ªû
, **
kw¬gs
):

153 
Invoiû
 = 
­ps
.
	`g‘_mod–
('silver', 'Invoice')

154 
ProfÜma
 = 
­ps
.
	`g‘_mod–
('silver', 'Proforma')

156 
š¡ªû
.
pk
 
ªd
 
nÙ
 
kw¬gs
.
	`g‘
('¿w', 
F®£
):

157 
´ovid”
 = 
Provid”
.
objeùs
.
	$g‘
(
pk
=
š¡ªû
.pk)

158 
Şd_švoiû_£r›s
 = 
´ovid”
.
švoiû_£r›s


159 
Şd_´ofÜma_£r›s
 = 
´ovid”
.
´ofÜma_£r›s


161 
š¡ªû
.
švoiû_£r›s
 !ğ
Şd_švoiû_£r›s
:

162 
švoiû
 
š
 
Invoiû
.
objeùs
.
	`f‹r
(
¡©e
='draft',

163 
´ovid”
=provider):

164 #upd©
the
 
£r›s
 
d¿á
 
švoiûs


165 
švoiû
.
£r›s
 = 
š¡ªû
.
švoiû_£r›s


166 
švoiû
.
numb”
 = 
NÚe


167 
švoiû
.
	$§ve
()

169 
š¡ªû
.
´ofÜma_£r›s
 !ğ
Şd_´ofÜma_£r›s
:

170 
´ofÜma
 
š
 
ProfÜma
.
objeùs
.
	`f‹r
(
¡©e
='draft',

171 
´ovid”
=provider):

172 #upd©
the
 
£r›s
 
d¿á
 
švoiûs


173 
´ofÜma
.
£r›s
 = 
š¡ªû
.
´ofÜma_£r›s


174 
´ofÜma
.
numb”
 = 
NÚe


175 
´ofÜma
.
	`§ve
()

	@silver/models/documents/__init__.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
	gäom
 .
ba£
 
impÜt
 
BlšgDocum’tBa£


17 
	gäom
 .
’Œ›s
 
impÜt
 
Docum’tEÁry


18 
	gäom
 .
švoiû
 
impÜt
 
Invoiû


19 
	gäom
 .
´ofÜma
 
impÜt
 
ProfÜma


20 
	gäom
 .
pdf
 
impÜt
 
	gPDF


	@silver/models/documents/base.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
loggšg


17 
äom
 
decim®
 
impÜt
 
Decim®


18 
äom
 
d©‘ime
 
impÜt
 
	gd©‘ime
, 
timed–


20 
impÜt
 
pytz


21 
äom
 
	gdjªgo
.
­ps
 
impÜt
‡pps

22 
äom
 
	gdjªgo
.
	gdb
.
	gmod–s
.
sigÇls
 
impÜt
 
po¡_§ve


23 
äom
 
	gdjªgo
.
di¥©ch
 
impÜt
 
»ûiv”


24 
äom
 
djªgo_fsm
 
impÜt
 
	gFSMF›ld
, 
	gŒªs™iÚ
, 
	gT¿ns™iÚNÙAÎowed
, 
po¡_Œªs™iÚ


25 
äom
 
	gªnoyšg
.
f›lds
 
impÜt
 
JSONF›ld


26 
äom
 
mod–_uts
 
impÜt
 
Choiûs


28 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


29 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
	gV®id©iÚE¼Ü
, 
NON_FIELD_ERRORS


30 
äom
 
	gdjªgo
.
	gcÜe
.
u¾»sŞv”s
 
impÜt
 
»v”£


31 
äom
 
	gdjªgo
.
	gcÜe
.
v®id©Üs
 
impÜt
 
MšV®ueV®id©Ü


32 
äom
 
	gdjªgo
.
db
 
impÜt
 
mod–s


33 
äom
 
	gdjªgo
.
db
 
impÜt
 
Œª§ùiÚ
 
as
 
db_Œª§ùiÚ


34 
äom
 
	gdjªgo
.
	gdb
.
mod–s
 
impÜt
 
	gMax
, 
	gFÜeignKey
, 
F


35 
äom
 
	gdjªgo
.
	g‹m¶©e
.
lßd”
 
impÜt
 
£Ëù_‹m¶©e


36 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


37 
äom
 
	gdjªgo
.
	guts
.
‹xt
 
impÜt
 
¦ugify


38 
äom
 
	gdjªgo
.
	guts
.
Œª¦©iÚ
 
impÜt
 
ug‘‹xt_Ïzy
 
as
 
_


39 
äom
 
	gdjªgo
.
	guts
.
moduË_lßdšg
 
impÜt
 
impÜt_¡ršg


41 
äom
 
	gsv”
.
	gmod–s
.
blšg_’t™›s
 
impÜt
 
	gCu¡om”
, 
Provid”


42 
äom
 
	gsv”
.
cu¼’c›s
 
impÜt
 
	gCu¼’cyCÚv”‹r
, 
R©eNÙFound


43 
äom
 
	gsv”
.
	gmod–s
.
	gdocum’ts
.
pdf
 
impÜt
 
PDF


44 
äom
 
	gsv”
.
	guts
.
š‹º©iÚ®
 
impÜt
 
cu¼’c›s


46 
	gäom
 .
’Œ›s
 
impÜt
 
Docum’tEÁry


49 
	g_¡Üage
 = 
g‘©Œ
(
£‰šgs
, 'SILVER_DOCUMENT_STORAGE', 
NÚe
)

50 
	g_¡Üage
:

51 
_¡Üage_kÏss
 = 
	$impÜt_¡ršg
(
_¡Üage
[0])

52 
_¡Üage
 = 
	$_¡Üage_kÏss
(*
_¡Üage
[1], **_storage[2])

55 
PAYMENT_DUE_DAYS
 = 
	`g‘©Œ
(
£‰šgs
, 'SILVER_DEFAULT_DUE_DAYS', 5)

57 
logg”
 = 
loggšg
.
	$g‘Logg”
(
__Çme__
)

60 
def
 
	$docum’ts_pdf_·th
(
docum’t
, 
f’ame
):

61 
·th
 = '{´efix}{com·ny}/{doc_Çme}/{d©e}/{f’ame}'.
	`fÜm©
(

62 
com·ny
=
	`¦ugify
(
	`unicode
(

63 
docum’t
.
´ovid”
.
com·ny
 
Ü
 docum’t.´ovid”.
Çme
)),

64 
d©e
=
docum’t
.
issue_d©e
.
	`¡ráime
('%Y/%m'),

65 
doc_Çme
=('%ss' % 
docum’t
.
__şass__
.
__Çme__
).
	`low”
(),

66 
´efix
=
	`g‘©Œ
(
£‰šgs
, 'SILVER_DOCUMENT_PREFIX', ''),

67 
f’ame
=filename)

68  
·th


71 
şass
 
	$BlšgDocum’tQu”yS‘
(
mod–s
.
Qu”yS‘
):

72 
def
 
	$due_this_mÚth
(
£lf
):

73  
£lf
.
	`f‹r
(

74 
¡©e
=
BlšgDocum’tBa£
.
STATES
.
ISSUED
,

75 
due_d©e__g‹
=
d©‘ime
.
	`now
(
pytz
.
utc
).
	`d©e
().
	$»¶aû
(
day
=1)

78 
def
 
	$due_today
(
£lf
):

79  
£lf
.
	`f‹r
(

80 
¡©e
=
BlšgDocum’tBa£
.
STATES
.
ISSUED
,

81 
due_d©e__exaù
=
d©‘ime
.
	`now
(
pytz
.
utc
).
	$d©e
()

84 
def
 
	$ov”due
(
£lf
):

85  
£lf
.
	`f‹r
(

86 
¡©e
=
BlšgDocum’tBa£
.
STATES
.
ISSUED
,

87 
due_d©e__É
=
d©‘ime
.
	`now
(
pytz
.
utc
).
	$d©e
()

90 
def
 
	$ov”due_sšû_Ï¡_mÚth
(
£lf
):

91  
£lf
.
	`f‹r
(

92 
¡©e
=
BlšgDocum’tBa£
.
STATES
.
ISSUED
,

93 
due_d©e__É
=
d©‘ime
.
	`now
(
pytz
.
utc
).
	`d©e
().
	$»¶aû
(
day
=1)

97 
şass
 
	$BlšgDocum’tMªag”
(
mod–s
.
Mªag”
):

98 
def
 
	$g‘_qu”y£t
(
£lf
):

99  
	`su³r
(
BlšgDocum’tMªag”
, 
£lf
).
	`g‘_qu”y£t
() \

100 .
	`£Ëù_»Ï‹d
('customer', 'provider',

104 
def
 
	$g‘_blšg_docum’ts_kšds
():

105  ((
subşass
.
__Çme__
.
	`low”
(), subclass.__name__)

106 
subşass
 
š
 
BlšgDocum’tBa£
.
	$__subşas£s__
())

109 
şass
 
	$BlšgDocum’tBa£
(
mod–s
.
Mod–
):

110 
objeùs
 = 
BlšgDocum’tMªag”
.
	$äom_qu”y£t
(
BlšgDocum’tQu”yS‘
)()

112 
şass
 
	$STATES
(
objeù
):

113 
DRAFT
 = 'draft'

114 
ISSUED
 = 'issued'

115 
PAID
 = 'paid'

116 
CANCELED
 = 'canceled'

118 
STATE_CHOICES
 = 
	`Choiûs
(

119 (
STATES
.
DRAFT
, 
	`_
('Draft')),

120 (
STATES
.
ISSUED
, 
	`_
('Issued')),

121 (
STATES
.
PAID
, 
	`_
('Paid')),

122 (
STATES
.
CANCELED
, 
	`_
('Canceled'))

125 
kšd
 = 
mod–s
.
	$Ch¬F›ld
(
g‘_blšg_docum’ts_kšds
, 
max_Ëngth
=8, 
db_šdex
=
True
)

126 
»Ï‹d_docum’t
 = 
mod–s
.
	`FÜeignKey
('£lf', 
bÏnk
=
True
, 
nuÎ
=True,

127 
»Ï‹d_Çme
='reverse_related_document')

129 
£r›s
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=20, 
bÏnk
=
True
, 
nuÎ
=True,

130 
db_šdex
=
True
)

131 
numb”
 = 
mod–s
.
	$IÁeg”F›ld
(
bÏnk
=
True
, 
nuÎ
=True, 
db_šdex
=True)

132 
cu¡om”
 = 
mod–s
.
	`FÜeignKey
('Customer')

133 
´ovid”
 = 
mod–s
.
	`FÜeignKey
('Provider')

134 
¬chived_cu¡om”
 = 
	$JSONF›ld
(=
diù
, 
nuÎ
=
True
, 
bÏnk
=True)

135 
¬chived_´ovid”
 = 
	$JSONF›ld
(=
diù
, 
nuÎ
=
True
, 
bÏnk
=True)

136 
due_d©e
 = 
mod–s
.
	$D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)

137 
issue_d©e
 = 
mod–s
.
	$D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True, 
db_šdex
=True)

138 
·id_d©e
 = 
mod–s
.
	$D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)

139 
ÿnûl_d©e
 = 
mod–s
.
	$D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)

140 
§Ës_x_³rûÁ
 = 
mod–s
.
	`Decim®F›ld
(
max_dig™s
=4, 
decim®_¶aûs
=2,

141 
v®id©Üs
=[
	`MšV®ueV®id©Ü
(0.0)],

142 
nuÎ
=
True
, 
bÏnk
=True)

143 
§Ës_x_Çme
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=64, 
bÏnk
=
True
, 
nuÎ
=True)

144 
cu¼’cy
 = 
mod–s
.
	`Ch¬F›ld
(

145 
choiûs
=
cu¼’c›s
, 
max_Ëngth
=4, ='USD',

146 
h–p_‹xt
='The currency used for billing.'

148 
Œª§ùiÚ_cu¼’cy
 = 
mod–s
.
	`Ch¬F›ld
(

149 
choiûs
=
cu¼’c›s
, 
max_Ëngth
=4,

150 
h–p_‹xt
='The currency used when making‡ransaction.'

152 
Œª§ùiÚ_xe_¿‹
 = 
mod–s
.
	`Decim®F›ld
(

153 
max_dig™s
=16, 
decim®_¶aûs
=4, 
nuÎ
=
True
, 
bÏnk
=True,

154 
h–p_‹xt
='Currencyƒxchange„ate from document currencyo '

157 
Œª§ùiÚ_xe_d©e
 = 
mod–s
.
	`D©eF›ld
(

158 
nuÎ
=
True
, 
bÏnk
=True,

159 
h–p_‹xt
='Date ofheransactionƒxchange„ate.'

162 
pdf
 = 
	$FÜeignKey
(
PDF
, 
nuÎ
=
True
)

163 
¡©e
 = 
	`FSMF›ld
(
choiûs
=
STATE_CHOICES
, 
max_Ëngth
=10, =
STATES
.
DRAFT
,

164 
v”bo£_Çme
="State",

165 
h–p_‹xt
='The statehe invoice is in.')

167 
_tÙ®
 = 
mod–s
.
	$Decim®F›ld
(
max_dig™s
=19, 
decim®_¶aûs
=2,

168 
nuÎ
=
True
, 
bÏnk
=True)

169 
_tÙ®_š_Œª§ùiÚ_cu¼’cy
 = 
mod–s
.
	$Decim®F›ld
(
max_dig™s
=19,

170 
decim®_¶aûs
=2,

171 
nuÎ
=
True
, 
bÏnk
=True)

173 
_Ï¡_¡©e
 = 
NÚe


174 
_docum’t_’Œ›s
 = 
NÚe


176 
şass
 
M‘a
:

177 
unique_tog‘h”
 = ('kind', 'provider', 'series', 'number')

178 
Üd”šg
 = ('-issue_date', 'series', '-number')

180 
def
 
	$__š™__
(
£lf
, *
¬gs
, **
kw¬gs
):

181 
	`su³r
(
BlšgDocum’tBa£
, 
£lf
).
	$__š™__
(*
¬gs
, **
kw¬gs
)

183 
nÙ
 
£lf
.
kšd
:

184 
£lf
.
kšd
 = s–f.
__şass__
.
__Çme__
.
	$low”
()

186 
subşass
 
š
 
BlšgDocum’tBa£
.
	$__subşas£s__
():

187 
subşass
.
__Çme__
.
	`low”
(è=ğ
£lf
.
kšd
:

188 
£lf
.
__şass__
 = 
subşass


190 
£lf
.
_Ï¡_¡©e
 = s–f.
¡©e


192 
def
 
	$_g‘_’Œ›s
(
£lf
):

193 
nÙ
 
£lf
.
_docum’t_’Œ›s
:

194 
£lf
.
_docum’t_’Œ›s
 = 
	`g‘©Œ
(£lf, s–f.
kšd
 + '_’Œ›s').
	$®l
()

196  
£lf
.
_docum’t_’Œ›s


198 
def
 
	$compu‹_tÙ®_š_Œª§ùiÚ_cu¼’cy
(
£lf
):

199  
	`sum
([
	$Decim®
(
’Œy
.
tÙ®_š_Œª§ùiÚ_cu¼’cy
)

200 
’Œy
 
š
 
£lf
.
	`_g‘_’Œ›s
()])

202 
def
 
	$compu‹_tÙ®
(
£lf
):

203  
	`sum
([
	$Decim®
(
’Œy
.
tÙ®
)

204 
’Œy
 
š
 
£lf
.
	`_g‘_’Œ›s
()])

206 
def
 
	$m¬k_fÜ_g’”©iÚ
(
£lf
):

207 
£lf
.
pdf
.
	$m¬k_as_dœty
()

209 
def
 
	$_issue
(
£lf
, 
issue_d©e
=
NÚe
, 
due_d©e
=None):

210 
issue_d©e
:

211 
£lf
.
issue_d©e
 = 
d©‘ime
.
	`¡½time
(issue_d©e, '%Y-%m-%d').
	$d©e
()

212 
–if
 
nÙ
 
£lf
.
issue_d©e
 
ªd
‚ot issue_date:

213 
£lf
.
issue_d©e
 = 
timezÚe
.
	`now
().
	$d©e
()

215 
nÙ
 
£lf
.
Œª§ùiÚ_xe_¿‹
:

216 
nÙ
 
£lf
.
Œª§ùiÚ_xe_d©e
:

217 
£lf
.
Œª§ùiÚ_xe_d©e
 = s–f.
issue_d©e


219 
Œy
:

220 
xe_¿‹
 = 
Cu¼’cyCÚv”‹r
.
	$cÚv”t
(1, 
£lf
.
cu¼’cy
,

221 
£lf
.
Œª§ùiÚ_cu¼’cy
,

222 
£lf
.
Œª§ùiÚ_xe_d©e
)

223 
exû±
 
R©eNÙFound
:

224 
¿i£
 
	`T¿ns™iÚNÙAÎowed
('Couldn\'t‡utomatically obtain‡n '

227 
£lf
.
Œª§ùiÚ_xe_¿‹
 = 
xe_¿‹


229 
due_d©e
:

230 
£lf
.
due_d©e
 = 
d©‘ime
.
	`¡½time
(due_d©e, '%Y-%m-%d').
	$d©e
()

231 
–if
 
nÙ
 
£lf
.
due_d©e
 
ªd
‚ot due_date:

232 
d–
 = 
	$timed–
(
days
=
PAYMENT_DUE_DAYS
)

233 
£lf
.
due_d©e
 = 
timezÚe
.
	`now
().
	`d©e
(è+ 
d–


235 
nÙ
 
£lf
.
§Ës_x_Çme
:

236 
£lf
.
§Ës_x_Çme
 = s–f.
cu¡om”
.sales_tax_name

237 
nÙ
 
£lf
.
§Ës_x_³rûÁ
:

238 
£lf
.
§Ës_x_³rûÁ
 = s–f.
cu¡om”
.sales_tax_percent

240 
nÙ
 
£lf
.
numb”
:

241 
£lf
.
numb”
 = s–f.
	$_g’”©e_numb”
()

243 
£lf
.
¬chived_cu¡om”
 = s–f.
cu¡om”
.
	$g‘_¬chivabË_f›ld_v®ues
()

244 
£lf
.
_tÙ®
 = s–f.
	$compu‹_tÙ®
()

245 
£lf
.
_tÙ®_š_Œª§ùiÚ_cu¼’cy
 = s–f.
	`compu‹_tÙ®_š_Œª§ùiÚ_cu¼’cy
()

247 @
	$Œªs™iÚ
(
f›ld
=
¡©e
, 
sourû
=
STATES
.
DRAFT
, 
rg‘
=STATES.
ISSUED
)

248 
def
 
	$issue
(
£lf
, 
issue_d©e
=
NÚe
, 
due_d©e
=None):

249 
£lf
.
	$_issue
(
issue_d©e
=issue_d©e, 
due_d©e
=due_date)

251 
def
 
	$_·y
(
£lf
, 
·id_d©e
=
NÚe
):

252 
·id_d©e
:

253 
£lf
.
·id_d©e
 = 
d©‘ime
.
	`¡½time
Õaid_d©e, '%Y-%m-%d').
	$d©e
()

254 
nÙ
 
£lf
.
·id_d©e
 
ªd
‚ot…aid_date:

255 
£lf
.
·id_d©e
 = 
timezÚe
.
	`now
().
	`d©e
()

257 @
	$Œªs™iÚ
(
f›ld
=
¡©e
, 
sourû
=
STATES
.
ISSUED
, 
rg‘
=STATES.
PAID
)

258 
def
 
	$·y
(
£lf
, 
·id_d©e
=
NÚe
):

259 
£lf
.
	$_·y
(
·id_d©e
=paid_date)

261 
def
 
	$_ÿnûl
(
£lf
, 
ÿnûl_d©e
=
NÚe
):

262 
ÿnûl_d©e
:

263 
£lf
.
ÿnûl_d©e
 = 
d©‘ime
.
	`¡½time
(ÿnûl_d©e, '%Y-%m-%d').
	$d©e
()

264 
nÙ
 
£lf
.
ÿnûl_d©e
 
ªd
‚ot cancel_date:

265 
£lf
.
ÿnûl_d©e
 = 
timezÚe
.
	`now
().
	`d©e
()

267 @
	$Œªs™iÚ
(
f›ld
=
¡©e
, 
sourû
=
STATES
.
ISSUED
, 
rg‘
=STATES.
CANCELED
)

268 
def
 
	$ÿnûl
(
£lf
, 
ÿnûl_d©e
=
NÚe
):

269 
£lf
.
	$_ÿnûl
(
ÿnûl_d©e
=cancel_date)

271 
def
 
	$sync_»Ï‹d_docum’t_¡©e
(
£lf
):

272 
£lf
.
»Ï‹d_docum’t
 
ªd
 s–f.
¡©e
 != self.related_document.state:

273 
¡©e_Œªs™iÚ_m­
 = {

274 
BlšgDocum’tBa£
.
STATES
.
ISSUED
: 'issue',

275 
BlšgDocum’tBa£
.
STATES
.
CANCELED
: 'cancel',

276 
BlšgDocum’tBa£
.
STATES
.
PAID
: 'pay'

277 
	}
}

278 
Œªs™iÚ_Çme
 = 
¡©e_Œªs™iÚ_m­
[
£lf
.
¡©e
]

280 
bound_Œªs™iÚ_m‘hod
 = 
	$g‘©Œ
(
£lf
.
»Ï‹d_docum’t
, 
Œªs™iÚ_Çme
)

281 
	$bound_Œªs™iÚ_m‘hod
()

283 
def
 
	$şÚe_što_d¿á
(
£lf
):

284 
cİ›d_f›lds
 = {

285 'cu¡om”': 
£lf
.
cu¡om”
,

286 '´ovid”': 
£lf
.
´ovid”
,

287 'cu¼’cy': 
£lf
.
cu¼’cy
,

288 '§Ës_x_³rûÁ': 
£lf
.
§Ës_x_³rûÁ
,

289 '§Ës_x_Çme': 
£lf
.
§Ës_x_Çme


290 
	}
}

292 
şÚe
 = 
£lf
.
__şass__
.
_deçuÉ_mªag”
.
	$ü—‹
(**
cİ›d_f›lds
)

293 
şÚe
.
¡©e
 = 
£lf
.
STATES
.
DRAFT


295 #şÚ
’Œ›s
 
too


296 
’Œy
 
š
 
£lf
.
_’Œ›s
:

297 
’Œy_şÚe
 = 
’Œy
.
	$şÚe
()

298 
docum’t_ty³_Çme
 = 
£lf
.
__şass__
.
__Çme__
.
	$low”
()

299 
	$£‰r
(
’Œy_şÚe
, 
docum’t_ty³_Çme
, 
şÚe
)

300 
’Œy_şÚe
.
	$§ve
()

302 
şÚe
.
	$§ve
()

304  
şÚe


306 
def
 
	$ş—n
(
£lf
):

307 
	`su³r
(
BlšgDocum’tBa£
, 
£lf
).
	$ş—n
()

309 #Th
Úly
 
chªge
 
th©
 
is
 
®lowed
 
the
 
docum’t
 i 
š
 
issued
 
¡©e


310 #i 
the
 
¡©e
 
chage
 
äom
 
issued
 
to
 
·id


311 #!! 
TODO
: 
If
 
_Ï¡_¡©e
 =ğ'issued' 
ªd
 
£lf
.
¡©e
 == 'paid' || 'canceled'

312 #™ 
should
 
®so
 
be
 
checked
 
th©
 
the
 
Ùh”
 
f›lds
 
¬e
h
§me
 
bc
.

313 #righˆ
now
 
a
 
docum’t
 
ÿn
 
be
 
š
 
issued
 
¡©e
 
ªd
 
someÚe
 
could


314 #£nd 
a
 
»que¡
 
which
 
cÚšs
 
the
 
¡©e
 = '·id' 
ªd
 
®so
 
£nd


315 #Ùh” 
chªged
 
f›lds
 
ªd
 
the
 
»que¡
 
would
 
be
 
acû±ed
 
bc
. 
Úly


316 #th
¡©e
 
is
 
v”if›d
.

317 
£lf
.
_Ï¡_¡©e
 =ğ£lf.
STATES
.
ISSUED
 
ªd
\

318 
£lf
.
¡©e
 
nÙ
 
š
 [£lf.
STATES
.
PAID
, s–f.STATES.
CANCELED
]:

319 
msg
 = 'You cannotƒdithe document once it is in issued state.'

320 
¿i£
 
	`V®id©iÚE¼Ü
({
NON_FIELD_ERRORS
: 
msg
})

322 
£lf
.
_Ï¡_¡©e
 =ğ£lf.
STATES
.
CANCELED
:

323 
msg
 = 'You cannotƒdithe document once it is in canceled state.'

324 
¿i£
 
V®id©iÚE¼Ü
({
NON_FIELD_ERRORS
: 
msg
})

326 #Ià
™
' š…aid s‹ => dÚ'
t
 
®low
 
ªy
 
chªges


327 
£lf
.
_Ï¡_¡©e
 =ğ£lf.
STATES
.
PAID
:

328 
msg
 = 'You cannotƒdithe document once it is in…aid state.'

329 
¿i£
 
V®id©iÚE¼Ü
({
NON_FIELD_ERRORS
: 
msg
})

331 
£lf
.
Œª§ùiÚs
.
exşude
(
cu¼’cy
=£lf.
Œª§ùiÚ_cu¼’cy
).
	$exi¡s
():

332 
mes§ge
 = 'There‡re unfinishedransactions ofhis documenthat use‡ ' \

334 
¿i£
 
	`V®id©iÚE¼Ü
({'Œª§ùiÚ_cu¼’cy': 
mes§ge
})

336 
def
 
	$§ve
(
£lf
, *
¬gs
, **
kw¬gs
):

337 
nÙ
 
£lf
.
Œª§ùiÚ_cu¼’cy
:

338 
£lf
.
Œª§ùiÚ_cu¼’cy
 = s–f.
cu¡om”
.
cu¼’cy
 
Ü
 self.currency

340 
nÙ
 
£lf
.
£r›s
:

341 
£lf
.
£r›s
 = s–f.
deçuÉ_£r›s


343 #G’”©
the
 
numb”


344 
nÙ
 
£lf
.
numb”
 
ªd
 s–f.
¡©e
 !ğ
BlšgDocum’tBa£
.
STATES
.
DRAFT
:

345 
£lf
.
numb”
 = s–f.
	$_g’”©e_numb”
()

347 #Add 
x
 
šfo


348 
nÙ
 
£lf
.
§Ës_x_Çme
:

349 
£lf
.
§Ës_x_Çme
 = s–f.
cu¡om”
.sales_tax_name

350 
nÙ
 
£lf
.
§Ës_x_³rûÁ
:

351 
£lf
.
§Ës_x_³rûÁ
 = s–f.
cu¡om”
.sales_tax_percent

353 
£lf
.
_Ï¡_¡©e
 = s–f.
¡©e


355 
w™h
 
db_Œª§ùiÚ
.
	$©omic
():

356 #C»©
pdf
 
objeù


357 
nÙ
 
£lf
.
pdf
 
ªd
 s–f.
¡©e
 !ğ£lf.
STATES
.
DRAFT
:

358 
£lf
.
pdf
 = 
PDF
.
objeùs
.
	`ü—‹
(
u¶ßd_·th
=£lf.
	`g‘_pdf_u¶ßd_·th
(), 
dœty
=1)

360 
	`su³r
(
BlšgDocum’tBa£
, 
£lf
).
	$§ve
(*
¬gs
, **
kw¬gs
)

362 
def
 
	$_g’”©e_numb”
(
£lf
, 
deçuÉ_¡¬tšg_numb”
=1):

364 
deçuÉ_¡¬tšg_numb”
 = 
	$max
(
deçuÉ_¡¬tšg_numb”
, 1)

366 
docum’ts
 = 
£lf
.
__şass__
.
_deçuÉ_mªag”
.
	$f‹r
(

367 
´ovid”
=
£lf
.´ovid”, 
£r›s
=self.series

369 
nÙ
 
docum’ts
.
	$exi¡s
():

370 #AÀ
švoiû
/
´ofÜma
 
w™h
 
this
 
´ovid”
 
ªd
 
£r›s
 
dÛs
 
nÙ
 
exi¡


371 
£lf
.
£r›s
 =ğ£lf.
deçuÉ_£r›s
:

372  
£lf
.
_¡¬tšg_numb”


374  
deçuÉ_¡¬tšg_numb”


376 #AÀ
švoiû
 
w™h
 
this
 
´ovid”
 
ªd
 
£r›s
 
®»ady
 
exi¡s


377 
max_exi¡šg_numb”
 = 
docum’ts
.
	`agg»g©e
(

378 
	`Max
('number')

380 
max_exi¡šg_numb”
:

381 
£lf
.
_¡¬tšg_numb”
 
ªd
 s–f.
£r›s
 =ğ£lf.
deçuÉ_£r›s
:

382  
	`max
(
max_exi¡šg_numb”
 + 1, 
£lf
.
_¡¬tšg_numb”
)

384  
max_exi¡šg_numb”
 + 1

386  
deçuÉ_¡¬tšg_numb”


388 
def
 
	$£r›s_numb”
(
£lf
):

389 
£lf
.
£r›s
:

390 
£lf
.
numb”
:

391  "%s-%d" % (
£lf
.
£r›s
, s–f.
numb”
)

393  "%s-d¿á-id:%d" % (
£lf
.
£r›s
, s–f.
pk
)

396  "d¿á-id:%d" % 
£lf
.
pk


398 
£r›s_numb”
.
shÜt_desütiÚ
 = 'Number'

399 
£r›s_numb”
 = 
	$´İ”ty
(
£r›s_numb”
)

401 
def
 
	$__unicode__
(
£lf
):

402  
u
'% % => % [%.2à%s]' % (
£lf
.
£r›s_numb”
,

403 
£lf
.
´ovid”
.
blšg_Çme
,

404 
£lf
.
cu¡om”
.
blšg_Çme
,

405 
£lf
.
tÙ®
, s–f.
cu¼’cy
)

407 @
´İ”ty


408 
def
 
	$upd©—bË_f›lds
(
£lf
):

413 @
´İ”ty


414 
def
 
	$admš_chªge_u¾
(
£lf
):

415 
u¾_ba£
 = 'admš:{­p_Ïb–}_{kÏss}_chªge'.
	`fÜm©
(

416 
­p_Ïb–
=
£lf
.
_m‘a
.app_label,

417 
kÏss
=
£lf
.
__şass__
.
__Çme__
.
	$low”
())

418 
u¾
 = 
	`»v”£
(
u¾_ba£
, 
¬gs
=(
£lf
.
pk
,))

419  '<¨h»f="{u¾}">{di¥Ïy_£r›s}</a>'.
	`fÜm©
(

420 
u¾
=u¾, 
di¥Ïy_£r›s
=
£lf
.
£r›s_numb”
)

422 @
´İ”ty


423 
def
 
	$_’Œ›s
(
£lf
):

424 #’Œ› 
™”©Ü
 
which
 
»¶aûs
 
the
 
švoiû
/
´ofÜma
 
äom
h
DB
 
w™h


425 #£lf. 
We
 
Ãed
 
this
 
š
 
g’”©e_pdf
 
so
 
th©
 
the
 
d©a
 iÀ
PDF
 
has
he

426 #Ï¡e¡ 
¡©e
 
the
 
docum’t
. 
W™hout
 
this
 
we
 
g‘
 
š
 
‹m¶©e
:

427 #
#švoiû.
issue_d©e
 !ğ
’Œy
.
švoiû
.issue_date

429 #
#which 
is
 
obviou¦y
 
çl£
.

431 
docum’t_ty³_Çme
 = 
£lf
.
__şass__
.
__Çme__
 #Invoiû 
Ü
 
ProfÜma


432 
kw¬gs
 = {
docum’t_ty³_Çme
.
	`low”
(): 
£lf
}

433 
’Œ›s
 = 
Docum’tEÁry
.
objeùs
.
	$f‹r
(**
kw¬gs
)

434 
’Œy
 
š
 
’Œ›s
:

435 
docum’t_ty³_Çme
.
	`low”
() == 'invoice':

436 
’Œy
.
švoiû
 = 
£lf


437 
docum’t_ty³_Çme
.
	`low”
() == 'proforma':

438 
’Œy
.
´ofÜma
 = 
£lf


439 
	$y›ld
(
’Œy
)

441 
def
 
	$g‘_‹m¶©e_cÚ‹xt
(
£lf
, 
¡©e
=
NÚe
):

442 
cu¡om”
 = 
	$Cu¡om”
(**
£lf
.
¬chived_cu¡om”
)

443 
´ovid”
 = 
	$Provid”
(**
£lf
.
¬chived_´ovid”
)

444 
¡©e
 
is
 
NÚe
:

445 
¡©e
 = 
£lf
.state

448 'docum’t': 
£lf
,

449 '´ovid”': 
´ovid”
,

450 'cu¡om”': 
cu¡om”
,

451 '’Œ›s': 
£lf
.
_’Œ›s
,

452 '¡©e': 
¡©e


453 
	}
}

455 
def
 
	$g‘_‹m¶©e
(
£lf
, 
¡©e
=
NÚe
):

456 
´ovid”_¡©e_‹m¶©e
 = '{´ovid”}/{kšd}_{¡©e}_pdf.html'.
	`fÜm©
(

457 
kšd
=
£lf
.kšd, 
´ovid”
=£lf.´ovid”.
¦ug
, 
¡©e
=¡©e).
	$low”
()

458 
´ovid”_‹m¶©e
 = '{´ovid”}/{kšd}_pdf.html'.
	`fÜm©
(

459 
kšd
=
£lf
.kšd, 
´ovid”
=£lf.´ovid”.
¦ug
).
	$low”
()

460 
g’”ic_¡©e_‹m¶©e
 = '{kšd}_{¡©e}_pdf.html'.
	`fÜm©
(

461 
kšd
=
£lf
.kšd, 
¡©e
=¡©e).
	$low”
()

462 
g’”ic_‹m¶©e
 = '{kšd}_pdf.html'.
	`fÜm©
(

463 
kšd
=
£lf
.kšd).
	$low”
()

464 
_‹m¶©es
 = [
´ovid”_¡©e_‹m¶©e
, 
´ovid”_‹m¶©e
,

465 
g’”ic_¡©e_‹m¶©e
, 
g’”ic_‹m¶©e
]

467 
‹m¶©es
 = []

468 
t
 
š
 
_‹m¶©es
:

469 
‹m¶©es
.
	`­³nd
('blšg_docum’ts/' + 
t
)

471  
	$£Ëù_‹m¶©e
(
‹m¶©es
)

473 
def
 
	$g‘_pdf_f’ame
(
£lf
):

474  '{doc_ty³}_{£r›s}-{numb”}.pdf'.
	$fÜm©
(

475 
doc_ty³
=
£lf
.
__şass__
.
__Çme__
,

476 
£r›s
=
£lf
.series,

477 
numb”
=
£lf
.number

480 
def
 
	$g‘_pdf_u¶ßd_·th
(
£lf
):

481 
·th_‹m¶©e
 = 
	`g‘©Œ
(

482 
£‰šgs
, 'SILVER_DOCUMENT_UPLOAD_PATH',

486 
cÚ‹xt
 = {

487 'doc': 
£lf
,

488 'f’ame': 
£lf
.
	`g‘_pdf_f’ame
(),

489 '´ovid”': 
£lf
.
´ovid”
.
¦ug
,

490 'cu¡om”': 
£lf
.
cu¡om”
.
¦ug
,

491 'issue_d©e': 
£lf
.
issue_d©e
.
	`¡ráime
('%Y/%m/%d')

492 
	}
}

494  
·th_‹m¶©e
.
	$fÜm©
(**
cÚ‹xt
)

496 
def
 
	$g’”©e_pdf
(
£lf
, 
¡©e
=
NÚe
, 
u¶ßd
=
True
):

497 #!!! 
’su»
 
this
 
is
 
nÙ
 
ÿÎed
 
cÚcu¼’y
 
the
 
§me
 
docum’t


499 
cÚ‹xt
 = 
£lf
.
	$g‘_‹m¶©e_cÚ‹xt
(
¡©e
)

500 
cÚ‹xt
['f’ame'] = 
£lf
.
	$g‘_pdf_f’ame
()

502 
pdf_fe_objeù
 = 
£lf
.
pdf
.
	`g’”©e
(
‹m¶©e
=£lf.
	`g‘_‹m¶©e
(
¡©e
),

503 
cÚ‹xt
=context,

504 
u¶ßd
=upload)

506  
pdf_fe_objeù


508 
def
 
	$g’”©e_html
(
£lf
, 
¡©e
=
NÚe
, 
»que¡
=None):

509 
cÚ‹xt
 = 
£lf
.
	$g‘_‹m¶©e_cÚ‹xt
(
¡©e
)

510 
‹m¶©e
 = 
£lf
.
	`g‘_‹m¶©e
(
¡©e
=
cÚ‹xt
['state'])

512  
‹m¶©e
.
	$»nd”
(
cÚ‹xt
, 
»que¡
)

514 
def
 
	$£rŸlize_hook
(
£lf
, 
hook
):

516 
U£d
 
to
 
g’”©e
 
a
 
skšny
 
·ylßd
.

520 'hook': 
hook
.
	`diù
(),

522 'id': 
£lf
.
id


524 
	}
}

526 @
´İ”ty


527 
def
 
	$’Œ›s
(
£lf
):

528 
¿i£
 
NÙIm¶em’‹dE¼Ü


530 @
´İ”ty


531 
def
 
	$tÙ®
(
£lf
):

532 
£lf
.
_tÙ®
 
is
 
nÙ
 
NÚe
:

533  
£lf
.
_tÙ®


535  
	`sum
([
’Œy
.
tÙ®
 ’Œy 
š
 
£lf
.
’Œ›s
])

537 @
´İ”ty


538 
def
 
	$tÙ®_befÜe_x
(
£lf
):

539  
	`sum
([
’Œy
.
tÙ®_befÜe_x
 ’Œy 
š
 
£lf
.
’Œ›s
])

541 @
´İ”ty


542 
def
 
	$x_v®ue
(
£lf
):

543  
	`sum
([
’Œy
.
x_v®ue
 ’Œy 
š
 
£lf
.
’Œ›s
])

545 @
´İ”ty


546 
def
 
	$tÙ®_š_Œª§ùiÚ_cu¼’cy
(
£lf
):

547 
£lf
.
_tÙ®_š_Œª§ùiÚ_cu¼’cy
 
is
 
nÙ
 
NÚe
:

548  
£lf
.
_tÙ®_š_Œª§ùiÚ_cu¼’cy


550  
	`sum
([
’Œy
.
tÙ®_š_Œª§ùiÚ_cu¼’cy


551 
’Œy
 
š
 
£lf
.
’Œ›s
])

553 @
´İ”ty


554 
def
 
	$tÙ®_befÜe_x_š_Œª§ùiÚ_cu¼’cy
(
£lf
):

555  
	`sum
([
’Œy
.
tÙ®_befÜe_x_š_Œª§ùiÚ_cu¼’cy


556 
’Œy
 
š
 
£lf
.
’Œ›s
])

558 @
´İ”ty


559 
def
 
	$x_v®ue_š_Œª§ùiÚ_cu¼’cy
(
£lf
):

560  
	`sum
([
’Œy
.
x_v®ue_š_Œª§ùiÚ_cu¼’cy


561 
’Œy
 
š
 
£lf
.
’Œ›s
])

563 @
´İ”ty


564 
def
 
	$amouÁ_·id_š_Œª§ùiÚ_cu¼’cy
(
£lf
):

565 
T¿n§ùiÚ
 = 
­ps
.
	`g‘_mod–
('silver.Transaction')

567  
	`sum
([
Œª§ùiÚ
.
amouÁ


568 
Œª§ùiÚ
 
š
 
£lf
.
Œª§ùiÚs
.
	`f‹r
(
¡©e
=
T¿n§ùiÚ
.
S‹s
.
S‘ed
)])

570 @
´İ”ty


571 
def
 
	$amouÁ_³ndšg_š_Œª§ùiÚ_cu¼’cy
(
£lf
):

572 
T¿n§ùiÚ
 = 
­ps
.
	`g‘_mod–
('silver.Transaction')

574  
	`sum
([
Œª§ùiÚ
.
amouÁ


575 
Œª§ùiÚ
 
š
 
£lf
.
Œª§ùiÚs
.
	`f‹r
(
¡©e
=
T¿n§ùiÚ
.
S‹s
.
P’dšg
)])

577 @
´İ”ty


578 
def
 
	$amouÁ_to_be_ch¬ged_š_Œª§ùiÚ_cu¼’cy
(
£lf
):

579 
T¿n§ùiÚ
 = 
­ps
.
	`g‘_mod–
('silver.Transaction')

581  
£lf
.
tÙ®_š_Œª§ùiÚ_cu¼’cy
 - 
	`sum
([

582 
Œª§ùiÚ
.
amouÁ


583 
Œª§ùiÚ
 
š
 
£lf
.
Œª§ùiÚs
.
	`f‹r
(
¡©e__š
=[

584 
T¿n§ùiÚ
.
S‹s
.
In™Ÿl
,

585 
T¿n§ùiÚ
.
S‹s
.
P’dšg
,

586 
T¿n§ùiÚ
.
S‹s
.
S‘ed


591 
def
 
	$ü—‹_Œª§ùiÚ_fÜ_docum’t
(
docum’t
):

592 #g‘ 
a
 
u§bË
, 
»cu¼šg
 
·ym’t_m‘hod
 
the
 
cu¡om”


593 
Paym’tM‘hod
 = 
­ps
.
	`g‘_mod–
('silver.PaymentMethod')

594 
T¿n§ùiÚ
 = 
­ps
.
	`g‘_mod–
('silver.Transaction')

596 
·ym’t_m‘hods
 = 
Paym’tM‘hod
.
objeùs
.
	$f‹r
(

597 
ÿnûËd
=
F®£
,

598 
v”if›d
=
True
,

599 
cu¡om”
=
docum’t
.customer

601 
·ym’t_m‘hod
 
š
 
·ym’t_m‘hods
:

602 
Œy
:

603  
T¿n§ùiÚ
.
objeùs
.
	$ü—‹
(
docum’t
=document,

604 
·ym’t_m‘hod
=payment_method)

605 
exû±
 
V®id©iÚE¼Ü
:

609 @
	$»ûiv”
(
po¡_Œªs™iÚ
)

610 
def
 
	$po¡_Œªs™iÚ_ÿÎback
(
£nd”
, 
š¡ªû
, 
Çme
, 
sourû
, 
rg‘
, **
kw¬gs
):

611 
nÙ
 
	$isš¡ªû
(
š¡ªû
, 
BlšgDocum’tBa£
):

614 
docum’t
 = 
š¡ªû


615 
	`£‰r
(
docum’t
, '.»ûÁly_Œªs™iÚed', 
rg‘
)

617 
docum’t
.
	`§ve
()

620 @
	$»ûiv”
(
po¡_§ve
)

621 
def
 
	$po¡_docum’t_§ve
(
£nd”
, 
š¡ªû
, 
ü—‹d
=
F®£
, **
kw¬gs
):

622 
nÙ
 
	$isš¡ªû
(
š¡ªû
, 
BlšgDocum’tBa£
):

625 
docum’t
 = 
š¡ªû


627 
nÙ
 
	`ha§‰r
(
docum’t
, '.recently_transitioned'):

630 #Th
docum’t
 
has
 
b“n
 
Œªs™iÚed
 
befÜe
 
bešg
 
§ved


631 
	`d–©Œ
(
docum’t
, '.recently_transitioned')

633 #T¿ns™iÚ 
»Ï‹d
 
docum’t
 
too
, 
Ãeded


634 
docum’t
.
	$sync_»Ï‹d_docum’t_¡©e
()

636 #C»©
a
 
Œª§ùiÚ
 
the
 
docum’t
 
was
 
»ûÁly
 
issued


637 ià(
docum’t
.
¡©e
 =ğ
BlšgDocum’tBa£
.
STATES
.
ISSUED
 
ªd


638 
£‰šgs
.
SILVER_AUTOMATICALLY_CREATE_TRANSACTIONS
):

639 #Buˆ
Úly
 
th”e
 
is
 
no
 
³ndšg
 
Œª§ùiÚ


640 
T¿n§ùiÚ
 = 
­ps
.
	`g‘_mod–
('silver', 'Transaction')

642 #Th
»Ï‹d
 
docum’t
 
might
 
have
 
the
 
Úly
 
»ã»nû
 
to
 
ª
 
exi¡šg
 
Œª§ùiÚ


643 
	`nÙ
 (
docum’t
.
»Ï‹d_docum’t
 
Ü
 docum’t).
Œª§ùiÚs
.
	$f‹r
(

644 
¡©e__š
=[
T¿n§ùiÚ
.
S‹s
.
P’dšg
,

645 
T¿n§ùiÚ
.
S‹s
.
In™Ÿl
,

646 
T¿n§ùiÚ
.
S‹s
.
S‘ed
]

648 
	$ü—‹_Œª§ùiÚ_fÜ_docum’t
(
docum’t
)

650 #G’”©
a
 
PDF


651 
docum’t
.
	`m¬k_fÜ_g’”©iÚ
()

	@silver/models/documents/entries.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
äom
 
decim®
 
impÜt
 
Decim®


18 
äom
 
	gdjªgo
.
	gcÜe
.
v®id©Üs
 
impÜt
 
MšV®ueV®id©Ü


19 
äom
 
	gdjªgo
.
db
 
impÜt
 
mod–s


22 
şass
 
	$Docum’tEÁry
(
mod–s
.
Mod–
):

23 
desütiÚ
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=1024)

24 
un™
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=1024, 
bÏnk
=
True
, 
nuÎ
=True)

25 
quªt™y
 = 
mod–s
.
	`Decim®F›ld
(
max_dig™s
=19, 
decim®_¶aûs
=4,

26 
v®id©Üs
=[
	`MšV®ueV®id©Ü
(0.0)])

27 
un™_´iû
 = 
mod–s
.
	$Decim®F›ld
(
max_dig™s
=19, 
decim®_¶aûs
=4)

28 
´oduù_code
 = 
mod–s
.
	`FÜeignKey
('ProduùCode', 
nuÎ
=
True
, 
bÏnk
=True,

29 
»Ï‹d_Çme
='invoices')

30 
¡¬t_d©e
 = 
mod–s
.
	$D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)

31 
’d_d©e
 = 
mod–s
.
	$D©eF›ld
(
nuÎ
=
True
, 
bÏnk
=True)

32 
´Ü©ed
 = 
mod–s
.
	$BoŞ—nF›ld
(=
F®£
)

33 
švoiû
 = 
mod–s
.
	`FÜeignKey
('BlšgDocum’tBa£', 
»Ï‹d_Çme
='invoice_entries',

34 
bÏnk
=
True
, 
nuÎ
=True)

35 
´ofÜma
 = 
mod–s
.
	`FÜeignKey
('BlšgDocum’tBa£', 
»Ï‹d_Çme
='proforma_entries',

36 
bÏnk
=
True
, 
nuÎ
=True)

38 
şass
 
M‘a
:

39 
v”bo£_Çme
 = 'Entry'

40 
v”bo£_Çme_¶u¿l
 = 'Entries'

42 @
´İ”ty


43 
def
 
	$docum’t
(
£lf
):

44  
£lf
.
švoiû
 
Ü
 s–f.
´ofÜma


46 @
´İ”ty


47 
def
 
	$tÙ®
(
£lf
):

48  
£lf
.
tÙ®_befÜe_x
 + s–f.
x_v®ue


50 @
´İ”ty


51 
def
 
	$tÙ®_befÜe_x
(
£lf
):

52 
»suÉ
 = 
	$Decim®
(
£lf
.
quªt™y
 * s–f.
un™_´iû
)

53  
»suÉ
.
	`quªtize
(
	`Decim®
('0.00'))

55 @
´İ”ty


56 
def
 
	$x_v®ue
(
£lf
):

57 
£lf
.
švoiû
:

58 
§Ës_x_³rûÁ
 = 
£lf
.
švoiû
.sales_tax_percent

59 
–if
 
£lf
.
´ofÜma
:

60 
§Ës_x_³rûÁ
 = 
£lf
.
´ofÜma
.sales_tax_percent

62 
§Ës_x_³rûÁ
 = 
NÚe


64 
nÙ
 
§Ës_x_³rûÁ
:

65  
	`Decim®
('0.00')

67 
»suÉ
 = 
£lf
.
tÙ®_befÜe_x
 * 
§Ës_x_³rûÁ
 / 100

68  
»suÉ
.
	`quªtize
(
	`Decim®
('0.00'))

70 @
´İ”ty


71 
def
 
	$tÙ®_š_Œª§ùiÚ_cu¼’cy
(
£lf
):

72  (
£lf
.
tÙ®_befÜe_x_š_Œª§ùiÚ_cu¼’cy
 +

73 
£lf
.
x_v®ue_š_Œª§ùiÚ_cu¼’cy
)

75 @
´İ”ty


76 
def
 
	$tÙ®_befÜe_x_š_Œª§ùiÚ_cu¼’cy
(
£lf
):

77 
»suÉ
 = 
£lf
.
tÙ®_befÜe_x
 * s–f.
docum’t
.
Œª§ùiÚ_xe_¿‹


78  
»suÉ
.
	`quªtize
(
	`Decim®
('0.00'))

80 @
´İ”ty


81 
def
 
	$un™_´iû_š_Œª§ùiÚ_cu¼’cy
(
£lf
):

82 
»suÉ
 = 
	`Decim®
(
£lf
.
un™_´iû
è* s–f.
docum’t
.
Œª§ùiÚ_xe_¿‹


83  
»suÉ
.
	`quªtize
(
	`Decim®
('0.0000'))

85 @
´İ”ty


86 
def
 
	$x_v®ue_š_Œª§ùiÚ_cu¼’cy
(
£lf
):

87 
»suÉ
 = 
£lf
.
x_v®ue
 * s–f.
docum’t
.
Œª§ùiÚ_xe_¿‹


88  
»suÉ
.
	`quªtize
(
	`Decim®
('0.00'))

90 
def
 
	$şÚe
(
£lf
):

91  
	$Docum’tEÁry
(

92 
desütiÚ
=
£lf
.description,

93 
un™
=
£lf
.unit,

94 
quªt™y
=
£lf
.quantity,

95 
un™_´iû
=
£lf
.unit_price,

96 
´oduù_code
=
£lf
.product_code,

97 
¡¬t_d©e
=
£lf
.start_date,

98 
’d_d©e
=
£lf
.end_date,

99 
´Ü©ed
=
£lf
.prorated

102 
def
 
	$__unicode__
(
£lf
):

103 
s
 = 
u
'{descr} - {unit} - {unit_price} - {quantity} - {product_code}'

104  
s
.
	`fÜm©
(

105 
desü
=
£lf
.
desütiÚ
,

106 
un™
=
£lf
.unit,

107 
un™_´iû
=
£lf
.unit_price,

108 
quªt™y
=
£lf
.quantity,

109 
´oduù_code
=
£lf
.product_code

	@silver/models/documents/invoice.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
äom
 
djªgo_fsm
 
impÜt
 
	gT¿ns™iÚNÙAÎowed
, 
Œªs™iÚ


18 
äom
 
	gdjªgo
.
db
 
impÜt
 
mod–s


19 
äom
 
	gdjªgo
.
­ps
 
impÜt
‡pps

20 
äom
 
	gdjªgo
.
	gdb
.
	gmod–s
.
sigÇls
 
impÜt
 
	g´e_d–‘e
, 
po¡_§ve


21 
äom
 
	gdjªgo
.
di¥©ch
 
impÜt
 
»ûiv”


23 
	gäom
 .
ba£
 
impÜt
 
	gBlšgDocum’tBa£
, 
	gBlšgDocum’tMªag”
, 
BlšgDocum’tQu”yS‘


24 
äom
 
	gsv”
.
	gmod–s
.
blšg_’t™›s
 
impÜt
 
Provid”


27 
şass
 
	$InvoiûMªag”
(
BlšgDocum’tMªag”
):

28 
def
 
	$g‘_qu”y£t
(
£lf
):

29 
qu”y£t
 = 
	`su³r
(
BlšgDocum’tMªag”
, 
£lf
).
	$g‘_qu”y£t
()

30  
qu”y£t
.
	`f‹r
(
kšd
='švoiû').
	`´eãtch_»Ï‹d
('invoice_entries__product_code')

33 
şass
 
	$Invoiû
(
BlšgDocum’tBa£
):

34 
objeùs
 = 
InvoiûMªag”
.
	$äom_qu”y£t
(
BlšgDocum’tQu”yS‘
)()

36 
şass
 
M‘a
:

37 
´oxy
 = 
True


39 
def
 
	$__š™__
(
£lf
, *
¬gs
, **
kw¬gs
):

40 
	`su³r
(
Invoiû
, 
£lf
).
	$__š™__
(*
¬gs
, **
kw¬gs
)

42 
´ovid”_f›ld
 = 
£lf
.
_m‘a
.
	`g‘_f›ld
("provider")

43 
´ovid”_f›ld
.
»Ï‹d_Çme
 = "invoices"

45 
cu¡om”_f›ld
 = 
£lf
.
_m‘a
.
	`g‘_f›ld
("customer")

46 
cu¡om”_f›ld
.
»Ï‹d_Çme
 = "invoices"

48 @
´İ”ty


49 
def
 
	$Œª§ùiÚs
(
£lf
):

50  
£lf
.
švoiû_Œª§ùiÚs
.
	`®l
()

52 @
	`Œªs™iÚ
(
f›ld
='¡©e', 
sourû
=
BlšgDocum’tBa£
.
STATES
.
DRAFT
,

53 
rg‘
=
BlšgDocum’tBa£
.
STATES
.
ISSUED
)

54 
def
 
	$issue
(
£lf
, 
issue_d©e
=
NÚe
, 
due_d©e
=None):

55 
£lf
.
¬chived_´ovid”
 = s–f.
´ovid”
.
	$g‘_švoiû_¬chivabË_f›ld_v®ues
()

57 
	`su³r
(
Invoiû
, 
£lf
).
	`_issue
(
issue_d©e
, 
due_d©e
)

59 @
´İ”ty


60 
def
 
	$_¡¬tšg_numb”
(
£lf
):

61  
£lf
.
´ovid”
.
švoiû_¡¬tšg_numb”


63 @
´İ”ty


64 
def
 
	$deçuÉ_£r›s
(
£lf
):

65 
Œy
:

66  
£lf
.
´ovid”
.
švoiû_£r›s


67 
exû±
 
Provid”
.
DÛsNÙExi¡
:

70 @
´İ”ty


71 
def
 
	$’Œ›s
(
£lf
):

72  
£lf
.
švoiû_’Œ›s
.
	`®l
()

75 @
	$»ûiv”
(
´e_d–‘e
, 
£nd”
=
Invoiû
)

76 
def
 
	$d–‘e_švoiû_pdf_äom_¡Üage
(
£nd”
, 
š¡ªû
, **
kw¬gs
):

77 
š¡ªû
.
pdf
:

78 #D–‘
the
 
švoiû
's PDF file

79 
š¡ªû
.
pdf
.
pdf_fe
.
	`d–‘e
(
F®£
)

82 @
	$»ûiv”
(
po¡_§ve
, 
£nd”
=
Invoiû
)

83 
def
 
	$po¡_švoiû_§ve
(
£nd”
, 
š¡ªû
, 
ü—‹d
=
F®£
, **
kw¬gs
):

84 
nÙ
 
ü—‹d
:

87 
T¿n§ùiÚ
 = 
­ps
.
	`g‘_mod–
('silver.Transaction')

88 
švoiû
 = 
š¡ªû


89 
´ofÜma
 = 
švoiû
.
»Ï‹d_docum’t


91 
´ofÜma
:

92 
T¿n§ùiÚ
.
objeùs
.
	`f‹r
(
´ofÜma
õrofÜma).
	`upd©e
(
švoiû
=invoice)

	@silver/models/documents/pdf.py

1 
impÜt
 
uuid


3 
äom
 
xhtml2pdf
 
impÜt
 
pi§


5 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


6 
äom
 
	gdjªgo
.
	gcÜe
.
	gfes
.
ba£
 
impÜt
 
CÚ‹ÁFe


7 
äom
 
	gdjªgo
.
db
 
impÜt
 
Œª§ùiÚ


8 
äom
 
	gdjªgo
.
	gdb
.
mod–s
 
impÜt
 
	gMod–
, 
	gFeF›ld
, 
	gTextF›ld
, 
	gUUIDF›ld
, 
	gPos™iveIÁeg”F›ld
, 
F


9 
äom
 
	gdjªgo
.
h‰p
 
impÜt
 
H‰pRe¥Ú£


10 
äom
 
	gdjªgo
.
	guts
.
moduË_lßdšg
 
impÜt
 
impÜt_¡ršg


12 
äom
 
	gsv”
.
	guts
.
pdf
 
impÜt
 
ãtch_»sourûs


15 
def
 
	$g‘_¡Üage
():

16 
¡Üage_£‰šgs
 = 
	`g‘©Œ
(
£‰šgs
, 'SILVER_DOCUMENT_STORAGE', 
NÚe
)

17 
nÙ
 
¡Üage_£‰šgs
:

20 
¡Üage_şass
 = 
	$impÜt_¡ršg
(
¡Üage_£‰šgs
[0])

21  
	$¡Üage_şass
(*
¡Üage_£‰šgs
[1], **storage_settings[2])

24 
def
 
	$g‘_u¶ßd_·th
(
š¡ªû
, 
f’ame
):

25  
š¡ªû
.
u¶ßd_·th


28 
şass
 
	$PDF
(
Mod–
):

29 
uuid
 = 
	$UUIDF›ld
(=
uuid
.
uuid4
, 
unique
=
True
)

30 
pdf_fe
 = 
	`FeF›ld
(
nuÎ
=
True
, 
bÏnk
=True, 
ed™abË
=
F®£
,

31 
¡Üage
=
	`g‘_¡Üage
(), 
u¶ßd_to
=
g‘_u¶ßd_·th
)

32 
dœty
 = 
	$Pos™iveIÁeg”F›ld
(=0)

33 
u¶ßd_·th
 = 
	`TextF›ld
(
nuÎ
=
True
, 
bÏnk
=True)

35 @
´İ”ty


36 
def
 
	$u¾
(
£lf
):

37  
£lf
.
pdf_fe
.
u¾
 £lf.pdf_f
NÚe


39 
def
 
	$g’”©e
(
£lf
, 
‹m¶©e
, 
cÚ‹xt
, 
u¶ßd
=
True
):

40 
pdf_fe_objeù
 = 
	`H‰pRe¥Ú£
(
cÚ‹Á_ty³
='application/pdf')

42 
html
 = 
‹m¶©e
.
	$»nd”
(
cÚ‹xt
)

43 
pi§
.
	`pi§Docum’t
(
¤c
=
html
.
	`’code
("UTF-8"),

44 
de¡
=
pdf_fe_objeù
,

45 
’codšg
='UTF-8',

46 
lšk_ÿÎback
=
ãtch_»sourûs
)

48 
nÙ
 
pdf_fe_objeù
:

51 
u¶ßd
:

52 
£lf
.
	`u¶ßd
(
pdf_fe_objeù
õdf_fe_objeù, 
f’ame
=
cÚ‹xt
['filename'])

54 
£lf
.
	$m¬k_as_ş—n
()

56  
pdf_fe_objeù


58 
def
 
	$u¶ßd
(
£lf
, 
pdf_fe_objeù
, 
f’ame
):

59 #th
PDF
's upload_path‡ttribute‚eedso be set before callinghis method

61 
pdf_cÚ‹Á
 = 
	$CÚ‹ÁFe
(
pdf_fe_objeù
)

63 
£lf
.
pdf_fe
.
	$§ve
(
f’ame
, 
pdf_cÚ‹Á
, 
True
)

65 
def
 
	$m¬k_as_dœty
(
£lf
):

66 
w™h
 
Œª§ùiÚ
.
	$©omic
():

67 
PDF
.
objeùs
.
	`f‹r
(
id
=
£lf
.id).
	`upd©e
(
dœty
=
	`F
('dirty') + 1)

68 
£lf
.
	`»äesh_äom_db
(
f›lds
=['dirty'])

70 
def
 
	$m¬k_as_ş—n
(
£lf
):

71 
PDF
.
objeùs
.
	`f‹r
(
id
=
£lf
.id).
	`upd©e
(
dœty
=
	`F
('dirty') - self.dirty)

	@silver/models/documents/proforma.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
äom
 
djªgo_fsm
 
impÜt
 
Œªs™iÚ


18 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
V®id©iÚE¼Ü


19 
äom
 
	gdjªgo
.
	gdb
.
	gmod–s
.
sigÇls
 
impÜt
 
´e_d–‘e


20 
äom
 
	gdjªgo
.
di¥©ch
 
impÜt
 
»ûiv”


22 
	gäom
 .
ba£
 
impÜt
 
	gBlšgDocum’tBa£
, 
	gBlšgDocum’tMªag”
, 
BlšgDocum’tQu”yS‘


23 
	gäom
 .
’Œ›s
 
impÜt
 
Docum’tEÁry


24 
	gäom
 .
švoiû
 
impÜt
 
Invoiû


25 
äom
 
	gsv”
.
	gmod–s
.
blšg_’t™›s
 
impÜt
 
Provid”


28 
şass
 
	$ProfÜmaMªag”
(
BlšgDocum’tMªag”
):

29 
def
 
	$g‘_qu”y£t
(
£lf
):

30 
qu”y£t
 = 
	`su³r
(
BlšgDocum’tMªag”
, 
£lf
).
	$g‘_qu”y£t
()

31  
qu”y£t
.
	`f‹r
(
kšd
='´ofÜma').
	`´eãtch_»Ï‹d
('proforma_entries__product_code',

35 
şass
 
	$ProfÜma
(
BlšgDocum’tBa£
):

36 
objeùs
 = 
ProfÜmaMªag”
.
	$äom_qu”y£t
(
BlšgDocum’tQu”yS‘
)()

38 
şass
 
M‘a
:

39 
´oxy
 = 
True


41 
def
 
	$__š™__
(
£lf
, *
¬gs
, **
kw¬gs
):

42 
	`su³r
(
ProfÜma
, 
£lf
).
	$__š™__
(*
¬gs
, **
kw¬gs
)

44 
´ovid”_f›ld
 = 
£lf
.
_m‘a
.
	`g‘_f›ld
("provider")

45 
´ovid”_f›ld
.
»Ï‹d_Çme
 = "proformas"

47 
cu¡om”_f›ld
 = 
£lf
.
_m‘a
.
	`g‘_f›ld
("customer")

48 
cu¡om”_f›ld
.
»Ï‹d_Çme
 = "proformas"

50 @
´İ”ty


51 
def
 
	$Œª§ùiÚs
(
£lf
):

52  
£lf
.
´ofÜma_Œª§ùiÚs
.
	$®l
()

54 
def
 
	$ş—n
(
£lf
):

55 
	`su³r
(
ProfÜma
, 
£lf
).
	$ş—n
()

56 
nÙ
 
£lf
.
£r›s
:

57 
nÙ
 
	`ha§‰r
(
£lf
, 'provider'):

58 #th
ş—n
 
m‘hod
 
is
 
ÿÎed
 
ev’
 
the
 
ş—n_f›lds
 method

59 #¿i£ 
exû±iÚs
, 
to
 
we
 
check
 
the
 
´ovid”
 
was
 
¥ecif›d


60 
·ss


61 
–if
 
nÙ
 
£lf
.
´ovid”
.
´ofÜma_£r›s
:

62 
”r_msg
 = {'series': 'You mustƒither specifyhe series or '

64 '´ovid”.'
	}
}

65 
¿i£
 
V®id©iÚE¼Ü
(
”r_msg
)

67 @
Œªs™iÚ
(
f›ld
='¡©e', 
sourû
=
BlšgDocum’tBa£
.
STATES
.
DRAFT
,

68 
rg‘
=
BlšgDocum’tBa£
.
STATES
.
ISSUED
)

69 
def
 
	$issue
(
£lf
, 
issue_d©e
=
NÚe
, 
due_d©e
=None):

70 
£lf
.
¬chived_´ovid”
 = s–f.
´ovid”
.
	$g‘_´ofÜma_¬chivabË_f›ld_v®ues
()

72 
	`su³r
(
ProfÜma
, 
£lf
).
	`_issue
(
issue_d©e
, 
due_d©e
)

74 @
	`Œªs™iÚ
(
f›ld
='¡©e', 
sourû
=
BlšgDocum’tBa£
.
STATES
.
ISSUED
,

75 
rg‘
=
BlšgDocum’tBa£
.
STATES
.
PAID
)

76 
def
 
	$·y
(
£lf
, 
·id_d©e
=
NÚe
):

77 
	`su³r
(
ProfÜma
, 
£lf
).
	$_·y
(
·id_d©e
)

79 
nÙ
 
£lf
.
»Ï‹d_docum’t
:

80 
£lf
.
»Ï‹d_docum’t
 = s–f.
	$_Ãw_švoiû
()

81 
£lf
.
»Ï‹d_docum’t
.
	$issue
()

82 
£lf
.
»Ï‹d_docum’t
.
	$·y
(
·id_d©e
=paid_date)

84 #ià
the
 
´ofÜma
 
is
 
·id
,h
švoiû
 
due_d©e
 
should
 
be
 
issue_d©e


85 
£lf
.
»Ï‹d_docum’t
.
due_d©e
 = s–f.»Ï‹d_docum’t.
issue_d©e


87 
£lf
.
»Ï‹d_docum’t
.
	$§ve
()

88 
£lf
.
	$§ve
()

90 
def
 
	$ü—‹_švoiû
(
£lf
):

91 
£lf
.
¡©e
 !ğ
BlšgDocum’tBa£
.
STATES
.
ISSUED
:

92 
¿i£
 
	`V®ueE¼Ü
("You can't create‡n invoice from‡ %s…roforma, "

93 "Úly from‡Àissued oÃ" % 
£lf
.
¡©e
)

95 
£lf
.
»Ï‹d_docum’t
:

96 
¿i£
 
	`V®ueE¼Ü
("This…roforma‡lready has‡n invoice { %s }"

97 % 
£lf
.
»Ï‹d_docum’t
)

99 
£lf
.
»Ï‹d_docum’t
 = s–f.
	$_Ãw_švoiû
()

100 
£lf
.
»Ï‹d_docum’t
.
	$issue
()

102 
£lf
.
	$§ve
()

104  
£lf
.
»Ï‹d_docum’t


106 
def
 
	$_Ãw_švoiû
(
£lf
):

107 #G’”©
the
 
Ãw
 
švoiû
 
ba£d
 
this
 
´ofÜma


108 
švoiû_f›lds
 = 
£lf
.
f›lds_fÜ_autom©ic_švoiû_g’”©iÚ


109 
švoiû_f›lds
.
	`upd©e
({'»Ï‹d_docum’t': 
£lf
})

110 
švoiû
 = 
Invoiû
.
objeùs
.
	$ü—‹
(**
švoiû_f›lds
)

112 #FÜ 
®l
 
the
 
’Œ›s
 
š
h
´ofÜma
 => 
add
h
lšk
 
to
h
Ãw


114 
Docum’tEÁry
.
objeùs
.
	`f‹r
(
´ofÜma
=
£lf
).
	$upd©e
(
švoiû
=invoice)

115  
švoiû


117 @
´İ”ty


118 
def
 
	$_¡¬tšg_numb”
(
£lf
):

119  
£lf
.
´ovid”
.
´ofÜma_¡¬tšg_numb”


121 @
´İ”ty


122 
def
 
	$deçuÉ_£r›s
(
£lf
):

123 
Œy
:

124  
£lf
.
´ovid”
.
´ofÜma_£r›s


125 
exû±
 
Provid”
.
DÛsNÙExi¡
:

128 @
´İ”ty


129 
def
 
	$f›lds_fÜ_autom©ic_švoiû_g’”©iÚ
(
£lf
):

130 
f›lds
 = ['customer', 'provider', 'archived_customer',

135  {
f›ld
: 
	`g‘©Œ
(
£lf
, f›ld, 
NÚe
èf›ld 
š
 
f›lds
}

137 @
´İ”ty


138 
def
 
	$’Œ›s
(
£lf
):

139  
£lf
.
´ofÜma_’Œ›s
.
	`®l
()

142 @
	$»ûiv”
(
´e_d–‘e
, 
£nd”
=
ProfÜma
)

143 
def
 
	$d–‘e_´ofÜma_pdf_äom_¡Üage
(
£nd”
, 
š¡ªû
, **
kw¬gs
):

144 
š¡ªû
.
pdf
:

145 #D–‘
the
 
´ofÜma
's PDF

146 
š¡ªû
.
pdf
.
pdf_fe
.
	`d–‘e
(
F®£
)

	@silver/models/payment_methods.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

14 
äom
 
™”toŞs
 
impÜt
 
chaš


16 
äom
 
	gªnoyšg
.
funùiÚs
 
impÜt
 
g‘_objeù_Ü_NÚe


17 
äom
 
	güy±og¿phy
.
ãº‘
 
impÜt
 
	gInv®idTok’
, 
F”Ãt


18 
äom
 
djªgo_fsm
 
impÜt
 
T¿ns™iÚNÙAÎowed


19 
äom
 
	gªnoyšg
.
f›lds
 
impÜt
 
JSONF›ld


20 
äom
 
	gmod–_uts
.
mªag”s
 
impÜt
 
Inh”™ªûMªag”


22 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


23 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
V®id©iÚE¼Ü


24 
äom
 
	gdjªgo
.
db
 
impÜt
 
mod–s


25 
äom
 
	gdjªgo
.
	gdb
.
	gmod–s
.
sigÇls
 
impÜt
 
	gpo¡_§ve
, 
´e_§ve


26 
äom
 
	gdjªgo
.
di¥©ch
 
impÜt
 
»ûiv”


27 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


29 
äom
 
sv”
 
impÜt
 
·ym’t_´oûssÜs


30 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gInvoiû
, 
ProfÜma


32 
	gäom
 .
blšg_’t™›s
 
impÜt
 
Cu¡om”


33 
	gäom
 .
Œª§ùiÚs
 
impÜt
 
T¿n§ùiÚ


36 
şass
 
	$Paym’tM‘hodInv®id
(
Exû±iÚ
):

37 
·ss


40 
şass
 
	$Paym’tM‘hod
(
mod–s
.
Mod–
):

41 
şass
 
Paym’tProûssÜs
:

42 @
şassm‘hod


43 
def
 
	$as_choiûs
(
şs
):

44 
Çme
 
š
 
£‰šgs
.
PAYMENT_PROCESSORS
.
	$keys
():

45 
	`y›ld
 (
Çme
,‚ame)

47 @
şassm‘hod


48 
def
 
	$as_li¡
(
şs
):

49  [
Çme
 Çm
š
 
£‰šgs
.
PAYMENT_PROCESSORS
.
	`keys
()]

51 
·ym’t_´oûssÜ
 = 
mod–s
.
	`Ch¬F›ld
(
choiûs
=
Paym’tProûssÜs
.
	`as_choiûs
(),

52 
bÏnk
=
F®£
, 
nuÎ
=F®£, 
max_Ëngth
=256)

53 
cu¡om”
 = 
mod–s
.
	$FÜeignKey
(
Cu¡om”
)

54 
added_©
 = 
mod–s
.
	$D©eTimeF›ld
(=
timezÚe
.
now
)

55 
d©a
 = 
	`JSONF›ld
(
bÏnk
=
True
, 
nuÎ
=True, ={
	}
})

57 
v”if›d
 = 
mod–s
.
	$BoŞ—nF›ld
(=
F®£
)

58 
ÿnûËd
 = 
mod–s
.
	$BoŞ—nF›ld
(=
F®£
)

60 
v®id_uÁ
 = 
mod–s
.
	$D©eTimeF›ld
(
nuÎ
=
True
, 
bÏnk
=True)

61 
di¥Ïy_šfo
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=256, 
nuÎ
=
True
, 
bÏnk
=True)

63 
objeùs
 = 
	$Inh”™ªûMªag”
()

65 
şass
 
M‘a
:

66 
Üd”šg
 = ['-id']

68 @
´İ”ty


69 
def
 
	$fš®_f›lds
(
£lf
):

72 @
´İ”ty


73 
def
 
	$œ»v”sibË_f›lds
(
£lf
):

76 
def
 
	$__š™__
(
£lf
, *
¬gs
, **
kw¬gs
):

77 
	`su³r
(
Paym’tM‘hod
, 
£lf
).
	$__š™__
(*
¬gs
, **
kw¬gs
)

79 
£lf
.
id
:

80 
Œy
:

81 
·ym’t_m‘hod_şass
 = 
£lf
.
	`g‘_·ym’t_´oûssÜ
().payment_method_class

83 
·ym’t_m‘hod_şass
:

84 
£lf
.
__şass__
 = 
·ym’t_m‘hod_şass


85 
exû±
 
A‰ribu‹E¼Ü
:

86 
·ss


88 @
´İ”ty


89 
def
 
	$Œª§ùiÚs
(
£lf
):

90  
£lf
.
Œª§ùiÚ_£t
.
	$®l
()

92 
def
 
	$g‘_·ym’t_´oûssÜ
(
£lf
):

93  
·ym’t_´oûssÜs
.
	$g‘_š¡ªû
(
£lf
.
·ym’t_´oûssÜ
)

95 
def
 
	$d–‘e
(
£lf
, 
usšg
=
NÚe
):

96 
nÙ
 
£lf
.
¡©e
 =ğ£lf.
S‹s
.
Unš™Ÿlized
:

97 
£lf
.
	$»move
()

99 
	`su³r
(
Paym’tM‘hod
, 
£lf
).
	$d–‘e
(
usšg
=using)

101 
def
 
	$’üy±_d©a
(
£lf
, 
d©a
):

102 
key
 = 
£‰šgs
.
PAYMENT_METHOD_SECRET


103  
	`F”Ãt
(
key
).
	`’üy±
(
	$by‹s
(
d©a
))

105 
def
 
	$deüy±_d©a
(
£lf
, 
üy±ed_d©a
):

106 
key
 = 
£‰šgs
.
PAYMENT_METHOD_SECRET


108 
Œy
:

109  
	`¡r
(
	`F”Ãt
(
key
).
	`deüy±
(
	$by‹s
(
üy±ed_d©a
)))

110 
exû±
 
Inv®idTok’
:

111  
NÚe


113 
def
 
	$ÿnûl
(
£lf
):

114 
£lf
.
ÿnûËd
:

115 
¿i£
 
	`V®id©iÚE¼Ü
("You can't cancel‡ canceled…ayment method.")

117 
ÿnûÏbË_¡©es
 = [
T¿n§ùiÚ
.
S‹s
.
In™Ÿl
,

118 
T¿n§ùiÚ
.
S‹s
.
P’dšg
]

120 
Œª§ùiÚs
 = 
£lf
.Œª§ùiÚs.
	$f‹r
(
¡©e__š
=
ÿnûÏbË_¡©es
)

122 
”rÜs
 = []

123 
Œª§ùiÚ
 
š
 
Œª§ùiÚs
:

124 
Œª§ùiÚ
.
¡©e
 =ğ
T¿n§ùiÚ
.
S‹s
.
In™Ÿl
:

125 
Œy
:

126 
Œª§ùiÚ
.
	$ÿnûl
()

127 
exû±
 
T¿ns™iÚNÙAÎowed
:

128 
”rÜs
.
	`­³nd
("T¿n§ùiÚ {} couldn'ˆbÿnûËd".
	$fÜm©
(
Œª§ùiÚ
.
uuid
))

130 
Œª§ùiÚ
.
¡©e
 =ğ
T¿n§ùiÚ
.
S‹s
.
P’dšg
:

131 
·ym’t_´oûssÜ
 = 
£lf
.
	$g‘_·ym’t_´oûssÜ
()

132 ià(
	`ha§‰r
(
·ym’t_´oûssÜ
, 'void_Œª§ùiÚ'è
ªd


133 
nÙ
 
·ym’t_´oûssÜ
.
	$void_Œª§ùiÚ
(
Œª§ùiÚ
)):

134 
”rÜs
.
	`­³nd
("T¿n§ùiÚ {} couldn'ˆbvoided".
	$fÜm©
(
Œª§ùiÚ
.
uuid
))

136 
Œª§ùiÚ
.
	$§ve
()

138 
”rÜs
:

139  
”rÜs


141 
£lf
.
ÿnûËd
 = 
True


142 
£lf
.
	$§ve
()

144  
NÚe


146 
def
 
	$ş—n_w™h_´evious_š¡ªû
(
£lf
, 
´evious_š¡ªû
):

147 
nÙ
 
´evious_š¡ªû
:

150 
f›ld
 
š
 
£lf
.
fš®_f›lds
:

151 
Şd_v®ue
 = 
	$g‘©Œ
(
´evious_š¡ªû
, 
f›ld
, 
NÚe
)

152 
cu¼’t_v®ue
 = 
	$g‘©Œ
(
£lf
, 
f›ld
, 
NÚe
)

154 
Şd_v®ue
 !ğ
cu¼’t_v®ue
:

155 
¿i£
 
	`V®id©iÚE¼Ü
(

156 "F›ld '%s' may‚Ù bchªged." % 
f›ld


159 
f›ld
 
š
 
£lf
.
œ»v”sibË_f›lds
:

160 
Şd_v®ue
 = 
	$g‘©Œ
(
´evious_š¡ªû
, 
f›ld
, 
NÚe
)

161 
cu¼’t_v®ue
 = 
	$g‘©Œ
(
£lf
, 
f›ld
, 
NÚe
)

163 
Şd_v®ue
 
ªd
 old_v®u!ğ
cu¼’t_v®ue
:

164 
¿i£
 
	`V®id©iÚE¼Ü
(

165 "F›ld '%s' may‚Ù bchªged‡nymÜe." % 
f›ld


168 
def
 
	$fuÎ_ş—n
(
£lf
, *
¬gs
, **
kw¬gs
):

169 
´evious_š¡ªû
 = 
kw¬gs
.
	`pİ
('´evious_š¡ªû', 
NÚe
)

171 
	`su³r
(
Paym’tM‘hod
, 
£lf
).
	$fuÎ_ş—n
(*
¬gs
, **
kw¬gs
)

172 
£lf
.
	$ş—n_w™h_´evious_š¡ªû
(
´evious_š¡ªû
)

174 #thi 
assumes
 
th©
 
nobody
 
ÿÎs
 
ş—n
 
ªd
 
th’
 
modif›s
 
this
 
objeù


175 #w™houˆ
ÿÎšg
 
ş—n
 
agaš


176 
	`£‰r
(
£lf
, '.ş—Ãd', 
True
)

178 @
´İ”ty


179 
def
 
	$®lowed_cu¼’c›s
(
£lf
):

180  
£lf
.
	`g‘_·ym’t_´oûssÜ
().
®lowed_cu¼’c›s


182 @
´İ”ty


183 
def
 
	$public_d©a
(
£lf
):

184  {
	}
}

186 
def
 
	$__unicode__
(
£lf
):

187  
u
'{} - {}'.
	`fÜm©
(
£lf
.
cu¡om”
,

188 
£lf
.
	$g‘_·ym’t_´oûssÜ_di¥Ïy
())

191 
def
 
	$ü—‹_Œª§ùiÚs_fÜ_issued_docum’ts
(
·ym’t_m‘hod
):

192 
cu¡om”
 = 
·ym’t_m‘hod
.customer

194 
·ym’t_m‘hod
.
ÿnûËd
 
Ü
 
nÙ
…aym’t_m‘hod.
v”if›d
:

197 
Œª§ùiÚs
 = []

199 
docum’t
 
š
 
	`chaš
(

200 
ProfÜma
.
objeùs
.
	`f‹r
(
»Ï‹d_docum’t
=
NÚe
, 
cu¡om”
=customer,

201 
¡©e
=
ProfÜma
.
STATES
.
ISSUED
),

202 
Invoiû
.
objeùs
.
	$f‹r
(
¡©e
=
Invoiû
.
STATES
.
ISSUED
, 
cu¡om”
=customer)

204 
Œy
:

205 
Œª§ùiÚs
.
	`­³nd
(
T¿n§ùiÚ
.
objeùs
.
	$ü—‹
(

206 
docum’t
=docum’t, 
·ym’t_m‘hod
=payment_method

208 
exû±
 
V®id©iÚE¼Ü
:

211  
Œª§ùiÚs


214 @
	$»ûiv”
(
´e_§ve
)

215 
def
 
	$´e_·ym’t_m‘hod_§ve
(
£nd”
, 
š¡ªû
=
NÚe
, **
kw¬gs
):

216 
nÙ
 
	$isš¡ªû
(
š¡ªû
, 
Paym’tM‘hod
):

219 
·ym’t_m‘hod
 = 
š¡ªû


221 
´evious_š¡ªû
 = 
	$g‘_objeù_Ü_NÚe
(
Paym’tM‘hod
, 
pk
=
·ym’t_m‘hod
.pk)

222 
	`£‰r
(
·ym’t_m‘hod
, '.´evious_š¡ªû', 
´evious_š¡ªû
)

224 
nÙ
 
	`g‘©Œ
(
·ym’t_m‘hod
, '.ş—Ãd', 
F®£
):

225 
·ym’t_m‘hod
.
	`fuÎ_ş—n
(
´evious_š¡ªû
=previous_instance)

228 @
	$»ûiv”
(
po¡_§ve
)

229 
def
 
	$po¡_·ym’t_m‘hod_§ve
(
£nd”
, 
š¡ªû
, **
kw¬gs
):

230 
nÙ
 
	$isš¡ªû
(
š¡ªû
, 
Paym’tM‘hod
):

233 
·ym’t_m‘hod
 = 
š¡ªû


235 
	`ha§‰r
(
·ym’t_m‘hod
, '.cleaned'):

236 
	`d–©Œ
(
·ym’t_m‘hod
, '.cleaned')

238 
´evious_š¡ªû
 = 
	`g‘©Œ
(
·ym’t_m‘hod
, '.´evious_š¡ªû', 
NÚe
)

240 
	`nÙ
 (
£‰šgs
.
SILVER_AUTOMATICALLY_CREATE_TRANSACTIONS
 
Ü


241 
nÙ
 
·ym’t_m‘hod
.
v”if›d
 
Ü


242 (
nÙ
 
·ym’t_m‘hod
.
	`g‘_·ym’t_´oûssÜ
().
ty³
 ==

243 
·ym’t_´oûssÜs
.
Ty³s
.
Trigg”ed
)):

246 
nÙ
 
´evious_š¡ªû
 
Ü
‚Ù…»vious_š¡ªû.
v”if›d
:

247 
	`ü—‹_Œª§ùiÚs_fÜ_issued_docum’ts
(
·ym’t_m‘hod
)

	@silver/models/plans.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
mod–_uts
 
impÜt
 
Choiûs


17 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
V®id©iÚE¼Ü


18 
äom
 
	gdjªgo
.
	gcÜe
.
v®id©Üs
 
impÜt
 
MšV®ueV®id©Ü


19 
äom
 
	gdjªgo
.
db
 
impÜt
 
mod–s


20 
äom
 
	gdjªgo
.
	guts
.
Œª¦©iÚ
 
impÜt
 
ug‘‹xt_Ïzy
 
as
 
_


22 
äom
 
	gsv”
.
	guts
.
š‹º©iÚ®
 
impÜt
 
cu¼’c›s


23 
äom
 
	gsv”
.
	guts
.
mod–s
 
impÜt
 
Un§vedFÜeignKey


26 
şass
 
	$PÏnMªag”
(
mod–s
.
Mªag”
):

27 
def
 
	$g‘_qu”y£t
(
£lf
):

28  
	`su³r
(
PÏnMªag”
, 
£lf
).
	`g‘_qu”y£t
().
	`£Ëù_»Ï‹d
('product_code')

31 
şass
 
	$PÏn
(
mod–s
.
Mod–
):

32 
objeùs
 = 
	$PÏnMªag”
()

34 
şass
 
	$INTERVALS
(
objeù
):

35 
DAY
 = 'day'

36 
WEEK
 = 'week'

37 
MONTH
 = 'month'

38 
YEAR
 = 'year'

40 
INTERVAL_CHOICES
 = 
	`Choiûs
(

41 (
INTERVALS
.
DAY
, 
	`_
('Day')),

42 (
INTERVALS
.
WEEK
, 
	`_
('Week')),

43 (
INTERVALS
.
MONTH
, 
	`_
('Month')),

44 (
INTERVALS
.
YEAR
, 
	`_
('Year'))

47 
Çme
 = 
mod–s
.
	`Ch¬F›ld
(

48 
max_Ëngth
=200, 
h–p_‹xt
='Display‚ame ofhe…lan.',

49 
db_šdex
=
True


51 
š‹rv®
 = 
mod–s
.
	`Ch¬F›ld
(

52 
choiûs
=
INTERVAL_CHOICES
, 
max_Ëngth
=12, =
INTERVALS
.
MONTH
,

53 
h–p_‹xt
='The frequency with which‡ subscription should be billed.'

55 
š‹rv®_couÁ
 = 
mod–s
.
	`Pos™iveIÁeg”F›ld
(

56 
h–p_‹xt
='The‚umber of intervals betweenƒach subscription billing'

58 
amouÁ
 = 
mod–s
.
	`Decim®F›ld
(

59 
max_dig™s
=19, 
decim®_¶aûs
=4, 
v®id©Üs
=[
	`MšV®ueV®id©Ü
(0.0)],

60 
h–p_‹xt
='The‡mount inhe specified currencyo be charged onhe '

63 
cu¼’cy
 = 
mod–s
.
	`Ch¬F›ld
(

64 
choiûs
=
cu¼’c›s
, 
max_Ëngth
=4, ='USD',

65 
h–p_‹xt
='The currency in whichhe subscription will be charged.'

67 
ŒŸl_³riod_days
 = 
mod–s
.
	`Pos™iveIÁeg”F›ld
(

68 
nuÎ
=
True
, 
bÏnk
=True,

69 
h–p_‹xt
='Number ofrial…eriod days granted when subscribing‡ '

71 
v”bo£_Çme
='Trial days'

73 
g’”©e_docum’ts_Ú_ŒŸl_’d
 = 
mod–s
.
	`NuÎBoŞ—nF›ld
(

74 
h–p_‹xt
="Ifhis is seto True,hen billing documents will be generated whenhe "

77 
£·¿‹_cyşes_duršg_ŒŸl
 = 
mod–s
.
	`NuÎBoŞ—nF›ld
(

78 
h–p_‹xt
="Ifhis is seto True,henherial…eriod cycle will be split if it spans "

81 
´ebl_¶ª
 = 
mod–s
.
	`NuÎBoŞ—nF›ld
(

82 
h–p_‹xt
="Ifhis is seto True,henhe…lan base‡mount will be billed‡the"

85 
m‘”ed_ã©u»s
 = 
mod–s
.
	`MªyToMªyF›ld
(

86 'M‘”edF—tu»', 
bÏnk
=
True
,

87 
h–p_‹xt
="A†ist ofhe…lan's metered features."

89 
g’”©e_aá”
 = 
mod–s
.
	`Pos™iveIÁeg”F›ld
(

91 
h–p_‹xt
='Number of secondso wait‡fter current billing cycleƒnds '

95 
cyşe_blšg_du¿tiÚ
 = 
mod–s
.
	`Du¿tiÚF›ld
(

96 
nuÎ
=
True
, 
bÏnk
=True,

97 
h–p_‹xt
="This can be usedoƒnsurehathe billing date doesn't…ass‡ certain date.\n"

103 
’abËd
 = 
mod–s
.
	`BoŞ—nF›ld
(=
True
,

104 
h–p_‹xt
='Whethero‡ccept subscriptions.')

105 
´iv©e
 = 
mod–s
.
	`BoŞ—nF›ld
(=
F®£
,

106 
h–p_‹xt
='Indicates if‡…lan is…rivate.')

107 
´oduù_code
 = 
mod–s
.
	`FÜeignKey
(

108 'ProduùCode', 
h–p_‹xt
='The…roduct code forhis…lan.'

110 
´ovid”
 = 
mod–s
.
	`FÜeignKey
(

111 'Provid”', 
»Ï‹d_Çme
='plans',

112 
h–p_‹xt
='The…rovider which…rovideshe…lan.'

115 
şass
 
M‘a
:

116 
Üd”šg
 = ('name',)

118 @
¡©icm‘hod


119 
def
 
	$v®id©e_m‘”ed_ã©u»s
(
m‘”ed_ã©u»s
):

120 
´oduù_codes
 = 
	$diù
()

121 
mf
 
š
 
m‘”ed_ã©u»s
:

122 
´oduù_codes
.
	$g‘
(
mf
.
´oduù_code
.
v®ue
, 
NÚe
):

123 
”r_msg
 = 'A…lan cannot havewo or more metered features ' \

125 % (
mf
.
Çme
, 
´oduù_codes
.
	$g‘
(
mf
.
´oduù_code
.
v®ue
))

126 
¿i£
 
	$V®id©iÚE¼Ü
(
”r_msg
)

127 
´oduù_codes
[
mf
.
´oduù_code
.
v®ue
] = mf.
Çme


129 
def
 
	$__unicode__
(
£lf
):

130  
	`unicode
(
£lf
.
Çme
)

132 @
´İ”ty


133 
def
 
	$´ovid”_æow
(
£lf
):

134  
£lf
.
´ovid”
.
æow


137 
şass
 
	$M‘”edF—tu»
(
mod–s
.
Mod–
):

138 
Çme
 = 
mod–s
.
	`Ch¬F›ld
(

139 
max_Ëngth
=200,

140 
h–p_‹xt
='The feature display‚ame.',

141 
db_šdex
=
True
,

143 
un™
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=20)

144 
´iû_³r_un™
 = 
mod–s
.
	`Decim®F›ld
(

145 
max_dig™s
=19, 
decim®_¶aûs
=4, 
v®id©Üs
=[
	`MšV®ueV®id©Ü
(0.0)],

146 
h–p_‹xt
='The…rice…er unit.',

148 
šşuded_un™s
 = 
mod–s
.
	`Decim®F›ld
(

149 
max_dig™s
=19, 
decim®_¶aûs
=4, 
v®id©Üs
=[
	`MšV®ueV®id©Ü
(0.0)],

150 
h–p_‹xt
='The‚umber of included units…er…lan interval.'

152 
šşuded_un™s_duršg_ŒŸl
 = 
mod–s
.
	`Decim®F›ld
(

153 
max_dig™s
=19, 
decim®_¶aûs
=4, 
v®id©Üs
=[
	`MšV®ueV®id©Ü
(0.0)],

154 
bÏnk
=
True
, 
nuÎ
=True,

155 
h–p_‹xt
='The‚umber of included units duringherial…eriod.'

157 
´oduù_code
 = 
	`Un§vedFÜeignKey
(

158 'ProduùCode', 
h–p_‹xt
='The…roduct code forhis…lan.'

161 
şass
 
M‘a
:

162 
Üd”šg
 = ('name',)

164 
def
 
	$__unicode__
(
£lf
):

165 
fmt
 = 
u
'{name} ({price:.2f}$, {included:.2f} included)'

166  
fmt
.
	`fÜm©
(
Çme
=
£lf
.Çme, 
´iû
=£lf.
´iû_³r_un™
,

167 
šşuded
=
£lf
.
šşuded_un™s
)

	@silver/models/product_codes.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
	gdjªgo
.
db
 
impÜt
 
mod–s


18 
şass
 
	$ProduùCode
(
mod–s
.
Mod–
):

19 
v®ue
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=128, 
unique
=
True
)

21 
def
 
	$__unicode__
(
£lf
):

22  
	`unicode
(
£lf
.
v®ue
)

	@silver/models/subscriptions.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
ÿËnd¬


17 
impÜt
 
loggšg


18 
äom
 
d©‘ime
 
impÜt
 
	gd©e
, 
	gd©‘ime
, 
timed–


19 
äom
 
decim®
 
impÜt
 
Decim®


21 
äom
 
	gªnoyšg
.
funùiÚs
 
impÜt
 
g‘_objeù_Ü_NÚe


22 
äom
 
d©eut
 
impÜt
 
¼uË


23 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


24 
äom
 
	gdjªgo
.
	guts
.
timezÚe
 
impÜt
 
utc


25 
äom
 
djªgo_fsm
 
impÜt
 
	gFSMF›ld
, 
	gŒªs™iÚ
, 
T¿ns™iÚNÙAÎowed


26 
äom
 
	gªnoyšg
.
f›lds
 
impÜt
 
JSONF›ld


27 
äom
 
mod–_uts
 
impÜt
 
Choiûs


29 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
V®id©iÚE¼Ü


30 
äom
 
	gdjªgo
.
	gcÜe
.
v®id©Üs
 
impÜt
 
MšV®ueV®id©Ü


31 
äom
 
	gdjªgo
.
db
 
impÜt
 
mod–s


32 
äom
 
	gdjªgo
.
	gdb
.
	gmod–s
.
sigÇls
 
impÜt
 
´e_d–‘e


33 
äom
 
	gdjªgo
.
di¥©ch
 
impÜt
 
»ûiv”


34 
äom
 
	gdjªgo
.
‹m¶©e
 
impÜt
 
Tem¶©eDÛsNÙExi¡


35 
äom
 
	gdjªgo
.
	g‹m¶©e
.
lßd”
 
impÜt
 
	gg‘_‹m¶©e
, 
»nd”_to_¡ršg


36 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


37 
äom
 
	gdjªgo
.
	guts
.
Œª¦©iÚ
 
impÜt
 
ug‘‹xt_Ïzy
 
as
 
_


39 
	gäom
 .
blšg_’t™›s
 
impÜt
 
Cu¡om”


40 
	gäom
 .
docum’ts
 
impÜt
 
Docum’tEÁry


41 
äom
 
	gsv”
.
	guts
.
d©es
 
impÜt
 
	gONE_DAY
, 
	g»Ïtived–
, 
fœ¡_day_of_mÚth


42 
äom
 
	gsv”
.
v®id©Üs
 
impÜt
 
v®id©e_»ã»nû


45 
	glogg”
 = 
loggšg
.
	$g‘Logg”
(
__Çme__
)

48 
def
 
	$f›ld_‹m¶©e_·th
(
f›ld
, 
´ovid”
=
NÚe
):

49 
´ovid”
:

50 
´ovid”_‹m¶©e_·th
 = 'billing_documents/{provider}/{field}.html'.\

51 
	$fÜm©
(
´ovid”
õrovid”, 
f›ld
=field)

52 
Œy
:

53 
	$g‘_‹m¶©e
(
´ovid”_‹m¶©e_·th
)

54  
´ovid”_‹m¶©e_·th


55 
exû±
 
Tem¶©eDÛsNÙExi¡
:

56 
·ss


57  'blšg_docum’ts/{f›ld}.html'.
	$fÜm©
(
f›ld
=field)

60 
şass
 
	$M‘”edF—tu»Un™sLog
(
mod–s
.
Mod–
):

61 
m‘”ed_ã©u»
 = 
mod–s
.
	`FÜeignKey
('M‘”edF—tu»', 
»Ï‹d_Çme
='consumed')

62 
subsütiÚ
 = 
mod–s
.
	`FÜeignKey
('SubsütiÚ', 
»Ï‹d_Çme
='mf_log_entries')

63 
cÚsumed_un™s
 = 
mod–s
.
	`Decim®F›ld
(
max_dig™s
=19, 
decim®_¶aûs
=4,

64 
v®id©Üs
=[
	`MšV®ueV®id©Ü
(0.0)])

65 
¡¬t_d©e
 = 
mod–s
.
	$D©eF›ld
(
ed™abË
=
F®£
)

66 
’d_d©e
 = 
mod–s
.
	$D©eF›ld
(
ed™abË
=
F®£
)

68 
şass
 
M‘a
:

69 
unique_tog‘h”
 = ('metered_feature', 'subscription', 'start_date',

72 
def
 
	$ş—n
(
£lf
):

73 
	`su³r
(
M‘”edF—tu»Un™sLog
, 
£lf
).
	$ş—n
()

74 
£lf
.
subsütiÚ
.
¡©e
 
š
 [
SubsütiÚ
.
STATES
.
ENDED
,

75 
SubsütiÚ
.
STATES
.
INACTIVE
]:

76 
nÙ
 
£lf
.
id
:

77 
aùiÚ_ty³
 = "create"

79 
aùiÚ_ty³
 = "change"

80 
”r_msg
 = 'You cannot %s‡ metered feature units†og belongingo '\

81 'ª % subsütiÚ.' % (
aùiÚ_ty³
,

82 
£lf
.
subsütiÚ
.
¡©e
)

83 
¿i£
 
	$V®id©iÚE¼Ü
(
”r_msg
)

85 
nÙ
 
£lf
.
id
:

86 
¡¬t_d©e
 = 
£lf
.
subsütiÚ
.
	$buck‘_¡¬t_d©e
()

87 
’d_d©e
 = 
£lf
.
subsütiÚ
.
	$buck‘_’d_d©e
()

88 
	$g‘_objeù_Ü_NÚe
(
M‘”edF—tu»Un™sLog
, 
¡¬t_d©e
=start_date,

89 
’d_d©e
=end_date,

90 
m‘”ed_ã©u»
=
£lf
.metered_feature,

91 
subsütiÚ
=
£lf
.subscription):

92 
”r_msg
 = 'A %s units†og forhe current date‡lreadyƒxists.'\

93 ' You cªƒd™h© oÃ.' % 
£lf
.
m‘”ed_ã©u»


94 
¿i£
 
	$V®id©iÚE¼Ü
(
”r_msg
)

96 
def
 
	$§ve
(
£lf
, *
¬gs
, **
kw¬gs
):

97 
nÙ
 
£lf
.
id
:

98 
nÙ
 
£lf
.
¡¬t_d©e
:

99 
£lf
.
¡¬t_d©e
 = s–f.
subsütiÚ
.
	$buck‘_¡¬t_d©e
()

100 
nÙ
 
£lf
.
’d_d©e
:

101 
£lf
.
’d_d©e
 = s–f.
subsütiÚ
.
	$buck‘_’d_d©e
()

102 
	`su³r
(
M‘”edF—tu»Un™sLog
, 
£lf
).
	$§ve
(*
¬gs
, **
kw¬gs
)

105 
upd©e_f›lds
 = []

106 
f›ld
 
š
 
£lf
.
_m‘a
.
f›lds
:

107 
f›ld
.
Çme
 !ğ'm‘”ed_ã©u»' 
ªd
 field.name != 'id':

108 
upd©e_f›lds
.
	$­³nd
(
f›ld
.
Çme
)

109 
kw¬gs
['upd©e_f›lds'] = kw¬gs.
	`g‘
('upd©e_f›lds', 
upd©e_f›lds
)

111 
	`su³r
(
M‘”edF—tu»Un™sLog
, 
£lf
).
	$§ve
(*
¬gs
, **
kw¬gs
)

113 
def
 
	$__unicode__
(
£lf
):

114  
	$unicode
(
£lf
.
m‘”ed_ã©u»
.
Çme
)

117 
şass
 
	$SubsütiÚ
(
mod–s
.
Mod–
):

118 
şass
 
	$STATES
(
objeù
):

119 
ACTIVE
 = 'active'

120 
INACTIVE
 = 'inactive'

121 
CANCELED
 = 'canceled'

122 
ENDED
 = 'ended'

124 
STATE_CHOICES
 = 
	`Choiûs
(

125 (
STATES
.
ACTIVE
, 
	`_
('Active')),

126 (
STATES
.
INACTIVE
, 
	`_
('Inactive')),

127 (
STATES
.
CANCELED
, 
	`_
('Canceled')),

128 (
STATES
.
ENDED
, 
	`_
('Ended'))

131 
şass
 
	$CANCEL_OPTIONS
(
objeù
):

132 
NOW
 = 'now'

133 
END_OF_BILLING_CYCLE
 = 'end_of_billing_cycle'

135 
_INTERVALS_CODES
 = {

136 'y—r': 
¼uË
.
YEARLY
,

137 'mÚth': 
¼uË
.
MONTHLY
,

138 'w“k': 
¼uË
.
WEEKLY
,

139 'day': 
¼uË
.
DAILY


140 
	}
}

142 
¶ª
 = 
mod–s
.
FÜeignKey
(

144 
h–p_‹xt
='The…lanhe customer is subscribedo.'

146 
desütiÚ
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=1024, 
bÏnk
=
True
, 
nuÎ
=True)

147 
cu¡om”
 = 
mod–s
.
	`FÜeignKey
(

148 'Cu¡om”', 
»Ï‹d_Çme
='subscriptions',

149 
h–p_‹xt
='The customer who is subscribedohe…lan.'

151 
ŒŸl_’d
 = 
mod–s
.
	`D©eF›ld
(

152 
bÏnk
=
True
, 
nuÎ
=True,

153 
h–p_‹xt
='The date‡t whichherialƒnds. '

156 
¡¬t_d©e
 = 
mod–s
.
	`D©eF›ld
(

157 
bÏnk
=
True
, 
nuÎ
=True,

158 
h–p_‹xt
='The starting date forhe subscription.'

160 
ÿnûl_d©e
 = 
mod–s
.
	`D©eF›ld
(

161 
bÏnk
=
True
, 
nuÎ
=True,

162 
h–p_‹xt
='The date whenhe subscription was canceled.'

164 
’ded_©
 = 
mod–s
.
	`D©eF›ld
(

165 
bÏnk
=
True
, 
nuÎ
=True,

166 
h–p_‹xt
='The date whenhe subscriptionƒnded.'

168 
»ã»nû
 = 
mod–s
.
	`Ch¬F›ld
(

169 
max_Ëngth
=128, 
bÏnk
=
True
, 
nuÎ
=True, 
v®id©Üs
=[
v®id©e_»ã»nû
],

170 
h–p_‹xt
="The subscription's„eference in‡nƒxternal system."

172 
¡©e
 = 
	`FSMF›ld
(

173 
choiûs
=
STATE_CHOICES
, 
max_Ëngth
=12, =
STATES
.
INACTIVE
,

174 
´Ùeùed
=
True
, 
h–p_‹xt
='The statehe subscription is in.'

176 
m‘a
 = 
	$JSONF›ld
(
bÏnk
=
True
, 
nuÎ
=True)

178 
def
 
	$ş—n
(
£lf
):

179 
”rÜs
 = 
	$diù
()

180 
£lf
.
¡¬t_d©e
 
ªd
 s–f.
ŒŸl_’d
:

181 
£lf
.
ŒŸl_’d
 < s–f.
¡¬t_d©e
:

182 
”rÜs
.
	`upd©e
(

184 "thsubsütiÚ' ¡¬ˆd©e."
	}
}

186 
£lf
.
’ded_©
:

187 
£lf
.
¡©e
 
nÙ
 
š
 [£lf.
STATES
.
CANCELED
, s–f.STATES.
ENDED
]:

188 
”rÜs
.
upd©e
(

192 
–if
 
£lf
.
’ded_©
 < s–f.
¡¬t_d©e
:

193 
”rÜs
.
upd©e
(

198 
”rÜs
:

199 
¿i£
 
V®id©iÚE¼Ü
(
”rÜs
)

201 @
´İ”ty


202 
def
 
	$´ovid”
(
£lf
):

203  
£lf
.
¶ª
.
´ovid”


205 
def
 
	$_g‘_®igÃd_¡¬t_d©e_aá”_d©e
(
£lf
, 
»ã»nû_d©e
, 
š‹rv®_ty³
,

206 
bymÚth
=
NÚe
, 
byw“kday
=NÚe, 
bymÚthday
=None):

207  
	`li¡
(

208 
¼uË
.
	`¼uË
(
š‹rv®_ty³
,

209 
couÁ
=1, #®igÀ
the
 
cyşe
 
to
h
giv’
 
ruËs
 
as
 
quickly
‡ 
possibË


210 
bymÚth
=bymonth,

211 
bymÚthday
=bymonthday,

212 
byw“kday
=byweekday,

213 
dt¡¬t
=
»ã»nû_d©e
)

214 )[-1].
	$d©e
()

216 
def
 
	$_g‘_Ï¡_¡¬t_d©e_w™hš_¿nge
(
£lf
, 
¿nge_¡¬t
, 
¿nge_’d
,

217 
š‹rv®_ty³
, 
š‹rv®_couÁ
,

218 
bymÚth
=
NÚe
, 
byw“kday
=NÚe, 
bymÚthday
=None):

219 #w
Œy
 
to
 
obš
 
a
 
¡¬t
 
d©e
 
®igÃd
Ø
the
 
giv’
 
ruËs


220 
®igÃd_¡¬t_d©e
 = 
£lf
.
	$_g‘_®igÃd_¡¬t_d©e_aá”_d©e
(

221 
»ã»nû_d©e
=
¿nge_¡¬t
,

222 
š‹rv®_ty³
=interval_type,

223 
bymÚth
=bymonth,

224 
bymÚthday
=bymonthday,

225 
byw“kday
=byweekday,

228 
»Ïtive_¡¬t_d©e
 = 
¿nge_¡¬t
 
®igÃd_¡¬t_d©e
 > 
¿nge_’d
 aligned_start_date

230 
d©es
 = 
	`li¡
(

231 
¼uË
.
	$¼uË
(
š‹rv®_ty³
,

232 
dt¡¬t
=
»Ïtive_¡¬t_d©e
,

233 
š‹rv®
=
š‹rv®_couÁ
,

234 
uÁ
=
¿nge_’d
)

237  
®igÃd_¡¬t_d©e
 
nÙ
 
d©es
 d©es[-1].
	$d©e
()

239 
def
 
	$_cyşe_¡¬t_d©e
(
£lf
, 
»ã»nû_d©e
=
NÚe
, 
ignÜe_ŒŸl
=NÚe, 
g¿nuÏ‹
=None):

240 
ignÜe_ŒŸl_deçuÉ
 = 
F®£


241 
g¿nuÏ‹_deçuÉ
 = 
F®£


243 
ignÜe_ŒŸl
 = 
ignÜe_ŒŸl_deçuÉ
 
Ü
 ignore_trial

244 
g¿nuÏ‹
 = 
g¿nuÏ‹_deçuÉ
 
Ü
 granulate

246 
»ã»nû_d©e
 
is
 
NÚe
:

247 
»ã»nû_d©e
 = 
timezÚe
.
	`now
().
	$d©e
()

249 
nÙ
 
£lf
.
¡¬t_d©e
 
Ü
 
»ã»nû_d©e
 < self.start_date:

250  
NÚe


252 
ruËs
 = {

253 'š‹rv®_ty³': 
£lf
.
_INTERVALS_CODES
[£lf.
¶ª
.
š‹rv®
],

254 'š‹rv®_couÁ': 1 
g¿nuÏ‹
 
£lf
.
¶ª
.
š‹rv®_couÁ
,

255 
	}
}

256 
£lf
.
¶ª
.
š‹rv®
 =ğ£lf.¶ª.
INTERVALS
.
MONTH
:

257 
ruËs
['bymÚthday'] = 1 #fœ¡ 
day
 
of
 
the
 
mÚth


258 
–if
 
£lf
.
¶ª
.
š‹rv®
 =ğ£lf.¶ª.
INTERVALS
.
WEEK
:

259 
ruËs
['byw“kday'] = 0 #fœ¡ 
day
 
of
 
the
 
	$w“k
 (
MÚday
)

260 
–if
 
£lf
.
¶ª
.
š‹rv®
 =ğ£lf.¶ª.
INTERVALS
.
YEAR
:

261 #fœ¡ 
day
 
of
 
the
 
fœ¡
 
	`mÚth
 (1 
Jª
)

262 
ruËs
['bymonth'] = 1

263 
ruËs
['bymonthday'] = 1

265 
¡¬t_d©e_ignÜšg_ŒŸl
 = 
£lf
.
	$_g‘_Ï¡_¡¬t_d©e_w™hš_¿nge
(

266 
¿nge_¡¬t
=
£lf
.
¡¬t_d©e
,

267 
¿nge_’d
=
»ã»nû_d©e
,

268 **
ruËs


271 
ignÜe_ŒŸl
 
Ü
 
nÙ
 
£lf
.
ŒŸl_’d
:

272  
¡¬t_d©e_ignÜšg_ŒŸl


273 : #TrŸÈ
³riod
 
is
 
cÚsid”ed


274 
£lf
.
ŒŸl_’d
 < 
»ã»nû_d©e
: #TrŸÈ
³riod
 
’ded


275 #Th
day
 
aá”
 
the
 
ŒŸl
 
’ded
 
ÿn
 
be
 
a
 
¡¬t
 
	`d©e
 (
Úû
, 
right
‡fterrialƒnded)

276 
d©e_aá”_ŒŸl_’d
 = 
£lf
.
ŒŸl_’d
 + 
ONE_DAY


278  
	$max
(
d©e_aá”_ŒŸl_’d
, 
¡¬t_d©e_ignÜšg_ŒŸl
)

279 : #TrŸÈ
is
 
¡l
 
Úgošg


280 
g¿nuÏ‹
 
Ü
 
£lf
.
£·¿‹_cyşes_duršg_ŒŸl
:

281 #Th
ŒŸl
 
³riod
 
is
 
¥l™
 
što
 
cyşes
 
accÜdšg
 
to
 
the
 
ruËs
 
defšed
 
above


282  
¡¬t_d©e_ignÜšg_ŒŸl


284 #Oth”wi£, 
the
 
¡¬t
 
d©e
 
of
h
ŒŸl
 
³riod
 
is
h
subsütiÚ
 start date

285  
£lf
.
¡¬t_d©e


287 
def
 
	$_cyşe_’d_d©e
(
£lf
, 
»ã»nû_d©e
=
NÚe
, 
ignÜe_ŒŸl
=NÚe, 
g¿nuÏ‹
=None):

288 
ignÜe_ŒŸl_deçuÉ
 = 
F®£


289 
g¿nuÏ‹_deçuÉ
 = 
F®£


291 
ignÜe_ŒŸl
 = ignÜe_ŒŸÈ
Ü
 
ignÜe_ŒŸl_deçuÉ


292 
g¿nuÏ‹
 = g¿nuÏ‹ 
Ü
 
g¿nuÏ‹_deçuÉ


294 
»ã»nû_d©e
 
is
 
NÚe
:

295 
»ã»nû_d©e
 = 
timezÚe
.
	`now
().
	$d©e
()

297 
»®_cyşe_¡¬t_d©e
 = 
£lf
.
	$_cyşe_¡¬t_d©e
(
»ã»nû_d©e
, 
ignÜe_ŒŸl
, 
g¿nuÏ‹
)

299 #w
Ãed
 
a
 
cu¼’t
 
¡¬t
 
d©e
 
š
 
Üd”
 
to
 
compu‹
‡ cu¼’ˆ
’d
 date

300 
nÙ
 
»®_cyşe_¡¬t_d©e
:

301  
NÚe


303 #duršg 
ŒŸl
 
ªd
rŸÈ
cyşe
 
is
 
nÙ
 
£·¿‹d
 
što
 
š‹rv®s


304 
£lf
.
	$Ú_ŒŸl
(
»ã»nû_d©e
è
ªd
 
	$nÙ
 (
£lf
.
£·¿‹_cyşes_duršg_ŒŸl
 
Ü


305 
g¿nuÏ‹
):

306  
	`mš
(
£lf
.
ŒŸl_’d
, (£lf.
’ded_©
 
Ü
 
d©‘ime
.
max
.
	$d©e
()))

308 
£lf
.
¶ª
.
š‹rv®
 =ğ£lf.¶ª.
INTERVALS
.
YEAR
:

309 
»Ïtive_d–
 = {'y—rs': 
£lf
.
¶ª
.
š‹rv®_couÁ
}

310 
–if
 
£lf
.
¶ª
.
š‹rv®
 =ğ£lf.¶ª.
INTERVALS
.
MONTH
:

311 
»Ïtive_d–
 = {'mÚths': 
£lf
.
¶ª
.
š‹rv®_couÁ
}

312 
–if
 
£lf
.
¶ª
.
š‹rv®
 =ğ£lf.¶ª.
INTERVALS
.
WEEK
:

313 
»Ïtive_d–
 = {'w“ks': 
£lf
.
¶ª
.
š‹rv®_couÁ
}

314 : #¶ª.
INTERVALS
.
DAY


315 
»Ïtive_d–
 = {'days': 
£lf
.
¶ª
.
š‹rv®_couÁ
}

317 
maximum_cyşe_’d_d©e
 = 
»®_cyşe_¡¬t_d©e
 + 
»Ïtived–
(**
»Ïtive_d–
è- 
ONE_DAY


318  
maximum_cyşe_’d_d©e


320 #W
know
 
th©
 
the
 
cyşe
 
’d_d©e
 
is
h
day
 
befÜe
h
Ãxt
 cyş
¡¬t_d©e
,

321 #th”efÜ
we
 
check
 
the
 
cyşe
 
¡¬t_d©e
 
our
 
maximum
 cyş
’d_d©e
 
is
h
§me


322 #a 
the
 
š™Ÿl
 
cyşe
 
¡¬t_d©e
.

323 #wh
True
:

324 #»ã»nû_cyşe_¡¬t_d©ğ
£lf
.
_cyşe_¡¬t_d©e
(
maximum_cyşe_’d_d©e
,

325 #ignÜe_ŒŸl, 
g¿nuÏ‹
)

326 ## 
™
 
m—ns
 
the
 
cyşe
 
’d_d©e
 
we
 
gÙ
 
is
h
right
 
Úe


327 #ià
»ã»nû_cyşe_¡¬t_d©e
 =ğ
»®_cyşe_¡¬t_d©e
:

328 #»tuº 
mš
(
maximum_cyşe_’d_d©e
, (
£lf
.
’ded_©
 
Ü
 
d©‘ime
.
max
.
d©e
()))

329 #–ià
»ã»nû_cyşe_¡¬t_d©e
 < 
»®_cyşe_¡¬t_d©e
:

330 ## 
This
 
should
 
Ãv”
 
h­³n
 
š
 
nÜm®
 
cÚd™iÚs
, 
but
 
™
 
may
 
¡İ
 
šfš™e
 
loİšg


331 #»tuº 
NÚe


333 #maximum_cyşe_’d_d©ğ
»ã»nû_cyşe_¡¬t_d©e
 - 
ONE_DAY


335 @
´İ”ty


336 
def
 
	$´ebl_¶ª
(
£lf
):

337 
£lf
.
¶ª
.
´ebl_¶ª
 
is
 
nÙ
 
NÚe
:

338  
£lf
.
¶ª
.
´ebl_¶ª


340  
£lf
.
´ovid”
.
´ebl_¶ª


342 @
´İ”ty


343 
def
 
	$cyşe_blšg_du¿tiÚ
(
£lf
):

344 
£lf
.
¶ª
.
cyşe_blšg_du¿tiÚ
 
is
 
nÙ
 
NÚe
:

345  
£lf
.
¶ª
.
cyşe_blšg_du¿tiÚ


347  
£lf
.
´ovid”
.
cyşe_blšg_du¿tiÚ


349 @
´İ”ty


350 
def
 
	$£·¿‹_cyşes_duršg_ŒŸl
(
£lf
):

351 
£lf
.
¶ª
.
£·¿‹_cyşes_duršg_ŒŸl
 
is
 
nÙ
 
NÚe
:

352  
£lf
.
¶ª
.
£·¿‹_cyşes_duršg_ŒŸl


354  
£lf
.
´ovid”
.
£·¿‹_cyşes_duršg_ŒŸl


356 @
´İ”ty


357 
def
 
	$g’”©e_docum’ts_Ú_ŒŸl_’d
(
£lf
):

358 
£lf
.
¶ª
.
g’”©e_docum’ts_Ú_ŒŸl_’d
 
is
 
nÙ
 
NÚe
:

359  
£lf
.
¶ª
.
g’”©e_docum’ts_Ú_ŒŸl_’d


361  
£lf
.
´ovid”
.
g’”©e_docum’ts_Ú_ŒŸl_’d


363 @
´İ”ty


364 
def
 
	$_ignÜe_ŒŸl_’d
(
£lf
):

365  
nÙ
 
£lf
.
g’”©e_docum’ts_Ú_ŒŸl_’d


367 
def
 
	$cyşe_¡¬t_d©e
(
£lf
, 
»ã»nû_d©e
=
NÚe
):

368  
£lf
.
	$_cyşe_¡¬t_d©e
(
ignÜe_ŒŸl
=
£lf
.
_ignÜe_ŒŸl_’d
,

369 
g¿nuÏ‹
=
F®£
,

370 
»ã»nû_d©e
=reference_date)

372 
def
 
	$cyşe_’d_d©e
(
£lf
, 
»ã»nû_d©e
=
NÚe
):

373  
£lf
.
	$_cyşe_’d_d©e
(
ignÜe_ŒŸl
=
£lf
.
_ignÜe_ŒŸl_’d
,

374 
g¿nuÏ‹
=
F®£
,

375 
»ã»nû_d©e
=reference_date)

377 
def
 
	$buck‘_¡¬t_d©e
(
£lf
, 
»ã»nû_d©e
=
NÚe
):

378  
£lf
.
	$_cyşe_¡¬t_d©e
(
»ã»nû_d©e
=reference_date,

379 
ignÜe_ŒŸl
=
F®£
, 
g¿nuÏ‹
=
True
)

381 
def
 
	$buck‘_’d_d©e
(
£lf
, 
»ã»nû_d©e
=
NÚe
):

382  
£lf
.
	$_cyşe_’d_d©e
(
»ã»nû_d©e
=reference_date,

383 
ignÜe_ŒŸl
=
F®£
, 
g¿nuÏ‹
=
True
)

385 
def
 
	$upd©—bË_buck‘s
(
£lf
):

386 
buck‘s
 = []

388 
£lf
.
¡©e
 
š
 ['ended', 'inactive']:

389  
buck‘s


391 
¡¬t_d©e
 = 
£lf
.
	$buck‘_¡¬t_d©e
()

392 
’d_d©e
 = 
£lf
.
	$buck‘_’d_d©e
()

394 
¡¬t_d©e
 
is
 
NÚe
 
Ü
 
’d_d©e
 is None:

395  
buck‘s


397 
£lf
.
¡©e
 =ğ£lf.
STATES
.
CANCELED
:

398 
£lf
.
ÿnûl_d©e
 < 
¡¬t_d©e
:

399  
buck‘s


401 
buck‘s
.
	`­³nd
({'¡¬t_d©e': 
¡¬t_d©e
, '’d_d©e': 
’d_d©e
})

403 
g’”©e_aá”
 = 
	$timed–
(
£cÚds
=
£lf
.
¶ª
.
g’”©e_aá”
)

404 
timezÚe
.
	`now
(è- 
g’”©e_aá”
 <

405 
d©‘ime
.
	`combše
(
¡¬t_d©e
, d©‘ime.
mš
.
	`time
()).
	`»¶aû
(

406 
tzšfo
=
timezÚe
.
	$g‘_cu¼’t_timezÚe
())):

407 
’d_d©e
 = 
¡¬t_d©e
 - 
ONE_DAY


408 
¡¬t_d©e
 = 
£lf
.
	$buck‘_¡¬t_d©e
(
’d_d©e
)

409 
¡¬t_d©e
 
is
 
NÚe
:

410  
buck‘s


411 
buck‘s
.
	`­³nd
({'¡¬t_d©e': 
¡¬t_d©e
, '’d_d©e': 
’d_d©e
})

413  
buck‘s


415 @
´İ”ty


416 
def
 
	$is_Ú_ŒŸl
(
£lf
):

418 
T–ls
 
the
 
subsütiÚ
 
is
 
cu¼’y
 
Ú
 
ŒŸl
.

420 :
¹y³
: 
boŞ


423 
£lf
.
¡©e
 =ğ£lf.
STATES
.
ACTIVE
 
ªd
 s–f.
ŒŸl_’d
:

424  
timezÚe
.
	`now
().
	`d©e
(è<ğ
£lf
.
ŒŸl_’d


425  
F®£


427 
def
 
	$Ú_ŒŸl
(
£lf
, 
d©e
):

429 
T–ls
 
the
 
subsütiÚ
 
was
 
Ú
 
ŒŸl
 
©
h
d©e
 
·s£d
 
as
 
¬gum’t
.

431 :
·¿m
 
d©e
: 
the
 d©
which
h
check
 
is
 
made
.

432 :
ty³
 
d©e
: 
d©‘ime
.date

433 :
¹y³
: 
boŞ


436 
£lf
.
ŒŸl_’d
:

437  
d©e
 <ğ
£lf
.
ŒŸl_’d


438  
F®£


440 
def
 
	$_log_should_be_bËd_»suÉ
(
£lf
, 
blšg_d©e
, 
š‹rv®_’d
):

441 
logg”
.
	`debug
('should_be_billed„esult: %s', {

442 'subsütiÚ': 
£lf
.
id
,

443 'blšg_d©e': 
blšg_d©e
.
	`¡ráime
('%Y-%m-%d'),

444 'š‹rv®_’d': 
š‹rv®_’d
.
	`¡ráime
('%Y-%m-%d')

445 
	}
})

447 @
´İ”ty


448 
def
 
	$bËd_up_to_d©es
(
£lf
):

449 
Ï¡_blšg_log
 = 
£lf
.last_billing_log

452 'm‘”ed_ã©u»s_bËd_up_to': 
Ï¡_blšg_log
.
m‘”ed_ã©u»s_bËd_up_to
,

453 '¶ª_bËd_up_to': 
Ï¡_blšg_log
.
¶ª_bËd_up_to


454 
	}
} 
Ï¡_blšg_log
 {

455 'm‘”ed_ã©u»s_bËd_up_to': 
£lf
.
¡¬t_d©e
 - 
ONE_DAY
,

456 '¶ª_bËd_up_to': 
£lf
.
¡¬t_d©e
 - 
ONE_DAY


459 
def
 
	$should_be_bËd
(
£lf
, 
blšg_d©e
, 
g’”©e_docum’ts_d©‘ime
=
NÚe
):

460 
£lf
.
¡©e
 
nÙ
 
š
 [£lf.
STATES
.
ACTIVE
, s–f.STATES.
CANCELED
]:

461  
F®£


463 
nÙ
 
g’”©e_docum’ts_d©‘ime
:

464 
g’”©e_docum’ts_d©‘ime
 = 
timezÚe
.
	$now
()

466 
£lf
.
cyşe_blšg_du¿tiÚ
:

467 
£lf
.
¡¬t_d©e
 > 
	`fœ¡_day_of_mÚth
(
blšg_d©e
è+ s–f.
cyşe_blšg_du¿tiÚ
:

468 #Th”
was
 
nÙhšg
 
to
 
bl
 
Ú
 
the
 
Ï¡
 
day
 
of
h
fœ¡
 
cyşe
 
blšg
 
du¿tiÚ


469  
F®£


471 #W
Ãed
 
the
 
fuÎ
 
cyşe
 
	`h”e
 (
ignÜšg
 
ŒŸl
 
’ds
)

472 
cyşe_¡¬t_d©‘ime_ignÜšg_ŒŸl
 = 
£lf
.
	$_cyşe_¡¬t_d©e
(
blšg_d©e
,

473 
ignÜe_ŒŸl
=
F®£
)

474 
Ï‹¡_possibË_blšg_d©‘ime
 = (

475 
cyşe_¡¬t_d©‘ime_ignÜšg_ŒŸl
 + 
£lf
.
cyşe_blšg_du¿tiÚ


478 
blšg_d©e
 = 
	$mš
(
blšg_d©e
, 
Ï‹¡_possibË_blšg_d©‘ime
)

480 
blšg_d©e
 > 
g’”©e_docum’ts_d©‘ime
.
	$d©e
():

481  
F®£


483 
cyşe_¡¬t_d©e
 = 
£lf
.
	$cyşe_¡¬t_d©e
(
blšg_d©e
)

485 
nÙ
 
cyşe_¡¬t_d©e
:

486  
F®£


488 
£lf
.
¡©e
 =ğ£lf.
STATES
.
CANCELED
:

489 
blšg_d©e
 <ğ
£lf
.
ÿnûl_d©e
:

490  
F®£


492 
cyşe_¡¬t_d©e
 = 
£lf
.
ÿnûl_d©e
 + 
ONE_DAY


494 
cyşe_¡¬t_d©‘ime
 = 
d©‘ime
.
	`combše
(
cyşe_¡¬t_d©e
,

495 
d©‘ime
.
mš
.
	`time
()).
	$»¶aû
(
tzšfo
=
utc
)

497 
g’”©e_aá”
 = 
	$timed–
(
£cÚds
=
£lf
.
¶ª
.
g’”©e_aá”
)

499 
g’”©e_docum’ts_d©‘ime
 < 
cyşe_¡¬t_d©‘ime
 + 
g’”©e_aá”
:

500  
F®£


502 
¶ª_bËd_up_to
 = 
£lf
.
bËd_up_to_d©es
['plan_billed_up_to']

504 #W
wªt
 
to
 
bl
 
the
 
subsütiÚ
 th
¶ª
 
ha¢
't been billed forhis cycle or

505 #ià
the
 
subsütiÚ
 
has
 
b“n
 
ÿnûËd
 
ªd
h
¶ª
 
wÚ
't be billed forhis cycle.

506 
£lf
.
´ebl_¶ª
 
Ü
 s–f.
¡©e
 =ğ£lf.
STATES
.
CANCELED
:

507  
¶ª_bËd_up_to
 < 
cyşe_¡¬t_d©e


509 #wa™ 
uÁ
 
the
 
cyşe
 
th©
 
is
 
gošg
 
to
 
be
 
bËd
 
’ds
:

510 
bËd_cyşe_’d_d©e
 = 
£lf
.
	`cyşe_’d_d©e
(
¶ª_bËd_up_to
 + 
ONE_DAY
)

511  
bËd_cyşe_’d_d©e
 < 
cyşe_¡¬t_d©e


513 @
´İ”ty


514 
def
 
	$_has_exi¡šg_cu¡om”_w™h_cÚsŞid©ed_blšg
(
£lf
):

515 #TODO: 
move
 
to
 
Cu¡om”


517 
£lf
.
cu¡om”
.
cÚsŞid©ed_blšg
 
ªd


518 
£lf
.
cu¡om”
.
subsütiÚs
.
	`f‹r
(
¡©e
=£lf.
STATES
.
ACTIVE
).
	`couÁ
() > 1

521 @
´İ”ty


522 
def
 
	$is_bËd_fœ¡_time
(
£lf
):

523  
£lf
.
blšg_logs
.
	`®l
().
	`couÁ
() == 0

525 @
´İ”ty


526 
def
 
	$Ï¡_blšg_log
(
£lf
):

527  
£lf
.
blšg_logs
.
	`Üd”_by
('blšg_d©e').
	`Ï¡
()

529 @
´İ”ty


530 
def
 
	$Ï¡_blšg_d©e
(
£lf
):

531 #ToDo: 
Im´ove
 
this
 
wh’
 
drİpšg
 
Djªgo
 1.8 
suµÜt


532 
Œy
:

533  
£lf
.
blšg_logs
.
	`®l
()[0].
blšg_d©e


534 
	$exû±
 (
BlšgLog
.
DÛsNÙExi¡
, 
IndexE¼Ü
):

535 #Iˆ
should
 
Ãv”
 
g‘
 
h”e
.

536  
NÚe


538 
def
 
	$_should_aùiv©e_w™h_ä“_ŒŸl
(
£lf
):

539  
SubsütiÚ
.
objeùs
.
	`f‹r
(

540 
¶ª__´ovid”
=
£lf
.
¶ª
.
´ovid”
,

541 
cu¡om”
=
£lf
.customer,

542 
¡©e__š
=[
SubsütiÚ
.
STATES
.
ACTIVE
, SubsütiÚ.STATES.
CANCELED
,

543 
SubsütiÚ
.
STATES
.
ENDED
]

544 ).
	`couÁ
() == 0

547 #STATE 
MACHINE
 
TRANSITIONS


549 @
	$Œªs™iÚ
(
f›ld
=
¡©e
, 
sourû
=[
STATES
.
INACTIVE
, STATES.
CANCELED
],

550 
rg‘
=
STATES
.
ACTIVE
)

551 
def
 
	$aùiv©e
(
£lf
, 
¡¬t_d©e
=
NÚe
, 
ŒŸl_’d_d©e
=None):

552 
äom
 
SubsütiÚ
.
uts
 
impÜt
 
»äesh_u£r_subsütiÚ


554 
¡¬t_d©e
:

555 
£lf
.
¡¬t_d©e
 = 
	`mš
(
timezÚe
.
	`now
().
	`d©e
(), start_date)

557 
£lf
.
¡¬t_d©e
:

558 
£lf
.
¡¬t_d©e
 = 
	`mš
(
timezÚe
.
	`now
().
	`d©e
(), self.start_date)

560 
£lf
.
¡¬t_d©e
 = 
timezÚe
.
	`now
().
	$d©e
()

562 
”rÜ
 = ''

563 
Œy
:

564 #Œª§ùiÚ = 
T¿n§ùiÚ
.
objeùs
.
	`g‘
(
ex‹º®_»ã»nû
=
£lf
.
»ã»nû
)

565 
cu¡om”
 = 
£lf
.customer

566 
¶ª
 = 
£lf
.plan

567 
¶ª
 
ªd
 
cu¡om”
:

568 
	$»äesh_u£r_subsütiÚ
(
cu¡om”
, 
¶ª
.
Çme
)

570 
sv”_logg”
.
	`debug
("NØ¶ª o¸cu¡om” found fÜhi subsütiÚ:„eã»nû: {}…k:{}".
	$fÜm©
(

571 
£lf
.
»ã»nû
, s–f.
pk
))

572 
¿i£
 
	`Exû±iÚ
("No…lan/customer‡ttachedo subscription")

574 #exû± 
T¿n§ùiÚ
.
DÛsNÙExi¡
 
as
 
e
:

576 #logg”.
	`debug
("NØŒª§ùiÚ found†škedØthi subsütiÚ:„eã»nû: {}…k:{}".
	`fÜm©
(

577 #£lf.
»ã»nû
, 
£lf
.
pk
))

578 
exû±
 
Exû±iÚ
 
as
 
e
:

579 
”rÜ
 = "Error in‡ctivating subscription"

580 
logg”
.
	`debug
("E¼Ü Occu»d iÀ£‰šg u£¸m‘ad©¨fÜhi subsütiÚ :»ã»nû:{}…k:{}".
	$fÜm©
(

581 
£lf
.
»ã»nû
,£lf.
pk
))

582 
logg”
.
	`debug
("E¼Ü MSG:{}".
	$fÜm©
(
e
))

584 
”rÜ
:

585 
¿i£
 
	$V®id©iÚE¼Ü
(
”rÜ
)

588 #ià
£lf
.
	`_should_aùiv©e_w™h_ä“_ŒŸl
():

589 #ià
ŒŸl_’d_d©e
:

590 #£lf.
ŒŸl_’d
 = 
	`max
(
£lf
.
¡¬t_d©e
, 
ŒŸl_’d_d©e
)

592 #ià
£lf
.
ŒŸl_’d
:

593 #ià
£lf
.
ŒŸl_’d
 < s–f.
¡¬t_d©e
:

594 #£lf.
ŒŸl_’d
 = 
NÚe


595 #–ià
£lf
.
¶ª
.
ŒŸl_³riod_days
 > 0:

596 #£lf.
ŒŸl_’d
 = 
£lf
.
¡¬t_d©e
 + 
	`timed–
(

597 #days=
£lf
.
¶ª
.
ŒŸl_³riod_days
 - 1)

599 @
	$Œªs™iÚ
(
f›ld
=
¡©e
, 
sourû
=
STATES
.
ACTIVE
, 
rg‘
=STATES.
CANCELED
)

600 
def
 
	$ÿnûl
(
£lf
, 
wh’
):

601 
now
 = 
timezÚe
.
	`now
().
	$d©e
()

602 
bsd
 = 
£lf
.
	$buck‘_¡¬t_d©e
()

603 
bed
 = 
£lf
.
	$buck‘_’d_d©e
()

605 
wh’
 =ğ
£lf
.
CANCEL_OPTIONS
.
END_OF_BILLING_CYCLE
:

606 
£lf
.
is_Ú_ŒŸl
:

607 
£lf
.
ÿnûl_d©e
 = s–f.
	$buck‘_’d_d©e
(
»ã»nû_d©e
=
£lf
.
ŒŸl_’d
)

609 
£lf
.
ÿnûl_d©e
 = s–f.
	$cyşe_’d_d©e
()

610 
–if
 
wh’
 =ğ
£lf
.
CANCEL_OPTIONS
.
NOW
:

611 
m‘”ed_ã©u»
 
š
 
£lf
.
¶ª
.
m‘”ed_ã©u»s
.
	$®l
():

612 
log
 = 
M‘”edF—tu»Un™sLog
.
objeùs
.
	`f‹r
(

613 
¡¬t_d©e
=
bsd
, 
’d_d©e
=
bed
,

614 
m‘”ed_ã©u»
=m‘”ed_ã©u».
pk
,

615 
subsütiÚ
=
£lf
.
pk
).
	$fœ¡
()

616 
log
:

617 
log
.
’d_d©e
 = 
now


618 
log
.
	$§ve
()

619 
£lf
.
	$Ú_ŒŸl
(
now
):

620 
£lf
.
ŒŸl_’d
 = 
now


621 
£lf
.
ÿnûl_d©e
 = 
now


623 
£lf
.
	`§ve
()

625 @
	$Œªs™iÚ
(
f›ld
=
¡©e
, 
sourû
=
STATES
.
CANCELED
, 
rg‘
=STATES.
ENDED
)

626 
def
 
	$’d
(
£lf
):

627 
£lf
.
’ded_©
 = 
timezÚe
.
	`now
().
	$d©e
()

630 
def
 
	$_ÿnûl_now
(
£lf
):

631 
£lf
.
	$ÿnûl
(
wh’
=
£lf
.
CANCEL_OPTIONS
.
NOW
)

633 
def
 
	$_ÿnûl_©_’d_of_blšg_cyşe
(
£lf
):

634 
£lf
.
	$ÿnûl
(
wh’
=
£lf
.
CANCEL_OPTIONS
.
END_OF_BILLING_CYCLE
)

636 
def
 
	$_add_ŒŸl_v®ue
(
£lf
, 
¡¬t_d©e
, 
’d_d©e
, 
švoiû
=
NÚe
,

637 
´ofÜma
=
NÚe
):

638 
£lf
.
	$_add_¶ª_ŒŸl
(
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=end_date,

639 
švoiû
=švoiû, 
´ofÜma
=proforma)

640 
£lf
.
	$_add_mfs_fÜ_ŒŸl
(
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=end_date,

641 
švoiû
=švoiû, 
´ofÜma
=proforma)

643 
def
 
	$_g‘_š‹rv®_’d_d©e
(
£lf
, 
d©e
=
NÚe
):

645 :
»tuºs
: 
the
 
’d
 
d©e
 
of
h
š‹rv®
 
th©
 
should
 
be
 
bËd
. 
The


646 
»tuºed
 
v®ue
 
is
 
a
 
funùiÚ
 
	$f
(
subsütiÚ_¡©e
, 
d©e
)

647 :
¹y³
: 
d©‘ime
.
d©e


650 
£lf
.
¡©e
 =ğ£lf.
STATES
.
ACTIVE
:

651 
’d_d©e
 = 
£lf
.
	$buck‘_’d_d©e
(
»ã»nû_d©e
=
d©e
)

652 
–if
 
£lf
.
¡©e
 =ğ£lf.
STATES
.
CANCELED
:

653 
£lf
.
ŒŸl_’d
 
ªd
 
d©e
 <= self.trial_end:

654 
£lf
.
ŒŸl_’d
 <ğ£lf.
ÿnûl_d©e
:

655 
’d_d©e
 = 
£lf
.
ŒŸl_’d


657 
’d_d©e
 = 
£lf
.
ÿnûl_d©e


659 
’d_d©e
 = 
£lf
.
ÿnûl_d©e


660  
’d_d©e


662 
def
 
	$_log_v®ue_¡©e
(
£lf
, 
v®ue_¡©e
):

663 
logg”
.
	`debug
('Adding value: %s', {

664 'subsütiÚ': 
£lf
.
id
,

665 'v®ue_¡©e': 
v®ue_¡©e


666 
	}
})

668 
def
 
	$_add_¶ª_ŒŸl
(
£lf
, 
¡¬t_d©e
, 
’d_d©e
, 
švoiû
=
NÚe
,

669 
´ofÜma
=
NÚe
):

671 
Adds
 
the
 
¶ª
 
ŒŸl
 
to
h
docum’t
, 
by
 
addšg
 
ª
 
’Œy
 
w™h
 
pos™ive


672 
´Ü©ed
 
v®ue
 
ªd
 
Úe
 
w™h
…rÜ©ed, 
Ãg©ive
 v®u
which
 
»´e£Ás


673 
the
 
discouÁ
 th
ŒŸl
 
³riod
.

676 
´Ü©ed
, 
³rûÁ
 = 
£lf
.
	$_g‘_´Ü©iÚ_¡©us_ªd_³rûÁ
(
¡¬t_d©e
,

677 
’d_d©e
)

678 
¶ª_´iû
 = 
£lf
.
¶ª
.
amouÁ
 * 
³rûÁ


680 
cÚ‹xt
 = 
£lf
.
	`_bud_’Œy_cÚ‹xt
({

681 'Çme': 
£lf
.
¶ª
.
Çme
,

682 'un™': 
£lf
.
¶ª
.
š‹rv®
,

683 '´oduù_code': 
£lf
.
¶ª
.
´oduù_code
,

684 '¡¬t_d©e': 
¡¬t_d©e
,

685 '’d_d©e': 
’d_d©e
,

686 '´Ü©ed': 
´Ü©ed
,

687 '´Ü©iÚ_³rûÁage': 
³rûÁ
,

689 
	}
})

691 
un™
 = 
£lf
.
	$_’Œy_un™
(
cÚ‹xt
)

693 
desütiÚ
 = 
£lf
.
	$_’Œy_desütiÚ
(
cÚ‹xt
)

695 #Add 
¶ª
 
w™h
 
pos™ive
 
v®ue


696 
Docum’tEÁry
.
objeùs
.
	`ü—‹
(

697 
švoiû
=švoiû, 
´ofÜma
õrofÜma, 
desütiÚ
=description,

698 
un™
=un™, 
un™_´iû
=
¶ª_´iû
, 
quªt™y
=
	`Decim®
('1.00'),

699 
´oduù_code
=
£lf
.
¶ª
.´oduù_code, 
´Ü©ed
=prorated,

700 
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=end_date

703 
cÚ‹xt
.
	`upd©e
({

705 
	}
})

707 
desütiÚ
 = 
£lf
.
	$_’Œy_desütiÚ
(
cÚ‹xt
)

709 #Add 
¶ª
 
w™h
 
Ãg©ive
 
v®ue


710 
Docum’tEÁry
.
objeùs
.
	`ü—‹
(

711 
švoiû
=švoiû, 
´ofÜma
õrofÜma, 
desütiÚ
=description,

712 
un™
=un™, 
un™_´iû
=-
¶ª_´iû
, 
quªt™y
=
	`Decim®
('1.00'),

713 
´oduù_code
=
£lf
.
¶ª
.´oduù_code, 
´Ü©ed
=prorated,

714 
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=end_date

717  
	`Decim®
("0.00")

719 
def
 
	$_g‘_cÚsumed_un™s_äom_tÙ®_šşuded_š_ŒŸl
(
£lf
, 
m‘”ed_ã©u»
,

720 
cÚsumed_un™s
):

722 :
»tuºs
: (
cÚsumed_un™s
, 
ä“_un™s
)

725 
m‘”ed_ã©u»
.
šşuded_un™s_duršg_ŒŸl
:

726 
šşuded_un™s_duršg_ŒŸl
 = 
m‘”ed_ã©u»
.included_units_during_trial

727 
cÚsumed_un™s
 > 
šşuded_un™s_duršg_ŒŸl
:

728 
exŒa_cÚsumed
 = 
cÚsumed_un™s
 - 
šşuded_un™s_duršg_ŒŸl


729  
exŒa_cÚsumed
, 
šşuded_un™s_duršg_ŒŸl


731  0, 
cÚsumed_un™s


732 
–if
 
m‘”ed_ã©u»
.
šşuded_un™s_duršg_ŒŸl
 =ğ
	`Decim®
('0.0000'):

733  
cÚsumed_un™s
, 0

734 
–if
 
m‘”ed_ã©u»
.
šşuded_un™s_duršg_ŒŸl
 
is
 
NÚe
:

735  0, 
cÚsumed_un™s


737 
def
 
	$_g‘_exŒa_cÚsumed_un™s_duršg_ŒŸl
(
£lf
, 
m‘”ed_ã©u»
,

738 
cÚsumed_un™s
):

740 :
»tuºs
: (
exŒa_cÚsumed
, 
ä“_un™s
)

741 
exŒa_cÚsumed
 - 
un™s
 
cÚsumed
 
exŒa
 
duršg
 
ŒŸl
 
th©
 
wl
 
be


742 
bËd


743 
ä“_un™s
 - 
the
 
un™s
 
šşuded
 
š
 
ŒŸl


746 
£lf
.
is_bËd_fœ¡_time
:

748  
£lf
.
	$_g‘_cÚsumed_un™s_äom_tÙ®_šşuded_š_ŒŸl
(

749 
m‘”ed_ã©u»
, 
cÚsumed_un™s
)

752 #Th
fŞlowšg
 
·¹
 
Œ›s
 
so
 
hªdË
 
the
 
wh’
h
ŒŸl


753 #¥ª 
ov”
 2 
mÚths
 
ªd
 
the
 
subsütiÚ
 
has
 
b“n
 
®»ady
 
bËd


754 #Úû => 
this
 
mÚth
 
™
 
is
 
¡l
 
Ú
 
ŒŸl
 
but
 iˆ
Úly


755 #ha 
»maššg
 = 
cÚsumed_Ï¡_cyşe
 - 
šşuded_duršg_ŒŸl


756 
Ï¡_log_’Œy
 = 
£lf
.
blšg_logs
.
	`®l
()[0]

757 
Ï¡_log_’Œy
.
´ofÜma
:

758 
qs
 = 
Ï¡_log_’Œy
.
´ofÜma
.
´ofÜma_’Œ›s
.
	$f‹r
(

759 
´oduù_code
=
m‘”ed_ã©u»
.product_code)

761 
qs
 = 
Ï¡_log_’Œy
.
švoiû
.
švoiû_’Œ›s
.
	$f‹r
(

762 
´oduù_code
=
m‘”ed_ã©u»
.product_code)

764 
nÙ
 
qs
.
	$exi¡s
():

765  
£lf
.
	$_g‘_cÚsumed_un™s_äom_tÙ®_šşuded_š_ŒŸl
(

766 
m‘”ed_ã©u»
, 
cÚsumed_un™s
)

768 
cÚsumed
 = [
qs_™em
.
quªt™y


769 
qs_™em
 
š
 
qs
 qs_™em.
un™_´iû
 >= 0]

770 
cÚsumed_š_Ï¡_blšg_cyşe
 = 
	$sum
(
cÚsumed
)

772 
m‘”ed_ã©u»
.
šşuded_un™s_duršg_ŒŸl
:

773 
šşuded_duršg_ŒŸl
 = 
m‘”ed_ã©u»
.
šşuded_un™s_duršg_ŒŸl


774 
cÚsumed_š_Ï¡_blšg_cyşe
 > 
šşuded_duršg_ŒŸl
:

775  
cÚsumed_un™s
, 0

777 
»maššg
 = 
šşuded_duršg_ŒŸl
 - 
cÚsumed_š_Ï¡_blšg_cyşe


778 
cÚsumed_un™s
 > 
»maššg
:

779  
cÚsumed_un™s
 - 
»maššg
,„emaining

780 
–if
 
cÚsumed_un™s
 <ğ
»maššg
:

781  0, 
cÚsumed_un™s


782  0, 
cÚsumed_un™s


784 
def
 
	$_add_mfs_fÜ_ŒŸl
(
£lf
, 
¡¬t_d©e
, 
’d_d©e
, 
švoiû
=
NÚe
,

785 
´ofÜma
=
NÚe
):

786 
´Ü©ed
, 
³rûÁ
 = 
£lf
.
	$_g‘_´Ü©iÚ_¡©us_ªd_³rûÁ
(
¡¬t_d©e
,

787 
’d_d©e
)

788 
cÚ‹xt
 = 
£lf
.
	`_bud_’Œy_cÚ‹xt
({

789 '´oduù_code': 
£lf
.
¶ª
.
´oduù_code
,

790 '¡¬t_d©e': 
¡¬t_d©e
,

791 '’d_d©e': 
’d_d©e
,

792 '´Ü©ed': 
´Ü©ed
,

793 '´Ü©iÚ_³rûÁage': 
³rûÁ
,

795 
	}
})

797 
tÙ®
 = 
Decim®
("0.00")

799 #Add 
®l
 
the
 
m‘”ed
 
ã©u»s
 
cÚsumed
 
duršg
h
ŒŸl
 
³riod


800 
m‘”ed_ã©u»
 
š
 
£lf
.
¶ª
.
m‘”ed_ã©u»s
.
	$®l
():

801 
cÚ‹xt
.
	`upd©e
({'m‘”ed_ã©u»': 
m‘”ed_ã©u»
,

802 'un™': 
m‘”ed_ã©u»
.
un™
,

803 'Çme': 
m‘”ed_ã©u»
.
Çme
,

804 '´oduù_code': 
m‘”ed_ã©u»
.
´oduù_code
})

806 
un™
 = 
£lf
.
	$_’Œy_un™
(
cÚ‹xt
)

808 
qs
 = 
£lf
.
mf_log_’Œ›s
.
	$f‹r
(
m‘”ed_ã©u»
=metered_feature,

809 
¡¬t_d©e__g‹
=
¡¬t_d©e
,

810 
’d_d©e__Ée
=
’d_d©e
)

811 
log
 = [
qs_™em
.
cÚsumed_un™s
 qs_™em 
š
 
qs
]

812 
tÙ®_cÚsumed_un™s
 = 
	$sum
(
log
)

814 
exŒa_cÚsumed
, 
ä“
 = 
£lf
.
	$_g‘_exŒa_cÚsumed_un™s_duršg_ŒŸl
(

815 
m‘”ed_ã©u»
, 
tÙ®_cÚsumed_un™s
)

817 
exŒa_cÚsumed
 > 0:

818 
ch¬ged_un™s
 = 
exŒa_cÚsumed


819 
ä“_un™s
 = 
ä“


821 
ä“_un™s
 = 
tÙ®_cÚsumed_un™s


822 
ch¬ged_un™s
 = 0

824 
ä“_un™s
 > 0:

825 
desütiÚ
 = 
£lf
.
	$_’Œy_desütiÚ
(
cÚ‹xt
)

827 #Pos™iv
v®ue
 
the
 
cÚsumed
 
™ems
.

828 
Docum’tEÁry
.
objeùs
.
	$ü—‹
(

829 
švoiû
=švoiû, 
´ofÜma
õrofÜma, 
desütiÚ
=description,

830 
un™
=un™, 
quªt™y
=
ä“_un™s
,

831 
un™_´iû
=
m‘”ed_ã©u»
.
´iû_³r_un™
,

832 
´oduù_code
=
m‘”ed_ã©u»
.product_code,

833 
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=end_date,

834 
´Ü©ed
=prorated

837 
cÚ‹xt
.
	`upd©e
({

839 
	}
})

841 
desütiÚ
 = 
£lf
.
	$_’Œy_desütiÚ
(
cÚ‹xt
)

843 #Neg©iv
v®ue
 
the
 
cÚsumed
 
™ems
.

844 
Docum’tEÁry
.
objeùs
.
	`ü—‹
(

845 
švoiû
=švoiû, 
´ofÜma
õrofÜma, 
desütiÚ
=description,

846 
un™
=un™, 
quªt™y
=
ä“_un™s
,

847 
un™_´iû
=-
m‘”ed_ã©u»
.
´iû_³r_un™
,

848 
´oduù_code
=
m‘”ed_ã©u»
.product_code,

849 
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=end_date,

850 
´Ü©ed
=prorated

853 #ExŒ¨
™ems
 
cÚsumed
 i‹m 
th©
 
¬e
 
nÙ
 
šşuded


854 
ch¬ged_un™s
 > 0:

855 
cÚ‹xt
.
	`upd©e
({

857 
	}
})

859 
desütiÚ_‹m¶©e_·th
 = 
f›ld_‹m¶©e_·th
(

860 
f›ld
='entry_description',

861 
´ovid”
=
£lf
.
¶ª
.´ovid”.
¦ug
)

862 
desütiÚ
 = 
	$»nd”_to_¡ršg
(

863 
desütiÚ_‹m¶©e_·th
, 
cÚ‹xt


866 
tÙ®
 +ğ
Docum’tEÁry
.
objeùs
.
	`ü—‹
(

867 
švoiû
=švoiû, 
´ofÜma
=proforma,

868 
desütiÚ
=desütiÚ, 
un™
=unit,

869 
quªt™y
=
ch¬ged_un™s
, 
´Ü©ed
=prorated,

870 
un™_´iû
=
m‘”ed_ã©u»
.
´iû_³r_un™
,

871 
´oduù_code
=
m‘”ed_ã©u»
.product_code,

872 
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=end_date

873 ).
tÙ®


875  
tÙ®


877 
def
 
	$_add_¶ª_v®ue
(
£lf
, 
¡¬t_d©e
, 
’d_d©e
, 
švoiû
=
NÚe
,

878 
´ofÜma
=
NÚe
):

880 
Adds
 
to
 
the
 
docum’t
h
v®ue
 
of
h
¶ª
.

883 
´Ü©ed
, 
³rûÁ
 = 
£lf
.
	$_g‘_´Ü©iÚ_¡©us_ªd_³rûÁ
(
¡¬t_d©e
,

884 
’d_d©e
)

886 
cÚ‹xt
 = 
£lf
.
	`_bud_’Œy_cÚ‹xt
({

887 'Çme': 
£lf
.
¶ª
.
Çme
,

888 'un™': 
£lf
.
¶ª
.
š‹rv®
,

889 '´oduù_code': 
£lf
.
¶ª
.
´oduù_code
,

890 '¡¬t_d©e': 
¡¬t_d©e
,

891 '’d_d©e': 
’d_d©e
,

892 '´Ü©ed': 
´Ü©ed
,

893 '´Ü©iÚ_³rûÁage': 
³rûÁ
,

895 
	}
})

896 
desütiÚ
 = 
£lf
.
	$_’Œy_desütiÚ
(
cÚ‹xt
)

898 #G‘ 
the
 
¶ª
's…rorated value

899 
¶ª_´iû
 = 
£lf
.
¶ª
.
amouÁ
 * 
³rûÁ


901 
un™
 = 
£lf
.
	$_’Œy_un™
(
cÚ‹xt
)

903  
Docum’tEÁry
.
objeùs
.
	`ü—‹
(

904 
švoiû
=švoiû, 
´ofÜma
õrofÜma, 
desütiÚ
=description,

905 
un™
=un™, 
un™_´iû
=
¶ª_´iû
, 
quªt™y
=
	`Decim®
('1.00'),

906 
´oduù_code
=
£lf
.
¶ª
.´oduù_code, 
´Ü©ed
=prorated,

907 
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=end_date

908 ).
tÙ®


910 
def
 
	$_g‘_cÚsumed_un™s
(
£lf
, 
m‘”ed_ã©u»
, 
´Ü©iÚ_³rûÁ
,

911 
¡¬t_d©e
, 
’d_d©e
):

912 
šşuded_un™s
 = (
´Ü©iÚ_³rûÁ
 * 
m‘”ed_ã©u»
.included_units)

914 
qs
 = 
£lf
.
mf_log_’Œ›s
.
	$f‹r
(
m‘”ed_ã©u»
=metered_feature,

915 
¡¬t_d©e__g‹
=
¡¬t_d©e
,

916 
’d_d©e__Ée
=
’d_d©e
)

917 
log
 = [
qs_™em
.
cÚsumed_un™s
 qs_™em 
š
 
qs
]

918 
tÙ®_cÚsumed_un™s
 = 
	`»duû
(
Ïmbda
 
x
, 
y
: x + y, 
log
, 0)

920 
tÙ®_cÚsumed_un™s
 > 
šşuded_un™s
:

921  
tÙ®_cÚsumed_un™s
 - 
šşuded_un™s


924 
def
 
	$_add_mfs
(
£lf
, 
¡¬t_d©e
, 
’d_d©e
, 
švoiû
=
NÚe
, 
´ofÜma
=None):

925 
´Ü©ed
, 
³rûÁ
 = 
£lf
.
	$_g‘_´Ü©iÚ_¡©us_ªd_³rûÁ
(
¡¬t_d©e
,

926 
’d_d©e
)

928 
cÚ‹xt
 = 
£lf
.
	`_bud_’Œy_cÚ‹xt
({

929 'Çme': 
£lf
.
¶ª
.
Çme
,

930 'un™': 
£lf
.
¶ª
.
š‹rv®
,

931 '´oduù_code': 
£lf
.
¶ª
.
´oduù_code
,

932 '¡¬t_d©e': 
¡¬t_d©e
,

933 '’d_d©e': 
’d_d©e
,

934 '´Ü©ed': 
´Ü©ed
,

935 '´Ü©iÚ_³rûÁage': 
³rûÁ
,

937 
	}
})

939 
mfs_tÙ®
 = 
Decim®
('0.00')

940 
m‘”ed_ã©u»
 
š
 
£lf
.
¶ª
.
m‘”ed_ã©u»s
.
	$®l
():

941 
cÚsumed_un™s
 = 
£lf
.
	$_g‘_cÚsumed_un™s
(

942 
m‘”ed_ã©u»
, 
³rûÁ
, 
¡¬t_d©e
, 
’d_d©e
)

944 
cÚ‹xt
.
	`upd©e
({'m‘”ed_ã©u»': 
m‘”ed_ã©u»
,

945 'un™': 
m‘”ed_ã©u»
.
un™
,

946 'Çme': 
m‘”ed_ã©u»
.
Çme
,

947 '´oduù_code': 
m‘”ed_ã©u»
.
´oduù_code
})

949 
desütiÚ
 = 
£lf
.
	$_’Œy_desütiÚ
(
cÚ‹xt
)

950 
un™
 = 
£lf
.
	$_’Œy_un™
(
cÚ‹xt
)

952 
mf
 = 
Docum’tEÁry
.
objeùs
.
	$ü—‹
(

953 
švoiû
=švoiû, 
´ofÜma
=proforma,

954 
desütiÚ
=desütiÚ, 
un™
=unit,

955 
quªt™y
=
cÚsumed_un™s
, 
´Ü©ed
=prorated,

956 
un™_´iû
=
m‘”ed_ã©u»
.
´iû_³r_un™
,

957 
´oduù_code
=
m‘”ed_ã©u»
.product_code,

958 
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=end_date

961 
mfs_tÙ®
 +ğ
mf
.
tÙ®


963  
mfs_tÙ®


965 
def
 
	$_g‘_´Ü©iÚ_¡©us_ªd_³rûÁ
(
£lf
, 
¡¬t_d©e
, 
’d_d©e
):

967 
R‘uºs
 
the
 
´Ü©iÚ
 
	$³rûÁ
 (
how
 
much
 
of
 
the
 
š‹rv®
 
wl
 
be
 
bËd
)

968 
ªd
 
the
 
	`¡©us
 (th
subsütiÚ
 
is
 
´Ü©ed
 
Ü
 
nÙ
).

970 :
»tuºs
: 
a
 
tu¶e
 
	`cÚššg
 (
	`Decim®
(
³rûÁ
), 
¡©us
è
wh”e
 status

971 
ÿn
 
be
 
Úe
 
of
 [
True
, 
F®£
]. 
The
 
decim®
 
v®ue
 
wl
 
äom
 
the


972 
š‹rv®
 [0.00; 1.00].

973 :
¹y³
: 
tu¶e


976 
fœ¡_day_of_mÚth
 = 
	$d©e
(
¡¬t_d©e
.
y—r
, s¹_d©e.
mÚth
, 1)

977 
Ï¡_day_šdex
 = 
ÿËnd¬
.
	`mÚth¿nge
(
¡¬t_d©e
.
y—r
,

978 
¡¬t_d©e
.
mÚth
)[1]

979 
Ï¡_day_of_mÚth
 = 
	$d©e
(
¡¬t_d©e
.
y—r
, s¹_d©e.
mÚth
,

980 
Ï¡_day_šdex
)

982 
¡¬t_d©e
 =ğ
fœ¡_day_of_mÚth
 
ªd
 
’d_d©e
 =ğ
Ï¡_day_of_mÚth
:

983  
F®£
, 
	`Decim®
('1.0000')

985 
days_š_fuÎ_š‹rv®
 = (
Ï¡_day_of_mÚth
 - 
fœ¡_day_of_mÚth
).
days
 + 1

986 
days_š_š‹rv®
 = (
’d_d©e
 - 
¡¬t_d©e
).
days
 + 1

987 
³rûÁ
 = 1.0 * 
days_š_š‹rv®
 / 
days_š_fuÎ_š‹rv®


988 
³rûÁ
 = 
	`Decim®
Õ”ûÁ).
	`quªtize
(Decimal('0.0000'))

990  
True
, 
³rûÁ


992 
def
 
	$_’Œy_un™
(
£lf
, 
cÚ‹xt
):

993 
un™_‹m¶©e_·th
 = 
	`f›ld_‹m¶©e_·th
(

994 
f›ld
='’Œy_un™', 
´ovid”
=
£lf
.
¶ª
.´ovid”.
¦ug
)

995  
	$»nd”_to_¡ršg
(
un™_‹m¶©e_·th
, 
cÚ‹xt
)

997 
def
 
	$_’Œy_desütiÚ
(
£lf
, 
cÚ‹xt
):

998 
desütiÚ_‹m¶©e_·th
 = 
	`f›ld_‹m¶©e_·th
(

999 
f›ld
='’Œy_desütiÚ', 
´ovid”
=
£lf
.
¶ª
.´ovid”.
¦ug


1001  
	`»nd”_to_¡ršg
(
desütiÚ_‹m¶©e_·th
, 
cÚ‹xt
)

1003 @
´İ”ty


1004 
def
 
	$_ba£_’Œy_cÚ‹xt
(
£lf
):

1006 'Çme': 
NÚe
,

1008 'subsütiÚ': 
£lf
,

1009 '¶ª': 
£lf
.
¶ª
,

1010 '´ovid”': 
£lf
.
¶ª
.
´ovid”
,

1011 'cu¡om”': 
£lf
.
cu¡om”
,

1012 '´oduù_code': 
NÚe
,

1013 '¡¬t_d©e': 
NÚe
,

1014 '’d_d©e': 
NÚe
,

1015 '´Ü©ed': 
NÚe
,

1016 '´Ü©iÚ_³rûÁage': 
NÚe
,

1017 'm‘”ed_ã©u»': 
NÚe
,

1018 'cÚ‹xt': 
NÚe


1019 
	}
}

1021 
def
 
	$_bud_’Œy_cÚ‹xt
(
£lf
, 
cÚ‹xt
):

1022 
ba£_cÚ‹xt
 = 
£lf
.
_ba£_’Œy_cÚ‹xt


1023 
ba£_cÚ‹xt
.
	$upd©e
(
cÚ‹xt
)

1024  
ba£_cÚ‹xt


1026 
def
 
	$__unicode__
(
£lf
):

1027  
u
'% (%s)' % (
£lf
.
cu¡om”
, s–f.
¶ª
)

1030 
şass
 
	$BlšgLog
(
mod–s
.
Mod–
):

1031 
subsütiÚ
 = 
mod–s
.
	`FÜeignKey
('Subscription',

1032 
»Ï‹d_Çme
='billing_logs')

1033 
švoiû
 = 
mod–s
.
	`FÜeignKey
('BlšgDocum’tBa£', 
nuÎ
=
True
, 
bÏnk
=True,

1034 
»Ï‹d_Çme
='invoice_billing_logs')

1035 
´ofÜma
 = 
mod–s
.
	`FÜeignKey
('BlšgDocum’tBa£', 
nuÎ
=
True
, 
bÏnk
=True,

1036 
»Ï‹d_Çme
='proforma_billing_logs')

1037 
blšg_d©e
 = 
mod–s
.
	`D©eF›ld
(

1038 
h–p_‹xt
="The date whenhe invoice/proforma was issued."

1040 
¶ª_bËd_up_to
 = 
mod–s
.
	`D©eF›ld
(

1041 
h–p_‹xt
="The date upo whichhe…lan base‡mount has been billed."

1043 
m‘”ed_ã©u»s_bËd_up_to
 = 
mod–s
.
	`D©eF›ld
(

1044 
h–p_‹xt
="The date upo whichhe metered features have been billed."

1046 
tÙ®
 = 
mod–s
.
	$Decim®F›ld
(

1047 
decim®_¶aûs
=2, 
max_dig™s
=12,

1048 
nuÎ
=
True
, 
bÏnk
=True

1050 
ü—‹d_©
 = 
mod–s
.
	$D©eTimeF›ld
(
auto_now_add
=
timezÚe
.
now
)

1052 
şass
 
M‘a
:

1053 
Üd”šg
 = ['-billing_date']

1055 
def
 
	$__unicode__
(
£lf
):

1056  
u
'{sub} - {´o} - {šv} - {d©e}'.
	`fÜm©
(

1057 
sub
=
£lf
.
subsütiÚ
, 
´o
=£lf.
´ofÜma
,

1058 
šv
=
£lf
.
švoiû
, 
d©e
=£lf.
blšg_d©e
)

1061 @
	$»ûiv”
(
´e_d–‘e
, 
£nd”
=
Cu¡om”
)

1062 
def
 
	$ÿnûl_blšg_docum’ts
(
£nd”
, 
š¡ªû
, **
kw¬gs
):

1063 
š¡ªû
.
pk
 
ªd
 
nÙ
 
kw¬gs
.
	`g‘
('¿w', 
F®£
):

1064 
subsütiÚs
 = 
SubsütiÚ
.
objeùs
.
	$f‹r
(

1065 
cu¡om”
=
š¡ªû
, 
¡©e
=
SubsütiÚ
.
STATES
.
ACTIVE


1067 
subsütiÚ
 
š
 
subsütiÚs
:

1068 
Œy
:

1069 
subsütiÚ
.
	$ÿnûl
()

1070 
subsütiÚ
.
	$’d
()

1071 
subsütiÚ
.
	$§ve
()

1072 
exû±
 
T¿ns™iÚNÙAÎowed
:

1073 
logg”
.
	`”rÜ
(

1075 'subsütiÚ': 
subsütiÚ
.
id
,

1076 
	}
}

1078 
	g·ss


	@silver/models/transactions/__init__.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
Œª§ùiÚ
 
impÜt
 
	gT¿n§ùiÚ


	@silver/models/transactions/codes.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
	gFAIL_CODES
 = {

63 
REFUND_CODES
 = {

69 
CANCEL_CODES
 = {

	@silver/models/transactions/transaction.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
impÜt
 
uuid


16 
impÜt
 
loggšg


17 
äom
 
decim®
 
impÜt
 
Decim®


19 
äom
 
	gdjªgo
.
	gdb
.
mod–s
 
impÜt
 
Q


20 
äom
 
	gªnoyšg
.
f›lds
 
impÜt
 
JSONF›ld


21 
äom
 
djªgo_fsm
 
impÜt
 
po¡_Œªs™iÚ


22 
äom
 
djªgo_fsm
 
impÜt
 
	gFSMF›ld
, 
Œªs™iÚ


23 
äom
 
	gªnoyšg
.
funùiÚs
 
impÜt
 
g‘_objeù_Ü_NÚe


25 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
V®id©iÚE¼Ü


26 
äom
 
	gdjªgo
.
	gcÜe
.
v®id©Üs
 
impÜt
 
MšV®ueV®id©Ü


27 
äom
 
	gdjªgo
.
db
 
impÜt
 
	gmod–s
, 
Œª§ùiÚ


28 
äom
 
	gdjªgo
.
	gdb
.
	gmod–s
.
sigÇls
 
impÜt
 
po¡_§ve


29 
äom
 
	gdjªgo
.
di¥©ch
 
impÜt
 
»ûiv”


30 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


31 
äom
 
	gdjªgo
.
	guts
.
Œª¦©iÚ
 
impÜt
 
ug‘‹xt_Ïzy
 
as
 
_


33 
äom
 
	gsv”
.
	guts
.
š‹º©iÚ®
 
impÜt
 
cu¼’c›s


34 
äom
 
	gsv”
.
	guts
.
mod–s
 
impÜt
 
AutoD©eTimeF›ld


35 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gInvoiû
, 
	gProfÜma
, 
SubsütiÚ


37 
	gäom
 .
codes
 
impÜt
 
	gFAIL_CODES
, 
	gREFUND_CODES
, 
CANCEL_CODES


40 
	glogg”
 = 
loggšg
.
	$g‘Logg”
(
__Çme__
)

43 
şass
 
	$T¿n§ùiÚ
(
mod–s
.
Mod–
):

44 
_´ovid”
 = 
NÚe


46 
amouÁ
 = 
mod–s
.
	`Decim®F›ld
(

47 
decim®_¶aûs
=2, 
max_dig™s
=12,

48 
v®id©Üs
=[
	`MšV®ueV®id©Ü
(
	`Decim®
('0.00'))]

50 
cu¼’cy
 = 
mod–s
.
	`Ch¬F›ld
(

51 
choiûs
=
cu¼’c›s
, 
max_Ëngth
=4,

52 
h–p_‹xt
='The currency used for billing.'

55 
şass
 
M‘a
:

56 
Üd”šg
 = ['-id']

58 
şass
 
S‹s
:

59 
In™Ÿl
 = 'initial'

60 
P’dšg
 = 'pending'

61 
S‘ed
 = 'settled'

62 
Faed
 = 'failed'

63 
CªûËd
 = 'canceled'

64 
Refunded
 = 'refunded'

66 @
şassm‘hod


67 
def
 
	$as_li¡
(
şs
):

68  [
	$g‘©Œ
(
şs
, 
¡©e
è¡©
š
 
	`v¬s
(şs).
	$keys
() 

69 
¡©e
[0].
	`isuµ”
()]

71 @
şassm‘hod


72 
def
 
	$as_choiûs
(
şs
):

74 (
¡©e
, 
	`_
(¡©e.
	$ÿp™®ize
())è
¡©e
 
š
 
şs
.
	$as_li¡
()

77 
ex‹º®_»ã»nû
 = 
mod–s
.
	$Ch¬F›ld
(
max_Ëngth
=256, 
nuÎ
=
True
, 
bÏnk
=True)

78 
d©a
 = 
	`JSONF›ld
(={
	}
}, 
	gnuÎ
=
True
, 
	gbÏnk
=True)

79 
¡©e
 = 
FSMF›ld
(
max_Ëngth
=8, 
choiûs
=
S‹s
.
as_choiûs
(),

80 =
S‹s
.
In™Ÿl
)

82 
´ofÜma
 = 
mod–s
.
FÜeignKey
("BlšgDocum’tBa£", 
nuÎ
=
True
, 
bÏnk
=True,

83 
»Ï‹d_Çme
='proforma_transactions')

84 
švoiû
 = 
mod–s
.
FÜeignKey
("BlšgDocum’tBa£", 
nuÎ
=
True
, 
bÏnk
=True,

85 
»Ï‹d_Çme
='invoice_transactions')

87 
·ym’t_m‘hod
 = 
mod–s
.
FÜeignKey
('PaymentMethod')

88 
uuid
 = 
mod–s
.
	$UUIDF›ld
(=
uuid
.
uuid4
)

89 
v®id_uÁ
 = 
mod–s
.
	$D©eTimeF›ld
(
nuÎ
=
True
, 
bÏnk
=True)

90 
Ï¡_acûss
 = 
mod–s
.
	$D©eTimeF›ld
(
nuÎ
=
True
, 
bÏnk
=True)

92 
ü—‹d_©
 = 
mod–s
.
	$D©eTimeF›ld
(=
timezÚe
.
now
)

93 
upd©ed_©
 = 
	$AutoD©eTimeF›ld
(=
timezÚe
.
now
)

95 
ç_code
 = 
mod–s
.
	`Ch¬F›ld
(

96 
choiûs
=[(
code
, codeècod
š
 
FAIL_CODES
.
	`keys
()], 
max_Ëngth
=32,

97 
nuÎ
=
True
, 
bÏnk
=True

99 
»fund_code
 = 
mod–s
.
	`Ch¬F›ld
(

100 
choiûs
=[(
code
, codeècod
š
 
REFUND_CODES
.
	`keys
()], 
max_Ëngth
=32,

101 
nuÎ
=
True
, 
bÏnk
=True

103 
ÿnûl_code
 = 
mod–s
.
	`Ch¬F›ld
(

104 
choiûs
=[(
code
, codeècod
š
 
CANCEL_CODES
.
	`keys
()], 
max_Ëngth
=32,

106 
nuÎ
=
True
, 
bÏnk
=True

109 @
´İ”ty


110 
def
 
	$fš®_f›lds
(
£lf
):

111 
f›lds
 = ['proforma', 'invoice', 'uuid', 'payment_method', 'amount',

114  
f›lds


116 
def
 
	$__š™__
(
£lf
, *
¬gs
, **
kw¬gs
):

117 
£lf
.
fÜm_şass
 = 
kw¬gs
.
	`pİ
('fÜm_şass', 
NÚe
)

119 
	`su³r
(
T¿n§ùiÚ
, 
£lf
).
	`__š™__
(*
¬gs
, **
kw¬gs
)

121 @
	$Œªs™iÚ
(
f›ld
=
¡©e
, 
sourû
=
S‹s
.
In™Ÿl
, 
rg‘
=S‹s.
P’dšg
)

122 
def
 
	$´oûss
(
£lf
):

123 
·ss


125 @
	$Œªs™iÚ
(
f›ld
=
¡©e
, 
sourû
=[
S‹s
.
In™Ÿl
, S‹s.
P’dšg
],

126 
rg‘
=
S‹s
.
S‘ed
)

127 
def
 
	$£‰Ë
(
£lf
, 
Ãw_šaùive_subsütiÚ
=
NÚe
):

128 
äom
 
SubsütiÚ
.
uts
 
impÜt
 
aùiv©eSubsütiÚ


129 
”rÜ
 = ''

130 
Œy
:

131 
nÙ
 
Ãw_šaùive_subsütiÚ
:

132 #Ãw_šaùive_subsütiÚ = 
SubsütiÚ
.
objeùs
.
	`g‘
(
»ã»nû
=
£lf
.
ex‹º®_»ã»nû
)

133 
¶ª
 = 
£lf
.
d©a
.
	`g‘
('¶ª_d‘a',{
	}
})

134 
nÙ
 
	g¶ª
:

135 
sv”_logg”
.
debug
("NØ¶ª found iÀŒª§ùiÚ havšg„eã»û = {}".
	$fÜm©
(
unq_Üd”_id
))

136 
¿i£
 
	`V®id©iÚE¼Ü
("No…lan found inransaction")

137 
PID
 = 
¶ª
.
	`g‘
('id')

138 
Ãw_šaùive_subsütiÚ
, 
ü—‹d
 = 
SubsütiÚ
.
objeùs
.
	`g‘_Ü_ü—‹
(
»ã»nû
=
£lf
.
ex‹º®_»ã»nû
,

139 
deçuÉs
={'¶ª_id':
PID
,'cu¡om”': 
£lf
.
cu¡om”
})

140 #subsütiÚ ,
”rÜ
 = 
aùiv©eSubsütiÚ
(
£lf
, 
Ãw_šaùive_subsütiÚ
)

141 
	gÃw_šaùive_subsütiÚ
.
aùiv©e
(
¡¬t_d©e
=
timezÚe
.
now
().
	$d©e
())

142 
Ãw_šaùive_subsütiÚ
.
	$§ve
()

143 
exû±
 
SubsütiÚ
.
DÛsNÙExi¡
 
as
 
e
:

144 
”rÜ
 = "Error in‡ctivating subscription"

145 
logg”
.
	`debug
("NØsubsütiÚ found†škedØŒª§ùiÚƒx‹º®_»ã»nû: {}…k:{}".
	$fÜm©
(

146 
£lf
.
ex‹º®_»ã»nû
, s–f.
pk
))

147 
exû±
 
V®id©iÚE¼Ü
 
as
 
e
:

148 
”rÜ
 = "Error in…roviding‡ccesso user"

149 
logg”
.
	`debug
("E¼Ü iÀ£‰šg u£¸m‘ad©¨fÜhi Œªa§ùiÚ :ex‹º®_»ã»nû: {}…k:{}".
	$fÜm©
(

150 
£lf
.
ex‹º®_»ã»nû
, s–f.
pk
))

151 
exû±
 
Exû±iÚ
 
as
 
e
:

152 
”rÜ
 = "Error in‡ctivating subscription"

153 
logg”
.
	`debug
("E¼Ü Occu»d iÀaùiv©šg SubsütiÚ iÀ£‰Ë T¿n§ùiÚ.ex‹º®_»ã»nû:{} subsütiÚ.pk:{}".
	$fÜm©
(

154 
£lf
.
ex‹º®_»ã»nû
,
Ãw_šaùive_subsütiÚ
.
pk
))

155 
logg”
.
	`debug
("E¼Ü Occu»d iÀaùiv©šg SubsütiÚ iÀhªdËTxnSucûs E¼Ü MSG:{}".
	$fÜm©
(
e
))

157 
”rÜ
:

158 
¿i£
 
	`V®id©iÚE¼Ü
(
”rÜ
)

160 @
	$Œªs™iÚ
(
f›ld
=
¡©e
, 
sourû
=[
S‹s
.
In™Ÿl
, S‹s.
P’dšg
],

161 
rg‘
=
S‹s
.
CªûËd
)

162 
def
 
	`ÿnûl
(
£lf
, 
ÿnûl_code
='deçuÉ', 
ÿnûl_»asÚ
='Unknown cancel„eason'):

163 
£lf
.
ÿnûl_code
 = cancel_code

164 
logg”
.
	`”rÜ
(
	`¡r
(
ÿnûl_»asÚ
))

166 @
	$Œªs™iÚ
(
f›ld
=
¡©e
, 
sourû
=[
S‹s
.
In™Ÿl
, S‹s.
P’dšg
],

167 
rg‘
=
S‹s
.
Faed
)

168 
def
 
	`ç
(
£lf
, 
ç_code
='deçuÉ', 
ç_»asÚ
='Unknown fail„eason'):

169 
£lf
.
ç_code
 = fail_code

170 
d©a_diù
 = 
£lf
.
d©a
 £lf.d©¨{
	}
}

171 
d©a_diù
.
upd©e
({'ç_»asÚ': 
ç_»asÚ
})

172 
logg”
.
”rÜ
(
¡r
(
ç_»asÚ
))

174 @
	$Œªs™iÚ
(
f›ld
=
¡©e
, 
sourû
=
S‹s
.
S‘ed
, 
rg‘
=S‹s.
Refunded
)

175 
def
 
	`»fund
(
£lf
, 
»fund_code
='deçuÉ', 
»fund_»asÚ
='Unknown„efund„eason'):

176 
£lf
.
»fund_code
 =„efund_code

177 
logg”
.
	`”rÜ
(
	`¡r
(
»fund_»asÚ
))

179 @
Œª§ùiÚ
.
	$©omic
()

180 
def
 
	$§ve
(
£lf
, *
¬gs
, **
kw¬gs
):

181 
´evious_š¡ªû
 = 
	$g‘_objeù_Ü_NÚe
(
T¿n§ùiÚ
, 
pk
=
£lf
.pkè£lf.pk 
NÚe


182 
	`£‰r
(
£lf
, '´evious_š¡ªû', 
´evious_š¡ªû
)

184 
nÙ
 
´evious_š¡ªû
:

185 #C»©šg 
a
 
Ãw
 
T¿n§ùiÚ
 
so
 
we
 
lock
 
the
 
DB
 
rows
 
»Ï‹d
 
blšg
 
docum’ts
 
ªd


187 
£lf
.
´ofÜma
:

188 
ProfÜma
.
objeùs
.
	`£Ëù_fÜ_upd©e
().
	$f‹r
(
pk
=
£lf
.
´ofÜma
.pk)

189 
–if
 
£lf
.
švoiû
:

190 
Invoiû
.
objeùs
.
	`£Ëù_fÜ_upd©e
().
	$f‹r
(
pk
=
£lf
.
švoiû
.pk)

192 
T¿n§ùiÚ
.
objeùs
.
	`£Ëù_fÜ_upd©e
().
	`f‹r
(
	`Q
(
´ofÜma
=
£lf
.proforma) |

193 
	$Q
(
švoiû
=
£lf
.invoice))

195 
nÙ
 
	`g‘©Œ
(
£lf
, '.ş—Ãd', 
F®£
):

196 
£lf
.
	$fuÎ_ş—n
(
´evious_š¡ªû
=previous_instance)

198 
	`su³r
(
T¿n§ùiÚ
, 
£lf
).
	$§ve
(*
¬gs
, **
kw¬gs
)

200 
def
 
	$ş—n
(
£lf
):

201 #V®id©
docum’ts


202 
docum’t
 = 
£lf
.document

203 
nÙ
 
docum’t
:

204 
¿i£
 
	`V®id©iÚE¼Ü
(

209 
docum’t
.
¡©e
 =ğdocum’t.
STATES
.
DRAFT
:

210 
¿i£
 
	`V®id©iÚE¼Ü
(

215 
£lf
.
švoiû
 
ªd
 s–f.
´ofÜma
:

216 
£lf
.
švoiû
.
»Ï‹d_docum’t
 !ğ£lf.
´ofÜma
:

217 
¿i£
 
	`V®id©iÚE¼Ü
('Invoice‡nd…roforma‡re‚ot„elated.')

219 
£lf
.
švoiû
:

220 
£lf
.
´ofÜma
 = s–f.
švoiû
.
»Ï‹d_docum’t


222 
£lf
.
švoiû
 = s–f.
´ofÜma
.
»Ï‹d_docum’t


224 
docum’t
.
cu¡om”
 !ğ
£lf
.customer:

225 
¿i£
 
	`V®id©iÚE¼Ü
(

229 #New 
Œª§ùiÚ


230 
nÙ
 
£lf
.
pk
:

231 
docum’t
.
¡©e
 !ğdocum’t.
STATES
.
ISSUED
:

232 
¿i£
 
	`V®id©iÚE¼Ü
(

236 
£lf
.
cu¼’cy
:

237 
£lf
.
cu¼’cy
 !ğ£lf.
docum’t
.
Œª§ùiÚ_cu¼’cy
:

238 
mes§ge
 = "Transaction currency is different from it's document's "\

240 
¿i£
 
	$V®id©iÚE¼Ü
(
mes§ge
)

242 
£lf
.
cu¼’cy
 = s–f.
docum’t
.
Œª§ùiÚ_cu¼’cy


244 ià(
£lf
.
·ym’t_m‘hod
.
®lowed_cu¼’c›s
 
ªd


245 
£lf
.
cu¼’cy
 
nÙ
 
š
 s–f.
·ym’t_m‘hod
.
®lowed_cu¼’c›s
):

246 
mes§ge
 = 'Currency {} is‚ot‡llowed byhe…ayment method. Allowed currencies ' \

247 '¬{}.'.
	$fÜm©
(

248 
£lf
.
cu¼’cy
, s–f.
·ym’t_m‘hod
.
®lowed_cu¼’c›s


250 
¿i£
 
	$V®id©iÚE¼Ü
(
mes§ge
)

251 
£lf
.
amouÁ
:

252 
£lf
.
amouÁ
 > s–f.
docum’t
.
amouÁ_to_be_ch¬ged_š_Œª§ùiÚ_cu¼’cy
:

253 
mes§ge
 = "Amount is greaterhanhe‡mounthat should be charged in order " \

255 
¿i£
 
	$V®id©iÚE¼Ü
(
mes§ge
)

257 
£lf
.
amouÁ
 = s–f.
docum’t
.
amouÁ_to_be_ch¬ged_š_Œª§ùiÚ_cu¼’cy


259 
def
 
	$ş—n_w™h_´evious_š¡ªû
(
£lf
, 
´evious_š¡ªû
):

260 
nÙ
 
´evious_š¡ªû
:

263 
f›ld
 
š
 
£lf
.
fš®_f›lds
:

264 
Şd_v®ue
 = 
	$g‘©Œ
(
´evious_š¡ªû
, 
f›ld
, 
NÚe
)

265 
cu¼’t_v®ue
 = 
	$g‘©Œ
(
£lf
, 
f›ld
, 
NÚe
)

267 
Şd_v®ue
 
is
 
nÙ
 
NÚe
 
ªd
 old_v®u!ğ
cu¼’t_v®ue
:

268 
¿i£
 
	`V®id©iÚE¼Ü
("F›ld '%s' may‚Ù bchªged." % 
f›ld
)

270 
def
 
	$fuÎ_ş—n
(
£lf
, *
¬gs
, **
kw¬gs
):

271 #'
amouÁ
'‡nd '
cu¼’cy
'‡re handled in our clean method

272 
kw¬gs
['exşude'] = kw¬gs.
	`g‘
('exclude', []) + ['currency', 'amount']

274 
´evious_š¡ªû
 = 
kw¬gs
.
	`pİ
('´evious_š¡ªû', 
NÚe
)

276 
	`su³r
(
T¿n§ùiÚ
, 
£lf
).
	$fuÎ_ş—n
(*
¬gs
, **
kw¬gs
)

278 
£lf
.
	$ş—n_w™h_´evious_š¡ªû
(
´evious_š¡ªû
)

280 #thi 
assumes
 
th©
 
nobody
 
ÿÎs
 
ş—n
 
ªd
 
th’
 
modif›s
 
this
 
objeù


281 #w™houˆ
ÿÎšg
 
ş—n
 
agaš


282 
	`£‰r
(
£lf
, '.ş—Ãd', 
True
)

284 @
´İ”ty


285 
def
 
	$ÿn_be_cÚsumed
(
£lf
):

286 
£lf
.
v®id_uÁ
 
ªd
 s–f.v®id_uÁ < 
timezÚe
.
	$now
():

287  
F®£


289 
£lf
.
¡©e
 !ğ
T¿n§ùiÚ
.
S‹s
.
In™Ÿl
:

290  
F®£


292  
True


294 @
´İ”ty


295 
def
 
	$cu¡om”
(
£lf
):

296  
£lf
.
·ym’t_m‘hod
.
cu¡om”


298 @
´İ”ty


299 
def
 
	$docum’t
(
£lf
):

300  
£lf
.
švoiû
 
Ü
 s–f.
´ofÜma


302 @
docum’t
.
£‰”


303 
def
 
	$docum’t
(
£lf
, 
v®ue
):

304 
	$isš¡ªû
(
v®ue
, 
Invoiû
):

305 
£lf
.
švoiû
 = 
v®ue


306 
–if
 
	$isš¡ªû
(
v®ue
, 
ProfÜma
):

307 
£lf
.
´ofÜma
 = 
v®ue


309 
¿i£
 
	`V®ueE¼Ü
(

313 @
´İ”ty


314 
def
 
	$´ovid”
(
£lf
):

315  
£lf
.
_´ovid”
 
Ü
 s–f.
docum’t
.
´ovid”


317 @
´ovid”
.
£‰”


318 
def
 
	$´ovid”
(
£lf
, 
´ovid”
):

319 
£lf
.
_´ovid”
 = 
´ovid”


321 @
´İ”ty


322 
def
 
	$·ym’t_´oûssÜ
(
£lf
):

323  
£lf
.
·ym’t_m‘hod
.
·ym’t_´oûssÜ


325 
def
 
	$upd©e_docum’t_¡©e
(
£lf
):

326 ià(
£lf
.
¡©e
 =ğ
T¿n§ùiÚ
.
S‹s
.
S‘ed
 
ªd


327 
nÙ
 
£lf
.
docum’t
.
amouÁ_to_be_ch¬ged_š_Œª§ùiÚ_cu¼’cy
):

328 
£lf
.
docum’t
.
	$·y
()

330 
def
 
	$__unicode__
(
£lf
):

331  
	`unicode
(
£lf
.
uuid
)

334 @
	$»ûiv”
(
po¡_Œªs™iÚ
)

335 
def
 
	$po¡_Œªs™iÚ_ÿÎback
(
£nd”
, 
š¡ªû
, 
Çme
, 
sourû
, 
rg‘
, **
kw¬gs
):

336 
	$issubşass
(
£nd”
, 
T¿n§ùiÚ
):

337 
	`£‰r
(
š¡ªû
, '.»ûÁly_Œªs™iÚed', 
rg‘
)

340 @
	$»ûiv”
(
po¡_§ve
, 
£nd”
=
T¿n§ùiÚ
)

341 
def
 
	$po¡_Œª§ùiÚ_§ve
(
£nd”
, 
š¡ªû
, **
kw¬gs
):

342 
Œª§ùiÚ
 = 
š¡ªû


344 
	`ha§‰r
(
Œª§ùiÚ
, '.recently_transitioned'):

345 
	`d–©Œ
(
Œª§ùiÚ
, '.recently_transitioned')

346 
Œª§ùiÚ
.
	$upd©e_docum’t_¡©e
()

348 
	`ha§‰r
(
Œª§ùiÚ
, '.cleaned'):

349 
	`d–©Œ
(
Œª§ùiÚ
, '.cleaned')

351 
nÙ
 
	`g‘©Œ
(
Œª§ùiÚ
, '´evious_š¡ªû', 
NÚe
):

352 #w
know
 
this
 
š¡ªû
 
is
 
äeshly
 
made
 
as
 
™
 
dÛ¢
't have‡n old_value

353 
logg”
.
	`šfo
('[Models][Transaction]: %s', {

355 'Œª§ùiÚ_id': 
Œª§ùiÚ
.
id
,

356 'cu¡om”_id': 
Œª§ùiÚ
.
cu¡om”
.
id
,

357 'švoiû_id': 
Œª§ùiÚ
.
švoiû
.
id
 Œª§ùiÚ.švoiû 
NÚe
,

359 
Œª§ùiÚ
.
´ofÜma
.
id
 Œª§ùiÚ.´ofÜm¨
NÚe


360 
	}
})

	@silver/payment_processors/__init__.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
	gäom
 .
ba£
 
impÜt
 
	gPaym’tProûssÜBa£
, 
	gg‘_š¡ªû
, 
g‘_®l_š¡ªûs


16 
	gäom
 .
mixšs
 
impÜt
 
Paym’tProûssÜTy³s
 
as
 
Ty³s


17 
	gäom
 .
mªu®
 
impÜt
 
	gMªu®ProûssÜ


	@silver/payment_processors/base.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


16 
äom
 
	gdjªgo
.
	guts
.
decÚ¡ruù
 
impÜt
 
decÚ¡ruùibË


17 
äom
 
	gdjªgo
.
	guts
.
moduË_lßdšg
 
impÜt
 
impÜt_¡ršg


18 
äom
 
	gdjªgo
.
	guts
.
‹xt
 
impÜt
 
¦ugify


19 
äom
 
	gdjªgo
.
	g‹m¶©e
.
lßd”
 
impÜt
 
£Ëù_‹m¶©e


22 
def
 
	$g‘_š¡ªû
(
Çme
):

23 
d©a
 = 
£‰šgs
.
PAYMENT_PROCESSORS
[
Çme
]

24 
kÏss
 = 
	`impÜt_¡ršg
(
d©a
['class'])

25 
kw¬gs
 = 
d©a
.
	`g‘
('£tup_d©a', {
	}
})

26  
	$kÏss
(
Çme
, **
kw¬gs
)

29 
def
 
	$g‘_®l_š¡ªûs
():

30 
choiûs
 = []

31 
´oûssÜ_impÜt_·th
 
š
 
£‰šgs
.
PAYMENT_PROCESSORS
.
	$keys
():

32 
choiûs
.
	`­³nd
(
	$g‘_š¡ªû
(
´oûssÜ_impÜt_·th
))

33  
choiûs


36 @
decÚ¡ruùibË


37 
şass
 
	$Paym’tProûssÜBa£
(
objeù
):

38 
fÜm_şass
 = 
NÚe


39 
‹m¶©e_¦ug
 = 
NÚe


40 
·ym’t_m‘hod_şass
 = 
NÚe


41 
Œª§ùiÚ_v›w_şass
 = 
NÚe


42 
®lowed_cu¼’c›s
 = ()

44 
def
 
	$__š™__
(
£lf
, 
Çme
):

45 
£lf
.
Çme
 =‚ame

47 
def
 
	$g‘_v›w
(
£lf
, 
Œª§ùiÚ
, 
»que¡
, **
kw¬gs
):

48 
kw¬gs
.
	`upd©e
({

49 'fÜm': 
£lf
.
	`g‘_fÜm
(
Œª§ùiÚ
, 
»que¡
),

50 '‹m¶©e': 
£lf
.
	`g‘_‹m¶©e
(
Œª§ùiÚ
),

51 'Œª§ùiÚ': 
Œª§ùiÚ
,

52 '»que¡': 
»que¡


53 
	}
})

54  
£lf
.
Œª§ùiÚ_v›w_şass
.
	$as_v›w
(**
kw¬gs
)

56 
def
 
	$g‘_fÜm
(
£lf
, 
Œª§ùiÚ
, 
»que¡
):

57 
fÜm
 = 
NÚe


58 
£lf
.
fÜm_şass
:

59 
fÜm
 = 
£lf
.
	$fÜm_şass
(
·ym’t_m‘hod
=
Œª§ùiÚ
.payment_method,

60 
Œª§ùiÚ
ñ¿n§ùiÚ, 
»que¡
=request)

62  
fÜm


64 
def
 
	$g‘_‹m¶©e
(
£lf
, 
Œª§ùiÚ
):

65 
´ovid”
 = 
Œª§ùiÚ
.
docum’t
.provider

66 
´ovid”_¦ug
 = 
	$¦ugify
(
´ovid”
.
com·ny
 
Ü
…rovid”.
Çme
)

68 
‹m¶©e
 = 
	`£Ëù_‹m¶©e
([

69 'fÜms/{}/{}_Œª§ùiÚ_fÜm.html'.
	`fÜm©
(

70 
£lf
.
‹m¶©e_¦ug
,

71 
´ovid”_¦ug


73 'fÜms/{}/Œª§ùiÚ_fÜm.html'.
	`fÜm©
(

74 
£lf
.
‹m¶©e_¦ug


79  
‹m¶©e


81 
def
 
	$hªdË_Œª§ùiÚ_»¥Ú£
(
£lf
, 
Œª§ùiÚ
, 
»que¡
):

83 
This
 
m‘hod
 
should
 
upd©e
 
the
 
Œª§ùiÚ
 
¡©us
 
aá”
h
fœ¡


84 
HTTP
 
»¥Ú£
 
äom
 
the
 
·ym’t
 
g©eway
.

86 
Upd©e
 
Œª§ùiÚ
's stateo Pending or Failed.

88 
It
's called by complete_payment_view.

90 
If
 
nÙ
 
Ãeded
, 
Úe
 
ÿn
 
·ss
 
™
.

93 
¿i£
 
NÙIm¶em’‹dE¼Ü


95 
def
 
	$__»´__
(
£lf
):

96  
£lf
.
Çme


98 
def
 
	$__unicode__
(
£lf
):

99  
	$unicode
(
£lf
.
Çme
)

101 
def
 
	$__¡r__
(
£lf
):

102  
	$¡r
(
£lf
.
Çme
)

104 
def
 
	$__eq__
(
£lf
, 
Ùh”
):

105  
£lf
.
__şass__
 
is
 
Ùh”
.__class__

107 
def
 
	$__Ã__
(
£lf
, 
Ùh”
):

108  
nÙ
 
£lf
.
	`__eq__
(
Ùh”
)

	@silver/payment_processors/forms.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
	gdjªgo
.
fÜms
 
impÜt
 
FÜm


18 
şass
 
	$G’”icT¿n§ùiÚFÜm
(
FÜm
):

19 
def
 
	$__š™__
(
£lf
, 
·ym’t_m‘hod
, 
Œª§ùiÚ
, 
»que¡
=
NÚe
, *
¬gs
, **
kw¬gs
):

20 
£lf
.
·ym’t_m‘hod
 =…ayment_method

21 
£lf
.
Œª§ùiÚ
 =ransaction

22 
£lf
.
»que¡
 =„equest

24 
	`su³r
(
G’”icT¿n§ùiÚFÜm
, 
£lf
).
	`__š™__
(*
¬gs
, **
kw¬gs
)

	@silver/payment_processors/manual.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
	gsv”
.
	g·ym’t_´oûssÜs
.
v›ws
 
impÜt
 
G’”icT¿n§ùiÚV›w


16 
äom
 
	gsv”
.
	g·ym’t_´oûssÜs
.
fÜms
 
impÜt
 
G’”icT¿n§ùiÚFÜm


18 
	gäom
 .
ba£
 
impÜt
 
Paym’tProûssÜBa£


19 
	gäom
 .
mixšs
 
impÜt
 
Mªu®ProûssÜMixš


22 
şass
 
	$Mªu®ProûssÜ
(
Paym’tProûssÜBa£
, 
Mªu®ProûssÜMixš
):

23 
Œª§ùiÚ_v›w_şass
 = 
G’”icT¿n§ùiÚV›w


24 
fÜm_şass
 = 
G’”icT¿n§ùiÚFÜm


	@silver/payment_processors/mixins.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
impÜt
 
loggšg


16 
impÜt
 
os


18 
äom
 
	gdjªgo
.
	gcÚŒib
.
	gadmš
.
	g‹m¶©‘ags
.
admš_li¡
 
impÜt
 
™ems_fÜ_»suÉ


19 
äom
 
	gdjªgo
.
	guts
.
decÚ¡ruù
 
impÜt
 
decÚ¡ruùibË


21 
	glogg”
 = 
loggšg
.
	$g‘Logg”
(
__Çme__
)

24 
şass
 
	$Paym’tProûssÜTy³s
(
objeù
):

25 
Mªu®
 = "manual"

26 
Autom©ic
 = "automatic"

27 
Trigg”ed
 = "triggered"

30 
şass
 
	$Mªu®ProûssÜMixš
(
objeù
):

31 
ty³
 = 
Paym’tProûssÜTy³s
.
Mªu®


34 
şass
 
	$Ba£AùiÚabËProûssÜ
(
objeù
):

36 
NÙ
 
a
 
Mªu®
 
ty³
 
ProûssÜ


39 
def
 
	$»fund_Œª§ùiÚ
(
£lf
, 
Œª§ùiÚ
, 
·ym’t_m‘hod
=
NÚe
):

41 
Refunds
 / 
»tuºs
 
the
 
mÚey
 
to
h
giv’
 
·ym’t_m‘hod
 
Ü
ohe

42 
Œª§ùiÚ
's…ayment method

44 :: 
True
 
Ú
 
sucûss
, 
F®£
 oÀ
çu»
.

47 
¿i£
 
NÙIm¶em’‹dE¼Ü


49 
def
 
	$void_Œª§ùiÚ
(
£lf
, 
Œª§ùiÚ
, 
·ym’t_m‘hod
=
NÚe
):

51 
Voids
 / 
š‹¼u±s
 
a
 
³ndšg
 / 
Úgošg
 
Œª§ùiÚ


53 :: 
True
 
Ú
 
sucûss
, 
F®£
 oÀ
çu»
.

56 
¿i£
 
NÙIm¶em’‹dE¼Ü


58 
def
 
	$execu‹_Œª§ùiÚ
(
£lf
, 
Œª§ùiÚ
):

60 
C»©es
 
a
 
»®
 
Œª§ùiÚ
 
ba£d
 
Ú
 
the
 
giv’
ransaction.

62 
Should
 
Úly
 
be
 
ÿÎed
 
š™Ÿl
 
Œª§ùiÚs
 
th©
 
b–Úg
 
to
 
the


63 
·ym’t
 
´oûssÜ
 
wh”e
 
this
 
is
 
im¶em’‹d
.

65 :: 
True
 
Ú
 
sucûss
, 
F®£
 oÀ
çu»
.

68 
¿i£
 
NÙIm¶em’‹dE¼Ü


70 
def
 
	$ãtch_Œª§ùiÚ_¡©us
(
£lf
, 
Œª§ùiÚ
):

72 
Im¶em’tiÚ
 
is
 
İtiÚ®
.

74 
U£d
 
·ym’t
 
´oûssÜs
 
th©
 dØ
nÙ
 
´ovide
 
webhooks
 
ªd
 
»quœe


75 
š‹¼og©iÚs
 
š™Ÿ‹d
 
by
 
us
, 
to
 
obš
 
the
 
¡©us
 
of
he

76 
Œª§ùiÚ
.

78 
Should
 
Úly
 
be
 
ÿÎed
 
³ndšg
 
Œª§ùiÚs
 
th©
 
b–Úg
 
to
 
the


79 
·ym’t
 
´oûssÜ
 
wh”e
 
this
 
is
 
im¶em’‹d
.

81 
Cª
 
be
 
ÿÎed
 
®l
 
³ndšg
 
Œª§ùiÚs
 
by
 
usšg
 
the
 
mªagem’t


82 
commªd
 
w™h
 
the
 
§me
 
Çme
.

84 :: 
True
 
Ú
 
sucûss
, 
F®£
 oÀ
çu»
.

87  
True


90 
şass
 
	$Autom©icProûssÜMixš
(
Ba£AùiÚabËProûssÜ
):

91 
ty³
 = 
Paym’tProûssÜTy³s
.
Autom©ic


93 
def
 
	$£tup_autom©ed_·ym’ts
(
£lf
, 
cu¡om”
):

95 
DÛs
 
the
 
Ãûs§ry
 
İ”©iÚs
 
to
 
’su»
 
·ym’ts
 
¬e
 
autom©iÿÎy


96 
´oûs£d
 
by
 
the
 
´oûssÜ
 
£rviû
.

98 
¿i£
 
NÙIm¶em’‹dE¼Ü


101 
şass
 
	$Trigg”edProûssÜMixš
(
Ba£AùiÚabËProûssÜ
):

102 
ty³
 = 
Paym’tProûssÜTy³s
.
Trigg”ed


	@silver/payment_processors/views.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #vim: 
á
=
pythÚ
:
sw
=4:
ts
=4:
¡s
=4:
‘
:

4 
äom
 
	gdjªgo
.
	gv›ws
.
g’”ic
 
impÜt
 
V›w


5 
äom
 
	gdjªgo
.
h‰p
 
impÜt
 
H‰pRe¥Ú£


6 
äom
 
	g»¡_äamewÜk
.
exû±iÚs
 
impÜt
 
M‘hodNÙAÎowed


7 
äom
 
	gsv”
.
	guts
.
·ym’ts
 
impÜt
 
g‘_·ym’t_com¶‘e_u¾


10 
şass
 
	$G’”icT¿n§ùiÚV›w
(
V›w
):

11 
fÜm
 = 
NÚe


12 
‹m¶©e
 = 
NÚe


13 
Œª§ùiÚ
 = 
NÚe


14 
»que¡
 = 
NÚe


16 
def
 
	$g‘_cÚ‹xt_d©a
(
£lf
):

18 '·ym’t_m‘hod': 
£lf
.
Œª§ùiÚ
.
·ym’t_m‘hod
,

19 'Œª§ùiÚ': 
£lf
.
Œª§ùiÚ
,

20 'docum’t': 
£lf
.
Œª§ùiÚ
.
docum’t
,

21 'cu¡om”': 
£lf
.
Œª§ùiÚ
.
cu¡om”
,

22 '´ovid”': 
£lf
.
Œª§ùiÚ
.
´ovid”
,

23 '’Œ›s': 
	`li¡
(
£lf
.
Œª§ùiÚ
.
docum’t
.
_’Œ›s
),

24 'fÜm': 
£lf
.
fÜm
,

25 '·ym’t_com¶‘e_u¾': 
	`g‘_·ym’t_com¶‘e_u¾
(
£lf
.
Œª§ùiÚ
,

26 
£lf
.
»que¡
)

27 
	}
}

29 
def
 
	$»nd”_‹m¶©e
(
£lf
):

30  
£lf
.
‹m¶©e
.
	`»nd”
(
cÚ‹xt
=£lf.
	$g‘_cÚ‹xt_d©a
())

32 
def
 
	$g‘
(
£lf
, 
»que¡
):

33  
	`H‰pRe¥Ú£
(
£lf
.
	$»nd”_‹m¶©e
())

35 
def
 
	$po¡
(
£lf
, 
»que¡
):

36 
¿i£
 
M‘hodNÙAÎowed


	@silver/static/css/skeleton.css

31 .
	gcÚš”
 {

32 
	gpos™iÚ
: 
»Ïtive
;

33 
	gwidth
: 100%;

34 
	gmax
-
	gwidth
: 960
px
;

35 
	gm¬gš
: 0‡uto;

36 
	g·ddšg
: 0 20
px
;

37 
	gbox
-
	gsizšg
: 
bÜd”
-
box
; }

38 .
	gcŞumn
,

39 .
	gcŞumns
 {

40 
	gwidth
: 100%;

41 : 
Ëá
;

42 
	gbox
-
	gsizšg
: 
bÜd”
-
box
; }

45 @
medŸ
 (
mš
-
width
: 400
px
) {

46 .
cÚš”
 {

47 
width
: 85%;

48 
	g·ddšg
: 0; }

52 @
medŸ
 (
mš
-
width
: 550
px
) {

53 .
cÚš”
 {

54 
width
: 80%; }

55 .
	gcŞumn
,

56 .
	gcŞumns
 {

57 
	gm¬gš
-
	gËá
: 4%; }

58 .
	gcŞumn
:
fœ¡
-
chd
,

59 .
	gcŞumns
:
fœ¡
-
chd
 {

60 
m¬gš
-
Ëá
: 0; }

62 .
	gÚe
.
	gcŞumn
,

63 .
	gÚe
.
	gcŞumns
 { 
	gwidth
: 4.66666666667%; }

64 .
	gtwo
.
	gcŞumns
 { 
	gwidth
: 13.3333333333%; }

65 .
	gth»e
.
	gcŞumns
 { 
	gwidth
: 22%; }

66 .
	gfour
.
	gcŞumns
 { 
	gwidth
: 30.6666666667%; }

67 .
	gfive
.
	gcŞumns
 { 
	gwidth
: 39.3333333333%; }

68 .
	gsix
.
	gcŞumns
 { 
	gwidth
: 48%; }

69 .
	g£v’
.
	gcŞumns
 { 
	gwidth
: 56.6666666667%; }

70 .
	geight
.
	gcŞumns
 { 
	gwidth
: 65.3333333333%; }

71 .
	gnše
.
	gcŞumns
 { 
	gwidth
: 74.0%; }

72 .
	g‹n
.
	gcŞumns
 { 
	gwidth
: 82.6666666667%; }

73 .
	g–ev’
.
	gcŞumns
 { 
	gwidth
: 91.3333333333%; }

74 .
	gtw–ve
.
	gcŞumns
 { 
	gwidth
: 100%; 
	gm¬gš
-
	gËá
: 0; }

76 .
	gÚe
-
	gthœd
.
	gcŞumn
 { 
	gwidth
: 30.6666666667%; }

77 .
	gtwo
-
	gthœds
.
	gcŞumn
 { 
	gwidth
: 65.3333333333%; }

79 .
	gÚe
-
	gh®f
.
	gcŞumn
 { 
	gwidth
: 48%; }

82 .
	goff£t
-
	gby
-
	gÚe
.
	gcŞumn
,

83 .
	goff£t
-
	gby
-
	gÚe
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 8.66666666667%; }

84 .
	goff£t
-
	gby
-
	gtwo
.
	gcŞumn
,

85 .
	goff£t
-
	gby
-
	gtwo
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 17.3333333333%; }

86 .
	goff£t
-
	gby
-
	gth»e
.
	gcŞumn
,

87 .
	goff£t
-
	gby
-
	gth»e
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 26%; }

88 .
	goff£t
-
	gby
-
	gfour
.
	gcŞumn
,

89 .
	goff£t
-
	gby
-
	gfour
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 34.6666666667%; }

90 .
	goff£t
-
	gby
-
	gfive
.
	gcŞumn
,

91 .
	goff£t
-
	gby
-
	gfive
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 43.3333333333%; }

92 .
	goff£t
-
	gby
-
	gsix
.
	gcŞumn
,

93 .
	goff£t
-
	gby
-
	gsix
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 52%; }

94 .
	goff£t
-
	gby
-
	g£v’
.
	gcŞumn
,

95 .
	goff£t
-
	gby
-
	g£v’
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 60.6666666667%; }

96 .
	goff£t
-
	gby
-
	geight
.
	gcŞumn
,

97 .
	goff£t
-
	gby
-
	geight
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 69.3333333333%; }

98 .
	goff£t
-
	gby
-
	gnše
.
	gcŞumn
,

99 .
	goff£t
-
	gby
-
	gnše
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 78.0%; }

100 .
	goff£t
-
	gby
-
	g‹n
.
	gcŞumn
,

101 .
	goff£t
-
	gby
-
	g‹n
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 86.6666666667%; }

102 .
	goff£t
-
	gby
-
	g–ev’
.
	gcŞumn
,

103 .
	goff£t
-
	gby
-
	g–ev’
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 95.3333333333%; }

105 .
	goff£t
-
	gby
-
	gÚe
-
	gthœd
.
	gcŞumn
,

106 .
	goff£t
-
	gby
-
	gÚe
-
	gthœd
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 34.6666666667%; }

107 .
	goff£t
-
	gby
-
	gtwo
-
	gthœds
.
	gcŞumn
,

108 .
	goff£t
-
	gby
-
	gtwo
-
	gthœds
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 69.3333333333%; }

110 .
	goff£t
-
	gby
-
	gÚe
-
	gh®f
.
	gcŞumn
,

111 .
	goff£t
-
	gby
-
	gÚe
-
	gh®f
.
	gcŞumns
 { 
	gm¬gš
-
	gËá
: 52%; }

121 
	ghtml
 {

122 
	gfÚt
-
	gsize
: 62.5%; }

123 
	gbody
 {

124 
	gfÚt
-
	gsize
: 1.5e
m
;

125 
	glše
-
	gheight
: 1.6;

126 
	gfÚt
-
	gweight
: 400;

127 
	gfÚt
-
	gçmy
: "R®eway", "H–v‘iÿNeue", "H–v‘iÿ Neue", 
	gH–v‘iÿ
, 
	gArŸl
, 
	g§ns
-
	g£rif
;

128 
	gcŞÜ
: #222; }

133 
	gh1
, 
	gh2
, 
	gh3
, 
	gh4
, 
	gh5
, 
	gh6
 {

134 
	gm¬gš
-
	gtİ
: 0;

135 
	gm¬gš
-
	gbÙtom
: 2
»m
;

136 
	gfÚt
-
	gweight
: 300; }

137 
	gh1
 { 
	gfÚt
-
	gsize
: 4.0
»m
; 
	glše
-
	gheight
: 1.2; 
	gË‰”
-
	g¥acšg
: -.1rem;}

138 
	gh2
 { 
	gfÚt
-
	gsize
: 3.6
»m
; 
	glše
-
	gheight
: 1.25; 
	gË‰”
-
	g¥acšg
: -.1rem; }

139 
	gh3
 { 
	gfÚt
-
	gsize
: 3.0
»m
; 
	glše
-
	gheight
: 1.3; 
	gË‰”
-
	g¥acšg
: -.1rem; }

140 
	gh4
 { 
	gfÚt
-
	gsize
: 2.4
»m
; 
	glše
-
	gheight
: 1.35; 
	gË‰”
-
	g¥acšg
: -.08rem; }

141 
	gh5
 { 
	gfÚt
-
	gsize
: 1.8
»m
; 
	glše
-
	gheight
: 1.5; 
	gË‰”
-
	g¥acšg
: -.05rem; }

142 
	gh6
 { 
	gfÚt
-
	gsize
: 1.5
»m
; 
	glše
-
	gheight
: 1.6; 
	gË‰”
-
	g¥acšg
: 0; }

145 @
medŸ
 (
mš
-
width
: 550
px
) {

146 
h1
 { 
fÚt
-
size
: 5.0
»m
; }

147 
	gh2
 { 
	gfÚt
-
	gsize
: 4.2
»m
; }

148 
	gh3
 { 
	gfÚt
-
	gsize
: 3.6
»m
; }

149 
	gh4
 { 
	gfÚt
-
	gsize
: 3.0
»m
; }

150 
	gh5
 { 
	gfÚt
-
	gsize
: 2.4
»m
; }

151 
	gh6
 { 
	gfÚt
-
	gsize
: 1.5
»m
; }

154 
	gp
 {

155 
	gm¬gš
-
	gtİ
: 0; }

160 
	ga
 {

161 
	gcŞÜ
: #1
EAEDB
; }

162 
	ga
:
hov”
 {

163 
cŞÜ
: #0
FA0CE
; }

168 .
	gbu‰Ú
,

169 
	gbu‰Ú
,

170 
	gšput
[
ty³
="submit"],

171 
	gšput
[
ty³
="reset"],

172 
	gšput
[
ty³
="button"] {

173 
di¥Ïy
: 
šlše
-
block
;

174 
	gheight
: 38
px
;

175 
	g·ddšg
: 0 30
px
;

176 
	gcŞÜ
: #555;

177 
	g‹xt
-
	g®ign
: 
ûÁ”
;

178 
	gfÚt
-
	gsize
: 11
px
;

179 
	gfÚt
-
	gweight
: 600;

180 
	glše
-
	gheight
: 38
px
;

181 
	gË‰”
-
	g¥acšg
: .1
»m
;

182 
	g‹xt
-
	gŒªsfÜm
: 
uµ”ÿ£
;

183 
	g‹xt
-
	gdecÜ©iÚ
: 
nÚe
;

184 
	gwh™e
-
	g¥aû
: 
now¿p
;

185 
	gbackground
-
	gcŞÜ
: 
Œª¥¬’t
;

186 
	gbÜd”
-
	g¿dius
: 4
px
;

187 
	gbÜd”
: 1
px
 
sŞid
 #bbb;

188 
	gcursÜ
: 
poš‹r
;

189 
	gbox
-
	gsizšg
: 
bÜd”
-
box
; }

190 .
	gbu‰Ú
:
hov”
,

191 
	gbu‰Ú
:
hov”
,

192 
	gšput
[
ty³
="subm™"]:
hov”
,

193 
	gšput
[
ty³
="»£t"]:
hov”
,

194 
	gšput
[
ty³
="bu‰Ú"]:
hov”
,

195 .
	gbu‰Ú
:
focus
,

196 
	gbu‰Ú
:
focus
,

197 
	gšput
[
ty³
="subm™"]:
focus
,

198 
	gšput
[
ty³
="»£t"]:
focus
,

199 
	gšput
[
ty³
="bu‰Ú"]:
focus
 {

200 
cŞÜ
: #333;

201 
	gbÜd”
-
	gcŞÜ
: #888;

202 
	gouše
: 0; }

203 .
	gbu‰Ú
.bu‰Ú-
	g´im¬y
,

204 
	gbu‰Ú
.bu‰Ú-
	g´im¬y
,

205 
	gšput
[
ty³
="subm™"].
bu‰Ú
-
´im¬y
,

206 
	gšput
[
ty³
="»£t"].
bu‰Ú
-
´im¬y
,

207 
	gšput
[
ty³
="bu‰Ú"].
bu‰Ú
-
´im¬y
 {

208 
cŞÜ
: #FFF;

209 
	gbackground
-
	gcŞÜ
: #33C3F0;

210 
	gbÜd”
-
	gcŞÜ
: #33C3F0; }

211 .
	gbu‰Ú
.bu‰Ú-
	g´im¬y
:
hov”
,

212 
	gbu‰Ú
.bu‰Ú-
	g´im¬y
:
hov”
,

213 
	gšput
[
ty³
="subm™"].
bu‰Ú
-
´im¬y
:
hov”
,

214 
	gšput
[
ty³
="»£t"].
bu‰Ú
-
´im¬y
:
hov”
,

215 
	gšput
[
ty³
="bu‰Ú"].
bu‰Ú
-
´im¬y
:
hov”
,

216 .
	gbu‰Ú
.bu‰Ú-
	g´im¬y
:
focus
,

217 
	gbu‰Ú
.bu‰Ú-
	g´im¬y
:
focus
,

218 
	gšput
[
ty³
="subm™"].
bu‰Ú
-
´im¬y
:
focus
,

219 
	gšput
[
ty³
="»£t"].
bu‰Ú
-
´im¬y
:
focus
,

220 
	gšput
[
ty³
="bu‰Ú"].
bu‰Ú
-
´im¬y
:
focus
 {

221 
cŞÜ
: #FFF;

222 
	gbackground
-
	gcŞÜ
: #1
EAEDB
;

223 
	gbÜd”
-
	gcŞÜ
: #1
EAEDB
; }

228 
	gšput
[
ty³
="email"],

229 
	gšput
[
ty³
="number"],

230 
	gšput
[
ty³
="search"],

231 
	gšput
[
ty³
="text"],

232 
	gšput
[
ty³
="tel"],

233 
	gšput
[
ty³
="url"],

234 
	gšput
[
ty³
="password"],

235 
	g‹x»a
,

236 
	g£Ëù
 {

237 
	gheight
: 38
px
;

238 
	g·ddšg
: 6
px
 10px;

239 
	gbackground
-
	gcŞÜ
: #fff;

240 
	gbÜd”
: 1
px
 
sŞid
 #D1D1D1;

241 
	gbÜd”
-
	g¿dius
: 4
px
;

242 
	gbox
-
	gshadow
: 
nÚe
;

243 
	gbox
-
	gsizšg
: 
bÜd”
-
box
; }

245 
	gšput
[
ty³
="email"],

246 
	gšput
[
ty³
="number"],

247 
	gšput
[
ty³
="search"],

248 
	gšput
[
ty³
="text"],

249 
	gšput
[
ty³
="tel"],

250 
	gšput
[
ty³
="url"],

251 
	gšput
[
ty³
="password"],

252 
	g‹x»a
 {

253 -
	gwebk™
-
	g­³¬ªû
: 
nÚe
;

254 -
	gmoz
-
	g­³¬ªû
: 
nÚe
;

255 
	g­³¬ªû
: 
nÚe
; }

256 
	g‹x»a
 {

257 
	gmš
-
	gheight
: 65
px
;

258 
	g·ddšg
-
	gtİ
: 6
px
;

259 
	g·ddšg
-
	gbÙtom
: 6
px
; }

260 
	gšput
[
ty³
="ema"]:
focus
,

261 
	gšput
[
ty³
="numb”"]:
focus
,

262 
	gšput
[
ty³
="£¬ch"]:
focus
,

263 
	gšput
[
ty³
="‹xt"]:
focus
,

264 
	gšput
[
ty³
="‹l"]:
focus
,

265 
	gšput
[
ty³
="u¾"]:
focus
,

266 
	gšput
[
ty³
="·sswÜd"]:
focus
,

267 
	g‹x»a
:
focus
,

268 
	g£Ëù
:
focus
 {

269 
bÜd”
: 1
px
 
sŞid
 #33C3F0;

270 
	gouše
: 0; }

271 
	gÏb–
,

272 
	gËg’d
 {

273 
	gdi¥Ïy
: 
block
;

274 
	gm¬gš
-
	gbÙtom
: .5
»m
;

275 
	gfÚt
-
	gweight
: 600; }

276 
	gf›ld£t
 {

277 
	g·ddšg
: 0;

278 
	gbÜd”
-
	gwidth
: 0; }

279 
	gšput
[
ty³
="checkbox"],

280 
	gšput
[
ty³
="radio"] {

281 
di¥Ïy
: 
šlše
; }

282 
	gÏb–
 > .Ïb–-
	gbody
 {

283 
	gdi¥Ïy
: 
šlše
-
block
;

284 
	gm¬gš
-
	gËá
: .5
»m
;

285 
	gfÚt
-
	gweight
: 
nÜm®
; }

290 
	gul
 {

291 
	gli¡
-
	g¡yË
: 
cœşe
 
šside
; }

292 
	gŞ
 {

293 
	gli¡
-
	g¡yË
: 
decim®
 
šside
; }

294 
	gŞ
, 
	gul
 {

295 
	g·ddšg
-
	gËá
: 0;

296 
	gm¬gš
-
	gtİ
: 0; }

297 
ul
 
	gul
,

298 
ul
 
	gŞ
,

299 
Ş
 
	gŞ
,

300 
Ş
 
	gul
 {

301 
	gm¬gš
: 1.5
»m
 0 1.5rem 3rem;

302 
	gfÚt
-
	gsize
: 90%; }

303 
	gli
 {

304 
	gm¬gš
-
	gbÙtom
: 1
»m
; }

309 
	gcode
 {

310 
	g·ddšg
: .2
»m
 .5rem;

311 
	gm¬gš
: 0 .2
»m
;

312 
	gfÚt
-
	gsize
: 90%;

313 
	gwh™e
-
	g¥aû
: 
now¿p
;

314 
	gbackground
: #F1F1F1;

315 
	gbÜd”
: 1
px
 
sŞid
 #E1E1E1;

316 
	gbÜd”
-
	g¿dius
: 4
px
; }

317 
	g´e
 > 
	gcode
 {

318 
	gdi¥Ïy
: 
block
;

319 
	g·ddšg
: 1
»m
 1.5rem;

320 
	gwh™e
-
	g¥aû
: 
´e
; }

325 
	gth
,

326 
	gtd
 {

327 
	g·ddšg
: 12
px
 15px;

328 
	g‹xt
-
	g®ign
: 
Ëá
;

329 
	gbÜd”
-
	gbÙtom
: 1
px
 
sŞid
 #E1E1E1; }

330 
	gth
:
fœ¡
-
chd
,

331 
	gtd
:
fœ¡
-
chd
 {

332 
·ddšg
-
Ëá
: 0; }

333 
	gth
:
Ï¡
-
chd
,

334 
	gtd
:
Ï¡
-
chd
 {

335 
·ddšg
-
right
: 0; }

340 
	gbu‰Ú
,

341 .
	gbu‰Ú
 {

342 
	gm¬gš
-
	gbÙtom
: 1
»m
; }

343 
	gšput
,

344 
	g‹x»a
,

345 
	g£Ëù
,

346 
	gf›ld£t
 {

347 
	gm¬gš
-
	gbÙtom
: 1.5
»m
; }

348 
	g´e
,

349 
	gblockquÙe
,

350 
	gdl
,

351 
	gfigu»
,

352 
	gbË
,

353 
	gp
,

354 
	gul
,

355 
	gŞ
,

356 
	gfÜm
 {

357 
	gm¬gš
-
	gbÙtom
: 2.5
»m
; }

362 .
	gu
-
	gfuÎ
-
	gwidth
 {

363 
	gwidth
: 100%;

364 
	gbox
-
	gsizšg
: 
bÜd”
-
box
; }

365 .
	gu
-
	gmax
-
	gfuÎ
-
	gwidth
 {

366 
	gmax
-
	gwidth
: 100%;

367 
	gbox
-
	gsizšg
: 
bÜd”
-
box
; }

368 .
	gu
-
	gpuÎ
-
	gright
 {

369 : 
right
; }

370 .
	gu
-
	gpuÎ
-
	gËá
 {

371 : 
Ëá
; }

376 
	ghr
 {

377 
	gm¬gš
-
	gtİ
: 3
»m
;

378 
	gm¬gš
-
	gbÙtom
: 3.5
»m
;

379 
	gbÜd”
-
	gwidth
: 0;

380 
	gbÜd”
-
	gtİ
: 1
px
 
sŞid
 #E1E1E1; }

387 .
	gcÚš”
:
aá”
,

388 .
	grow
:
aá”
,

389 .
	gu
-
	gcf
 {

390 
	gcÚ‹Á
: "";

391 
	gdi¥Ïy
: 
bË
;

392 
	gş—r
: 
bÙh
; }

406 @
medŸ
 (
mš
-
width
: 400
px
) {}

409 @
medŸ
 (
mš
-
width
: 550
px
) {}

412 @
medŸ
 (
mš
-
width
: 750
px
) {}

415 @
medŸ
 (
mš
-
width
: 1000
px
) {}

418 @
medŸ
 (
mš
-
width
: 1200
px
) {}

	@silver/tasks.py

1 
äom
 
™”toŞs
 
impÜt
 
chaš


3 
äom
 
ûËry
 
impÜt
 
	ggroup
, 
sh¬ed_sk


4 
äom
 
ûËry_Úû
 
impÜt
 
QueueOnû


5 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


6 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


7 
äom
 
	g»dis
.
exû±iÚs
 
impÜt
 
LockE¼Ü


9 
äom
 
	gsv”
.
docum’ts_g’”©Ü
 
impÜt
 
Docum’tsG’”©Ü


10 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gInvoiû
, 
	gProfÜma
, 
	gT¿n§ùiÚ
, 
BlšgDocum’tBa£


11 
äom
 
	gsv”
.
	g·ym’t_´oûssÜs
.
mixšs
 
impÜt
 
Paym’tProûssÜTy³s


12 
äom
 
	gsv”
.
	gv’dÜs
.
»dis_£rv”
 
impÜt
 
»dis


15 
	gPDF_GENERATION_TIME_LIMIT
 = 
g‘©Œ
(
£‰šgs
, 'PDF_GENERATION_TIME_LIMIT',

16 60è#deçuÉ 60
	gs


19 @
sh¬ed_sk
(
ba£
=
QueueOnû
, 
Úû
={'g¿ûful': 
True
},

20 
time_lim™
=
PDF_GENERATION_TIME_LIMIT
)

21 
def
 
	$g’”©e_pdf
(
docum’t_id
, 
docum’t_ty³
):

22 
docum’t
 = 
BlšgDocum’tBa£
.
objeùs
.
	$g‘
(
id
=
docum’t_id
, 
kšd
=
docum’t_ty³
)

24 
docum’t
.
	`g’”©e_pdf
()

27 @
	$sh¬ed_sk
(
ignÜe_»suÉ
=
True
)

28 
def
 
	$g’”©e_pdfs
():

29 
dœty_docum’ts
 = 
	`chaš
(
Invoiû
.
objeùs
.
	`f‹r
(
pdf__dœty__gt
=0),

30 
ProfÜma
.
objeùs
.
	$f‹r
(
pdf__dœty__gt
=0))

32 #G’”©
PDFs
 
š
 
·¿Î–


33 
	`group
(
g’”©e_pdf
.
	$s
(
docum’t
.
id
, docum’t.
kšd
)

34 
docum’t
 
š
 
dœty_docum’ts
)()

37 
DOCS_GENERATION_TIME_LIMIT
 = 
	`g‘©Œ
(
£‰šgs
, 'DOCS_GENERATION_TIME_LIMIT',

38 60 * 60è#deçuÉ 60
m


41 @
	`sh¬ed_sk
(
ba£
=
QueueOnû
, 
Úû
={'g¿ûful': 
True
},

42 
	gtime_lim™
=
DOCS_GENERATION_TIME_LIMIT
, 
	gignÜe_»suÉ
=
True
)

43 
def
 
	$g’”©e_blšg_docum’ts
(
blšg_d©e
=
NÚe
):

44 
nÙ
 
blšg_d©e
:

45 
blšg_d©e
 = 
timezÚe
.
	`now
().
	$d©e
()

47 
	`Docum’tsG’”©Ü
().
	$g’”©e
(
blšg_d©e
=billing_date)

50 
FETCH_TRANSACTION_STATUS_TIME_LIMIT
 = 
	`g‘©Œ
(
£‰šgs
, 'FETCH_TRANSACTION_STATUS_TIME_LIMIT',

51 60è#deçuÉ 60
s


54 @
	`sh¬ed_sk
(
ba£
=
QueueOnû
, 
Úû
={'g¿ûful': 
True
},

55 
	gtime_lim™
=
FETCH_TRANSACTION_STATUS_TIME_LIMIT
)

56 
def
 
	$ãtch_Œª§ùiÚ_¡©us
(
Œª§ùiÚ_id
):

57 
Œª§ùiÚ
 = 
T¿n§ùiÚ
.
objeùs
.
	`f‹r
(
pk
=
Œª§ùiÚ_id
).
	$fœ¡
()

58 
nÙ
 
Œª§ùiÚ
:

61 
·ym’t_´oûssÜ
 = 
Œª§ùiÚ
.
·ym’t_m‘hod
.
	$g‘_·ym’t_´oûssÜ
()

62 
·ym’t_´oûssÜ
.
ty³
 !ğ
Paym’tProûssÜTy³s
.
Trigg”ed
:

65 
·ym’t_´oûssÜ
.
	`ãtch_Œª§ùiÚ_¡©us
(
Œª§ùiÚ
)

68 @
	$sh¬ed_sk
(
ignÜe_»suÉ
=
True
)

69 
def
 
	$ãtch_Œª§ùiÚs_¡©us
(
Œª§ùiÚ_ids
=
NÚe
):

70 
–igibË_Œª§ùiÚs
 = 
T¿n§ùiÚ
.
objeùs
.
	$f‹r
(
¡©e
=
T¿n§ùiÚ
.
S‹s
.
P’dšg
)

72 
Œª§ùiÚ_ids
:

73 
–igibË_Œª§ùiÚs
 =ƒligibË_Œª§ùiÚs.
	$f‹r
(
pk__š
=
Œª§ùiÚ_ids
)

75 
	`group
(
ãtch_Œª§ùiÚ_¡©us
.
	$s
(
Œª§ùiÚ
.
id
èŒª§ùiÚ 
š
 
–igibË_Œª§ùiÚs
)()

78 
EXECUTE_TRANSACTION_TIME_LIMIT
 = 
	`g‘©Œ
(
£‰šgs
, 'EXECUTE_TRANSACTION_TIME_LIMIT',

79 60è#deçuÉ 60
s


82 @
	`sh¬ed_sk
(
ba£
=
QueueOnû
, 
Úû
={'g¿ûful': 
True
},

83 
	gtime_lim™
=
EXECUTE_TRANSACTION_TIME_LIMIT
)

84 
def
 
	$execu‹_Œª§ùiÚ
(
Œª§ùiÚ_id
):

85 
Œª§ùiÚ
 = 
T¿n§ùiÚ
.
objeùs
.
	`f‹r
(
pk
=
Œª§ùiÚ_id
).
	$fœ¡
()

86 
nÙ
 
Œª§ùiÚ
:

89 
nÙ
 
Œª§ùiÚ
.
·ym’t_m‘hod
.
v”if›d
 
Ü
¿n§ùiÚ.·ym’t_m‘hod.
ÿnûËd
:

92 
·ym’t_´oûssÜ
 = 
Œª§ùiÚ
.
·ym’t_m‘hod
.
	$g‘_·ym’t_´oûssÜ
()

93 
·ym’t_´oûssÜ
.
ty³
 !ğ
Paym’tProûssÜTy³s
.
Trigg”ed
:

96 
·ym’t_´oûssÜ
.
	`execu‹_Œª§ùiÚ
(
Œª§ùiÚ
)

99 @
	$sh¬ed_sk
(
ignÜe_»suÉ
=
True
)

100 
def
 
	$execu‹_Œª§ùiÚs
(
Œª§ùiÚ_ids
=
NÚe
):

101 
execubË_Œª§ùiÚs
 = 
T¿n§ùiÚ
.
objeùs
.
	$f‹r
(
¡©e
=
T¿n§ùiÚ
.
S‹s
.
In™Ÿl
)

103 
Œª§ùiÚ_ids
:

104 
execubË_Œª§ùiÚs
 =ƒxecubË_Œª§ùiÚs.
	$f‹r
(
pk__š
=
Œª§ùiÚ_ids
)

106 
	`group
(
execu‹_Œª§ùiÚ
.
	$s
(
Œª§ùiÚ
.
id
èŒª§ùiÚ 
š
 
execubË_Œª§ùiÚs
)()

	@silver/templates/admin/issue_all_customer_documents.html

1 {% 
	gex‹nds
 "admin/base_site.html" %}

2 {% 
lßd
 
i18n
 
l10n
 %}

3 {% 
lßd
 
admš_u¾s
 %}

5 {% 
block
 
b»adüumbs
 %}

6 <
div
 
şass
="breadcrumbs">

7 <
a
 
h»f
="{% u¾ 'admš:šdex' %}">{% 
Œªs
 'Home' %}</a> â€º

8 <
a
 
h»f
="{% u¾ 'admš:­p_li¡'‡µ_Ïb–=İts.­p_Ïb– %}">{{ 
İts
.
­p_Ïb–
|
ÿpfœ¡
 }}</a> â€º

9 <
a
 
h»f
="{% u¾ o±s|admš_u¾Çme:'chªg–i¡' %}">{{ 
İts
.
v”bo£_Çme_¶u¿l
|
ÿpfœ¡
 }}</a> â€º 
Issue
 
muÉË
 
Invoiûs
 
Ü
 
ProfÜmas


10 </
div
>

11 {% 
’dblock
 %}

13 {% 
block
 
cÚ‹Á
 %}

15 <
fÜm
 
aùiÚ
="" 
m‘hod
="post">

16 {% 
c¤f_tok’
 %}

18 {% 
aùive_subsütiÚs
 %}

19 <
p
> 
The
 
fŞlowšg
 <
b
>
aùive
</b> 
subsütiÚs
 
wl
 
be
 <b>
CANCELED
</b> 
ªd
 <b>
ISSUED
</b>: </p>

20 <
ul
>{{ 
aùive_subsütiÚs
|
unÜd”ed_li¡
 }}</ul>

21 {% 
’dif
 %}

23 {% 
ÿnûËd_subsütiÚs
 %}

24 <
p
> 
The
 
fŞlowšg
 <
b
>
ÿnûËd
</b> 
subsütiÚs
 
wl
 
be
 <b>
ISSUED
</b>: </p>

25 <
ul
>{{ 
ÿnûËd_subsütiÚs
|
unÜd”ed_li¡
 }}</ul>

26 {% 
’dif
 %}

28 <
div
>

29 {% 
obj
 
š
 
qu”y£t
 %}

30 <
šput
 
ty³
="hidd’" 
Çme
="{{‡ùiÚ_checkbox_Çm}}" 
v®ue
="{{ obj.pk|unlocalize }}" />

31 {% 
’dfÜ
 %}

32 <
šput
 
ty³
="hidd’" 
Çme
="aùiÚ" 
v®ue
="generate_all_documents" />

33 <
šput
 
ty³
="hidd’" 
Çme
="po¡" 
v®ue
="yes" />

34 <
šput
 
ty³
="subm™" 
v®ue
="{%¿n "
Yes
, 
I
'm sure" %}" />

35 <
a
 
h»f
="#" 
Úşick
="wšdow.hi¡Üy.back();„‘uº f®£;" 
şass
="bu‰Ú cªûl-lšk">{% 
Œªs
 "No,ake me back" %}</a>

37 </
div
>

38 </
fÜm
>

39 {% 
’dblock
 
cÚ‹Á
 %}

	@silver/templates/admin/monthly_totals.html

1 {% 
	gex‹nds
 "admin/base_site.html" %}

3 {% 
lßd
 
i18n
 
l10n
 %}

4 {% 
lßd
 
admš_u¾s
 %}

6 {% 
block
 
b»adüumbs
 %}

7 <
div
 
şass
="breadcrumbs">

8 <
a
 
h»f
="{% u¾ 'admš:šdex' %}">{% 
Œªs
 'Home' %}</a> â€º

9 <
a
 
h»f
="{% u¾ 'admš:­p_li¡'‡µ_Ïb–=İts.­p_Ïb– %}">{{ 
İts
.
­p_Ïb–
|
ÿpfœ¡
 }}</a> â€º

10 <
a
 
h»f
="{% u¾ o±s|admš_u¾Çme:'chªg–i¡' %}">{{ 
İts
.
v”bo£_Çme_¶u¿l
|
ÿpfœ¡
 }}</a> â€º 
MÚthly
 
Provid”s
 
R•Üts


11 </
div
>

12 {% 
’dblock
 %}

14 {% 
block
 
cÚ‹Á
 %}

16 <
fÜm
 
aùiÚ
="" 
m‘hod
="post">

17 {% 
c¤f_tok’
 %}

18 <
ul
>

19 {% 
´ovid”
, 
±Ù®s
 
š
 
tÙ®s
.
™ems
 %}

20 {% 
±Ù®s
 %}

21 <
li
> <
b
>{{ 
´ovid”
 }}</b> <
br
>

22 <
ul
>

23 {% 
doc_Çme
, 
tÙ®s_ªd_d¿á
 
š
 
±Ù®s
.
™ems
 %}

24 <
li
>

25 {% 
’Œy
, 
™em_v®ue
 
š
 
tÙ®s_ªd_d¿á
.
™ems
 %}

26 {% 
fÜloİ
.
fœ¡
 %}

27 <
b
> {{ 
doc_Çme
 }} </b> (
tÙ®
 
d¿á
: {{ 
™em_v®ue
 }})

29 {% 
™em_v®ue
|
Ëngth
 %}

30 <
bË
>

31 <
Œ
>

32 <
th
> 
MÚth
 </th>

33 <
th
> 
TÙ®
 </th>

34 <
th
> 
Paid
 </th>

35 <
th
> 
UÅaid
 </th>

36 </
Œ
>

37 {% 
mÚth
, 
tÙ®s_v®ue
 
š
 
™em_v®ue
.
™ems
 %}

38 <
Œ
>

39 <
td
> {{ 
mÚth
 }} </td>

40 {% 
Çme
, 
v®ue
 
š
 
tÙ®s_v®ue
.
™ems
 %}

41 <
td
> {{ 
v®ue
 }} </td>

42 {% 
’dfÜ
 %}

43 </
Œ
>

44 {% 
’dfÜ
 %}

45 </
bË
>

46 {% 
’dif
 %}

47 {% 
’dif
%}

48 {% 
’dfÜ
 %}

49 </
li
>

50 <
br
>

51 {% 
’dfÜ
 %}

52 </
ul
>

53 </
li
>

54 <
br
>

55 {% 
’dif
 %}

56 {% 
’dfÜ
 %}

57 </
ul
>

59 <
div
>

60 <
šput
 
ty³
="hidd’" 
Çme
="aùiÚ" 
v®ue
="generate_monthly_totals" />

61 <
šput
 
ty³
="hidd’" 
Çme
="po¡" 
v®ue
="yes" />

62 <
a
 
h»f
="#" 
Úşick
="wšdow.hi¡Üy.back();„‘uº f®£;" 
şass
="bu‰Ú cªûl-lšk">{% 
Œªs
 "Back" %}</a>

63 </
div
>

64 </
fÜm
>

65 {% 
’dblock
 
cÚ‹Á
 %}

	@silver/templates/billing_documents/document_pdf_base.html

1 {% 
lßd
 
	g¡©icfes
 %}

2 <!
DOCTYPE
 
html
>

3 <
html
>

4 <
h—d
>

5 <
t™Ë
>{% 
docum’t
.
¡©e
 =ğ'ÿnûËd' %} 
CªûËd
 {% 
’dif
 %}{{ docum’t.
kšd
 }} {{ docum’t.
£r›s
 }}-{{ docum’t.
numb”
 }}</title>

6 <
¡yË
 
ty³
="text/css">

7 @
·ge
 {

8 
size
: 
a4
;

9 
m¬gš
: 2c
m
;

13 @
fÚt
-
çû
 {

14 
fÚt
-
çmy
: 
İ’
-
§ns
;

15 
¤c
: 
u¾
({% 'font/OpenSans-Regular.ttf' %});

19 @
fÚt
-
çû
 {

20 
fÚt
-
çmy
: 
İ’
-
§ns
;

21 
¤c
: 
u¾
({% 'font/OpenSans-Bold.ttf' %});

22 
fÚt
-
weight
: 
bŞd
;

26 @
fÚt
-
çû
 {

27 
fÚt
-
çmy
: 
İ’
-
§ns
;

28 
¤c
: 
u¾
({% 'font/OpenSans-Italic.ttf' %});

29 
fÚt
-
¡yË
: 
™®ic
;

33 @
fÚt
-
çû
 {

34 
fÚt
-
çmy
: 
İ’
-
§ns
;

35 
¤c
: 
u¾
({% 'font/OpenSans-BoldItalic.ttf' %});

36 
fÚt
-
¡yË
: 
™®ic
;

37 
fÚt
-
weight
: 
bŞd
;

40 
hr
 {

41 
cŞÜ
: #86ba49;

44 
html
 {

45 
fÚt
-
çmy
: 
İ’
-
§ns
;

48 
body
 {

49 
fÚt
-
çmy
: 
İ’
-
§ns
;

50 
fÚt
-
size
: 8
±
;

51 
cŞÜ
: #4
d4d4d
;

54 
¡rÚg
 {

55 
fÚt
-
weight
: 
bŞd
;

58 #·¹› 
td
 {

59 
v”tiÿl
-
®ign
: 
tİ
;

63 
m¬gš
-
tİ
: 1c
m
;

66 #’Œ› 
th
 {

67 
‹xt
-
®ign
: 
Ëá
;

70 #’Œ› 
th
.
´iû
 {

71 
‹xt
-
®ign
: 
Ëá
;

74 #’Œ› 
Œ
 {

75 
·ddšg
: 5
±
 0 1pt;

76 
bÜd”
-
bÙtom
: 1
±
 
sŞid
 #ddd;

79 #’Œ› 
tbody
 
td
 {

80 
v”tiÿl
-
®ign
: 
tİ
;

83 #’Œ› 
tbody
 
td
 {

84 
·ddšg
-
right
: 3
±
;

87 #’Œ› 
tfoÙ
 {

88 
fÚt
-
weight
: 
bŞd
;

91 #’Œ› 
tfoÙ
 
Œ
 {

92 
bÜd”
-
bÙtom
: 
nÚe
;

95 #’Œ› 
tfoÙ
 
td
 {

96 
v”tiÿl
-
®ign
: 
tİ
;

99 #’Œ› 
tfoÙ
 .
tÙ®
 {

100 
·ddšg
-
Ëá
: 5
±
;

101 
·ddšg
-
right
: 5
±
;

102 
‹xt
-
®ign
: 
right
;

104 </
¡yË
>

105 </
h—d
>

106 <
body
>

107 <
div
 
id
="header">

108 <
bË
>

109 <
Œ
>

110 <
td
 
şass
="title">

111 <
h1
>{% 
docum’t
.
¡©e
 =ğ'ÿnûËd' %} 
CªûËd
 {% 
’dif
 %}{{ docum’t.
kšd
 }} {{ docum’t.
£r›s
 }}-{{ docum’t.
numb”
 }}</h1>

112 <
bË
>

113 <
Œ
>

114 <
td
 
width
="48mm"><
¡rÚg
>
Issue
 
d©e
</strong></td>

115 <
td
>{{ 
docum’t
.
issue_d©e
|
d©e
:"d M. Y" }}</td>

116 </
Œ
>

117 <
Œ
>

118 <
td
 
width
="48mm"><
¡rÚg
>
Due
 
d©e
</strong></td>

119 <
td
>{{ 
docum’t
.
due_d©e
|
d©e
:"d M. Y" }}</td>

120 </
Œ
>

121 {% 
docum’t
.
§Ës_x_³rûÁ
 %}

122 <
Œ
>

123 <
td
 
width
="48mm" 
¡yË
="vertical-align:op;">

124 <
¡rÚg
> {% 
docum’t
.
§Ës_x_Çme
 %} {{ docum’t.§Ës_x_Çm}} {% %} 
Tax
 {% 
’dif
 %} </strong>

125 </
td
>

126 <
td
>

127 {{ 
docum’t
.
§Ës_x_³rûÁ
 }}%

128 </
td
>

129 </
Œ
>

130 {% 
’dif
 %}

131 </
bË
>

132 </
td
>

133 </
Œ
>

134 </
bË
>

135 <
hr
 
cŞÜ
="#86ba49" 
size
="0.5mm">

136 </
div
>

138 <
div
 
id
="content">

139 <
bË
 
id
="parties">

140 <
Œ
>

141 <
td
 
width
="8cm">

142 <
h1
>
Issu”
: {{ 
´ovid”
.
blšg_Çme
 }}</h1>

144 <
¡rÚg
>
Add»ss
</¡rÚg>: {{ 
´ovid”
.
add»ss_1
 }}<
br
>

146 {% 
´ovid”
.
add»ss_2
 %}

147 {{ 
´ovid”
.
add»ss_2
 }}<
br
>

148 {% 
’dif
 %}

150 {{ 
´ovid”
.
c™y
 }}<
br
>

151 {% 
´ovid”
.
¡©e
 %}

152 {{ 
´ovid”
.
¡©e
 }}<
br
>

153 {% 
’dif
 %}

155 {% 
´ovid”
.
z_code
 %}

156 {{ 
´ovid”
.
z_code
 }}<
br
>

157 {% 
’dif
 %}

159 {% 
´ovid”
.
ema
 %}

160 <
¡rÚg
>
Ema
</¡rÚg>: {{ 
´ovid”
.
ema
 }}<
br
>

161 {% 
’dif
 %}

163 {% 
´ovid”
.
exŒa
 %}

164 <
br
>

165 {{ 
´ovid”
.
exŒa
|
lšeb»aksbr
 }}<
br
>

166 {% 
’dif
 %}

167 </
td
>

168 <
td
 
width
="8cm">

169 <
h1
>
Cu¡om”
: {{ 
cu¡om”
.
blšg_Çme
 }}</h1>

171 {% 
cu¡om”
.
§Ës_x_numb”
 %}

172 <
¡rÚg
>
Tax
 
ID
</¡rÚg>: {{ 
cu¡om”
.
§Ës_x_numb”
 }}<
br
>

173 {% 
’dif
 %}

175 <
¡rÚg
>
Add»ss
</¡rÚg>: {{ 
cu¡om”
.
add»ss_1
 }}<
br
>

177 {% 
cu¡om”
.
add»ss_2
 %}

178 {{ 
cu¡om”
.
add»ss_2
 }}<
br
>

179 {% 
’dif
 %}

181 {{ 
cu¡om”
.
c™y
 }}<
br
>

182 {% 
cu¡om”
.
¡©e
 %}

183 {{ 
cu¡om”
.
¡©e
 }}<
br
>

184 {% 
’dif
 %}

186 {% 
cu¡om”
.
z_code
 %}

187 {{ 
cu¡om”
.
z_code
 }}<
br
>

188 {% 
’dif
 %}

190 {% 
cu¡om”
.
ema
 %}

191 <
¡rÚg
>
Ema
</¡rÚg>: {{ 
cu¡om”
.
ema
 }}<
br
>

192 {% 
’dif
 %}

194 {% 
cu¡om”
.
com·ny
 %}

195 <
¡rÚg
>
Name
</¡rÚg>: {{ 
cu¡om”
.
Çme
 }}<
br
>

196 {% 
’dif
 %}

198 {% 
cu¡om”
.
cu¡om”_»ã»nû
 %}

199 <
¡rÚg
>
Cu¡om”
 
Reã»nû
</strong>:

200 {{ 
cu¡om”
.
cu¡om”_»ã»nû
 }}

201 <
br
>

202 {% 
’dif
 %}

204 {% 
cu¡om”
.
exŒa
 %}

205 <
br
>

206 {{ 
cu¡om”
.
exŒa
|
lšeb»aksbr
 }}

207 {% 
’dif
 %}

208 </
td
>

209 </
Œ
>

210 </
bË
>

211 <
bË
 
id
="entries">

212 <
th—d
>

213 <
Œ
>

214 <
th
 
width
="3%">

215 <
i
>#</i><
br
>

216 </
th
>

217 <
th
 
width
="40%" 
şass
="description">

218 
S”viû


219 </
th
>

220 <
th
 
şass
="un™" 
width
="18%">

221 
Un™


222 </
th
>

223 <
th
 
şass
="couÁ" 
width
="7%">

224 
Qty
.

225 </
th
>

226 <
th
 
şass
="un™_´iû" 
width
="16%">

227 
Un™
 
´iû


228 </
th
>

229 <
th
 
şass
="´iû" 
width
="16%">

230 
TÙ®
 
AmouÁ


231 </
th
>

232 </
Œ
>

233 </
th—d
>

234 <
hr
 
cŞÜ
="#86ba49" 
size
="0.5mm">

235 <
tbody
>

236 {% 
’Œy
 
š
 
’Œ›s
 %}

237 <
Œ
>

238 <
td
 
şass
="index">

239 {{ 
fÜloİ
.
couÁ”
 }}

240 </
td
>

241 <
td
 
şass
="description">

242 {{ 
’Œy
.
desütiÚ
 }}

243 </
td
>

244 <
td
 
şass
="unit">

245 {{ 
’Œy
.
un™
 }}

246 </
td
>

247 <
td
 
şass
="count">

248 {{ 
’Œy
.
quªt™y
|
æßtfÜm©
:-2 }}

249 </
td
>

250 <
td
 
şass
="unit_price">

251 {{ 
’Œy
.
un™_´iû
|
æßtfÜm©
:2 }} {{ 
docum’t
.
cu¼’cy
 }}

252 </
td
>

253 <
td
 
şass
="price">

254 {{ 
’Œy
.
tÙ®
|
æßtfÜm©
:2 }} {{ 
docum’t
.
cu¼’cy
 }}

255 </
td
>

256 </
Œ
>

257 {% 
’dfÜ
 %}

258 </
tbody
>

259 <
tfoÙ
>

260 <
Œ
>

261 <
td
 
cŞ¥ª
="5" 
şass
="tÙ®">
TÙ®
</td>

262 <
td
 
şass
="total_amount">

263 {{ 
docum’t
.
tÙ®
|
æßtfÜm©
:2 }} {{ docum’t.
cu¼’cy
 }}

264 </
td
>

265 </
Œ
>

266 </
tfoÙ
>

267 </
bË
>

268 </
div
>

269 </
body
>

270 </
html
>

	@silver/templates/billing_documents/entry_description.html

1 {% 
	g¥aûËss
 %}

2 {% 
cÚ‹xt
 == 'plan' %}

3 {% 
´Ü©ed
 %}

4 {{ 
Çme
 }} 
PÏn
 {{ 
¶ª
.
š‹rv®
 }} 
PrÜ©ed
 
SubsütiÚ
 ({{ 
¡¬t_d©e
 }} - {{ 
’d_d©e
 }})

6 {{ 
Çme
 }} 
PÏn
 {{ 
¶ª
.
š‹rv®
 }} 
SubsütiÚ
 ({{ 
¡¬t_d©e
 }} - {{ 
’d_d©e
 }})

7 {% 
’dif
 %}

9 {% 
–if
 
cÚ‹xt
 == 'plan-trial' %}

10 {{ 
Çme
 }} 
¶ª
 
ŒŸl
 
subsütiÚ
 ({{ 
¡¬t_d©e
 }} - {{ 
’d_d©e
 }})

12 {% 
–if
 
cÚ‹xt
 == 'plan-trial-discount' %}

13 {{ 
Çme
 }} 
¶ª
 
ŒŸl
 
discouÁ
 ({{ 
¡¬t_d©e
 }} - {{ 
’d_d©e
 }})

15 {% 
–if
 
cÚ‹xt
 == 'metered-feature' %}

16 
ExŒa
 {{ 
Çme
 }} ({{ 
¡¬t_d©e
 }} - {{ 
’d_d©e
 }}).

18 {% 
–if
 
cÚ‹xt
 == 'metered-feature-trial' %}

19 {{ 
Çme
 }} ({{ 
¡¬t_d©e
 }} - {{ 
’d_d©e
 }}).

21 {% 
–if
 
cÚ‹xt
 == 'metered-feature-trial-discount' %}

22 {{ 
Çme
 }} ({{ 
¡¬t_d©e
 }} - {{ 
’d_d©e
 }}è
ŒŸl
 
discouÁ
.

24 {% 
–if
 
cÚ‹xt
 == 'metered-feature-trial-not-discounted' %}

25 
ExŒa
 {{ 
Çme
 }} 
Duršg
 
TrŸl
 ({{ 
¡¬t_d©e
 }} - {{ 
’d_d©e
 }})

28 {{ 
Çme
 }} ({{ 
¡¬t_d©e
 }} - {{ 
’d_d©e
 }}).

30 {% 
’dif
 %}

31 {% 
’d¥aûËss
 %}

	@silver/templates/billing_documents/entry_unit.html

1 {% 
	g¥aûËss
 %}

2 {% 
cÚ‹xt
 == 'plan' %}

3 {{ 
un™
 }}
s


5 {% 
–if
 
cÚ‹xt
 == 'plan-trial' %}

6 {{ 
un™
 }}
s


8 {% 
–if
 
cÚ‹xt
 == 'plan-trial-discount' %}

9 {{ 
un™
 }}
s


11 {% 
–if
 
cÚ‹xt
 == 'metered-feature' %}

12 {{ 
un™
 }}

14 {% 
–if
 
cÚ‹xt
 == 'metered-feature-trial' %}

15 {{ 
un™
 }}

17 {% 
–if
 
cÚ‹xt
 == 'metered-feature-trial-discount' %}

18 {{ 
un™
 }}

20 {% 
–if
 
cÚ‹xt
 == 'metered-feature-trial-not-discounted' %}

21 {{ 
un™
 }}

24 {{ 
un™
 }}

26 {% 
’dif
 %}

27 {% 
’d¥aûËss
 %}

	@silver/templates/billing_documents/invoice_pdf.html

1 {% 
	gex‹nds
 "billing_documents/document_pdf_base.html" %}

	@silver/templates/billing_documents/proforma_pdf.html

1 {% 
	gex‹nds
 "billing_documents/document_pdf_base.html" %}

	@silver/templates/forms/transaction_form.html

1 {% 
lßd
 
	g¡©icfes
 %}

2 <
html
>

3 <
h—d
>

4 <
t™Ë
>
Paym’t
 {{ 
docum’t
.
kšd
 }} {{ docum’t.
£r›s
 }}-{{ docum’t.
numb”
 }}</title>

5 <
¡yË
 
ty³
="text/css">

6 @
·ge
 {

7 
size
: 
a4
;

8 
m¬gš
: 2c
m
;

10 
fÜm
 
p
 {

11 
width
: 32%;

12 : 
Ëá
;

13 
m¬gš
-
right
: 1%;

15 
fÜm
 
p
 
šput
,

16 
fÜm
 
p
 
£Ëù
,

17 
fÜm
 
p
 
‹x»a
 {

18 
width
: 100%;

19 
m¬gš
-
bÙtom
: 2%;

21 
fÜm
 
¥ª
 {

22 
di¥Ïy
: 
block
;

24 
fÜm
 
em
 {

25 
cŞÜ
: 
»d
;

26 
fÚt
-
size
: 80%;

28 
fÜm
 
f›ld£t
:
aá”
 {

29 
cÚ‹Á
: "";

30 
di¥Ïy
: 
bË
;

31 
ş—r
: 
bÙh
;

33 
fÜm
 
f›ld£t
[
rŞe
="actions"] {

34 
‹xt
-
®ign
: 
ûÁ”
;

36 
bË
 {

37 
width
: 100%;

39 
bË
 
th—d
 
td
 {

40 
v”tiÿl
-
®ign
: 
tİ
;

42 
bË
 
sm®l
 {

43 
cŞÜ
: 
g¿y
;

45 </
¡yË
>

46 <
lšk
 
»l
="¡yËsh“t" 
ty³
="‹xt/css" 
h»f
="{% static 'css/skeleton.css' %}">

48 {% 
block
 
exŒah—d
 %}

49 {% 
’dblock
 %}

51 </
h—d
>

52 <
body
>

53 <
div
 
şass
="container">

54 {% 
block
 
·ym’t_´oûssÜ
 %}

55 {% 
’dblock
 %}

57 {% 
block
 
docum’t
 %}

58 <
bË
 
ûÎ¥acšg
="0" 
ûÎ·ddšg
="0">

59 <
th—d
>

60 <
Œ
>

61 <
td
>

62 {% 
block
 
docum’t_issu”
 %}

63 <
h5
><
¥ª
>
Issu”
:</¥ª> {{ 
´ovid”
.
blšg_Çme
 }}</h5>

64 <
p
>{{ 
´ovid”
.
add»ss_1
 }}<
br
 />

66 {% 
´ovid”
.
add»ss_2
 %}

67 {{ 
´ovid”
.
add»ss_2
 }}<
br
 />

68 {% 
’dif
 %}

70 {{ 
´ovid”
.
c™y
 }}<
br
 />

72 {% 
´ovid”
.
¡©e
 %}

73 {{ 
´ovid”
.
¡©e
 }}<
br
 />

74 {% 
’dif
 %}

76 {% 
´ovid”
.
z_code
 %}

77 {{ 
´ovid”
.
z_code
 }}<
br
 />

78 {% 
’dif
 %}

80 {% 
´ovid”
.
ema
 %}

81 <
¡rÚg
>
Ema
:</¡rÚg> {{ 
´ovid”
.
ema
 }}<
br
 />

82 {% 
’dif
 %}

84 {% 
´ovid”
.
exŒa
 %}

85 {{ 
´ovid”
.
exŒa
|
lšeb»aksbr
 }}

86 {% 
’dif
 %}

87 </
p
>

88 {% 
’dblock
 %}

89 </
td
>

90 <
td
>

91 {% 
block
 
docum’t_cu¡om”
 %}

92 <
h5
><
¥ª
>
Cu¡om”
:</¥ª> {{ 
cu¡om”
.
blšg_Çme
 }}</h5>

93 <
p
>

94 {% 
cu¡om”
.
§Ës_x_numb”
 %}

95 {{ 
cu¡om”
.
§Ës_x_numb”
 }}<
br
 />

96 {% 
’dif
 %}

98 {{ 
cu¡om”
.
add»ss_1
 }}<
br
 />

100 {% 
cu¡om”
.
add»ss_2
 %}

101 {{ 
cu¡om”
.
add»ss_2
 }}<
br
 />

102 {% 
’dif
 %}

104 {{ 
cu¡om”
.
c™y
 }}<
br
 />

106 {% 
cu¡om”
.
¡©e
 %}

107 {{ 
cu¡om”
.
¡©e
 }}<
br
 />

108 {% 
’dif
 %}

110 {% 
cu¡om”
.
z_code
 %}

111 {{ 
cu¡om”
.
z_code
 }}<
br
 />

112 {% 
’dif
 %}

114 {% 
cu¡om”
.
ema
 %}

115 {{ 
cu¡om”
.
ema
 }}<
br
 />

116 {% 
’dif
 %}

118 {% 
cu¡om”
.
com·ny
 %}

119 {{ 
cu¡om”
.
com·ny
 }}<
br
 />

120 {% 
’dif
 %}

122 {% 
cu¡om”
.
exŒa
 %}

123 {{ 
cu¡om”
.
exŒa
|
lšeb»aksbr
 }}<
br
 />

124 {% 
’dif
 %}

125 </
p
>

126 {% 
’dblock
 %}

127 </
td
>

128 </
Œ
>

129 </
th—d
>

130 <
tbody
>

131 <
Œ
>

132 <
td
 
cŞ¥ª
="2">

133 {% 
Œª§ùiÚ
.
¡©e
 =ğŒª§ùiÚ.
S‹s
.
In™Ÿl
 %}

134 {% 
block
 
fÜm
 %}

135 <
div
>

136 <
¡rÚg
>{{ 
Œª§ùiÚ
.
amouÁ
 }} {{¿n§ùiÚ.
cu¼’cy
 }}</strong>

137 {{ 
fÜm
 }}

138 </
div
>

139 {% 
’dblock
 %}

141 {% 
block
 
Œª§ùiÚ
 %}

142 <
¡rÚg
> 
The
 
·ym’t
 
is
 {{ 
Œª§ùiÚ
.
¡©e
 }}.</strong>

143 {% 
’dblock
 %}

144 {% 
’dif
 %}

145 </
td
>

146 </
Œ
>

147 </
tbody
>

148 </
bË
>

149 {% 
block
 
docum’t_d‘as
 %}

150 <
bË
 
ûÎ¥acšg
="0" 
ûÎ·ddšg
="0">

151 <
th—d
>

152 <
Œ
>

153 <
th
>#</th>

154 <
th
>
S”viû
</th>

155 <
th
>
Un™
</th>

156 <
th
>
Qty
.</th>

157 <
th
>
Un™
 
Priû
</th>

158 <
th
>
TÙ®
 
AmouÁ
</th>

159 </
Œ
>

160 </
th—d
>

161 <
tbody
>

162 {% 
’Œy
 
š
 
’Œ›s
 %}

163 <
Œ
>

164 <
td
>{{ 
fÜloİ
.
couÁ”
 }}</td>

165 <
td
>{{ 
’Œy
.
desütiÚ
 }}</td>

166 <
td
>{{ 
’Œy
.
un™
 }}</td>

167 <
td
>{{ 
’Œy
.
quªt™y
|
æßtfÜm©
:-2 }}</td>

168 <
td
>{{ 
’Œy
.
un™_´iû
|
æßtfÜm©
:2 }} {{ 
docum’t
.
cu¼’cy
 }}</td>

169 <
td
>{{ 
’Œy
.
tÙ®
|
æßtfÜm©
:2 }} {{ 
docum’t
.
cu¼’cy
 }}</td>

170 </
Œ
>

171 {% 
’dfÜ
 %}

172 </
tbody
>

173 <
tfoÙ
>

174 <
Œ
>

175 <
td
 
cŞ¥ª
="5">

176 <
¡rÚg
>
AmouÁ
 
·id
</strong>

177 <
br
/><
sm®l
>* 
this
 
may
 
nÙ
 
»´e£Á
 
docum’t
'sotal‡mount</small>

178 </
td
>

179 <
td
>

180 <
¡rÚg
>{{ 
Œª§ùiÚ
.
amouÁ
 }} {{¿n§ùiÚ.
cu¼’cy
 }}</strong>

181 </
td
>

182 </
Œ
>

183 <
Œ
>

184 <
td
 
cŞ¥ª
="5">

185 <
h3
>
TÙ®
 
amouÁ
</h3>

186 </
td
>

187 <
td
>

188 <
h3
>{{ 
docum’t
.
tÙ®
|
æßtfÜm©
:2 }} {{ docum’t.
cu¼’cy
 }}</h3>

189 </
td
>

190 </
Œ
>

191 </
tfoÙ
>

192 </
bË
>

193 {% 
’dblock
 %}

194 {% 
’dblock
 %}

196 {% 
block
 
foÙ”
 %}

197 {% 
’dblock
 %}

198 </
div
>

199 </
body
>

	@silver/templates/transactions/complete_payment.html

1 {% 
lßd
 
	g¡©icfes
 %}

2 <
html
>

3 <
h—d
>

4 <
t™Ë
>

5 
Paym’t
 
com¶‘ed
 {{ 
docum’t
.
kšd
 }} {{ docum’t.
£r›s
 }}-{{ docum’t.
numb”
 }}

6 </
t™Ë
>

8 <
¡yË
 
ty³
="text/css">

9 @
·ge
 {

10 
size
: 
a4
;

11 
m¬gš
: 2c
m
;

13 </
¡yË
>

14 <
lšk
 
»l
="¡yËsh“t" 
ty³
="‹xt/css" 
h»f
="{% static 'css/skeleton.css' %}">

16 {% 
block
 
exŒah—d
 %}

17 {% 
’dblock
 %}

19 </
h—d
>

21 <
body
>

22 <
div
 
şass
="container">

23 {% 
block
 
cÚ‹Á
%}

24 {% 
block
 
Œª§ùiÚ_¡©e
 %}

25 <
div
>

26 <
h2
>

27 {% 
Œª§ùiÚ
.
¡©e
 =ğŒª§ùiÚ.
S‹s
.
Faed
 %}

28 
Paym’t
 
çed
 

29 {% 
–if
 
Œª§ùiÚ
.
¡©e
 =ğŒª§ùiÚ.
S‹s
.
P’dšg
 %}

30 
Paym’t
 
³ndšg
 

31 {% 
–if
 
Œª§ùiÚ
.
¡©e
 =ğŒª§ùiÚ.
S‹s
.
In™Ÿl
 %}

32 
Paym’t
 
is
 
¡l
 
š™Ÿlizšg
 

34 
Paym’t
 
sucûded
 

35 {% 
’dif
 %}

36 </
h2
>

37 {% 
ç_d©a
 %}

38 <
p
>
ç_d©a
.
mes§ge
</p>

39 <
p
>
ç_d©a
.
sucûss_mes§ge
</p>

40 {% 
’dif
 %}

41 </
div
>

42 {% 
’dblock
 %}

44 {% 
block
 
docum’t
 %}

45 <
div
>

46 <
h3
>{{ 
docum’t
.
kšd
 }} {{ docum’t.
£r›s
 }}-{{ docum’t.
numb”
 }}</h3>

47 </
div
>

48 {% 
’dblock
 %}

49 {% 
’dblock
%}

50 </
div
>

51 </
body
>

52 </
html
>

	@silver/templates/transactions/expired_payment.html

1 {% 
lßd
 
	g¡©icfes
 %}

2 <
html
>

3 <
h—d
>

4 <
t™Ë
>

5 
Paym’t
 
nÙ
 
found
 {{ 
docum’t
.
kšd
 }} {{ docum’t.
£r›s
 }}-{{ docum’t.
numb”
 }}

6 </
t™Ë
>

8 <
¡yË
 
ty³
="text/css">

9 @
·ge
 {

10 
size
: 
a4
;

11 
m¬gš
: 2c
m
;

13 </
¡yË
>

14 <
lšk
 
»l
="¡yËsh“t" 
ty³
="‹xt/css" 
h»f
="{% static 'css/skeleton.css' %}">

16 {% 
block
 
exŒah—d
 %}

17 {% 
’dblock
 %}

19 </
h—d
>

21 <
body
>

22 <
div
 
şass
="container">

23 {% 
block
 
cÚ‹Á
%}

24 <
h2
>
T¿n§ùiÚ
 
expœed
 </h2>

26 {% 
block
 
docum’t
 %}

27 <
div
>

28 <
h3
>{{ 
docum’t
.
kšd
 }} {{ docum’t.
£r›s
 }}-{{ docum’t.
numb”
 }}</h3>

29 </
div
>

30 {% 
’dblock
 %}

31 {% 
’dblock
%}

32 </
div
>

33 </
body
>

34 </
html
>

	@silver/tests/__init__.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

	@silver/tests/admin/__init__.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

	@silver/tests/admin/test_invoice.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

14 
äom
 
™”toŞs
 
impÜt
 
cyşe


16 
äom
 
	gdjªgo
.
	gcÚŒib
.
	gadmš
.
mod–s
 
impÜt
 
CHANGE


17 
äom
 
	gdjªgo
.
	gcÚŒib
.
	gauth
.
mod–s
 
impÜt
 
U£r


18 
äom
 
	gdjªgo
.
	gcÚŒib
.
	gcÚ‹Áty³s
.
mod–s
 
impÜt
 
CÚ‹ÁTy³


19 
äom
 
	gdjªgo
.
	gcÜe
.
u¾»sŞv”s
 
impÜt
 
»v”£


20 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
	gTe¡Ca£
, 
Cl›Á


21 
äom
 
djªgo_fsm
 
impÜt
 
T¿ns™iÚNÙAÎowed


22 
äom
 
mock
 
impÜt
 
	gMagicMock
, 
·tch


24 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
impÜt
 
InvoiûFaùÜy


27 
şass
 
	$InvoiûAdmšTe¡Ca£
(
Te¡Ca£
):

28 
def
 
	$£tUp
(
£lf
):

29 
£lf
.
u£r
 = 
U£r
.
objeùs
.
	`ü—‹_su³ru£r
('user', 'myemail@test.com', 'password')

31 
£lf
.
admš
 = 
	$Cl›Á
()

33 
£lf
.
admš
.
	`logš
(
u£ºame
='u£r', 
·sswÜd
='password')

35 
def
 
	$‹¡_aùiÚs_log_’Œ›s
(
£lf
):

36 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

38 
u¾
 = 
	`»v”£
('admin:silver_invoice_changelist')

40 
mock_log_’Œy
 = 
	$MagicMock
()

41 
mock_log_aùiÚ
 = 
	$MagicMock
()

42 
mock_log_’Œy
.
objeùs
.
log_aùiÚ
 = 
mock_log_aùiÚ


44 
mock_aùiÚ
 = 
	`MagicMock
(
»tuº_v®ue
=MagicMock(
£r›s_numb”
='aaa'))

46 
mock_švoiû
 = 
	$MagicMock
()

47 
mock_švoiû
.
issue
 = 
mock_aùiÚ


48 
mock_švoiû
.
ÿnûl
 = 
mock_aùiÚ


49 
mock_švoiû
.
·y
 = 
mock_aùiÚ


50 
mock_švoiû
.
şÚe_što_d¿á
 = 
mock_aùiÚ


52 
w™h
 
·tch
.
	`muÉË
('silver.admin',

53 
LogEÁry
=
mock_log_’Œy
,

54 
Invoiû
=
mock_švoiû
):

55 
aùiÚs
 = ['issue', 'pay', 'cancel', 'clone']

57 
aùiÚ
 
š
 
aùiÚs
:

58 
£lf
.
admš
.
	`po¡
(
u¾
, {

59 'aùiÚ': 
aùiÚ
,

60 '_£Ëùed_aùiÚ': [
	`¡r
(
švoiû
.
pk
)]

61 
	}
})

63 
as£¹
 
mock_aùiÚ
.
ÿÎ_couÁ


65 
mock_aùiÚ
.
	$»£t_mock
()

67 
aùiÚ
 == 'clone':

68 
aùiÚ
 = 'clone_into_draft'

70 
mock_log_aùiÚ
.
	`as£¹_ÿÎed_w™h
(

71 
u£r_id
=
£lf
.
u£r
.
pk
,

72 
cÚ‹Á_ty³_id
=
CÚ‹ÁTy³
.
objeùs
.
	`g‘_fÜ_mod–
(
švoiû
).
pk
,

73 
objeù_id
=
švoiû
.
pk
,

74 
objeù_»´
=
	`unicode
(
švoiû
),

75 
aùiÚ_æag
=
CHANGE
,

76 
chªge_mes§ge
='{aùiÚ}‡ùiÚ in™Ÿ‹d by u£r.'.
	`fÜm©
(

77 
aùiÚ
÷ùiÚ.
	`ÿp™®ize
().
	`»¶aû
('_', ' ')

81 
def
 
	$‹¡_aùiÚs_çed_no_log_’Œ›s
(
£lf
):

82 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

84 
u¾
 = 
	`»v”£
('admin:silver_invoice_changelist')

86 
mock_log_’Œy
 = 
	$MagicMock
()

87 
mock_log_aùiÚ
 = 
	$MagicMock
()

88 
mock_log_’Œy
.
objeùs
.
log_aùiÚ
 = 
mock_log_aùiÚ


90 
exû±iÚs
 = 
	$cyşe
([
V®ueE¼Ü
, 
T¿ns™iÚNÙAÎowed
])

92 
def
 
	$_exû±iÚ_throw”
(*
¬gs
):

93 
¿i£
 
exû±iÚs
.
	$Ãxt
()

95 
mock_aùiÚ
 = 
	$MagicMock
(
side_efãù
=
_exû±iÚ_throw”
)

97 
mock_švoiû
 = 
	$MagicMock
()

98 
mock_švoiû
.
issue
 = 
mock_aùiÚ


99 
mock_švoiû
.
ÿnûl
 = 
mock_aùiÚ


100 
mock_švoiû
.
·y
 = 
mock_aùiÚ


101 
mock_švoiû
.
şÚe_što_d¿á
 = 
mock_aùiÚ


102 
mock_švoiû
.
ü—‹_švoiû
 = 
mock_aùiÚ


104 
w™h
 
·tch
.
	`muÉË
('silver.admin',

105 
LogEÁry
=
mock_log_’Œy
,

106 
Invoiû
=
mock_švoiû
):

107 
aùiÚs
 = ['issue', 'pay', 'cancel', 'clone']

109 
aùiÚ
 
š
 
aùiÚs
:

110 
£lf
.
admš
.
	`po¡
(
u¾
, {

111 'aùiÚ': 
aùiÚ
,

112 '_£Ëùed_aùiÚ': [
	`¡r
(
švoiû
.
pk
)]

113 
	}
})

115 
as£¹
 
nÙ
 
mock_log_aùiÚ
.
ÿÎ_couÁ


	@silver/tests/admin/test_proforma.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

14 
äom
 
™”toŞs
 
impÜt
 
cyşe


16 
äom
 
	gdjªgo
.
	gcÚŒib
.
	gadmš
.
mod–s
 
impÜt
 
CHANGE


17 
äom
 
	gdjªgo
.
	gcÚŒib
.
	gauth
.
mod–s
 
impÜt
 
U£r


18 
äom
 
	gdjªgo
.
	gcÚŒib
.
	gcÚ‹Áty³s
.
mod–s
 
impÜt
 
CÚ‹ÁTy³


19 
äom
 
	gdjªgo
.
	gcÜe
.
u¾»sŞv”s
 
impÜt
 
»v”£


20 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
	gTe¡Ca£
, 
Cl›Á


21 
äom
 
djªgo_fsm
 
impÜt
 
T¿ns™iÚNÙAÎowed


22 
äom
 
mock
 
impÜt
 
	gMagicMock
, 
·tch


24 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
impÜt
 
ProfÜmaFaùÜy


27 
şass
 
	$ProfÜmaAdmšTe¡Ca£
(
Te¡Ca£
):

28 
def
 
	$£tUp
(
£lf
):

29 
£lf
.
u£r
 = 
U£r
.
objeùs
.
	`ü—‹_su³ru£r
('user', 'myemail@test.com', 'password')

31 
£lf
.
admš
 = 
	$Cl›Á
()

33 
£lf
.
admš
.
	`logš
(
u£ºame
='u£r', 
·sswÜd
='password')

35 
def
 
	$‹¡_aùiÚs_log_’Œ›s
(
£lf
):

36 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

38 
u¾
 = 
	`»v”£
('admin:silver_proforma_changelist')

40 
mock_log_’Œy
 = 
	$MagicMock
()

41 
mock_log_aùiÚ
 = 
	$MagicMock
()

42 
mock_log_’Œy
.
objeùs
.
log_aùiÚ
 = 
mock_log_aùiÚ


44 
mock_aùiÚ
 = 
	`MagicMock
(
»tuº_v®ue
=MagicMock(
£r›s_numb”
='aaa'))

46 
mock_´ofÜma
 = 
	$MagicMock
()

47 
mock_´ofÜma
.
issue
 = 
mock_aùiÚ


48 
mock_´ofÜma
.
ÿnûl
 = 
mock_aùiÚ


49 
mock_´ofÜma
.
·y
 = 
mock_aùiÚ


50 
mock_´ofÜma
.
şÚe_što_d¿á
 = 
mock_aùiÚ


51 
mock_´ofÜma
.
ü—‹_švoiû
 = 
mock_aùiÚ


53 
w™h
 
·tch
.
	`muÉË
('silver.admin',

54 
LogEÁry
=
mock_log_’Œy
,

55 
ProfÜma
=
mock_´ofÜma
):

56 
aùiÚs
 = ['issue', 'pay', 'cancel', 'clone', 'create_invoice']

58 
aùiÚ
 
š
 
aùiÚs
:

59 
£lf
.
admš
.
	`po¡
(
u¾
, {

60 'aùiÚ': 
aùiÚ
,

61 '_£Ëùed_aùiÚ': [
	`¡r
(
´ofÜma
.
pk
)]

62 
	}
})

64 
as£¹
 
mock_aùiÚ
.
ÿÎ_couÁ


66 
mock_aùiÚ
.
	$»£t_mock
()

68 
aùiÚ
 == 'clone':

69 
aùiÚ
 = 'clone_into_draft'

71 
mock_log_aùiÚ
.
	`as£¹_ÿÎed_w™h
(

72 
u£r_id
=
£lf
.
u£r
.
pk
,

73 
cÚ‹Á_ty³_id
=
CÚ‹ÁTy³
.
objeùs
.
	`g‘_fÜ_mod–
(
´ofÜma
).
pk
,

74 
objeù_id
=
´ofÜma
.
pk
,

75 
objeù_»´
=
	`unicode
(
´ofÜma
),

76 
aùiÚ_æag
=
CHANGE
,

77 
chªge_mes§ge
='{aùiÚ}‡ùiÚ in™Ÿ‹d by u£r.'.
	`fÜm©
(

78 
aùiÚ
÷ùiÚ.
	`ÿp™®ize
().
	`»¶aû
('_', ' ')

82 
def
 
	$‹¡_aùiÚs_çed_no_log_’Œ›s
(
£lf
):

83 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

85 
u¾
 = 
	`»v”£
('admin:silver_proforma_changelist')

87 
mock_log_’Œy
 = 
	$MagicMock
()

88 
mock_log_aùiÚ
 = 
	$MagicMock
()

89 
mock_log_’Œy
.
objeùs
.
log_aùiÚ
 = 
mock_log_aùiÚ


91 
exû±iÚs
 = 
	$cyşe
([
V®ueE¼Ü
, 
T¿ns™iÚNÙAÎowed
])

93 
def
 
	$_exû±iÚ_throw”
(*
¬gs
):

94 
¿i£
 
exû±iÚs
.
	$Ãxt
()

96 
mock_aùiÚ
 = 
	$MagicMock
(
side_efãù
=
_exû±iÚ_throw”
)

98 
mock_´ofÜma
 = 
	$MagicMock
()

99 
mock_´ofÜma
.
issue
 = 
mock_aùiÚ


100 
mock_´ofÜma
.
ÿnûl
 = 
mock_aùiÚ


101 
mock_´ofÜma
.
·y
 = 
mock_aùiÚ


102 
mock_´ofÜma
.
şÚe_što_d¿á
 = 
mock_aùiÚ


103 
mock_´ofÜma
.
ü—‹_švoiû
 = 
mock_aùiÚ


105 
w™h
 
·tch
.
	`muÉË
('silver.admin',

106 
LogEÁry
=
mock_log_’Œy
,

107 
ProfÜma
=
mock_´ofÜma
):

108 
aùiÚs
 = ['issue', 'pay', 'cancel', 'clone', 'create_invoice']

110 
aùiÚ
 
š
 
aùiÚs
:

111 
£lf
.
admš
.
	`po¡
(
u¾
, {

112 'aùiÚ': 
aùiÚ
,

113 '_£Ëùed_aùiÚ': [
	`¡r
(
´ofÜma
.
pk
)]

114 
	}
})

116 
as£¹
 
nÙ
 
mock_log_aùiÚ
.
ÿÎ_couÁ


	@silver/tests/commands/__init__.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

	@silver/tests/commands/test_execute_transactions.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
mock
 
impÜt
 
	gMagicMock
, 
	g·tch
, 
ÿÎ


17 
äom
 
	gdjªgo
.
	gcÜe
.
mªagem’t
 
impÜt
 
ÿÎ_commªd


18 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
	gTe¡Ca£
, 
ov”ride_£‰šgs


20 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
impÜt
 
	gT¿n§ùiÚFaùÜy
, 
Paym’tM‘hodFaùÜy


21 
äom
 
	gsv”
.
	g‹¡s
.
fixtu»s
 
impÜt
 (
Trigg”edProûssÜ
, 
PAYMENT_PROCESSORS
,

22 
Œigg”ed_´oûssÜ
)

25 @
	$ov”ride_£‰šgs
(
PAYMENT_PROCESSORS
=PAYMENT_PROCESSORS)

26 
şass
 
	$Te¡Execu‹T¿n§ùiÚsCommªd
(
Te¡Ca£
):

27 
def
 
	$‹¡_Œª§ùiÚ_executšg
(
£lf
):

28 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

29 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
,

30 
v”if›d
=
True


33 
Œª§ùiÚs
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹_b©ch
(

34 5, 
·ym’t_m‘hod
=payment_method

37 
mock_execu‹
 = 
	$MagicMock
()

38 
w™h
 
·tch
.
	$muÉË
(
Trigg”edProûssÜ
,

39 
execu‹_Œª§ùiÚ
=
mock_execu‹
):

40 
	`ÿÎ_commªd
('execute_transactions')

42 
Œª§ùiÚ
 
š
 
Œª§ùiÚs
:

43 
£lf
.
	`as£¹In
(
	`ÿÎ
(
Œª§ùiÚ
), 
mock_execu‹
.
ÿÎ_¬gs_li¡
)

45 
£lf
.
	`as£¹Equ®
(
mock_execu‹
.
ÿÎ_couÁ
, 
	$Ën
(
Œª§ùiÚs
))

47 
def
 
	$‹¡_Œª§ùiÚ_f‹ršg
(
£lf
):

48 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

49 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
,

50 
v”if›d
=
True


53 
Œª§ùiÚs
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹_b©ch
(

54 5, 
·ym’t_m‘hod
=payment_method

57 
f‹»d_Œª§ùiÚs
 = [

58 
Œª§ùiÚs
[0],ransactions[2],ransactions[4]

61 
mock_execu‹
 = 
	$MagicMock
()

62 
w™h
 
·tch
.
	$muÉË
(
Trigg”edProûssÜ
,

63 
execu‹_Œª§ùiÚ
=
mock_execu‹
):

64 
Œª§ùiÚs_¬g
 = [

65 
	$¡r
(
Œª§ùiÚ
.
pk
èŒª§ùiÚ 
š
 
f‹»d_Œª§ùiÚs


67 
	`ÿÎ_commªd
('execute_transactions',

68 '--Œª§ùiÚs=%s' % ','.
	$još
(
Œª§ùiÚs_¬g
))

70 
Œª§ùiÚ
 
š
 
f‹»d_Œª§ùiÚs
:

71 
£lf
.
	`as£¹In
(
	`ÿÎ
(
Œª§ùiÚ
), 
mock_execu‹
.
ÿÎ_¬gs_li¡
)

73 
£lf
.
	`as£¹Equ®
(
mock_execu‹
.
ÿÎ_couÁ
, 
	`Ën
(
f‹»d_Œª§ùiÚs
))

75 @
	`·tch
('silver.management.commands.execute_transactions.logger.error')

76 
def
 
	$‹¡_exû±iÚ_loggšg
(
£lf
, 
mock_logg”
):

77 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

78 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
,

79 
v”if›d
=
True


82 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
·ym’t_m‘hod
=payment_method)

84 
mock_execu‹
 = 
	$MagicMock
()

85 
mock_execu‹
.
side_efãù
 = 
	`Exû±iÚ
('This happened.')

87 
w™h
 
·tch
.
	$muÉË
(
Trigg”edProûssÜ
,

88 
execu‹_Œª§ùiÚ
=
mock_execu‹
):

89 
	`ÿÎ_commªd
('execute_transactions')

90 
ex³ùed_ÿÎ
 = 
	`ÿÎ
(

92 1, 
exc_šfo
=
True


95 
£lf
.
	$as£¹Equ®
(
ex³ùed_ÿÎ
, 
mock_logg”
.
ÿÎ_¬gs
)

97 
def
 
	$‹¡_sk_Œª§ùiÚ_w™h_unv”if›d_·ym’t_m‘hod
(
£lf
):

98 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

99 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
,

100 
v”if›d
=
F®£


103 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
·ym’t_m‘hod
=payment_method)

105 
mock_execu‹
 = 
	$MagicMock
()

106 
w™h
 
·tch
.
	$muÉË
(
Trigg”edProûssÜ
,

107 
execu‹_Œª§ùiÚ
=
mock_execu‹
):

108 
	`ÿÎ_commªd
('execute_transactions')

110 
£lf
.
	`as£¹Equ®
(
mock_execu‹
.
ÿÎ_couÁ
, 0)

	@silver/tests/commands/test_generate_docs.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
d©‘ime
 
as
 
dt


17 
äom
 
decim®
 
impÜt
 
Decim®


19 
äom
 
	gdjªgo
.
	gcÜe
.
mªagem’t
 
impÜt
 
ÿÎ_commªd


20 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
Te¡Ca£


21 
äom
 
	gdjªgo
.
	guts
.
six
 
impÜt
 
SŒšgIO


22 
äom
 
mock
 
impÜt
 
	g·tch
, 
	gPrİ”tyMock
, 
MagicMock


24 
äom
 
	gsv”
.
mod–s
 
	$impÜt
 (
ProfÜma
, 
Docum’tEÁry
, 
Invoiû
, 
SubsütiÚ
, 
Cu¡om”
, 
PÏn
,

25 
BlšgLog
)

26 
äom
 
sv”
.
‹¡s
.
çùÜ›s
 
	$impÜt
 (
SubsütiÚFaùÜy
, 
PÏnFaùÜy
,

27 
M‘”edF—tu»FaùÜy
,

28 
M‘”edF—tu»Un™sLogFaùÜy
,

29 
Cu¡om”FaùÜy
, 
Provid”FaùÜy
)

30 
äom
 
sv”
.
mªagem’t
.
commªds
.
g’”©e_docs
 
impÜt
 
d©e
 
as
 
g’”©e_docs_d©e


31 
äom
 
sv”
.
uts
.
d©es
 
impÜt
 
ONE_DAY


34 
şass
 
	$Te¡InvoiûG’”©iÚCommªd
(
Te¡Ca£
):

36 
Te¡s
:

37 * 
nÚ
-
ÿnûËd


38 * 
cÚsŞid©ed
 
blšg
 
w
/ 
šşuded
 
un™s
 --

39 * 
cÚsŞid©ed
 
blšg
 
w
/
a
 
šşuded
 
un™s
 --

40 * 
´Ü©ed
 
subsütiÚs
 
w
/ 
cÚsumed
 
mfs
 
und”æow
 --

41 * 
´Ü©ed
 
subsütiÚs
 
w
/ 
cÚsumed
 
mfs
 
ov”æow
 --

42 * 
cÚsŞid©ed
 -> 
subsütiÚs
 
fuÎ
 
as
 
w–l
‡ fuÎ 
ŒŸl


43 * 
nÚ
-
cÚsŞid©ed
 
blšg
 
w
/ 
šşuded
 
un™s
 --

44 * 
nÚ
-
cÚsŞid©ed
 
blšg
 
w
/
a
 
šşuded
 
un™s
 --

45 * 
nÚ
-
cÚsŞid©ed
 
blšg
 
w
/ 
´Ü©ed
 
subsütiÚs


46 * 
G’”©e
 
w™h
 
difã»Á
  
¡©es


47 * 
d¿á
 --

48 * 
issued
 --

49 * 
ŒŸl
 
ov”
 
muÉË
 
mÚths
 --

50 * 
v¬ŸtiÚs
 
nÚ
-
ÿnûËd
 
subsütiÚs
. 
Check
 
the
 
ÿ£s
 
·³r
 --

51 * 
ÿnûËd


52 * 
ÿnûËd
 
subsütiÚ
 
w
/ 
ŒŸl
 --

53 * 
ÿnûËd
 
subsütiÚ
 
w
/
a
 
ŒŸl
 --

54 * 
ÿnûËd
 
subsütiÚ
 
w
 
ŒŸl
 
und”æow
 --

55 * 
ÿnûËd
 
subsütiÚ
 
w
 
ŒŸl
 
ov”æow
 --

56 * 
d©es
 -- 
w™h
 
the
 
cu¼’t
 
‹¡s
 
we
 
Úly
 
‹¡
 
v®ue
. 
The
e¡ 
should


57 
should
 
šşude
 
the
 
d©es
 th
™ems
 
too
.

58 * 
§Ës
 
x
 
³rûÁ


59 * 
g’”©e_aá”


61 
TODO
: 
add
 
missšg
 
‹¡
 
desütiÚs


64 
def
 
	$__š™__
(
£lf
, *
¬gs
, **
kw¬gs
):

65 
	`su³r
(
Te¡InvoiûG’”©iÚCommªd
, 
£lf
).
	$__š™__
(*
¬gs
, **
kw¬gs
)

66 
£lf
.
ouut
 = 
	$SŒšgIO
()

68 ###########################################################################
#NÚ-
CªûËd


70 ###########################################################################
e¡_ŒŸl_¥ªnšg_ov”_muÉË_mÚths(£lf):

72 ## 
SETUP
 ##

73 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

75 
mf_´iû
 = 
	`Decim®
('2.5')

76 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

77 
šşuded_un™s_duršg_ŒŸl
=
	`Decim®
('0.00'),

78 
´iû_³r_un™
=
mf_´iû
)

79 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

80 
š‹rv®_couÁ
=1, 
g’”©e_aá”
=120,

81 
’abËd
=
True
, 
amouÁ
=
	`Decim®
('200.00'),

82 
ŒŸl_³riod_days
=24,

83 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

84 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 5, 20)

86 #C»©
the
 
´Ü©ed
 
subsütiÚ


87 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

88 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

89 
subsütiÚ
.
	$aùiv©e
()

90 
subsütiÚ
.
	$§ve
()

92 
cÚsumed_1
 = 
	`Decim®
('5.00')

93 
cÚsumed_2
 = 
	`Decim®
('5.00')

94 
mf_log
 = 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

95 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

96 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 6, 1), 
’d_d©e
=
subsütiÚ
.
ŒŸl_’d
,

97 
cÚsumed_un™s
=
cÚsumed_1
)

99 
´ev_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-06-04'è#Duršg 
ŒŸl
 
³riod


100 
cu¼_blšg_d©e
 = 
subsütiÚ
.
ŒŸl_’d
 + 
ONE_DAY


102 ## 
TEST
 ##

103 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
´ev_blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

105 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	$fœ¡
()

106 #Ex³ù 4 
’Œ›s
:

107 #- 
´Ü©ed
 
¶ª
 
	`ŒŸl
 (+-è
fœ¡
 
mÚth


108 #- 
´Ü©ed
 
¶ª
 
	`ŒŸl
 (+-è
Ãxt
 
mÚth


109 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 4

111 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

113 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
()[0].
tÙ®
 =ğ
	`Decim®
('0.00')

115 
mf_log
.
cÚsumed_un™s
 +ğ
cÚsumed_2


116 
mf_log
.
	$§ve
()

118 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
cu¼_blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

120 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

121 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

123 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[1]

124 #Ex³ù 2 
’Œ›s
:

125 #- 
cÚsumed
 
mfs
 
äom
 
	`ŒŸl
 (
as
 
šşuded_duršg_ŒŸl
=0)

126 #- 
´Ü©ed
 
subsütiÚ
 
the
 
»maššg
 
³riod


127 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 2

128 
as£¹
 
	`®l
([
’Œy
.
´Ü©ed


129 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

130 
as£¹
 
	`®l
([
’Œy
.
tÙ®
 !ğ
	`Decim®
('0.0000')

131 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

132 
´Ü©ed_¶ª_v®ue
 = 
	`Decim®
(18 / 30.0).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


133 
cÚsumed_mfs_v®ue
 = (
cÚsumed_1
 + 
cÚsumed_2
è* 
mf_´iû


134 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
´Ü©ed_¶ª_v®ue
 + 
cÚsumed_mfs_v®ue


136 
def
 
	$‹¡_g’_fÜ_nÚ_cÚsŞid©ed_blšg_w™h_cÚsumed_un™s
(
£lf
):

138 
A
 
cu¡om”
 
has
 3 
subsütiÚs
 
which
 
we
 
u£
 
the
 
nÜm®
 :

139 * 
add
 
cÚsumed
 
mfs
 
the
 
´evious
 
mÚth


140 * 
add
 
the
 
v®ue
 
of
h
¶ª
 th
Ãxt
 
mÚth


141 => 3 
difã»Á
 
´ofÜmas


143 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-01')

145 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
(
cÚsŞid©ed_blšg
=
F®£
)

146 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(
šşuded_un™s
=
	`Decim®
('0.00'))

147 
¶ª_´iû
 = 
	`Decim®
('200.00')

148 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

149 
g’”©e_aá”
=120, 
’abËd
=
True
,

150 
amouÁ
=
¶ª_´iû
,

151 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

152 
¡¬t_d©e
 = 
dt
.
	$d©e
(2014, 1, 1)

154 #C»©3 
subsütiÚs
 
the
 
§me
 
cu¡om”


155 
SubsütiÚFaùÜy
.
	$ü—‹_b©ch
(
size
=3,

156 
¶ª
õÏn, 
¡¬t_d©e
=start_date,

157 
cu¡om”
=customer)

159 
cÚsumed_mfs
 = 
	`Decim®
('50.00')

160 
subsütiÚ
 
š
 
SubsütiÚ
.
objeùs
.
	$®l
():

161 
subsütiÚ
.
	$aùiv©e
()

162 
subsütiÚ
.
	$§ve
()

164 #FÜ 
—ch
 
subsütiÚ
, 
add
 
cÚsumed
 
un™s


165 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

166 
subsütiÚ
=subscription,

167 
m‘”ed_ã©u»
=metered_feature,

168 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 2, 1),

169 
’d_d©e
=
dt
.
	`d©e
(2015, 2, 28),

170 
cÚsumed_un™s
=
cÚsumed_mfs
)

172 #Add 
a
 
BlšgLog
 
to
 
deş¬e
 
wh’
 
the
 
subsütiÚ
 
was
 
Ï¡
 
bËd


173 
BlšgLog
.
objeùs
.
	`ü—‹
(
subsütiÚ
=subscription,

174 
blšg_d©e
=
dt
.
	`d©e
(2015, 1, 1),

175 
¶ª_bËd_up_to
=
dt
.
	`d©e
(2015, 2, 28),

176 
m‘”ed_ã©u»s_bËd_up_to
=
dt
.
	$d©e
(2015, 1, 31))

178 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=billing_date,

179 
¡dout
=
£lf
.
ouut
)

181 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 3

182 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

184 
´ofÜma
 
š
 
ProfÜma
.
objeùs
.
	$®l
():

185 
’Œ›s
 = 
´ofÜma
.
´ofÜma_’Œ›s
.
	$®l
()

186 
as£¹
 
’Œ›s
.
	`couÁ
(è=ğ2 #PÏÀ
cu¼’t
 
mÚth
, 
M‘”ed
 
ã©u»s
 
Ï¡
 month

188 
’Œy
 
š
 
’Œ›s
:

189 
’Œy
.
´oduù_code
 =ğ
¶ª
.product_code:

190 
as£¹
 
’Œy
.
quªt™y
 == 1

191 
as£¹
 
’Œy
.
un™_´iû
 =ğ
¶ª_´iû


193 
as£¹
 
’Œy
.
quªt™y
 =ğ
cÚsumed_mfs


194 
as£¹
 
’Œy
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


196 
def
 
	$‹¡_g’_fÜ_nÚ_cÚsŞid©ed_blšg_w™hout_cÚsumed_un™s
(
£lf
):

198 
A
 
cu¡om”
 
has
 3 
subsütiÚs
 
which
 
he
 
dÛs
 
nÙ
 
have
 
ªy


199 
cÚsumed
 
un™s
 => 3 
difã»Á
 
´ofÜmas
, 
—ch
 
cÚššg
 
Úly
 
the


200 
¶ª
's value.

202 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-01')

204 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
(
cÚsŞid©ed_blšg
=
F®£
)

205 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

206 
g’”©e_aá”
=120, 
’abËd
=
True
,

207 
amouÁ
=
	`Decim®
('200.00'))

208 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 1, 1)

210 #C»©3 
subsütiÚs
 
the
 
§me
 
cu¡om”


211 
SubsütiÚFaùÜy
.
	$ü—‹_b©ch
(

212 
size
=3, 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

214 
subsütiÚ
 
š
 
SubsütiÚ
.
objeùs
.
	$®l
():

215 
subsütiÚ
.
	$aùiv©e
()

216 
subsütiÚ
.
	$§ve
()

218 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=billing_date,

219 
¡dout
=
£lf
.
ouut
)

221 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 3

222 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

224 
´ofÜma
 
š
 
ProfÜma
.
objeùs
.
	$®l
():

225 
’Œ›s
 = 
´ofÜma
.
´ofÜma_’Œ›s
.
	$®l
()

226 #¶ª 
jªu¬y


227 #¶ª 
ãbru¬y


228 #¶ª 
m¬ch


229 
as£¹
 
’Œ›s
.
	`couÁ
() == 3

231 
’Œy
 
š
 
’Œ›s
:

232 
as£¹
 
’Œy
.
quªt™y
 == 1

233 
as£¹
 
’Œy
.
un™_´iû
 =ğ
¶ª
.
amouÁ


235 
def
 
	$‹¡_g’_cÚsŞid©ed_blšg_w™h_cÚsumed_mfs
(
£lf
):

237 
A
 
cu¡om”
 
has
 3 
subsütiÚs
 
which
 
we
 
u£
 
the
 
nÜm®
 :

238 * 
add
 
cÚsumed
 
mfs
 
the
 
´evious
 
mÚth
 
—ch
 
subsütiÚ


239 * 
add
 
the
 
v®ue
 
of
h
¶ª
 th
Ãxt
 
mÚth
 
—ch
 
subsütiÚ


240 => 1 
´ofÜma
 
w™h
 
®l
 
the
 
afÜem’tiÚed
 
d©a


243 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-01')

244 
subsütiÚs_út
 = 3

246 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(

247 
cÚsŞid©ed_blšg
=
True
,

248 
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

249 
mf_´iû
 = 
	`Decim®
('2.5')

250 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

251 
šşuded_un™s
=
	`Decim®
('0.00'), 
´iû_³r_un™
=
mf_´iû
)

252 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

253 
g’”©e_aá”
=120, 
’abËd
=
True
,

254 
amouÁ
=
	`Decim®
('200.00'),

255 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

256 
¡¬t_d©e
 = 
dt
.
	$d©e
(2014, 1, 3)

258 
subsütiÚs
 = 
SubsütiÚFaùÜy
.
	$ü—‹_b©ch
(

259 
size
=
subsütiÚs_út
, 
¶ª
õÏn, 
¡¬t_d©e
=start_date,

260 
cu¡om”
=customer)

262 
cÚsumed_mfs
 = 
	`Decim®
('50.00')

263 
subsütiÚ
 
š
 
subsütiÚs
:

264 
subsütiÚ
.
	$aùiv©e
()

265 
subsütiÚ
.
	$§ve
()

267 #FÜ 
—ch
 
subsütiÚ
, 
add
 
cÚsumed
 
un™s


268 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

269 
subsütiÚ
=subscription,

270 
m‘”ed_ã©u»
=metered_feature,

271 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 2, 1),

272 
’d_d©e
=
dt
.
	`d©e
(2015, 2, 28),

273 
cÚsumed_un™s
=
cÚsumed_mfs
)

275 
BlšgLog
.
objeùs
.
	`ü—‹
(
subsütiÚ
=subscription,

276 
blšg_d©e
=
dt
.
	`d©e
(2015, 2, 1),

277 
¶ª_bËd_up_to
=
dt
.
	`d©e
(2015, 2, 28),

278 
m‘”ed_ã©u»s_bËd_up_to
=
dt
.
	$d©e
(2015, 1, 31))

280 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=blšg_d©e, 
¡dout
=
£lf
.
ouut
)

282 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

283 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

285 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[0]

286 #FÜ 
—ch
 
doc
, 
ex³ù
 2 
’Œ›s
: 
the
 
¶ª
 
v®ue
 
ªd
h
mfs


287 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
().
	`couÁ
(è=ğ
subsütiÚs_út
 * 2

289 
ex³ùed_tÙ®
 = (
subsütiÚs_út
 * 
¶ª
.
amouÁ
 +

290 
subsütiÚs_út
 * (
mf_´iû
 * 
cÚsumed_mfs
))

291 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
ex³ùed_tÙ®


293 
def
 
	$‹¡_g’_cÚsŞid©ed_blšg_w™hout_mfs
(
£lf
):

295 
A
 
cu¡om”
 
has
 3 
subsütiÚs
 
which
 
™
 
dÛs
 
nÙ
 
have
 
ªy


296 
cÚsumed
 
m‘”ed
 
ã©u»s
.

299 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-01')

300 
subsütiÚs_út
 = 3

302 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(

303 
cÚsŞid©ed_blšg
=
True
,

304 
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

305 
mf_´iû
 = 
	`Decim®
('2.5')

306 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

307 
šşuded_un™s
=
	`Decim®
('0.00'), 
´iû_³r_un™
=
mf_´iû
)

308 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

309 
g’”©e_aá”
=120, 
’abËd
=
True
,

310 
amouÁ
=
	`Decim®
('200.00'),

311 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

312 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 1, 3)

314 
subsütiÚs
 = 
SubsütiÚFaùÜy
.
	$ü—‹_b©ch
(

315 
size
=
subsütiÚs_út
, 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer

318 
subsütiÚ
 
š
 
subsütiÚs
:

319 
subsütiÚ
.
	$aùiv©e
()

320 
subsütiÚ
.
	$§ve
()

322 
BlšgLog
.
objeùs
.
	`ü—‹
(
subsütiÚ
=subscription,

323 
blšg_d©e
=
dt
.
	`d©e
(2015, 2, 1),

324 
¶ª_bËd_up_to
=
dt
.
	`d©e
(2015, 2, 28),

325 
m‘”ed_ã©u»s_bËd_up_to
=
dt
.
	$d©e
(2015, 1, 31))

327 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=blšg_d©e, 
¡dout
=
£lf
.
ouut
)

329 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

330 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

332 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[0]

333 #FÜ 
—ch
 
doc
, 
ex³ù
 2 
’Œ›s
: 
the
 
¶ª
' v®u+h'
exŒa
'

334 #mf 
w™h
 0 
v®ue


335 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
().
	`couÁ
(è=ğ2 * 
subsütiÚs_út


337 
ex³ùed_tÙ®
 = 
subsütiÚs_út
 * 
¶ª
.
amouÁ


338 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
ex³ùed_tÙ®


340 
def
 
	$‹¡_´Ü©ed_subsütiÚ_w™h_cÚsumed_mfs_und”æow
(
£lf
):

342 
The
 
subsütiÚ
 
¡¬‹d
 
Ï¡
 
mÚth
 
ªd
 
™
 
dÛs
 
nÙ
 
have
 
a
 
ŒŸl


343 => 
´Ü©ed
 
v®ue
 
the
 
¶ª
;h
cÚsumed_mfs
 < 
šşuded_mfs


344 => 1 
´ofÜma
 
w™h
 1 
sšgË
 
v®ue
, 
cÜ»¥Údšg
 
to
 
the
 
¶ª
 the

345 
Ãxt
 
mÚth


348 
´ev_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-02-14')

349 
cu¼_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-02')

351 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(

352 
cÚsŞid©ed_blšg
=
F®£
, 
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

353 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(
šşuded_un™s
=
	`Decim®
('20.00'))

354 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

355 
g’”©e_aá”
=120, 
’abËd
=
True
,

356 
amouÁ
=
	`Decim®
('200.00'),

357 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

358 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 2, 14)

360 #C»©
the
 
´Ü©ed
 
subsütiÚ


361 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

362 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=cu¡om”, 
ŒŸl_’d
=
NÚe
)

363 
subsütiÚ
.
	$aùiv©e
()

364 
subsütiÚ
.
	$§ve
()

366 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
´ev_blšg_d©e
,

367 
¡dout
=
£lf
.
ouut
)

369 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

370 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

372 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

373 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

374 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 2, 14), 
’d_d©e
=dt.date(2015, 2, 28),

375 
cÚsumed_un™s
=
	`Decim®
('10.00'))

377 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
cu¼_blšg_d©e
,

378 
¡dout
=
£lf
.
ouut
)

380 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

381 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

383 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[1]

384 #Ex³ù 2 
’Œ›s
: 
the
 
¶ª
 th
Ãxt
 
mÚth
 
ªd
h
cÚsumed
 
mfs
 
w™h
 0 
tÙ®
.

385 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
().
	`couÁ
() == 2

386 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
¶ª
.
amouÁ


388 
def
 
	$‹¡_´Ü©ed_subsütiÚ_w™h_cÚsumed_mfs_ov”æow
(
£lf
):

389 
´ev_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-02-15')

390 
cu¼_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-02')

392 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(
cÚsŞid©ed_blšg
=
F®£
,

393 
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

395 
mf_´iû
 = 
	`Decim®
('2.5')

396 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(
šşuded_un™s
=
	`Decim®
('20.00'),

397 
´iû_³r_un™
=
mf_´iû
)

398 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

399 
g’”©e_aá”
=120, 
’abËd
=
True
,

400 
amouÁ
=
	`Decim®
('200.00'),

401 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

402 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 2, 15)

404 #C»©
the
 
´Ü©ed
 
subsütiÚ


405 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

406 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

407 
subsütiÚ
.
	$aùiv©e
()

408 
subsütiÚ
.
	$§ve
()

410 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
´ev_blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

412 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

413 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

415 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[0]

416 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
	`Decim®
(14 / 28.0è* 
¶ª
.
amouÁ


417 
as£¹
 
	`®l
([
’Œy
.
´Ü©ed


418 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

420 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

421 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

422 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 2, 15), 
’d_d©e
=dt.date(2015, 2, 28),

423 
cÚsumed_un™s
=
	`Decim®
('12.00'))

425 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
cu¼_blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

427 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

428 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

430 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[1]

431 #Ex³ù 2 
’Œ›s
: 
the
 
¶ª
 th
Ãxt
 
mÚth
 +h
exŒa
 
cÚsumed


432 #un™s. 
exŒa_mfs
 = 2, 
sšû
 
šşuded_mfs
=20 
but
 
the
 
¶ª
 
is


433 #50% 
´Ü©ed
 => 
Úly
 50% 
of
 
the
 
tÙ®
 
šşuded_mfs
 
¬e
 
šşuded
.

434 #Th
mfs
 
wl
 
nÙ
 
be
 
added
 
as
 
the
 
cÚsumed_mfs
 < 
šşuded_mfs


435 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
().
	`couÁ
() == 2

436 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
¶ª
.
amouÁ
 + 
mf_´iû
 * 2

437 #mf 
Ï¡
 
mÚth


438 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()[0].
´Ü©ed
 
is
 
True


439 #¶ª 
upcomšg
 
mÚth


440 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()[1].
´Ü©ed
 
is
 
F®£


442 
def
 
	$‹¡_subsütiÚ_w™h_ŒŸl_w™hout_m‘”ed_ã©u»s_to_d¿á
(
£lf
):

443 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-02')

445 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

446 
g’”©e_aá”
=120, 
’abËd
=
True
,

447 
ŒŸl_³riod_days
=14, 
amouÁ
=
	`Decim®
('200.00'))

449 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 2, 4)

451 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(
¶ª
õÏn, 
¡¬t_d©e
=start_date)

452 
subsütiÚ
.
	$aùiv©e
()

453 
subsütiÚ
.
	$§ve
()

455 
Cu¡om”
.
objeùs
.
	`®l
()[0].
§Ës_x_³rûÁ
 = 
	`Decim®
('0.00')

457 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=blšg_d©e, 
¡dout
=
£lf
.
ouut
)

459 #Ex³ù 
Úe
 
ProfÜma


460 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

461 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

463 #IÀ
d¿á
 
¡©e


464 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
()[0].
¡©e
 =ğProfÜma.
STATES
.
DRAFT


466 
docum’t_’Œ›s
 = 
Docum’tEÁry
.
objeùs
.
	$®l
()

467 #Ex³ù 4 
’Œ›s
:

468 #PÏÀ
	`TrŸl
 (+-), 
PÏn
 
	`PrÜ©ed
 (+), PÏÀ
Ãxt
 
	`mÚth
(+)

469 
as£¹
 
	`Ën
(
docum’t_’Œ›s
) == 4

471 
doc
 = 
docum’t_’Œ›s
[0]

472 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
(14.0 / 28).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


474 
doc
 = 
docum’t_’Œ›s
[1]

475 
as£¹
 
doc
.
un™_´iû
 =ğ- 
	`Decim®
(14.0 / 28).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


477 
doc
 = 
docum’t_’Œ›s
[2]

478 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
(11.0 / 28).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


480 
doc
 = 
docum’t_’Œ›s
[3]

481 
as£¹
 
doc
.
un™_´iû
 =ğ
¶ª
.
amouÁ


483 #And 
quªt™y
 1

484 
as£¹
 
doc
.
quªt™y
 == 1

486 
def
 
	$‹¡_subsütiÚ_w™h_ŒŸl_w™h_m‘”ed_ã©u»s_und”æow_to_d¿á
(
£lf
):

487 
šşuded_un™s_duršg_ŒŸl
 = 
	`Decim®
('5.00')

488 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

489 
šşuded_un™s
=
	`Decim®
('0.00'),

490 
šşuded_un™s_duršg_ŒŸl
=included_units_during_trial

492 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

493 
g’”©e_aá”
=120, 
’abËd
=
True
,

494 
ŒŸl_³riod_days
=7, 
amouÁ
=
	`Decim®
('200.00'),

495 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

496 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 2, 1)

498 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(
¶ª
õÏn, 
¡¬t_d©e
=start_date)

499 
subsütiÚ
.
	$aùiv©e
()

500 
subsütiÚ
.
	$§ve
()

502 
cÚsumed_mfs_duršg_ŒŸl
 = 
	`Decim®
('3.00')

503 
M‘”edF—tu»Un™sLogFaùÜy
.
	$ü—‹
(

504 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

505 
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=
subsütiÚ
.
ŒŸl_’d
,

506 
cÚsumed_un™s
=
cÚsumed_mfs_duršg_ŒŸl


509 
mf_un™s_log_aá”_ŒŸl
 = 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

510 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

511 
¡¬t_d©e
=
subsütiÚ
.
ŒŸl_’d
 + 
dt
.
	`timed–
(
days
=1),

512 
’d_d©e
=
dt
.
	$d©‘ime
(2015, 2, 28)

515 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
dt
.
	`d©e
(2015, 3, 1), 
¡dout
=
£lf
.
ouut
)

517 #Ex³ù 
Úe
 
ProfÜma


518 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

519 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

521 #IÀ
d¿á
 
¡©e


522 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[0]

523 
as£¹
 
´ofÜma
.
¡©e
 =ğ
ProfÜma
.
STATES
.
DRAFT


525 
docum’t_’Œ›s
 = 
´ofÜma
.
´ofÜma_’Œ›s
.
	$®l
()

526 #Ex³ù 7 
’Œ›s
:

527 #PÏÀ
	`TrŸl
 (+-), 
PÏn
 
TrŸl
 
M‘”ed
 
	`F—tu»
 (+-), PÏÀ
Aá”
 Trial (+)

528 #M‘”ed 
F—tu»s
 
Aá”
 
	`TrŸl
 (+), 
PÏn
 
Ãxt
 
	`mÚth
 (+)

529 
as£¹
 
	`Ën
(
docum’t_’Œ›s
) == 7

531 
doc
 = 
docum’t_’Œ›s
[0]

532 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
('50.00') #7 / 28 * 200

534 
doc
 = 
docum’t_’Œ›s
[1]

535 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
('-50.00')

537 
doc
 = 
docum’t_’Œ›s
[2]

538 
as£¹
 
doc
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


539 
as£¹
 
doc
.
quªt™y
 =ğ
cÚsumed_mfs_duršg_ŒŸl


541 
doc
 = 
docum’t_’Œ›s
[3]

542 
as£¹
 
doc
.
un™_´iû
 =ğ- 
m‘”ed_ã©u»
.
´iû_³r_un™


543 
as£¹
 
doc
.
quªt™y
 =ğ
cÚsumed_mfs_duršg_ŒŸl


545 
doc
 = 
docum’t_’Œ›s
[4]

546 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
('150.00') #21 / 28 * 200

548 
doc
 = 
docum’t_’Œ›s
[5]

549 
as£¹
 
doc
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


550 
as£¹
 
doc
.
quªt™y
 =ğ
mf_un™s_log_aá”_ŒŸl
.
cÚsumed_un™s


552 
doc
 = 
docum’t_’Œ›s
[6]

553 
as£¹
 
doc
.
un™_´iû
 =ğ
¶ª
.
amouÁ


555 #And 
quªt™y
 1

556 
as£¹
 
doc
.
quªt™y
 == 1

558 
def
 
	$‹¡_subsütiÚ_w™h_ŒŸl_w™h_m‘”ed_ã©u»s_ov”æow_to_d¿á
(
£lf
):

559 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-01')

561 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

562 
šşuded_un™s
=
	`Decim®
('0.00'),

563 
šşuded_un™s_duršg_ŒŸl
=
	`Decim®
('5.00'))

564 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

565 
g’”©e_aá”
=120, 
’abËd
=
True
,

566 
ŒŸl_³riod_days
=7, 
amouÁ
=
	`Decim®
('200.00'),

567 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

568 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 2, 1)

569 
ŒŸl_’d
 = 
¡¬t_d©e
 + 
dt
.
	$timed–
(
days
=
¶ª
.
ŒŸl_³riod_days
)

571 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

572 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
ŒŸl_’d
=trial_end)

573 
subsütiÚ
.
	$aùiv©e
()

574 
subsütiÚ
.
	$§ve
()

576 
un™s_cÚsumed_duršg_ŒŸl
 = 
	`Decim®
('7.00')

577 
	$M‘”edF—tu»Un™sLogFaùÜy
(

578 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

579 
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=
ŒŸl_’d
,

580 
cÚsumed_un™s
=
un™s_cÚsumed_duršg_ŒŸl


583 
mf_un™s_log_aá”_ŒŸl
 = 
	`M‘”edF—tu»Un™sLogFaùÜy
(

584 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

585 
¡¬t_d©e
=
ŒŸl_’d
 + 
dt
.
	`timed–
(
days
=1),

586 
’d_d©e
=
dt
.
	$d©‘ime
(2015, 2, 28)

589 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=billing_date,

590 
¡dout
=
£lf
.
ouut
)

592 #Ex³ù 
Úe
 
ProfÜma


593 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

594 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

596 #IÀ
d¿á
 
¡©e


597 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
()[0].
¡©e
 =ğProfÜma.
STATES
.
DRAFT


599 
docum’t_’Œ›s
 = 
Docum’tEÁry
.
objeùs
.
	$®l
()

600 #Ex³ù 7 
’Œ›s
:

601 #PÏÀ
	`TrŸl
 (+-), 
PÏn
 
TrŸl
 
M‘”ed
 
	`F—tu»
 (+-),

602 #ExŒ¨
un™s
 
cÚsumed
 
duršg
 
	`ŒŸl
 (+)

603 #PÏÀ
Aá”
 
	`TrŸl
 (+)

604 #M‘”ed 
F—tu»s
 
Aá”
 
	`TrŸl
 (+), 
PÏn
 
Ãxt
 
	`mÚth
 (+)

605 
as£¹
 
	`Ën
(
docum’t_’Œ›s
) == 8

607 
doc
 = 
docum’t_’Œ›s
[0]

608 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
('57.14')

610 
doc
 = 
docum’t_’Œ›s
[1]

611 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
('-57.14')

613 
doc
 = 
docum’t_’Œ›s
[2]

614 
as£¹
 
doc
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


615 
as£¹
 
doc
.
quªt™y
 =ğ
m‘”ed_ã©u»
.
šşuded_un™s_duršg_ŒŸl


617 
doc
 = 
docum’t_’Œ›s
[3]

618 
as£¹
 
doc
.
un™_´iû
 =ğ- 
m‘”ed_ã©u»
.
´iû_³r_un™


619 
as£¹
 
doc
.
quªt™y
 =ğ
m‘”ed_ã©u»
.
šşuded_un™s_duršg_ŒŸl


621 
doc
 = 
docum’t_’Œ›s
[4]

622 
as£¹
 
doc
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


624 
šşuded_ŒŸl_un™s
 = 
m‘”ed_ã©u»
.
šşuded_un™s_duršg_ŒŸl


625 
as£¹
 
doc
.
quªt™y
 =ğ
un™s_cÚsumed_duršg_ŒŸl
 - 
šşuded_ŒŸl_un™s


627 
doc
 = 
docum’t_’Œ›s
[5]

628 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
('142.8600') #20 / 28 * 200

630 
doc
 = 
docum’t_’Œ›s
[6]

631 
as£¹
 
doc
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


632 
as£¹
 
doc
.
quªt™y
 =ğ
mf_un™s_log_aá”_ŒŸl
.
cÚsumed_un™s


634 
doc
 = 
docum’t_’Œ›s
[7]

635 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
('200.00')

637 #And 
quªt™y
 1

638 
as£¹
 
doc
.
quªt™y
 == 1

640 
def
 
	$‹¡_Ú_ŒŸl_w™h_cÚsumed_un™s_und”æow
(
£lf
):

641 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

643 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

644 
šşuded_un™s_duršg_ŒŸl
=
	`Decim®
('10.00'))

645 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

646 
g’”©e_aá”
=120, 
’abËd
=
True
,

647 
amouÁ
=
	`Decim®
('200.00'),

648 
ŒŸl_³riod_days
=14,

649 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

650 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 2, 20)

652 #C»©
the
 
´Ü©ed
 
subsütiÚ


653 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

654 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

655 
subsütiÚ
.
	$aùiv©e
()

656 
subsütiÚ
.
	$§ve
()

657 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

658 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

659 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 2, 20), 
’d_d©e
=dt.date(2015, 2, 28),

660 
cÚsumed_un™s
=
	`Decim®
('8.00'))

662 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-02')

663 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=blšg_d©e, 
¡dout
=
£lf
.
ouut
)

665 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

666 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

668 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[0]

669 #Ex³ù 6 
’Œ›s
:

670 #- 
¶ª
 
ŒŸl
 
	`ãbru¬y
 (+-)

671 #- 
mfs
 
ŒŸl
 
	`ãbru¬y
 (+-)

672 #- 
¶ª
 
ŒŸl
 
	`m¬ch
 (+-)

673 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 6

674 
as£¹
 
	`®l
([
’Œy
.
´Ü©ed


675 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

676 
as£¹
 
	`®l
([
’Œy
.
tÙ®
 !ğ
	`Decim®
('0.0000')

677 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

678 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
	`Decim®
('0.0000')

680 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-07')

682 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=billing_date,

683 
¡dout
=
£lf
.
ouut
)

685 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

686 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

688 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[1]

689 #Ex³ù 3 
’Œ›s
:

690 #- 
mfs
 
ŒŸl
 
	`m¬ch
 (+-)

691 #- 
»maššg
 
¶ª
 
	`m¬ch
 (+)

692 
as£¹
 
	`®l
([
’Œy
.
´Ü©ed


693 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

694 
as£¹
 
	`®l
([
’Œy
.
tÙ®
 !ğ
	`Decim®
('0.0000')

695 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

696 
as£¹
 
´ofÜma
.
tÙ®
 !ğ
	`Decim®
('0.0000')

698 
def
 
	$‹¡_Ú_ŒŸl_w™h_cÚsumed_un™s_ov”æow
(
£lf
):

699 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-07')

701 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

703 
mf_´iû
 = 
	`Decim®
('2.5')

704 
šşuded_duršg_ŒŸl
 = 
	`Decim®
('10.00')

705 
m‘”ed_ã©u»
 = 
	$M‘”edF—tu»FaùÜy
(

706 
šşuded_un™s_duršg_ŒŸl
=
šşuded_duršg_ŒŸl
,

707 
´iû_³r_un™
=
mf_´iû
)

708 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

709 
g’”©e_aá”
=120, 
’abËd
=
True
,

710 
amouÁ
=
	`Decim®
('200.00'), 
ŒŸl_³riod_days
=14,

711 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

712 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 2, 20)

714 #C»©
the
 
´Ü©ed
 
subsütiÚ


715 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

716 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

717 
subsütiÚ
.
	$aùiv©e
()

718 
subsütiÚ
.
	$§ve
()

719 
cÚsumed_duršg_ŒŸl
 = 
	`Decim®
('12.00')

720 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

721 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

722 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 2, 20), 
’d_d©e
=dt.date(2015, 2, 28),

723 
cÚsumed_un™s
=
cÚsumed_duršg_ŒŸl
)

725 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=blšg_d©e, 
¡dout
=
£lf
.
ouut
)

727 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

728 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

730 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[0]

731 #Ex³ù 8 
’Œ›s
:

732 #- 
¶ª
 
ŒŸl
 
	`ãbru¬y
 (+-)

733 #- 
mfs
 
ŒŸl
 
	`ãbru¬y
 (+-)

734 #- 
exŒa
 
cÚsumed
 
mfs
 
	`ãbru¬y
 (+)

735 #- 
¶ª
 
ŒŸl
 
	`m¬ch
 (+-)

736 #- 
»maššg
 
¶ª
 
	`m¬ch
 (+)

737 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 8

738 
as£¹
 
	`®l
([
’Œy
.
´Ü©ed


739 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

740 
as£¹
 
	`®l
([
’Œy
.
tÙ®
 !ğ
	`Decim®
('0.0000')

741 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

742 
exŒa_duršg_ŒŸl
 = 
cÚsumed_duršg_ŒŸl
 - 
šşuded_duršg_ŒŸl


743 
´Ü©ed_¶ª_v®ue
 = 
	`Decim®
(26 / 31.0).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


744 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
exŒa_duršg_ŒŸl
 * 
mf_´iû
 + 
´Ü©ed_¶ª_v®ue


746 
def
 
	$‹¡_2nd_sub_aá”_ŒŸl_w™h_cÚsumed_un™s_und”æow
(
£lf
):

748 
The
 
subsütiÚ
:

749 * 
¡¬t_d©e
=2015-05-20

750 * 
ŒŸl_’d
=2015-06-03

751 * 
fœ¡
 
blšg_d©e
=2015-06-01

752 * 
£cÚd
 
blšg_d©e
=2015-06-04 (
right
 
aá”
 
the
 
ŒŸl_’d
)

753 
The
 
cÚsumed_duršg_ŒŸl
 < 
šşuded_duršg_ŒŸl


756 ## 
SETUP
 ##

757 
´ev_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-06-01')

758 
cu¼_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-06-04'è#Fœ¡ 
day
 
aá”
 
ŒŸl_’d


760 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

762 
šşuded_duršg_ŒŸl
 = 
	`Decim®
('10.00')

763 
m‘”ed_ã©u»
 = 
	$M‘”edF—tu»FaùÜy
(

764 
šşuded_un™s_duršg_ŒŸl
=
šşuded_duršg_ŒŸl
)

765 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

766 
g’”©e_aá”
=120, 
’abËd
=
True
,

767 
amouÁ
=
	`Decim®
('200.00'), 
ŒŸl_³riod_days
=14,

768 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

769 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 5, 20)

771 #C»©
the
 
´Ü©ed
 
subsütiÚ


772 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

773 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

774 
subsütiÚ
.
	$aùiv©e
()

775 
subsütiÚ
.
	$§ve
()

776 
cÚsumed_duršg_fœ¡_ŒŸl_·¹
 = 
	`Decim®
('5.00')

777 
cÚsumed_duršg_£cÚd_ŒŸl_·¹
 = 
	`Decim®
('5.00')

778 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

779 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

780 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 5, 20), 
’d_d©e
=dt.date(2015, 5, 31),

781 
cÚsumed_un™s
=
cÚsumed_duršg_fœ¡_ŒŸl_·¹
)

782 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

783 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

784 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 6, 1), 
’d_d©e
=dt.date(2015, 6, 2),

785 
cÚsumed_un™s
=
cÚsumed_duršg_£cÚd_ŒŸl_·¹
)

787 ## 
TEST
 ##

788 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
´ev_blšg_d©e
,

789 
¡dout
=
£lf
.
ouut
)

791 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

792 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

793 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	$fœ¡
()

794 #Ex³ù 6 
’Œ›s
:

795 #- 
¶ª
 
ŒŸl
 
	`may
 (+-)

796 #- 
mfs
 
ŒŸl
 
	`may
 (+-)

797 #- 
¶ª
 
ŒŸl
 
	`juÃ
 (+-)

798 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 6

799 
as£¹
 
	`®l
([
’Œy
.
´Ü©ed


800 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

801 
as£¹
 
	`®l
([
’Œy
.
tÙ®
 !ğ
	`Decim®
('0.0000')

802 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

803 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
cu¼_blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

804 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
	`Decim®
('0.0000')

806 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
cu¼_blšg_d©e
,

807 
¡dout
=
£lf
.
ouut
)

809 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

810 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

812 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[1]

813 #Ex³ù 3 
’Œ›s
:

814 #- 
mfs
 
ŒŸl
 
	`juÃ
 (+-)

815 #- 
»maššg
 
¶ª
 
	`juÃ
 (+)

816 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 3

817 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	$®l
():

818 
as£¹
 
’Œy
.
´Ü©ed


819 
’Œy
.
´oduù_code
 =ğ
¶ª
.product_code:

820 
as£¹
 
’Œy
.
¡¬t_d©e
 =ğ
subsütiÚ
.
ŒŸl_’d
 + 
ONE_DAY


821 
as£¹
 
’Œy
.
’d_d©e
 =ğ
dt
.
	$d©e
(2015, 6, 30)

823 
as£¹
 
’Œy
.
¡¬t_d©e
 =ğ
dt
.
	$d©e
(2015, 6, 1)

824 
as£¹
 
’Œy
.
’d_d©e
 =ğ
subsütiÚ
.
ŒŸl_’d


826 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
	`Decim®
(28 / 30.0).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


828 
def
 
	$‹¡_2nd_sub_blšg_aá”_ŒŸl_w™h_®l_cÚsumed_un™s_ov”æow
(
£lf
):

830 
The
 
subsütiÚ
:

831 * 
¡¬t_d©e
=2015-05-20

832 * 
ŒŸl_’d
=2015-06-03

833 * 
fœ¡
 
blšg_d©e
=2015-06-01

834 * 
£cÚd
 
blšg_d©e
=2015-06-04 (
right
 
aá”
 
the
 
ŒŸl_’d
)

835 
Duršg
 2014-05-20->2015-06-03 
®l
 
the
 
šşuded_duršg_ŒŸl
 
un™s
 
have


836 
b“n
 
cÚsumed
.

839 ## 
SETUP
 ##

840 
´ev_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-06-01')

841 
cu¼_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-06-04'è#Fœ¡ 
day
 
aá”
 
ŒŸl_’d


843 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

845 
šşuded_duršg_ŒŸl
 = 
	`Decim®
('10.00')

846 
mf_´iû
 = 
	`Decim®
('2.5')

847 
m‘”ed_ã©u»
 = 
	$M‘”edF—tu»FaùÜy
(

848 
šşuded_un™s_duršg_ŒŸl
=
šşuded_duršg_ŒŸl
,

849 
´iû_³r_un™
=
mf_´iû
)

850 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

851 
g’”©e_aá”
=120, 
’abËd
=
True
,

852 
amouÁ
=
	`Decim®
('200.00'), 
ŒŸl_³riod_days
=14,

853 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

854 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 5, 20)

856 #C»©
the
 
´Ü©ed
 
subsütiÚ


857 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

858 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

859 
subsütiÚ
.
	$aùiv©e
()

860 
subsütiÚ
.
	$§ve
()

861 
cÚsumed_duršg_fœ¡_ŒŸl_·¹
 = 
	`Decim®
('10.00')

862 
cÚsumed_duršg_£cÚd_ŒŸl_·¹
 = 
	`Decim®
('12.00')

863 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

864 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

865 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 5, 20), 
’d_d©e
=dt.date(2015, 5, 31),

866 
cÚsumed_un™s
=
cÚsumed_duršg_fœ¡_ŒŸl_·¹
)

867 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

868 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

869 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 6, 1), 
’d_d©e
=dt.date(2015, 6, 2),

870 
cÚsumed_un™s
=
cÚsumed_duršg_£cÚd_ŒŸl_·¹
)

872 ## 
TEST
 ##

873 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
´ev_blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

875 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

876 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

878 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[0]

879 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
	`Decim®
('0.0000')

881 #Ex³ù 6 
’Œ›s
:

882 #- 
¶ª
 
ŒŸl
 
	`may
 (+-)

883 #- 
mfs
 
ŒŸl
 
	`may
 (+-)

884 #- 
¶ª
 
ŒŸl
 
	`juÃ
 (+-)

885 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 6

886 
as£¹
 
	`®l
([
’Œy
.
´Ü©ed


887 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

888 
as£¹
 
	`®l
([
’Œy
.
tÙ®
 !ğ
	`Decim®
('0.0000')

889 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

890 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
cu¼_blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

892 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

893 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

895 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[1]

896 #Ex³ù 2 
’Œ›s
:

897 #- 
mfs
 
ŒŸl
 
exŒa
 
	`juÃ
 (+)

898 #- 
»maššg
 
¶ª
 
	`juÃ
 (+)

899 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 2

900 
fœ¡_’Œy
 = 
´ofÜma
.
´ofÜma_’Œ›s
.
	$fœ¡
()

901 
as£¹
 
fœ¡_’Œy
.
¡¬t_d©e
 =ğ
dt
.
	$d©e
(2015, 6, 1)

902 
as£¹
 
fœ¡_’Œy
.
’d_d©e
 =ğ
subsütiÚ
.
ŒŸl_’d


904 
£cÚd_’Œy
 = 
´ofÜma
.
´ofÜma_’Œ›s
.
	$Ï¡
()

905 
as£¹
 
£cÚd_’Œy
.
¡¬t_d©e
 =ğ
subsütiÚ
.
ŒŸl_’d
 + 
ONE_DAY


906 
as£¹
 
£cÚd_’Œy
.
’d_d©e
 =ğ
dt
.
	$d©e
(2015, 6, 30)

908 
´Ü©ed_¶ª_v®ue
 = 
	`Decim®
(28 / 30.0).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


909 
exŒa_mfs_duršg_ŒŸl
 = 
cÚsumed_duršg_£cÚd_ŒŸl_·¹
 * 
mf_´iû


910 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
´Ü©ed_¶ª_v®ue
 + 
exŒa_mfs_duršg_ŒŸl


912 
def
 
	$‹¡_2nd_sub_blšg_aá”_ŒŸl_w™h_some_cÚsumed_un™s_ov”æow
(
£lf
):

914 
The
 
subsütiÚ
:

915 * 
¡¬t_d©e
=2015-05-20

916 * 
ŒŸl_’d
=2015-06-03

917 * 
fœ¡
 
blšg_d©e
=2015-06-01

918 * 
£cÚd
 
blšg_d©e
=2015-06-04 (
right
 
aá”
 
the
 
ŒŸl_’d
)

919 
Duršg
 2015-05-20->2015-06-03 
Úly
 
a
 
·¹
 
of
 
the
 
šşuded
 
un™s
 
have


920 
b“n
 
cÚsumed
 => 
a
 
·¹
 
»maš
 
the
 2015-06-01->2015-06-03

923 ## 
SETUP
 ##

924 
´ev_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-06-01')

925 
cu¼_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-06-03'è#Fœ¡ 
day
 
aá”
 
ŒŸl_’d


927 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

929 
šşuded_duršg_ŒŸl
 = 
	`Decim®
('12.00')

930 
mf_´iû
 = 
	`Decim®
('2.5')

931 
m‘”ed_ã©u»
 = 
	$M‘”edF—tu»FaùÜy
(

932 
šşuded_un™s_duršg_ŒŸl
=
šşuded_duršg_ŒŸl
,

933 
´iû_³r_un™
=
mf_´iû
)

934 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

935 
g’”©e_aá”
=120, 
’abËd
=
True
,

936 
amouÁ
=
	`Decim®
('200.00'), 
ŒŸl_³riod_days
=14,

937 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

938 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 5, 20)

940 #C»©
the
 
´Ü©ed
 
subsütiÚ


941 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

942 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

943 
subsütiÚ
.
	$aùiv©e
()

944 
subsütiÚ
.
	$§ve
()

945 
cÚsumed_duršg_fœ¡_ŒŸl_·¹
 = 
	`Decim®
('10.00')

946 
cÚsumed_duršg_£cÚd_ŒŸl_·¹
 = 
	`Decim®
('12.00')

947 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

948 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

949 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 5, 20), 
’d_d©e
=dt.date(2015, 5, 31),

950 
cÚsumed_un™s
=
cÚsumed_duršg_fœ¡_ŒŸl_·¹


952 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

953 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

954 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 6, 1), 
’d_d©e
=dt.date(2015, 6, 2),

955 
cÚsumed_un™s
=
cÚsumed_duršg_£cÚd_ŒŸl_·¹


958 ## 
TEST
 ##

959 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
´ev_blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

961 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

962 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

964 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	$fœ¡
()

965 #Ex³ù 2 
’Œ›s
:

966 #- 
¶ª
 
ŒŸl
 
	`may
 (+-)

967 #- 
mfs
 
ŒŸl
 
	`may
 (+-)

968 #- 
¶ª
 
ŒŸl
 
	`juÃ
 (+-)

969 
as£¹
 
	`®l
([
’Œy
.
´Ü©ed
 ’Œy 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.all()])

970 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 6

971 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
	`Decim®
('0.0000')

973 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
cu¼_blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

975 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

976 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

978 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[1]

979 #Ex³ù 4 
’Œ›s
:

980 #- 
mfs
 
ŒŸl
 
	`juÃ
 (+-)

981 #- 
mfs
 
ŒŸl
 
exŒa
 
	`juÃ
 (+)

982 #- 
´Ü©ed
 
subsütiÚ
 
the
 
»maššg
 
³riod


983 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 4

984 
as£¹
 
	`®l
([
’Œy
.
´Ü©ed


985 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

986 
as£¹
 
	`®l
([
’Œy
.
tÙ®
 !ğ
	`Decim®
('0.0000')

987 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

988 
´Ü©ed_¶ª_v®ue
 = 
	`Decim®
(28 / 30.0).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


989 
exŒa_mfs_duršg_ŒŸl
 = 10 * 
mf_´iû


990 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
´Ü©ed_¶ª_v®ue
 + 
exŒa_mfs_duršg_ŒŸl


992 
def
 
	$‹¡_2nd_sub_aá”_´Ü©ed_mÚth_w™hout_ŒŸl_w™hout_cÚsumed_un™s
(
£lf
):

994 
The
 
subsütiÚ
:

995 * 
¡¬t_d©e
=2015-05-20, 
no
 
ŒŸl


996 * 
fœ¡
 
blšg_d©e
=2015-05-20 (
right
 
aá”
 
aùiv©šg


997 
the
 
subsütiÚ
)

998 * 
£cÚd
 
blšg_d©e
=2015-06-01

999 
It
 
has
 0 
cÚsumed
 
un™s
 
duršg
 2015-05-20 -> 2015-06-01.

1002 ## 
SETUP
 ##

1003 
´ev_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-05-20')

1004 
cu¼_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-06-01')

1006 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

1008 
m‘”ed_ã©u»
 = 
	$M‘”edF—tu»FaùÜy
()

1009 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

1010 
g’”©e_aá”
=120, 
’abËd
=
True
,

1011 
amouÁ
=
	`Decim®
('200.00'),

1012 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1013 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 5, 20)

1015 #C»©
the
 
´Ü©ed
 
subsütiÚ


1016 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

1017 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

1018 
subsütiÚ
.
	$aùiv©e
()

1019 
subsütiÚ
.
	$§ve
()

1021 ## 
TEST
 ##

1022 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
´ev_blšg_d©e
,

1023 
subsütiÚ
=subsütiÚ.
id
, 
¡dout
=
£lf
.
ouut
)

1025 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1026 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1028 
³rûÁ
 = 
	`Decim®
(12 / 31.0).
	`quªtize
(Decimal('0.0000'))

1029 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
()[0].
tÙ®
 =ğ
³rûÁ
 * 
¶ª
.
amouÁ


1031 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
cu¼_blšg_d©e
,

1032 
subsütiÚ
=subsütiÚ.
id
, 
¡dout
=
£lf
.
ouut
)

1034 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

1035 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1037 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[1]

1038 #Ex³ù 2 
’Œ›s
: 
the
 
subsütiÚ
 th
Ãxt
 
mÚth


1039 #OÃ 
’Œy
 
the
 0 
cÚsumed
 
mfs


1040 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 2

1041 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
¶ª
.
amouÁ


1043 
def
 
	$‹¡_fuÎ_mÚth_w™h_cÚsumed_un™s
(
£lf
):

1044 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-07-01')

1046 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

1048 
mf_´iû
 = 
	`Decim®
('2.5')

1049 
šşuded_un™s
 = 
	`Decim®
('20.00')

1050 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

1051 
´iû_³r_un™
=
mf_´iû
, 
šşuded_un™s
=
	`Decim®
('20.00'))

1052 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

1053 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

1054 
g’”©e_aá”
=120, 
’abËd
=
True
,

1055 
amouÁ
=
	`Decim®
('200.00'),

1056 
´ovid”
=provider,

1057 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1058 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 2, 14)

1060 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

1061 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

1062 
subsütiÚ
.
	$aùiv©e
()

1063 
subsütiÚ
.
	$§ve
()

1065 
BlšgLog
.
objeùs
.
	`ü—‹
(
subsütiÚ
=subscription,

1066 
blšg_d©e
=
dt
.
	`d©e
(2015, 6, 1),

1067 
m‘”ed_ã©u»s_bËd_up_to
=
dt
.
	`d©e
(2015, 5, 31),

1068 
¶ª_bËd_up_to
=
dt
.
	$d©e
(2015, 6, 30))

1070 
cÚsumed_un™s
 = 
	`Decim®
('40.0000')

1071 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

1072 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

1073 
¡¬t_d©e
=
dt
.
	`d©e
(2015, 6, 1), 
’d_d©e
=dt.date(2015, 6, 30),

1074 
cÚsumed_un™s
=consumed_units)

1076 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

1078 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1079 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1081 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[0]

1082 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
().
	`couÁ
() == 2

1083 
as£¹
 
	`®l
([
nÙ
 
’Œy
.
´Ü©ed


1084 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

1085 
cÚsumed_mfs_v®ue
 = (
cÚsumed_un™s
 - 
šşuded_un™s
è* 
mf_´iû


1086 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
¶ª
.
amouÁ
 + 
cÚsumed_mfs_v®ue


1088 
def
 
	$‹¡_fuÎ_mÚth_w™hout_cÚsumed_un™s
(
£lf
):

1089 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-07-01')

1091 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

1093 
m‘”ed_ã©u»
 = 
	$M‘”edF—tu»FaùÜy
()

1094 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

1095 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

1096 
g’”©e_aá”
=120, 
’abËd
=
True
,

1097 
amouÁ
=
	`Decim®
('200.00'), 
´ovid”
=provider,

1098 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1099 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 2, 14)

1101 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

1102 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

1103 
subsütiÚ
.
	$aùiv©e
()

1104 
subsütiÚ
.
	$§ve
()

1106 
BlšgLog
.
objeùs
.
	`ü—‹
(
subsütiÚ
=subscription,

1107 
blšg_d©e
=
dt
.
	`d©e
(2015, 6, 1),

1108 
m‘”ed_ã©u»s_bËd_up_to
=
dt
.
	`d©e
(2015, 5, 31),

1109 
¶ª_bËd_up_to
=
dt
.
	$d©e
(2015, 6, 30))

1111 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

1113 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1114 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1116 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[0]

1117 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
().
	`couÁ
() == 2

1118 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
¶ª
.
amouÁ


1120 
def
 
	$‹¡_g’_´ofÜma_to_issued_¡©e_fÜ_Úe_´ovid”
(
£lf
):

1121 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-02')

1123 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(

1124 
cÚsŞid©ed_blšg
=
F®£
, 
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

1125 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(
šşuded_un™s
=
	`Decim®
('20.00'))

1126 
´ovid”
 = 
Provid”FaùÜy
.
	`ü—‹
(
deçuÉ_docum’t_¡©e
='issued')

1127 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

1128 
g’”©e_aá”
=120, 
’abËd
=
True
,

1129 
amouÁ
=
	`Decim®
('200.00'), 
´ovid”
=provider,

1130 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1131 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 2, 14)

1133 #C»©
the
 
´Ü©ed
 
subsütiÚ


1134 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

1135 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

1136 
subsütiÚ
.
	$aùiv©e
()

1137 
subsütiÚ
.
	$§ve
()

1139 
mocked_should_be_bËd
 = 
	$MagicMock
(
»tuº_v®ue
=
True
)

1140 
w™h
 
·tch
.
	`muÉË
('silver.models.Subscription',

1141 
should_be_bËd
=
mocked_should_be_bËd
):

1142 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=billing_date,

1143 
¡dout
=
£lf
.
ouut
)

1145 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1146 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1148 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`fœ¡
().
¡©e
 =ğProfÜma.
STATES
.
ISSUED


1150 
def
 
	$‹¡_g’_mixed_¡©es_fÜ_muÉË_´ovid”s
(
£lf
):

1151 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-02')

1153 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(

1154 
cÚsŞid©ed_blšg
=
F®£
, 
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

1155 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

1156 
šşuded_un™s
=
	`Decim®
('20.00'))

1157 
´ovid”_d¿á
 = 
Provid”FaùÜy
.
	`ü—‹
(

1158 
deçuÉ_docum’t_¡©e
='draft')

1159 
´ovid”_issued
 = 
Provid”FaùÜy
.
	`ü—‹
(

1160 
deçuÉ_docum’t_¡©e
='issued')

1161 
¶ª_´iû
 = 
	`Decim®
('200.00')

1162 
¶ª1
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

1163 
g’”©e_aá”
=120, 
’abËd
=
True
,

1164 
amouÁ
=
¶ª_´iû
, 
´ovid”
=
´ovid”_d¿á
,

1165 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1166 
¶ª2
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

1167 
g’”©e_aá”
=120, 
’abËd
=
True
,

1168 
amouÁ
=
¶ª_´iû
, 
´ovid”
=
´ovid”_issued
,

1169 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1170 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 2, 14)

1172 #C»©
the
 
´Ü©ed
 
subsütiÚ


1173 
subsütiÚ1
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

1174 
¶ª
=
¶ª1
, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

1175 
subsütiÚ1
.
	$aùiv©e
()

1176 
subsütiÚ1
.
	$§ve
()

1178 
subsütiÚ2
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

1179 
¶ª
=
¶ª2
, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer)

1180 
subsütiÚ2
.
	$aùiv©e
()

1181 
subsütiÚ2
.
	$§ve
()

1183 
mocked_Ï¡_blšg_d©e
 = 
	`Prİ”tyMock
(

1184 
»tuº_v®ue
=
dt
.
	$d©e
(2015, 2, 14))

1185 
mocked_is_bËd_fœ¡_time
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
F®£
)

1186 
mocked_g‘_cÚsumed_un™s_duršg_ŒŸl
 = 
	`MagicMock
(
»tuº_v®ue
=(0, 0))

1187 
w™h
 
·tch
.
	`muÉË
(

1189 
Ï¡_blšg_d©e
=
mocked_Ï¡_blšg_d©e
,

1190 
is_bËd_fœ¡_time
=
mocked_is_bËd_fœ¡_time
,

1191 
_g‘_exŒa_cÚsumed_un™s_duršg_ŒŸl
=
mocked_g‘_cÚsumed_un™s_duršg_ŒŸl


1194 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=billing_date,

1195 
¡dout
=
£lf
.
ouut
)

1197 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

1198 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1200 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
()[0].
¡©e
 =ğProfÜma.
STATES
.
ISSUED


1201 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
()[1].
¡©e
 =ğProfÜma.
STATES
.
DRAFT


1203 
def
 
	$‹¡_ÿnûl_sub_w™hout_ŒŸl_©_’d_of_blšg_cyşe
(
£lf
):

1205 
It
 
has
 
cÚsumed
 
mfs
 
b‘w“n
 
¡¬t_d©e
 -> 
’d_of_mÚth


1208 ## 
SETUP
 ##

1209 
´ev_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-05-20')

1210 
¿ndom_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-05-27')

1211 
cu¼_blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-06-01')

1213 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(
§Ës_x_³rûÁ
=
	`Decim®
('0.00'))

1215 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

1216 
šşuded_un™s
=
	`Decim®
('0.0000'),

1217 
´iû_³r_un™
=
	`Decim®
('2.5'))

1218 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

1219 
š‹rv®_couÁ
=1, 
g’”©e_aá”
=120,

1220 
’abËd
=
True
, 
amouÁ
=
	`Decim®
('200.00'),

1221 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1222 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 5, 20)

1223 
’d_of_mÚth
 = 
dt
.
	$d©e
(2015, 5, 31)

1225 #C»©
the
 
´Ü©ed
 
subsütiÚ


1226 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

1227 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
cu¡om”
=customer

1229 
subsütiÚ
.
	$aùiv©e
()

1230 
subsütiÚ
.
	$§ve
()

1232 ## 
TEST
 ##

1235 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
´ev_blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

1237 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1238 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1240 #Iˆ
should
 
add
 
the
 
´Ü©ed
 
v®ue
 
of
h
¶ª
 th
»¡
 ofhe

1242 
´Ü©ed_days
 = (
’d_of_mÚth
 - 
¡¬t_d©e
).
days
 + 1

1243 
´Ü©ed_¶ª_v®ue
 = 
	`Decim®
(
´Ü©ed_days
 / 31.0).
	`quªtize
(

1244 
	`Decim®
('0.0000')è* 
¶ª
.
amouÁ


1245 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
()[0].
tÙ®
 =ğ
´Ü©ed_¶ª_v®ue


1248 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
¿ndom_blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

1250 #Iˆ
should
 
be
 
ignÜed


1251 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1252 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1254 #Mov
™
 
to
 `
ÿnûËd
` 
¡©e


1255 
subsütiÚ
.
	$ÿnûl
(
wh’
=
SubsütiÚ
.
CANCEL_OPTIONS
.
END_OF_BILLING_CYCLE
)

1256 
subsütiÚ
.
ÿnûl_d©e
 = 
dt
.
	$d©e
(2015, 5, 31)

1257 
subsütiÚ
.
	$§ve
()

1259 #CÚsum
some
 
mfs


1260 
cÚsumed_mfs
 = 
	`Decim®
('5.00')

1261 
M‘”edF—tu»Un™sLogFaùÜy
.
	$ü—‹
(

1262 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

1263 
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=
’d_of_mÚth
,

1264 
cÚsumed_un™s
=
cÚsumed_mfs
)

1267 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
cu¼_blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

1269 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

1270 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1272 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[1]

1273 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 1

1274 
as£¹
 
	`®l
([
’Œy
.
´Ü©ed


1275 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

1276 
as£¹
 
	`®l
([
’Œy
.
tÙ®
 !ğ
	`Decim®
('0.0000')

1277 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`®l
()])

1278 
cÚsumed_mfs_v®ue
 = 
cÚsumed_mfs
 * 
m‘”ed_ã©u»
.
´iû_³r_un™


1279 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
cÚsumed_mfs_v®ue


1283 ###########################################################################
e¡_ÿnûËd_subsütiÚ_w™h_ŒŸl_ªd_cÚsumed_m‘”ed_ã©u»s_d¿á(£lf):

1286 
SubsütiÚ
 
w™h
 
cÚsumed
 
mfs
 
bÙh
 
duršg
 
ŒŸl
 
ªd
 
aá”w¬ds
,

1287 
ÿnûËd
 
š
 
the
 
§me
 
mÚth
 
™
 
¡¬‹d
.

1289 
¡¬t_d©e
 = 2015-02-01

1290 
ŒŸl_’d
 = 2015-02-08 -- 
has
 
cÚsumed
 
un™s
 
duršg
 
ŒŸl
 
³riod


1291 
’d_d©e
 = 2015-02-28 -- 
has
 
cÚsumed
 
un™s
 
b‘w“n
 
ŒŸl
 
ªd
ƒnd_date

1294 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-01')

1296 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(
šşuded_un™s
=
	`Decim®
('0.00'))

1297 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

1298 
g’”©e_aá”
=120, 
’abËd
=
True
,

1299 
ŒŸl_³riod_days
=7, 
amouÁ
=
	`Decim®
('200.00'),

1300 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1301 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 02, 01)

1302 
ŒŸl_’d
 = 
¡¬t_d©e
 + 
dt
.
	$timed–
(
days
=
¶ª
.
ŒŸl_³riod_days
)

1304 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(

1305 
¶ª
õÏn, 
¡¬t_d©e
=¡¬t_d©e, 
ŒŸl_’d
=trial_end)

1306 
subsütiÚ
.
	$aùiv©e
()

1307 
subsütiÚ
.
	$§ve
()

1309 
mf_un™s_log_duršg_ŒŸl
 = 
	$M‘”edF—tu»Un™sLogFaùÜy
(

1310 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

1311 
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=
ŒŸl_’d
)

1313 
mf_un™s_log_aá”_ŒŸl
 = 
	`M‘”edF—tu»Un™sLogFaùÜy
(

1314 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

1315 
¡¬t_d©e
=
ŒŸl_’d
 + 
dt
.
	`timed–
(
days
=1),

1316 #ÿnûËd 4 
days
 
befÜe
 
the
 
’d
 
of
h
mÚth


1317 
’d_d©e
=
dt
.
	$d©‘ime
(2015, 2, 28))

1319 
subsütiÚ
.
	$ÿnûl
(
wh’
=
SubsütiÚ
.
CANCEL_OPTIONS
.
END_OF_BILLING_CYCLE
)

1320 
subsütiÚ
.
ÿnûl_d©e
 = 
dt
.
	$d©e
(2015, 2, 28)

1321 
subsütiÚ
.
	$§ve
()

1323 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=blšg_d©e, 
¡dout
=
£lf
.
ouut
)

1325 #Ex³ù 
Úe
 
ProfÜma


1326 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1327 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1329 #IÀ
d¿á
 
¡©e


1330 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
()[0].
¡©e
 =ğProfÜma.
STATES
.
DRAFT


1331 #Ex³ù 6 
’Œ›s
:

1332 #PÏÀ
	`TrŸl
 (+-), 
PÏn
 
TrŸl
 
M‘”ed
 
	`F—tu»
 (+-),

1333 #PÏÀ
Aá”
 
	`TrŸl
 (+), 
M‘”ed
 
F—tu»s
 After Trial (+)

1334 
docum’t_’Œ›s
 = 
Docum’tEÁry
.
objeùs
.
	$®l
()

1335 
as£¹
 
	`Ën
(
docum’t_’Œ›s
) == 6

1337 
doc
 = 
docum’t_’Œ›s
[0] #PÏÀ
	`ŒŸl
 (+)

1338 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
('57.14')

1340 
doc
 = 
docum’t_’Œ›s
[1] #PÏÀ
	`ŒŸl
 (-)

1341 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
('-57.14')

1343 
doc
 = 
docum’t_’Œ›s
[2] #CÚsumed 
	`mf
 (+)

1344 
as£¹
 
doc
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


1345 
as£¹
 
doc
.
quªt™y
 =ğ
mf_un™s_log_duršg_ŒŸl
.
cÚsumed_un™s


1347 
doc
 = 
docum’t_’Œ›s
[3] #CÚsumed 
	`mf
 (-)

1348 
as£¹
 
doc
.
un™_´iû
 =ğ- 
m‘”ed_ã©u»
.
´iû_³r_un™


1349 
as£¹
 
doc
.
quªt™y
 =ğ
mf_un™s_log_duršg_ŒŸl
.
cÚsumed_un™s


1351 
doc
 = 
docum’t_’Œ›s
[4] #PÏÀ
aá”
 
ŒŸl
 
’d


1352 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
(20.0 / 28).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1354 
doc
 = 
docum’t_’Œ›s
[5] #CÚsumed 
mf
 
aá”
 
ŒŸl


1355 
as£¹
 
doc
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


1356 
as£¹
 
doc
.
quªt™y
 =ğ
mf_un™s_log_aá”_ŒŸl
.
cÚsumed_un™s


1358 
def
 
	$‹¡_ÿnûËd_subsütiÚ_w™h_m‘”ed_ã©u»s_to_d¿á
(
£lf
):

1360 
¡¬t_d©e
 = 2015-01-01

1361 
ŒŸl_’d
 = 2015-01-08

1362 
Ï¡_blšg_d©e
 = 2015-02-01

1364 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-01')

1366 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(
šşuded_un™s
=
	`Decim®
('0.00'))

1367 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

1368 
g’”©e_aá”
=120, 
’abËd
=
True
,

1369 
ŒŸl_³riod_days
=7, 
amouÁ
=
	`Decim®
('200.00'),

1370 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1371 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 1, 1)

1373 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(
¶ª
õÏn, 
¡¬t_d©e
=start_date)

1374 
subsütiÚ
.
	$aùiv©e
()

1375 
subsütiÚ
.
	$§ve
()

1377 
mf_un™s_log
 = 
	`M‘”edF—tu»Un™sLogFaùÜy
(

1378 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

1379 
¡¬t_d©e
=
dt
.
	`d©‘ime
(2015, 2, 1),

1380 
’d_d©e
=
dt
.
	$d©‘ime
(2015, 2, 28)

1383 
subsütiÚ
.
	$ÿnûl
(
wh’
=
SubsütiÚ
.
CANCEL_OPTIONS
.
END_OF_BILLING_CYCLE
)

1384 
subsütiÚ
.
ÿnûl_d©e
 = 
dt
.
	$d©e
(2015, 2, 28)

1385 
subsütiÚ
.
	$§ve
()

1387 
BlšgLog
.
objeùs
.
	`ü—‹
(
subsütiÚ
=subscription,

1388 
blšg_d©e
=
dt
.
	`d©e
(2015, 2, 1),

1389 
¶ª_bËd_up_to
=
dt
.
	`d©e
(2015, 2, 28),

1390 
m‘”ed_ã©u»s_bËd_up_to
=
dt
.
	$d©e
(2015, 1, 31))

1392 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=blšg_d©e, 
¡dout
=
£lf
.
ouut
)

1394 #Ex³ù 
Úe
 
ProfÜma


1395 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1396 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1398 #Ex³ù 1 
’Œy
:

1399 #ExŒ¨
M‘”ed
 
	`F—tu»s
 (+)

1400 
as£¹
 
Docum’tEÁry
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1402 
doc
 = 
Docum’tEÁry
.
objeùs
.
	`®l
()[0]

1403 
as£¹
 
doc
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


1404 
as£¹
 
doc
.
quªt™y
 =ğ
mf_un™s_log
.
cÚsumed_un™s


1406 
def
 
	$‹¡_ÿnûËd_subsütiÚ_w™h_ŒŸl_ªd_ŒŸl_und”æow
(
£lf
):

1408 
A
 
subsütiÚ
 
th©
 
was
 
ÿnûËd
 
š
 
the
 
§me
 
mÚth
 
as
 
™
 
¡¬‹d
,

1409 
the
 
cu¡om”
 
cÚsumšg
 
Ëss
 
m‘”ed
 
ã©u»s
 
thª


1410 
šşuded_un™s_duršg_ŒŸl
.

1413 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-01')

1415 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

1416 
šşuded_un™s
=
	`Decim®
('0.00'),

1417 
šşuded_un™s_duršg_ŒŸl
=
	`Decim®
('5.00'))

1418 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

1419 
g’”©e_aá”
=120, 
’abËd
=
True
,

1420 
ŒŸl_³riod_days
=7, 
amouÁ
=
	`Decim®
('200.00'),

1421 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1422 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 02, 01)

1424 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(
¶ª
õÏn, 
¡¬t_d©e
=start_date)

1425 
subsütiÚ
.
	$aùiv©e
()

1426 
subsütiÚ
.
	$§ve
()

1428 
ŒŸl_quªt™y
 = 
	`Decim®
('3.00')

1429 
	$M‘”edF—tu»Un™sLogFaùÜy
(

1430 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

1431 
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=
subsütiÚ
.
ŒŸl_’d
,

1432 
cÚsumed_un™s
=
ŒŸl_quªt™y
)

1434 
mf_un™s_log_aá”_ŒŸl
 = 
	`M‘”edF—tu»Un™sLogFaùÜy
(

1435 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

1436 
¡¬t_d©e
=
subsütiÚ
.
ŒŸl_’d
 + 
dt
.
	`timed–
(
days
=1),

1437 
’d_d©e
=
dt
.
	$d©‘ime
(2015, 2, 28)

1440 
subsütiÚ
.
	$ÿnûl
(
wh’
=
SubsütiÚ
.
CANCEL_OPTIONS
.
END_OF_BILLING_CYCLE
)

1441 
subsütiÚ
.
ÿnûl_d©e
 = 
dt
.
	$d©e
(2015, 02, 28)

1442 
subsütiÚ
.
	$§ve
()

1444 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=blšg_d©e, 
¡dout
=
£lf
.
ouut
)

1446 #Ex³ù 
Úe
 
ProfÜma


1447 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1448 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1450 #IÀ
d¿á
 
¡©e


1451 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
()[0].
¡©e
 =ğProfÜma.
STATES
.
DRAFT


1453 
docum’t_’Œ›s
 = 
Docum’tEÁry
.
objeùs
.
	$®l
()

1454 #Ex³ù 6 
’Œ›s
:

1455 #PÏÀ
	`TrŸl
 (+-), 
PÏn
 
TrŸl
 
M‘”ed
 
	`F—tu»
 (+-),

1456 #PÏÀ
Aá”
 
	`TrŸl
 (+), 
M‘”ed
 
F—tu»s
 After Trial (+)

1457 
as£¹
 
	`Ën
(
docum’t_’Œ›s
) == 6

1459 
doc
 = 
docum’t_’Œ›s
[0] #PÏÀ
	`ŒŸl
 (+)

1460 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
(7.0 / 28).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1462 
doc
 = 
docum’t_’Œ›s
[1] #PÏÀ
	`ŒŸl
 (-)

1463 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
(-7.0 / 28).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1465 
doc
 = 
docum’t_’Œ›s
[2] #CÚsumed 
	`mf
 (+)

1466 
as£¹
 
doc
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


1467 
as£¹
 
doc
.
quªt™y
 =ğ
ŒŸl_quªt™y


1469 
doc
 = 
docum’t_’Œ›s
[3] #CÚsumed 
	`mf
 (-)

1470 
as£¹
 
doc
.
un™_´iû
 =ğ- 
m‘”ed_ã©u»
.
´iû_³r_un™


1471 
as£¹
 
doc
.
quªt™y
 =ğ
ŒŸl_quªt™y


1473 
doc
 = 
docum’t_’Œ›s
[4] #PÏÀ
aá”
 
ŒŸl
 
’d


1474 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
(21.0 / 28).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1476 
doc
 = 
docum’t_’Œ›s
[5] #CÚsumed 
mf
 
aá”
 
ŒŸl


1477 
as£¹
 
doc
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


1478 
as£¹
 
doc
.
quªt™y
 =ğ
mf_un™s_log_aá”_ŒŸl
.
cÚsumed_un™s


1480 
def
 
	$‹¡_ÿnûËd_subsütiÚ_w™h_ŒŸl_ªd_ŒŸl_ov”æow
(
£lf
):

1481 
blšg_d©e
 = 
	`g’”©e_docs_d©e
('2015-03-01')

1483 
un™s_šşuded_duršg_ŒŸl
 = 
	`Decim®
('5.00')

1484 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

1485 
šşuded_un™s
=
	`Decim®
('0.00'),

1486 
šşuded_un™s_duršg_ŒŸl
=
un™s_šşuded_duršg_ŒŸl
)

1487 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

1488 
g’”©e_aá”
=120, 
’abËd
=
True
,

1489 
ŒŸl_³riod_days
=7, 
amouÁ
=
	`Decim®
('200.00'),

1490 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1491 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 02, 01)

1493 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(
¶ª
õÏn, 
¡¬t_d©e
=start_date)

1494 
subsütiÚ
.
	$aùiv©e
()

1495 
subsütiÚ
.
	$§ve
()

1497 
un™s_cÚsumed_duršg_ŒŸl
 = 
	`Decim®
('7.00')

1498 
	$M‘”edF—tu»Un™sLogFaùÜy
(

1499 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

1500 
¡¬t_d©e
=¡¬t_d©e, 
’d_d©e
=
subsütiÚ
.
ŒŸl_’d
,

1501 
cÚsumed_un™s
=
un™s_cÚsumed_duršg_ŒŸl
)

1503 
mf_un™s_log_aá”_ŒŸl
 = 
	`M‘”edF—tu»Un™sLogFaùÜy
(

1504 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

1505 
¡¬t_d©e
=
subsütiÚ
.
ŒŸl_’d
 + 
dt
.
	`timed–
(
days
=1),

1506 
’d_d©e
=
dt
.
	$d©‘ime
(2015, 2, 28)

1509 
subsütiÚ
.
	$ÿnûl
(

1510 
wh’
=
SubsütiÚ
.
CANCEL_OPTIONS
.
END_OF_BILLING_CYCLE


1512 
subsütiÚ
.
ÿnûl_d©e
 = 
dt
.
	$d©e
(2015, 2, 28)

1513 
subsütiÚ
.
	$§ve
()

1515 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=billing_date,

1516 
¡dout
=
£lf
.
ouut
)

1518 #Ex³ù 
Úe
 
ProfÜma


1519 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1520 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1522 #IÀ
d¿á
 
¡©e


1523 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
()[0].
¡©e
 =ğProfÜma.
STATES
.
DRAFT


1525 
docum’t_’Œ›s
 = 
Docum’tEÁry
.
objeùs
.
	$®l
()

1526 #Ex³ù 7 
’Œ›s
:

1527 #PÏÀ
	`TrŸl
 (+-), 
PÏn
 
TrŸl
 
M‘”ed
 
	`F—tu»
 (+-),

1528 #ExŒ¨
cÚsumed
 
mf


1529 #PÏÀ
Aá”
 
	`TrŸl
 (+), 
M‘”ed
 
F—tu»s
 After Trial (+)

1530 
as£¹
 
	`Ën
(
docum’t_’Œ›s
) == 7

1532 
doc
 = 
docum’t_’Œ›s
[0] #PÏÀ
	`ŒŸl
 (+)

1533 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
(7.0 / 28).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1535 
doc
 = 
docum’t_’Œ›s
[1] #PÏÀ
	`ŒŸl
 (-)

1536 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
(-7.0 / 28).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1538 
doc
 = 
docum’t_’Œ›s
[2] #CÚsumed 
	`mf
 (+)

1539 
as£¹
 
doc
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


1540 
as£¹
 
doc
.
quªt™y
 =ğ
un™s_šşuded_duršg_ŒŸl


1542 
doc
 = 
docum’t_’Œ›s
[3] #CÚsumed 
	`mf
 (-)

1543 
as£¹
 
doc
.
un™_´iû
 =ğ- 
m‘”ed_ã©u»
.
´iû_³r_un™


1544 
as£¹
 
doc
.
quªt™y
 =ğ
un™s_šşuded_duršg_ŒŸl


1546 
doc
 = 
docum’t_’Œ›s
[4] #CÚsumed 
	`mf
 (-)

1547 
as£¹
 
doc
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


1548 
as£¹
 
doc
.
quªt™y
 =ğ
un™s_cÚsumed_duršg_ŒŸl
 - 
un™s_šşuded_duršg_ŒŸl


1550 
doc
 = 
docum’t_’Œ›s
[5] #PÏÀ
aá”
 
ŒŸl
 
’d


1551 
as£¹
 
doc
.
un™_´iû
 =ğ
	`Decim®
(21.0 / 28).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1553 
doc
 = 
docum’t_’Œ›s
[6] #CÚsumed 
mf
 
aá”
 
ŒŸl


1554 
as£¹
 
doc
.
un™_´iû
 =ğ
m‘”ed_ã©u»
.
´iû_³r_un™


1555 
as£¹
 
doc
.
quªt™y
 =ğ
mf_un™s_log_aá”_ŒŸl
.
cÚsumed_un™s


1557 
def
 
	$‹¡_g’_fÜ_sšgË_ÿnûËd_subsütiÚ_duršg_ŒŸl
(
£lf
):

1558 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

1559 
š‹rv®_couÁ
=1, 
g’”©e_aá”
=120,

1560 
’abËd
=
True
, 
ŒŸl_³riod_days
=7,

1561 
amouÁ
=
	`Decim®
('200.00'))

1563 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(
¶ª
õÏn, 
¡¬t_d©e
=
dt
.
	$d©e
(2015, 1, 3))

1564 
subsütiÚ
.
	$aùiv©e
()

1565 
subsütiÚ
.
	$ÿnûl
(
wh’
=
SubsütiÚ
.
CANCEL_OPTIONS
.
NOW
)

1566 
subsütiÚ
.
ÿnûl_d©e
 = 
dt
.
	$d©e
(2015, 1, 6)

1567 
subsütiÚ
.
	$§ve
()

1569 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-01-06'),

1570 
subsütiÚ
=subsütiÚ.
pk
, 
¡dout
=
£lf
.
ouut
)

1572 
as£¹
 
SubsütiÚ
.
objeùs
.
	`f‹r
(
¡©e
='’ded').
	`couÁ
() == 0

1574 #th
d©e
 
aá”
 
the
 
ÿnûl
 date

1575 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-01-07'),

1576 
subsütiÚ
=subsütiÚ.
pk
, 
¡dout
=
£lf
.
ouut
)

1578 
as£¹
 
SubsütiÚ
.
objeùs
.
	`f‹r
(
¡©e
='’ded').
	`couÁ
() == 1

1580 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1581 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1583 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[0]

1585 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 2

1586 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	$®l
():

1587 
as£¹
 
’Œy
.
´Ü©ed


1588 
as£¹
 
’Œy
.
¡¬t_d©e
 =ğ
subsütiÚ
.start_date

1589 
as£¹
 
’Œy
.
’d_d©e
 =ğ
subsütiÚ
.
ÿnûl_d©e


1591 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
	`Decim®
('0.0000')

1593 
def
 
	$‹¡_g’_aùive_ªd_ÿnûËd_£ËùiÚ
(
£lf
):

1594 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
='mÚth', 
š‹rv®_couÁ
=1,

1595 
g’”©e_aá”
=120, 
’abËd
=
True
,

1596 
ŒŸl_³riod_days
=7, 
amouÁ
=
	`Decim®
('200.00'))

1597 
¡¬t_d©e
 = 
dt
.
	$d©e
(2015, 1, 29)

1599 
SubsütiÚFaùÜy
.
	$ü—‹_b©ch
(
size
=5, 
¶ª
õÏn, 
¡¬t_d©e
=start_date)

1601 
subsütiÚ
 
š
 
SubsütiÚ
.
objeùs
.
	$®l
():

1602 
subsütiÚ
.
	$aùiv©e
()

1603 
subsütiÚ
.
	$§ve
()

1605 
ÿnûl_d©e
 = 
dt
.
	$d©e
(2015, 1, 29)

1607 
subsütiÚ
 
š
 
SubsütiÚ
.
objeùs
.
	`®l
()[2:5]:

1608 
subsütiÚ
.
	$ÿnûl
(
wh’
=
SubsütiÚ
.
CANCEL_OPTIONS
.
NOW
)

1609 
subsütiÚ
.
ÿnûl_d©e
 = cancel_date

1610 
subsütiÚ
.
	$§ve
()

1612 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
ÿnûl_d©e
, 
¡dout
=
£lf
.
ouut
)

1613 #Ex³ù 2 
ProfÜmas
 
äom
 
the
 
aùive
 
subs


1614 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

1615 
as£¹
 
SubsütiÚ
.
objeùs
.
	`f‹r
(
¡©e
='’ded').
	`couÁ
() == 0

1617 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
ÿnûl_d©e
 + 
ONE_DAY
, 
¡dout
=
£lf
.
ouut
)

1619 #Ex³ù 5 
	`ProfÜmas
 (2 
aùive
 
Subs
, 3 
ÿnûËd
)

1620 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 5

1621 
as£¹
 
Invoiû
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1623 
as£¹
 
SubsütiÚ
.
objeùs
.
	`f‹r
(
¡©e
='’ded').
	`couÁ
() == 3

1625 
def
 
	$‹¡_subsütiÚ_w™h_£·¿‹_cyşes_duršg_ŒŸl
(
£lf
):

1626 
£·¿‹_cyşes_duršg_ŒŸl
 = 
True


1627 
´ebl_¶ª
 = 
F®£


1628 
g’”©e_docum’ts_Ú_ŒŸl_’d
 = 
F®£


1630 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

1631 
šşuded_un™s_duršg_ŒŸl
=
	`Decim®
('5.00'),

1632 
´iû_³r_un™
=
	`Decim®
('1.00')

1634 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

1635 
š‹rv®_couÁ
=1, 
g’”©e_aá”
=120,

1636 
’abËd
=
True
, 
ŒŸl_³riod_days
=15,

1637 
amouÁ
=
	`Decim®
('200.00'),

1638 
£·¿‹_cyşes_duršg_ŒŸl
=separate_cycles_during_trial,

1639 
g’”©e_docum’ts_Ú_ŒŸl_’d
=generate_documents_on_trial_end,

1640 
´ebl_¶ª
=prebill_plan,

1641 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1643 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(
¶ª
õÏn, 
¡¬t_d©e
=
dt
.
	$d©e
(2015, 1, 25))

1644 
subsütiÚ
.
	$aùiv©e
()

1645 
subsütiÚ
.
	$§ve
()

1646 
subsütiÚ
.
cu¡om”
.
§Ës_x_³rûÁ
 = 
NÚe


1647 
subsütiÚ
.
cu¡om”
.
	$§ve
()

1649 
mf_log
 = 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

1650 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

1651 
¡¬t_d©e
=
subsütiÚ
.¡¬t_d©e, 
’d_d©e
=
dt
.
	`d©e
(2015, 01, 31),

1652 
cÚsumed_un™s
=
	`Decim®
('5.00')

1655 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-01-25'), 
¡dout
=
£lf
.
ouut
)

1657 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1659 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-02-01'), 
¡dout
=
£lf
.
ouut
)

1661 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1663 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[0]

1664 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
	`Decim®
('0.00')

1665 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
(è=ğ4 #¶ª 
ŒŸl
 
ªd
 
cÚsumed
 
mfs


1666 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	$®l
():

1667 
’Œy
.
´oduù_code
 =ğ
¶ª
.product_code:

1668 
un™_´iû
 = 
	`Decim®
(7 / 31.0).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1669 
as£¹
 
’Œy
.
quªt™y
 == 1

1671 
as£¹
 
’Œy
.
quªt™y
 =ğ
mf_log
.
cÚsumed_un™s


1672 
un™_´iû
 = 
m‘”ed_ã©u»
.
´iû_³r_un™


1674 
’Œy
.
un™_´iû
 < 0: #discount

1675 
un™_´iû
 *= -1

1677 
as£¹
 
’Œy
.
un™_´iû
 == unit_price

1678 
as£¹
 
’Œy
.
´Ü©ed


1679 
as£¹
 
’Œy
.
¡¬t_d©e
 =ğ
subsütiÚ
.start_date

1680 
as£¹
 
’Œy
.
’d_d©e
 =ğ
dt
.
	$d©e
(2015, 01, 31)

1682 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-03-01'),

1683 
subsütiÚ
=subsütiÚ.
pk
, 
¡dout
=
£lf
.
ouut
)

1685 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

1686 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[1]

1688 
bËd_¶ª_amouÁ
 = 
	`Decim®
(20 / 28.0).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1689 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
bËd_¶ª_amouÁ


1691 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
(è=ğ4 #¶ª 
	`ŒŸl
 (+-), 
	`¶ª
 (+è
ªd
 
	$mfs
 (0)

1692 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	$®l
():

1693 
’Œy
.
´oduù_code
 =ğ
¶ª
.product_code:

1694 
as£¹
 
’Œy
.
quªt™y
 == 1

1695 
’Œy
.
¡¬t_d©e
 =ğ
dt
.
	$d©e
(2015, 2, 1): #trial

1696 
un™_´iû
 = 
¶ª
.
amouÁ
 - 
bËd_¶ª_amouÁ


1697 
as£¹
 
’Œy
.
’d_d©e
 =ğ
dt
.
	$d©e
(2015, 2, 8)

1699 
as£¹
 
’Œy
.
¡¬t_d©e
 =ğ
dt
.
	$d©e
(2015, 2, 9)

1700 
as£¹
 
’Œy
.
’d_d©e
 =ğ
dt
.
	$d©e
(2015, 2, 28)

1701 
un™_´iû
 = 
bËd_¶ª_amouÁ


1703 
as£¹
 
’Œy
.
quªt™y
 =ğ
	`Decim®
('0.00')

1704 
as£¹
 
’Œy
.
¡¬t_d©e
 =ğ
subsütiÚ
.
ŒŸl_’d
 + 
ONE_DAY


1705 
as£¹
 
’Œy
.
’d_d©e
 =ğ
dt
.
	$d©e
(2015, 2, 28)

1706 
un™_´iû
 = 
’Œy
.unit_price

1708 
’Œy
.
un™_´iû
 < 0: #discount

1709 
un™_´iû
 *= -1

1711 
as£¹
 
’Œy
.
un™_´iû
 == unit_price

1712 
as£¹
 
’Œy
.
´Ü©ed


1714 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-02-10'),

1715 
subsütiÚ
=subsütiÚ.
pk
, 
¡dout
=
£lf
.
ouut
)

1716 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

1718 
def
 
	$‹¡_subsütiÚ_w™h_docum’ts_g’”©iÚ_Ú_ŒŸl_’d
(
£lf
):

1719 
£·¿‹_cyşes_duršg_ŒŸl
 = 
F®£


1720 
g’”©e_docum’ts_Ú_ŒŸl_’d
 = 
True


1722 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

1723 
šşuded_un™s_duršg_ŒŸl
=
	`Decim®
('5.00'),

1724 
´iû_³r_un™
=
	`Decim®
('1.00')

1726 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

1727 
š‹rv®_couÁ
=1, 
g’”©e_aá”
=120,

1728 
’abËd
=
True
, 
ŒŸl_³riod_days
=15,

1729 
amouÁ
=
	`Decim®
('200.00'),

1730 
£·¿‹_cyşes_duršg_ŒŸl
=separate_cycles_during_trial,

1731 
g’”©e_docum’ts_Ú_ŒŸl_’d
=generate_documents_on_trial_end,

1732 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1734 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(
¶ª
õÏn, 
¡¬t_d©e
=
dt
.
	$d©e
(2015, 1, 25))

1735 
subsütiÚ
.
	$aùiv©e
()

1736 
subsütiÚ
.
	$§ve
()

1737 
subsütiÚ
.
cu¡om”
.
§Ës_x_³rûÁ
 = 
NÚe


1738 
subsütiÚ
.
cu¡om”
.
	$§ve
()

1740 
mf_log
 = 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

1741 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

1742 
¡¬t_d©e
=
subsütiÚ
.¡¬t_d©e, 
’d_d©e
=
dt
.
	`d©e
(2015, 01, 31),

1743 
cÚsumed_un™s
=
	`Decim®
('5.00')

1746 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-01-25'), 
¡dout
=
£lf
.
ouut
)

1748 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1750 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[0]

1751 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
	`Decim®
('0.00')

1752 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
(è=ğ4 #¶ª 
	`ŒŸl
 (+-è
¥l™
 
by
 
	$mÚths
 (*2)

1753 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	$®l
():

1754 
’Œy
.
¡¬t_d©e
 =ğ
subsütiÚ
.start_date:

1755 
as£¹
 
’Œy
.
’d_d©e
 =ğ
dt
.
	$d©e
(2015, 1, 31)

1756 
un™_´iû
 = 
	`Decim®
(7 / 31.0).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1758 
un™_´iû
 = 
	`Decim®
(8 / 28.0).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1759 
as£¹
 
’Œy
.
¡¬t_d©e
 =ğ
dt
.
	$d©e
(2015, 2, 1)

1760 
as£¹
 
’Œy
.
’d_d©e
 =ğ
subsütiÚ
.
ŒŸl_’d


1762 
’Œy
.
un™_´iû
 < 0: #discount

1763 
un™_´iû
 *= -1

1765 
as£¹
 
’Œy
.
quªt™y
 == 1

1766 
as£¹
 
’Œy
.
un™_´iû
 == unit_price

1767 
as£¹
 
’Œy
.
´Ü©ed


1769 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-02-01'), 
¡dout
=
£lf
.
ouut
)

1771 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1773 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-02-09'), 
¡dout
=
£lf
.
ouut
)

1774 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[1]

1776 
¶ª_amouÁ
 = 
	`Decim®
(20 / 28.0).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1777 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
(è=ğ3 #mf 
duršg
 
	`ŒŸl
 (+-è
ªd
 
»maššg
 
¶ª


1779 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	$®l
():

1780 
’Œy
.
´oduù_code
 =ğ
¶ª
.product_code:

1781 
as£¹
 
’Œy
.
quªt™y
 == 1

1782 
un™_´iû
 = 
¶ª_amouÁ


1784 
as£¹
 
’Œy
.
quªt™y
 =ğ
mf_log
.
cÚsumed_un™s


1785 
un™_´iû
 = 
m‘”ed_ã©u»
.
´iû_³r_un™


1787 
’Œy
.
un™_´iû
 < 0: #discount

1788 
un™_´iû
 *= -1

1790 
as£¹
 
’Œy
.
un™_´iû
 == unit_price

1791 
as£¹
 
’Œy
.
´Ü©ed


1792 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
¶ª_amouÁ


1794 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-02-10'), 
¡dout
=
£lf
.
ouut
)

1795 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

1797 
def
 
	$‹¡_subsütiÚ_w™h_docum’ts_g’”©iÚ_duršg_ªd_aá”_ŒŸl
(
£lf
):

1798 
£·¿‹_cyşes_duršg_ŒŸl
 = 
True


1799 
g’”©e_docum’ts_Ú_ŒŸl_’d
 = 
True


1801 
m‘”ed_ã©u»
 = 
	`M‘”edF—tu»FaùÜy
(

1802 
šşuded_un™s_duršg_ŒŸl
=
	`Decim®
('5.00'),

1803 
´iû_³r_un™
=
	`Decim®
('1.00')

1805 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

1806 
š‹rv®_couÁ
=1, 
g’”©e_aá”
=120,

1807 
’abËd
=
True
, 
ŒŸl_³riod_days
=15,

1808 
amouÁ
=
	`Decim®
('200.00'),

1809 
£·¿‹_cyşes_duršg_ŒŸl
=separate_cycles_during_trial,

1810 
g’”©e_docum’ts_Ú_ŒŸl_’d
=generate_documents_on_trial_end,

1811 
m‘”ed_ã©u»s
=[
m‘”ed_ã©u»
])

1813 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(
¶ª
õÏn, 
¡¬t_d©e
=
dt
.
	$d©e
(2015, 1, 25))

1814 
subsütiÚ
.
	$aùiv©e
()

1815 
subsütiÚ
.
	$§ve
()

1816 
subsütiÚ
.
cu¡om”
.
§Ës_x_³rûÁ
 = 
NÚe


1817 
subsütiÚ
.
cu¡om”
.
	$§ve
()

1819 
mf_log
 = 
M‘”edF—tu»Un™sLogFaùÜy
.
	`ü—‹
(

1820 
subsütiÚ
=subsütiÚ, 
m‘”ed_ã©u»
=metered_feature,

1821 
¡¬t_d©e
=
subsütiÚ
.¡¬t_d©e, 
’d_d©e
=
dt
.
	`d©e
(2015, 01, 31),

1822 
cÚsumed_un™s
=
	`Decim®
('5.00')

1825 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-01-25'), 
¡dout
=
£lf
.
ouut
)

1827 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1829 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[0]

1830 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
	`Decim®
('0.00')

1831 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
(è=ğ2 #¶ª 
ŒŸl
 
	`jªu¬y
 (+-)

1832 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	$®l
():

1833 
as£¹
 
’Œy
.
¡¬t_d©e
 =ğ
subsütiÚ
.start_date

1834 
as£¹
 
’Œy
.
’d_d©e
 =ğ
dt
.
	$d©e
(2015, 1, 31)

1835 
un™_´iû
 = 
	`Decim®
(7 / 31.0).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1837 
’Œy
.
un™_´iû
 < 0:

1838 
un™_´iû
 *= -1

1840 
as£¹
 
’Œy
.
quªt™y
 == 1

1841 
as£¹
 
’Œy
.
un™_´iû
 == unit_price

1842 
as£¹
 
’Œy
.
´Ü©ed


1844 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-02-01'), 
¡dout
=
£lf
.
ouut
)

1846 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 2

1848 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[1]

1849 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
	`Decim®
('0.00')

1851 #mf 
	`jªu¬y
 (+-)

1852 #¶ª 
ŒŸl
 
	`ãbru¬y
 (+-)

1853 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 4

1854 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	$®l
():

1855 
’Œy
.
´oduù_code
 =ğ
¶ª
.product_code:

1856 
as£¹
 
’Œy
.
quªt™y
 == 1

1857 
un™_´iû
 = 
	`Decim®
(8 / 28.0).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1859 
as£¹
 
’Œy
.
quªt™y
 =ğ
mf_log
.
cÚsumed_un™s


1860 
un™_´iû
 = 
m‘”ed_ã©u»
.
´iû_³r_un™


1862 
’Œy
.
un™_´iû
 < 0: #discount

1863 
un™_´iû
 *= -1

1865 
as£¹
 
’Œy
.
un™_´iû
 == unit_price

1866 
as£¹
 
’Œy
.
´Ü©ed


1868 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-02-09'), 
¡dout
=
£lf
.
ouut
)

1869 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 3

1871 
´ofÜma
 = 
ProfÜma
.
objeùs
.
	`®l
()[2]

1872 
¶ª_amouÁ
 = 
	`Decim®
(20 / 28.0).
	`quªtize
(Decim®('0.0000')è* 
¶ª
.
amouÁ


1873 
as£¹
 
´ofÜma
.
tÙ®
 =ğ
¶ª_amouÁ


1875 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
(è=ğ1 #»maššg 
	`¶ª
 (+)

1877 
’Œy
 
š
 
´ofÜma
.
´ofÜma_’Œ›s
.
	$®l
():

1878 
’Œy
.
´oduù_code
 =ğ
¶ª
.product_code:

1879 
as£¹
 
’Œy
.
quªt™y
 == 1

1880 
un™_´iû
 = 
¶ª_amouÁ


1882 
as£¹
 
’Œy
.
quªt™y
 =ğ
mf_log
.
cÚsumed_un™s


1883 
un™_´iû
 = 
m‘”ed_ã©u»
.
´iû_³r_un™


1885 
’Œy
.
un™_´iû
 < 0: #discount

1886 
un™_´iû
 *= -1

1888 
as£¹
 
’Œy
.
un™_´iû
 == unit_price

1889 
as£¹
 
’Œy
.
´Ü©ed


1891 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-02-10'), 
¡dout
=
£lf
.
ouut
)

1892 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 3

1894 
def
 
	$‹¡_subsütiÚ_cyşe_blšg_du¿tiÚ
(
£lf
):

1895 
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

1896 
š‹rv®_couÁ
=1, 
g’”©e_aá”
=120,

1897 
’abËd
=
True
, 
ŒŸl_³riod_days
=15,

1898 
amouÁ
=
	`Decim®
('200.00'),

1899 
cyşe_blšg_du¿tiÚ
=
dt
.
	$timed–
(
days
=5))

1901 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(
¶ª
õÏn, 
¡¬t_d©e
=
dt
.
	$d©e
(2015, 1, 25))

1902 
subsütiÚ
.
	$aùiv©e
()

1903 
subsütiÚ
.
	$§ve
()

1904 
subsütiÚ
.
cu¡om”
.
§Ës_x_³rûÁ
 = 
NÚe


1905 
subsütiÚ
.
cu¡om”
.
	$§ve
()

1907 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
	`g’”©e_docs_d©e
('2015-01-25'), 
¡dout
=
£lf
.
ouut
)

1909 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 0

1911 
blšg_d©e
 = 
dt
.
	$d©e
(2015, 2, 1)

1912 
	`ÿÎ_commªd
('g’”©e_docs', 
d©e
=
blšg_d©e
, 
¡dout
=
£lf
.
ouut
)

1914 
as£¹
 
ProfÜma
.
objeùs
.
	`®l
().
	`couÁ
() == 1

1916 
blšg_log
 = 
BlšgLog
.
objeùs
.
	`f‹r
(
subsütiÚ
=subsütiÚ).
	$Ï¡
()

1918 
as£¹
 
blšg_log
.
blšg_d©e
 == billing_date

	@silver/tests/commands/test_generate_docs_args.py

1 #Cİyrighˆ(
c
è2016 
Univ”s™y
 
of
 
OxfÜd


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
äom
 
decim®
 
impÜt
 
Decim®


18 
äom
 
	gdjªgo
.
	gcÜe
.
mªagem’t
 
impÜt
 
ÿÎ_commªd


19 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
Te¡Ca£


20 
äom
 
	gdjªgo
.
	guts
.
six
 
impÜt
 
SŒšgIO


21 
äom
 
mock
 
impÜt
 
	g·tch
, 
	gPrİ”tyMock
, 
MagicMock


22 
äom
 
	gªnoyšg
.
funùiÚs
 
impÜt
 
g‘_objeù_Ü_NÚe


24 
äom
 
	gsv”
.
mod–s
 
	$impÜt
 (
ProfÜma
, 
Docum’tEÁry
, 
Invoiû
, 
SubsütiÚ
,

25 
Cu¡om”
, 
PÏn
)

26 
äom
 
sv”
.
‹¡s
.
çùÜ›s
 
	$impÜt
 (
SubsütiÚFaùÜy
, 
PÏnFaùÜy
,

27 
M‘”edF—tu»FaùÜy
,

28 
M‘”edF—tu»Un™sLogFaùÜy
,

29 
Cu¡om”FaùÜy
, 
Provid”FaùÜy
)

30 
äom
 
sv”
.
mªagem’t
.
commªds
.
g’”©e_docs
 
impÜt
 
d©e
 
as
 
g’”©e_docs_d©e


33 
şass
 
	$Te¡G’”©eDocsArgum’ts
(
Te¡Ca£
):

36 
Quick
 
‹¡s
 
to
 
’su»
 
th©
 
g’”©e_docs
 
·r£s
 
ªy
 
¬gum’ts


37 
cÜ»ùly


39 
Te¡s
:

40 * 
·ss
 
š
 
nÙhšg


41 * 
·ss
 
š
 
d©e


42 * 
·ss
 
š
 
subsütiÚ
 
id


43 * 
·ss
 
š
 
d©e
 
ªd
 
subsütiÚ
 
id


45 
TODO
: 
add
 
missšg
 
‹¡
 
desütiÚs


48 
def
 
	$__š™__
(
£lf
, *
¬gs
, **
kw¬gs
):

49 
	`su³r
(
Te¡G’”©eDocsArgum’ts
, 
£lf
).
	$__š™__
(*
¬gs
, **
kw¬gs
)

50 
£lf
.
ouut
 = 
	$SŒšgIO
()

51 
£lf
.
good_ouut
 = 'Done. You can have‡ Club-Mate‚ow. :)\n'

52 
£lf
.
d©e_¡ršg
 = '2016-06-01'

53 
£lf
.
d©e
 = 
	$g’”©e_docs_d©e
(
£lf
.
d©e_¡ršg
)

55 
def
 
	$£tUp
(
£lf
):

56 #S‘u°
sim¶e
 
subsütiÚ


57 
£lf
.
¶ª
 = 
PÏnFaùÜy
.
	`ü—‹
(
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

58 
š‹rv®_couÁ
=1, 
g’”©e_aá”
=120,

59 
’abËd
=
True
, 
amouÁ
=
	`Decim®
('200.00'),

60 
ŒŸl_³riod_days
=0)

62 
£lf
.
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(
¶ª
=
£lf
.plan,

63 
¡¬t_d©e
=
£lf
.
d©e
)

64 
£lf
.
subsütiÚ
.
	$aùiv©e
()

65 
£lf
.
subsütiÚ
.
	$§ve
()

67 
def
 
	$‹¡_g’”©e_docs_no_¬gs
(
£lf
):

69 
	`ÿÎ_commªd
('g’”©e_docs', 
¡dout
=
£lf
.
ouut
)

71 
as£¹
 
£lf
.
ouut
.
	`g‘v®ue
(è=ğ£lf.
good_ouut


73 
def
 
	$‹¡_g’”©e_docs_subsütiÚ_¬g·r£r
(
£lf
):

75 
	`ÿÎ_commªd
(

76 'g’”©e_docs', '--subsütiÚ=%s' % 
£lf
.
subsütiÚ
.
id
,

77 
¡dout
=
£lf
.
ouut


80 
as£¹
 
£lf
.
ouut
.
	`g‘v®ue
(è=ğ£lf.
good_ouut


82 
def
 
	$‹¡_g’”©e_docs_subsütiÚ_İtiÚs
(
£lf
):

84 
	`ÿÎ_commªd
('g’”©e_docs', 
subsütiÚ
=
£lf
.subsütiÚ.
id
,

85 
¡dout
=
£lf
.
ouut
)

86 
as£¹
 
£lf
.
ouut
.
	`g‘v®ue
(è=ğ£lf.
good_ouut


88 
def
 
	$‹¡_g’”©e_docs_d©e_¬g·r£r
(
£lf
):

90 
	`ÿÎ_commªd
('g’”©e_docs', '--d©e=%s' % 
£lf
.
d©e_¡ršg
,

91 
¡dout
=
£lf
.
ouut
)

93 
as£¹
 
£lf
.
ouut
.
	`g‘v®ue
(è=ğ£lf.
good_ouut


95 
def
 
	$‹¡_g’”©e_docs_d©e_İtiÚs
(
£lf
):

97 
	`ÿÎ_commªd
('g’”©e_docs', 
blšg_d©e
=
£lf
.
d©e
,

98 
¡dout
=
£lf
.
ouut
)

100 
as£¹
 
£lf
.
ouut
.
	`g‘v®ue
(è=ğ£lf.
good_ouut


102 
def
 
	$‹¡_g’”©e_docs_d©e_sub_¬g·r£r
(
£lf
):

104 
	`ÿÎ_commªd
('generate_docs',

105 '--d©e=%s' % 
£lf
.
d©e_¡ršg
,

106 '--subsütiÚ=%s' % 
£lf
.
subsütiÚ
.
id
,

107 
¡dout
=
£lf
.
ouut
)

109 
as£¹
 
£lf
.
ouut
.
	`g‘v®ue
(è=ğ£lf.
good_ouut


111 
def
 
	$‹¡_g’”©e_docs_d©e_sub_İtiÚs
(
£lf
):

113 
	`ÿÎ_commªd
('generate_docs',

114 
blšg_d©e
=
£lf
.
d©e
,

115 
subsütiÚ
=
£lf
.subsütiÚ.
id
,

116 
¡dout
=
£lf
.
ouut
)

118 
as£¹
 
£lf
.
ouut
.
	`g‘v®ue
(è=ğ£lf.
good_ouut


	@silver/tests/commands/test_update_transactions_status.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
mock
 
impÜt
 
	gMagicMock
, 
	g·tch
, 
ÿÎ


17 
äom
 
	gdjªgo
.
	gcÜe
.
mªagem’t
 
impÜt
 
ÿÎ_commªd


18 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
	gTe¡Ca£
, 
ov”ride_£‰šgs


20 
äom
 
	gsv”
.
mod–s
 
impÜt
 
T¿n§ùiÚ


21 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
impÜt
 
	gT¿n§ùiÚFaùÜy
, 
Paym’tM‘hodFaùÜy


22 
äom
 
	gsv”
.
	g‹¡s
.
fixtu»s
 
impÜt
 (
Trigg”edProûssÜ
, 
PAYMENT_PROCESSORS
,

23 
Œigg”ed_´oûssÜ
)

26 @
	$ov”ride_£‰šgs
(
PAYMENT_PROCESSORS
=PAYMENT_PROCESSORS)

27 
şass
 
	$Te¡Upd©eT¿n§ùiÚsStusCommªd
(
Te¡Ca£
):

28 
def
 
	$‹¡_ãtch_Œª§ùiÚ_¡©us_ÿÎ
(
£lf
):

29 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

30 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ


33 
Œª§ùiÚs
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹_b©ch
(

34 5, 
·ym’t_m‘hod
õaym’t_m‘hod, 
¡©e
=
T¿n§ùiÚ
.
S‹s
.
P’dšg


37 
mock_ãtch_¡©us
 = 
	$MagicMock
()

38 
w™h
 
·tch
.
	$muÉË
(
Trigg”edProûssÜ
,

39 
ãtch_Œª§ùiÚ_¡©us
=
mock_ãtch_¡©us
):

40 
	`ÿÎ_commªd
('fetch_transactions_status')

42 
Œª§ùiÚ
 
š
 
Œª§ùiÚs
:

43 
£lf
.
	`as£¹In
(
	`ÿÎ
(
Œª§ùiÚ
),

44 
mock_ãtch_¡©us
.
ÿÎ_¬gs_li¡
)

46 
£lf
.
	`as£¹Equ®
(
mock_ãtch_¡©us
.
ÿÎ_couÁ
,

47 
	$Ën
(
Œª§ùiÚs
))

49 
def
 
	$‹¡_ãtch_Œª§ùiÚ_¡©us_Œª§ùiÚs_f‹ršg
(
£lf
):

50 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

51 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ


54 
Œª§ùiÚs
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹_b©ch
(

55 5, 
·ym’t_m‘hod
õaym’t_m‘hod, 
¡©e
=
T¿n§ùiÚ
.
S‹s
.
P’dšg


58 
f‹»d_Œª§ùiÚs
 = [

59 
Œª§ùiÚs
[0],ransactions[2],ransactions[4]

62 
mock_ãtch_¡©us
 = 
	$MagicMock
()

63 
w™h
 
·tch
.
	$muÉË
(
Trigg”edProûssÜ
,

64 
ãtch_Œª§ùiÚ_¡©us
=
mock_ãtch_¡©us
):

65 
Œª§ùiÚs_¬g
 = [

66 
	$¡r
(
Œª§ùiÚ
.
pk
èŒª§ùiÚ 
š
 
f‹»d_Œª§ùiÚs


68 
	`ÿÎ_commªd
('fetch_transactions_status',

69 '--Œª§ùiÚs=%s' % ','.
	$još
(
Œª§ùiÚs_¬g
))

71 
Œª§ùiÚ
 
š
 
f‹»d_Œª§ùiÚs
:

72 
£lf
.
	`as£¹In
(
	`ÿÎ
(
Œª§ùiÚ
),

73 
mock_ãtch_¡©us
.
ÿÎ_¬gs_li¡
)

75 
£lf
.
	`as£¹Equ®
(
mock_ãtch_¡©us
.
ÿÎ_couÁ
,

76 
	`Ën
(
f‹»d_Œª§ùiÚs
))

78 @
	`·tch
('silver.management.commands.fetch_transactions_status.logger.error')

79 
def
 
	$‹¡_Œª§ùiÚ_upd©e_¡©us_exû±iÚ_loggšg
(
£lf
, 
mock_logg”
):

80 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

81 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ


84 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
·ym’t_m‘hod
=payment_method,

85 
¡©e
=
T¿n§ùiÚ
.
S‹s
.
P’dšg
)

87 
mock_ãtch_¡©us
 = 
	$MagicMock
()

88 
mock_ãtch_¡©us
.
side_efãù
 = 
	`Exû±iÚ
('This happened.')

90 
w™h
 
·tch
.
	$muÉË
(
Trigg”edProûssÜ
,

91 
ãtch_Œª§ùiÚ_¡©us
=
mock_ãtch_¡©us
):

92 
	`ÿÎ_commªd
('fetch_transactions_status')

93 
ex³ùed_ÿÎ
 = 
	`ÿÎ
(

95 1, 
exc_šfo
=
True


98 
£lf
.
	`as£¹Equ®
(
ex³ùed_ÿÎ
, 
mock_logg”
.
ÿÎ_¬gs
)

	@silver/tests/factories.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


3 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

5 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

6 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


9 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


11 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

12 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

13 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


14 #lim™©iÚ 
und”
 
the
 
Liûn£
.

17 
impÜt
 
d©‘ime


18 
äom
 
decim®
 
impÜt
 
Decim®


20 
impÜt
 
çùÜy


21 
impÜt
 
	gçùÜy
.
fuzzy


22 
äom
 
çk”
 
impÜt
 
Fak”


24 
äom
 
	gdjªgo
.
	gcÚŒib
.
auth
 
impÜt
 
g‘_u£r_mod–


25 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


27 
äom
 
	gsv”
.
mod–s
 
	$impÜt
 (
Provid”
, 
PÏn
, 
M‘”edF—tu»
, 
Cu¡om”
,

28 
SubsütiÚ
, 
Invoiû
, 
ProduùCode
, 
PDF
,

29 
ProfÜma
, 
M‘”edF—tu»Un™sLog
, 
Docum’tEÁry
,

30 
T¿n§ùiÚ
, 
Paym’tM‘hod
)

31 
äom
 
sv”
.
‹¡s
.
fixtu»s
 
impÜt
 
mªu®_´oûssÜ


34 
çk”
 = 
	`Fak”
(
loÿË
='hu_HU')

37 
şass
 
	$ProduùCodeFaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

38 
şass
 
M‘a
:

39 
mod–
 = 
ProduùCode


41 
v®ue
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$—n8
())

44 
şass
 
	$Cu¡om”FaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

45 
şass
 
M‘a
:

46 
mod–
 = 
Cu¡om”


48 
fœ¡_Çme
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$fœ¡_Çme
())

49 
Ï¡_Çme
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$Ï¡_Çme
())

50 
com·ny
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$com·ny
())

51 
ema
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$com·ny_ema
())

52 
add»ss_1
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$add»ss
())

53 
add»ss_2
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$add»ss
())

54 
couÁry
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$couÁry_code
())

55 
c™y
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$c™y
())

56 
¡©e
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$c™y_·¹
())

57 
z_code
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$po¡code
())

58 
phÚe
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$phÚe_numb”
())

59 
exŒa
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$‹xt
())

60 
m‘a
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: {"som‘hšg": [n,‚ + 1]
	}
})

61 
cÚsŞid©ed_blšg
 = 
True


63 
cu¡om”_»ã»nû
 = 
çùÜy
.
Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$uuid4
())

64 
§Ës_x_³rûÁ
 = 
	$Decim®
(1.0)

65 
§Ës_x_Çme
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 'VAT')

66 
·ym’t_due_days
 = 5

69 
şass
 
	$M‘”edF—tu»FaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

70 
şass
 
M‘a
:

71 
mod–
 = 
M‘”edF—tu»


73 
Çme
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$£Á’û
(
nb_wÜds
=2))

74 
un™
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 'M‘”edF—tu»{út}Un™'.
	$fÜm©
(
út
=
n
))

75 
´iû_³r_un™
 = 
çùÜy
.
fuzzy
.
	$FuzzyDecim®
(
low
=0.01, 
high
=100.00,

76 
´ecisiÚ
=4)

77 
šşuded_un™s
 = 
çùÜy
.
fuzzy
.
	$FuzzyDecim®
(
low
=0.01, 
high
=100000.00,

78 
´ecisiÚ
=4)

79 
´oduù_code
 = 
çùÜy
.
	$SubFaùÜy
(
ProduùCodeFaùÜy
)

82 
şass
 
	$Provid”FaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

83 
şass
 
M‘a
:

84 
mod–
 = 
Provid”


86 
Çme
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$Çme
())

87 
com·ny
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$com·ny
())

88 
ema
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$com·ny_ema
())

89 
add»ss_1
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$add»ss
())

90 
add»ss_2
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$add»ss
())

91 
couÁry
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$couÁry_code
())

92 
c™y
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$c™y
())

93 
¡©e
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$c™y_·¹
())

94 
z_code
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$po¡code
())

95 
exŒa
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$‹xt
())

96 
m‘a
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: {"som‘hšg": [n,‚ + 1]
	}
})

98 
æow
 = 'proforma'

99 
švoiû_£r›s
 = 'InvoiceSeries'

100 
švoiû_¡¬tšg_numb”
 = 1

101 
´ofÜma_£r›s
 = 'ProformaSeries'

102 
´ofÜma_¡¬tšg_numb”
 = 1

105 
şass
 
	$PÏnFaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

106 
şass
 
M‘a
:

107 
mod–
 = 
PÏn


109 
Çme
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 
çk”
.
	$Çme
())

110 
š‹rv®
 = 
PÏn
.
INTERVALS
.
MONTH


111 
š‹rv®_couÁ
 = 
çùÜy
.
	$Sequ’û
(
Ïmbda
 
n
:‚)

112 
amouÁ
 = 
çùÜy
.
	$Sequ’û
(
Ïmbda
 
n
:‚)

113 
cu¼’cy
 = 'USD'

114 
g’”©e_aá”
 = 
çùÜy
.
	$Sequ’û
(
Ïmbda
 
n
:‚)

115 
’abËd
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
:‚ % 2 != 0)

116 
´iv©e
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
:‚ % 2 != 0)

117 
´oduù_code
 = 
çùÜy
.
	$SubFaùÜy
(
ProduùCodeFaùÜy
)

118 
´ovid”
 = 
çùÜy
.
	`SubFaùÜy
(
Provid”FaùÜy
)

120 @
çùÜy
.
po¡_g’”©iÚ


121 
def
 
	$m‘”ed_ã©u»s
(
£lf
, 
ü—‹
, 
exŒaùed
, **
kw¬gs
):

122 
nÙ
 
ü—‹
:

125 
exŒaùed
:

126 #A 
li¡
 
of
 
groups
 
w”e
 
·s£d
 
š
, 
u£
 
them


127 
m‘”ed_ã©u»
 
š
 
exŒaùed
:

128 
£lf
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

131 
şass
 
	$SubsütiÚFaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

132 
şass
 
M‘a
:

133 
mod–
 = 
SubsütiÚ


135 
¶ª
 = 
çùÜy
.
	$SubFaùÜy
(
PÏnFaùÜy
)

136 
cu¡om”
 = 
çùÜy
.
	$SubFaùÜy
(
Cu¡om”FaùÜy
)

137 
¡¬t_d©e
 = 
timezÚe
.
	`now
().
	$d©e
()

138 
ŒŸl_’d
 = 
çùÜy
.
	`LazyA‰ribu‹
(

139 
Ïmbda
 
obj
: obj.
¡¬t_d©e
 + 
d©‘ime
.
	`timed–
(
days
=obj.
¶ª
.
ŒŸl_³riod_days
 - 1)

140 
obj
.
¶ª
.
ŒŸl_³riod_days
 
NÚe
)

141 
»ã»nû
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: "{}".
	$fÜm©
(
n
))

142 
m‘a
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: {"som‘hšg": [n,‚ + 1]
	}
})

144 @
çùÜy
.
po¡_g’”©iÚ


145 
def
 
	$m‘”ed_ã©u»s
(
£lf
, 
ü—‹
, 
exŒaùed
, **
kw¬gs
):

146 
nÙ
 
ü—‹
:

149 
exŒaùed
:

150 #A 
li¡
 
of
 
groups
 
w”e
 
·s£d
 
š
, 
u£
 
them


151 
m‘”ed_ã©u»
 
š
 
exŒaùed
:

152 
£lf
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

155 
şass
 
	$M‘”edF—tu»Un™sLogFaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

156 
şass
 
M‘a
:

157 
mod–
 = 
M‘”edF—tu»Un™sLog


158 
m‘”ed_ã©u»
 = 
çùÜy
.
	$SubFaùÜy
(
M‘”edF—tu»FaùÜy
)

159 
subsütiÚ
 = 
çùÜy
.
	$SubFaùÜy
(
SubsütiÚFaùÜy
)

160 
cÚsumed_un™s
 = 
çùÜy
.
fuzzy
.
	$FuzzyDecim®
(
low
=0.01, 
high
=50000.00,

161 
´ecisiÚ
=4)

164 
şass
 
	$InvoiûFaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

165 
şass
 
M‘a
:

166 
mod–
 = 
Invoiû


168 
cu¡om”
 = 
çùÜy
.
	$SubFaùÜy
(
Cu¡om”FaùÜy
)

169 
´ovid”
 = 
çùÜy
.
	$SubFaùÜy
(
Provid”FaùÜy
)

170 
cu¼’cy
 = 'RON'

171 
Œª§ùiÚ_cu¼’cy
 = 'RON'

172 
Œª§ùiÚ_xe_¿‹
 = 
	$Decim®
(1)

173 
¡©e
 = 
Invoiû
.
STATES
.
DRAFT


174 
issue_d©e
 = 
çùÜy
.
	`LazyA‰ribu‹
(

175 
Ïmbda
 
švoiû
: (
çk”
.
	`·¡_d©‘ime
(
¡¬t_d©e
="-200d", 
tzšfo
=
NÚe
)

176 
švoiû
.
¡©e
 !ğ
Invoiû
.
STATES
.
DRAFT
 
NÚe
)

178 
·id_d©e
 = 
çùÜy
.
	`LazyA‰ribu‹
(

179 
Ïmbda
 
švoiû
: 
timezÚe
.
	`now
().
	$d©e
(è
švoiû
.
¡©e
 =ğ
Invoiû
.
STATES
.
PAID
 
NÚe


181 
ÿnûl_d©e
 = 
çùÜy
.
	`LazyA‰ribu‹
(

182 
Ïmbda
 
švoiû
: 
timezÚe
.
	`now
().
	$d©e
(è
švoiû
.
¡©e
 =ğ
Invoiû
.
STATES
.
CANCELED
 
NÚe


185 @
çùÜy
.
po¡_g’”©iÚ


186 
def
 
	$švoiû_’Œ›s
(
£lf
, 
ü—‹
, 
exŒaùed
, **
kw¬gs
):

187 
nÙ
 
ü—‹
:

190 
exŒaùed
:

191 #A 
li¡
 
of
 
groups
 
w”e
 
·s£d
 
š
, 
u£
 
them


192 
švoiû_’Œy
 
š
 
exŒaùed
:

193 
£lf
.
švoiû_’Œ›s
.
	$add
(
švoiû_’Œy
)

195 
£lf
.
¡©e
 != 'draft':

196 
£lf
.
_tÙ®
 = s–f.
	$compu‹_tÙ®
()

197 
£lf
.
_tÙ®_š_Œª§ùiÚ_cu¼’cy
 = s–f.
	$compu‹_tÙ®_š_Œª§ùiÚ_cu¼’cy
()

198 
£lf
.
	$§ve
()

201 
şass
 
	$ProfÜmaFaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

202 
şass
 
M‘a
:

203 
mod–
 = 
ProfÜma


205 
cu¡om”
 = 
çùÜy
.
	$SubFaùÜy
(
Cu¡om”FaùÜy
)

206 
´ovid”
 = 
çùÜy
.
	$SubFaùÜy
(
Provid”FaùÜy
)

207 
cu¼’cy
 = 'RON'

208 
Œª§ùiÚ_cu¼’cy
 = 'RON'

209 
Œª§ùiÚ_xe_¿‹
 = 
	$Decim®
(1)

210 
¡©e
 = 
ProfÜma
.
STATES
.
DRAFT


211 
issue_d©e
 = 
çùÜy
.
	`LazyA‰ribu‹
(

212 
Ïmbda
 
´ofÜma
: (
çk”
.
	`·¡_d©‘ime
(
¡¬t_d©e
="-200d", 
tzšfo
=
NÚe
)

213 
´ofÜma
.
¡©e
 !ğ
Invoiû
.
STATES
.
DRAFT
 
NÚe
)

215 
·id_d©e
 = 
çùÜy
.
	`LazyA‰ribu‹
(

216 
Ïmbda
 
´ofÜma
: 
timezÚe
.
	`now
().
	$d©e
(è
´ofÜma
.
¡©e
 =ğ
Invoiû
.
STATES
.
PAID
 
NÚe


218 
ÿnûl_d©e
 = 
çùÜy
.
	`LazyA‰ribu‹
(

219 
Ïmbda
 
´ofÜma
: (
timezÚe
.
	`now
().
	$d©e
()

220 
´ofÜma
.
¡©e
 =ğ
Invoiû
.
STATES
.
CANCELED
 
NÚe
)

223 @
çùÜy
.
po¡_g’”©iÚ


224 
def
 
	$subsütiÚs
(
£lf
, 
ü—‹
, 
exŒaùed
, **
kw¬gs
):

225 
nÙ
 
ü—‹
:

228 
exŒaùed
:

229 
subsütiÚ
 
š
 
exŒaùed
:

230 
£lf
.
subsütiÚs
.
	`add
(
subsütiÚ
)

232 @
çùÜy
.
po¡_g’”©iÚ


233 
def
 
	$´ofÜma_’Œ›s
(
£lf
, 
ü—‹
, 
exŒaùed
, **
kw¬gs
):

234 
nÙ
 
ü—‹
:

237 
exŒaùed
:

238 #A 
li¡
 
of
 
groups
 
w”e
 
·s£d
 
š
, 
u£
 
them


239 
´ofÜma_’Œy
 
š
 
exŒaùed
:

240 
£lf
.
´ofÜma_’Œ›s
.
	$add
(
´ofÜma_’Œy
)

242 
£lf
.
¡©e
 !ğ
ProfÜma
.
STATES
.
DRAFT
:

243 
£lf
.
_tÙ®
 = s–f.
	$compu‹_tÙ®
()

244 
£lf
.
_tÙ®_š_Œª§ùiÚ_cu¼’cy
 = s–f.
	$compu‹_tÙ®_š_Œª§ùiÚ_cu¼’cy
()

245 
£lf
.
	$§ve
()

248 
şass
 
	$Docum’tEÁryFaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

249 
şass
 
M‘a
:

250 
mod–
 = 
Docum’tEÁry


252 
desütiÚ
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 'DesütiÚ{út}'.
	$fÜm©
(
út
=
n
))

253 
un™
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
: 'Un™{út}'.
	$fÜm©
(
út
=
n
))

254 
quªt™y
 = 
çùÜy
.
fuzzy
.
	$FuzzyDecim®
(
low
=1.00, 
high
=50000.00, 
´ecisiÚ
=4)

255 
un™_´iû
 = 
çùÜy
.
fuzzy
.
	$FuzzyDecim®
(
low
=0.01, 
high
=100.00, 
´ecisiÚ
=4)

256 
´oduù_code
 = 
çùÜy
.
	$SubFaùÜy
(
ProduùCodeFaùÜy
)

257 
’d_d©e
 = 
çùÜy
.
	`Sequ’û
(

258 
Ïmbda
 
n
: 
d©‘ime
.
d©e
.
	`today
(è+ d©‘ime.
	$timed–
(
days
=
n
))

259 
¡¬t_d©e
 = 
d©‘ime
.
d©e
.
	$today
()

260 
´Ü©ed
 = 
çùÜy
.
	`Sequ’û
(
Ïmbda
 
n
:‚ % 2 == 1)

263 
şass
 
	$AdmšU£rFaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

264 
şass
 
M‘a
:

265 
mod–
 = 
	$g‘_u£r_mod–
()

267 
u£ºame
 = 'admin'

268 
ema
 = 'admin@admin.com'

269 
·sswÜd
 = 
çùÜy
.
	`Po¡G’”©iÚM‘hodC®l
('set_password', 'admin')

270 
is_aùive
 = 
True


271 
is_su³ru£r
 = 
True


272 
is_¡aff
 = 
True


275 
şass
 
	$Paym’tM‘hodFaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

276 
şass
 
M‘a
:

277 
mod–
 = 
Paym’tM‘hod


279 
·ym’t_´oûssÜ
 = 
mªu®_´oûssÜ


280 
cu¡om”
 = 
çùÜy
.
	$SubFaùÜy
(
Cu¡om”FaùÜy
)

283 
şass
 
	$T¿n§ùiÚFaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

284 
şass
 
M‘a
:

285 
mod–
 = 
T¿n§ùiÚ


287 
·ym’t_m‘hod
 = 
çùÜy
.
	$SubFaùÜy
(
Paym’tM‘hodFaùÜy
)

288 
´ofÜma
 = 
çùÜy
.
	`SubFaùÜy
(

289 
ProfÜmaFaùÜy
,

290 
cu¡om”
=
çùÜy
.
	`S–fA‰ribu‹
('..payment_method.customer'),

291 
¡©e
=
ProfÜma
.
STATES
.
ISSUED
,

292 
issue_d©e
=
timezÚe
.
	`now
().
	`d©e
(),

293 
Œª§ùiÚ_xe_¿‹
=
	`Decim®
('1')

295 
švoiû
 = 
çùÜy
.
	`SubFaùÜy
(

296 
InvoiûFaùÜy
,

297 
cu¡om”
=
çùÜy
.
	`S–fA‰ribu‹
('..payment_method.customer'),

298 
¡©e
=
Invoiû
.
STATES
.
ISSUED
,

299 
issue_d©e
=
timezÚe
.
	`now
().
	`d©e
(),

300 
Œª§ùiÚ_xe_¿‹
=
	`Decim®
('1')

303 
¡©e
 = 
T¿n§ùiÚ
.
S‹s
.
In™Ÿl


305 @
şassm‘hod


306 
def
 
	$_ü—‹
(
şs
, 
mod–_şass
, *
¬gs
, **
kw¬gs
):

307 
švoiû
 = 
kw¬gs
.
	`g‘
('invoice')

308 
´ofÜma
 = 
kw¬gs
.
	`g‘
('proforma')

309 
´ofÜma
:

310 
´ofÜma
.
»Ï‹d_docum’t
 = 
švoiû


311 
švoiû
:

312 
´ofÜma
.
Œª§ùiÚ_cu¼’cy
 = 
švoiû
.transaction_currency

313 
´ofÜma
.
	$§ve
()

315 
švoiû
:

316 
švoiû
.
»Ï‹d_docum’t
 = 
´ofÜma


317 
´ofÜma
:

318 
švoiû
.
Œª§ùiÚ_cu¼’cy
 = 
´ofÜma
.transaction_currency

319 
švoiû
.
	$§ve
()

321  
	`su³r
(
T¿n§ùiÚFaùÜy
, 
şs
).
	$_ü—‹
(
mod–_şass
, *
¬gs
, **
kw¬gs
)

324 
şass
 
	$PDFFaùÜy
(
çùÜy
.
djªgo
.
DjªgoMod–FaùÜy
):

325 
şass
 
M‘a
:

326 
mod–
 = 
PDF


	@silver/tests/fixtures.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
	gsv”
.
·ym’t_´oûssÜs
 
impÜt
 
Paym’tProûssÜBa£


16 
äom
 
	gsv”
.
	g·ym’t_´oûssÜs
.
mixšs
 
	$impÜt
 (
Trigg”edProûssÜMixš
,

17 
Mªu®ProûssÜMixš
)

18 
äom
 
sv”
.
·ym’t_´oûssÜs
.
v›ws
 
impÜt
 
G’”icT¿n§ùiÚV›w


20 
Œigg”ed_´oûssÜ
 = 'triggered'

21 
mªu®_´oûssÜ
 = 'manual'

22 
çšg_void_´oûssÜ
 = 'failing_void'

24 
PAYMENT_PROCESSORS
 = {

25 
Œigg”ed_´oûssÜ
: {

28 
mªu®_´oûssÜ
: {

31 
çšg_void_´oûssÜ
: {

35 
	}
}

38 
def
 
	$nÙ_im¶em’‹d_v›w
(*
¬gs
):

39 
¿i£
 
NÙIm¶em’‹dE¼Ü


42 
şass
 
	$Mªu®ProûssÜ
(
Paym’tProûssÜBa£
, 
Mªu®ProûssÜMixš
):

43 
Œª§ùiÚ_v›w_şass
 = 
G’”icT¿n§ùiÚV›w


46 
şass
 
	$Trigg”edProûssÜ
(
Paym’tProûssÜBa£
, 
Trigg”edProûssÜMixš
):

47 
Œª§ùiÚ_v›w_şass
 = 
G’”icT¿n§ùiÚV›w


49 
def
 
	$ãtch_Œª§ùiÚ_¡©us
(
£lf
, 
Œª§ùiÚ
):

50 
·ss


52 
def
 
	$execu‹_Œª§ùiÚ
(
£lf
, 
Œª§ùiÚ
):

53 
·ss


55 
def
 
	$void_Œª§ùiÚ
(
£lf
, 
Œª§ùiÚ
):

56 
Œª§ùiÚ
.
	$ÿnûl
()

57  
True


59 @
´İ”ty


60 
def
 
	$®lowed_cu¼’c›s
(
£lf
):

64 
şass
 
	$FašgVoidTrigg”edProûssÜ
(
Trigg”edProûssÜ
):

65 
def
 
	$void_Œª§ùiÚ
(
£lf
, 
Œª§ùiÚ
):

66  
F®£


	@silver/tests/integration/__init__.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

	@silver/tests/integration/test_documents_transactions.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

14 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
V®id©iÚE¼Ü


15 
äom
 
mock
 
impÜt
 
	gMagicMock
, 
·tch


17 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
	gTe¡Ca£
, 
ov”ride_£‰šgs


18 
äom
 
	gsv”
.
mod–s
 
impÜt
 
T¿n§ùiÚ


19 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
InvoiûFaùÜy
, 
Paym’tM‘hodFaùÜy
,

20 
T¿n§ùiÚFaùÜy
, 
ProfÜmaFaùÜy
, 
Docum’tEÁryFaùÜy
)

21 
äom
 
sv”
.
‹¡s
.
fixtu»s
 
	`impÜt
 (
Trigg”edProûssÜ
, 
PAYMENT_PROCESSORS
,

22 
Œigg”ed_´oûssÜ
)

25 @
	$ov”ride_£‰šgs
(
PAYMENT_PROCESSORS
=PAYMENT_PROCESSORS)

26 
şass
 
	$Te¡Docum’tsT¿n§ùiÚs
(
Te¡Ca£
):

27 
def
 
	$‹¡_·y_docum’ts_Ú_Œª§ùiÚ_£‰Ë
(
£lf
):

28 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(

29 
¡©e
=
T¿n§ùiÚ
.
S‹s
.
P’dšg


31 
Œª§ùiÚ
.
	$£‰Ë
()

32 
Œª§ùiÚ
.
	$§ve
()

34 
´ofÜma
 = 
Œª§ùiÚ
.proforma

35 
švoiû
 = 
Œª§ùiÚ
.invoice

37 
£lf
.
	$as£¹Equ®
(
´ofÜma
.
¡©e
,…rofÜma.
STATES
.
PAID
)

38 
£lf
.
	$as£¹Equ®
(
švoiû
.
¡©e
, invoiû.
STATES
.
PAID
)

40 #®sØ
»fundšg
 
Ãeds
 
to
 
be
 
‹¡ed
 
wh’
 
im¶em’‹d


42 
def
 
	$‹¡_Œª§ùiÚ_ü—tiÚ_fÜ_issued_docum’ts
(
£lf
):

44 
The
 
h­py
 .

46 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

47 
cu¡om”
 = 
švoiû
.customer

49 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

50 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
, 
cu¡om”
=customer,

51 
ÿnûËd
=
F®£
,

52 
v”if›d
=
True
,

55 
švoiû
.
	$issue
()

57 
Œª§ùiÚs
 = 
T¿n§ùiÚ
.
objeùs
.
	$f‹r
(

58 
švoiû
=švoiû, 
´ofÜma
=švoiû.
»Ï‹d_docum’t


60 
£lf
.
	`as£¹Equ®
(
	`Ën
(
Œª§ùiÚs
), 1)

62 
def
 
	$‹¡_no_Œª§ùiÚ_ü—tiÚ_fÜ_issued_docum’ts_ÿ£_1
(
£lf
):

64 
The
 
·ym’t
 
m‘hod
 
is
 
nÙ
 
»cu¼šg


66 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

67 
cu¡om”
 = 
švoiû
.customer

68 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

69 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
, 
cu¡om”
=customer,

70 
ÿnûËd
=
F®£
,

71 
v”if›d
=
F®£


74 
mock_execu‹
 = 
	$MagicMock
()

75 
w™h
 
·tch
.
	$muÉË
(
Trigg”edProûssÜ
, 
execu‹_Œª§ùiÚ
=
mock_execu‹
):

76 
švoiû
.
	$issue
()

78 
Œª§ùiÚs
 = 
T¿n§ùiÚ
.
objeùs
.
	$f‹r
(

79 
švoiû
=švoiû, 
´ofÜma
=švoiû.
»Ï‹d_docum’t


81 
£lf
.
	`as£¹Equ®
(
	`Ën
(
Œª§ùiÚs
), 0)

83 
def
 
	$‹¡_no_Œª§ùiÚ_ü—tiÚ_fÜ_issued_docum’ts_ÿ£2
(
£lf
):

85 
The
 
·ym’t
 
m‘hod
 
is
 
nÙ
 
u§bË


87 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

88 
cu¡om”
 = 
švoiû
.customer

89 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

90 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
, 
cu¡om”
=customer,

91 
ÿnûËd
=
F®£


94 
mock_execu‹
 = 
	$MagicMock
()

95 
w™h
 
·tch
.
	$muÉË
(
Trigg”edProûssÜ
, 
execu‹_Œª§ùiÚ
=
mock_execu‹
):

96 
švoiû
.
	$issue
()

98 
Œª§ùiÚs
 = 
T¿n§ùiÚ
.
objeùs
.
	$f‹r
(

99 
švoiû
=švoiû, 
´ofÜma
=švoiû.
»Ï‹d_docum’t


101 
£lf
.
	`as£¹Equ®
(
	`Ën
(
Œª§ùiÚs
), 0)

103 
def
 
	$‹¡_no_Œª§ùiÚ_ü—tiÚ_fÜ_issued_docum’ts_ÿ£3
(
£lf
):

105 
Th”e
 
¬e
 1 
³ndšg
 
ªd
 1 
£‰Ëd
 
Œª§ùiÚs
 
th©
 
tog‘h”
 
cov”
 
the
 
docum’t
 
amouÁ
.

107 
’Œy
 = 
	$Docum’tEÁryFaùÜy
(
quªt™y
=1, 
un™_´iû
=100)

108 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
švoiû_’Œ›s
=[
’Œy
])

109 
švoiû
.
	$issue
()

111 
cu¡om”
 = 
švoiû
.customer

112 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

113 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
, 
cu¡om”
=customer,

114 
ÿnûËd
=
F®£
,

115 
v”if›d
=
F®£
,

118 
T¿n§ùiÚFaùÜy
.
	`ü—‹
(
švoiû
=invoice,

119 
·ym’t_m‘hod
=payment_method,

120 
amouÁ
=
švoiû
.
tÙ®_š_Œª§ùiÚ_cu¼’cy
 / 2,

121 
¡©e
=
T¿n§ùiÚ
.
S‹s
.
S‘ed
)

123 
T¿n§ùiÚFaùÜy
.
	`ü—‹
(
švoiû
=invoice,

124 
·ym’t_m‘hod
=payment_method,

125 
amouÁ
=
švoiû
.
tÙ®_š_Œª§ùiÚ_cu¼’cy
 / 2,

126 
¡©e
=
T¿n§ùiÚ
.
S‹s
.
P’dšg
)

128 
mock_execu‹
 = 
	$MagicMock
()

129 
w™h
 
·tch
.
	$muÉË
(
Trigg”edProûssÜ
, 
execu‹_Œª§ùiÚ
=
mock_execu‹
):

130 
ex³ùed_exû±iÚ
 = 
V®id©iÚE¼Ü


131 
ex³ùed_mes§ge
 = "{'__all__': [u'Amount is greaterhanhe‡mounthat should be " \

133 
Œy
:

134 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
švoiû
=invoice,

135 
·ym’t_m‘hod
=payment_method,

136 
amouÁ
=1)

138 
£lf
.
	`ç
('{}‚Ù„ai£d.'.
	`fÜm©
(
	$¡r
(
ex³ùed_exû±iÚ
)))

139 
exû±
 
ex³ùed_exû±iÚ
 
as
 
e
:

140 
£lf
.
	`as£¹Equ®
(
	`¡r
(
e
), 
ex³ùed_mes§ge
)

142 
Œª§ùiÚs
 = 
T¿n§ùiÚ
.
objeùs
.
	$f‹r
(

143 
·ym’t_m‘hod
õaym’t_m‘hod, 
švoiû
=invoice,

145 
£lf
.
	`as£¹Equ®
(
	`Ën
(
Œª§ùiÚs
), 2)

147 
£lf
.
	$as£¹Equ®
(
mock_execu‹
.
ÿÎ_couÁ
, 0)

149 
def
 
	$‹¡_no_Œª§ùiÚ_ü—tiÚ_©_švoiû_ü—tiÚ_äom_´ofÜma
(
£lf
):

150 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
»Ï‹d_docum’t
=
NÚe
)

152 
cu¡om”
 = 
´ofÜma
.customer

153 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

154 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
, 
cu¡om”
=customer,

155 
ÿnûËd
=
F®£
,

156 
v”if›d
=
True
,

159 
´ofÜma
.
	$issue
()

161 
£lf
.
	`as£¹Equ®
(
	`Ën
(
T¿n§ùiÚ
.
objeùs
.
	`f‹r
(
´ofÜma
=proforma)),

164 
švoiû
 = 
´ofÜma
.
	$ü—‹_švoiû
()

166 
£lf
.
	`as£¹Equ®
(
	`Ën
(
T¿n§ùiÚ
.
objeùs
.
	`f‹r
(
´ofÜma
=proforma)), 1)

168 
Œª§ùiÚ
 = 
T¿n§ùiÚ
.
objeùs
.
	`f‹r
(
´ofÜma
=proforma)[0]

169 
£lf
.
	$as£¹Equ®
(
Œª§ùiÚ
.
švoiû
, invoice)

171 
def
 
	$‹¡_no_Œª§ùiÚ_ü—tiÚ_©_´ofÜma_·y
(
£lf
):

172 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
»Ï‹d_docum’t
=
NÚe
)

174 
cu¡om”
 = 
´ofÜma
.customer

175 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

176 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
, 
cu¡om”
=customer,

177 
ÿnûËd
=
F®£
,

178 
v”if›d
=
True
,

181 
´ofÜma
.
	$issue
()

182 
´ofÜma
.
	$·y
()

184 
švoiû
 = 
´ofÜma
.
»Ï‹d_docum’t


186 
£lf
.
	`as£¹Equ®
(
	`Ën
(
T¿n§ùiÚ
.
objeùs
.
	`f‹r
(
´ofÜma
=proforma)), 1)

188 
Œª§ùiÚ
 = 
T¿n§ùiÚ
.
objeùs
.
	`f‹r
(
´ofÜma
=proforma)[0]

189 
£lf
.
	$as£¹Equ®
(
Œª§ùiÚ
.
švoiû
, invoice)

191 
def
 
	$‹¡_no_Œª§ùiÚ_£‰Ë_w™h_Úly_»Ï‹d_´ofÜma
(
£lf
):

192 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
»Ï‹d_docum’t
=
NÚe
)

194 
cu¡om”
 = 
´ofÜma
.customer

195 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

196 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
, 
cu¡om”
=customer,

197 
ÿnûËd
=
F®£
,

198 
v”if›d
=
True
,

201 
´ofÜma
.
	$issue
()

203 
Œª§ùiÚ
 = 
´ofÜma
.
Œª§ùiÚs
[0]

204 #h”
Œª§ùiÚ
.
´ofÜma
 
is
 
the
 
§me
 
objeù
 
as
h´ofÜm¨
äom
he

205 #DB 
due
 
to
 
the
 
way
 
Œªs™iÚ
 
ÿÎbacks
 
ªd
 
§ves
 
¬e
 
ÿÎed


207 
Œª§ùiÚ
.
	$£‰Ë
()

208 
Œª§ùiÚ
.
	$§ve
()

210 
£lf
.
	$as£¹Equ®
(
´ofÜma
.
¡©e
,…rofÜma.
STATES
.
PAID
)

212 
švoiû
 = 
´ofÜma
.
»Ï‹d_docum’t


213 
£lf
.
	$as£¹Equ®
(
švoiû
.
¡©e
, invoiû.
STATES
.
PAID
)

215 
£lf
.
	`as£¹Equ®
(
	`li¡
(
´ofÜma
.
Œª§ùiÚs
),

216 
	$li¡
(
švoiû
.
Œª§ùiÚs
))

218 
£lf
.
	`as£¹Equ®
(
	`Ën
(
´ofÜma
.
Œª§ùiÚs
), 1)

220 
def
 
	$‹¡_Œª§ùiÚ_švoiû_Ú_Œª§ùiÚ_£‰Ë
(
£lf
):

221 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(

222 
¡©e
=
T¿n§ùiÚ
.
S‹s
.
P’dšg
,

223 
švoiû
=
NÚe


226 #h”
Œª§ùiÚ
.
´ofÜma
 
is
 
ª
 
Şd
 
v”siÚ
 
of
 
™£lf


227 #th
aùu®
 
´ofÜma
 
th©
 
is
 
§ved
 
š
 
db
 
has
 
a
 
»Ï‹d
 
švoiû


228 #sØ
a
 
»äesh_äom_db
 
is
 
Ãeded


229 #‹¡_no_Œª§ùiÚ_£‰Ë_w™h_Úly_»Ï‹d_´ofÜm¨
would
 
be
 
’ough


230 #ià
the
 
Œªs™iÚ
 
ÿÎbacks
 
would
 
be
 
hªdËd
 
š
 
po¡_§ve


232 
Œª§ùiÚ
.
	$£‰Ë
()

233 
Œª§ùiÚ
.
	$§ve
()

235 
Œª§ùiÚ
.
	$»äesh_äom_db
()

237 
´ofÜma
 = 
Œª§ùiÚ
.proforma

238 
švoiû
 = 
Œª§ùiÚ
.invoice

240 
£lf
.
	`as£¹Equ®
(
´ofÜma
.
»Ï‹d_docum’t
, 
švoiû
)

	@silver/tests/integration/test_transactions_payment_methods.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

14 
äom
 
decim®
 
impÜt
 
Decim®


16 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
V®id©iÚE¼Ü


17 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
	gTe¡Ca£
, 
ov”ride_£‰šgs


18 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


19 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gInvoiû
, 
ProfÜma


21 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
Paym’tM‘hodFaùÜy
, 
InvoiûFaùÜy
,

22 
ProfÜmaFaùÜy
, 
T¿n§ùiÚFaùÜy
,

23 
Cu¡om”FaùÜy
)

24 
äom
 
sv”
.
‹¡s
.
fixtu»s
 
	`impÜt
 (
PAYMENT_PROCESSORS
, 
Œigg”ed_´oûssÜ
)

27 @
	$ov”ride_£‰šgs
(
PAYMENT_PROCESSORS
=PAYMENT_PROCESSORS)

28 
şass
 
	$Te¡Docum’tsT¿n§ùiÚs
(
Te¡Ca£
):

29 
def
 
	$‹¡_ü—‹_Œª§ùiÚ_w™h_nÙ_®lowed_cu¼’cy
(
£lf
):

30 
švoiû
 = 
InvoiûFaùÜy
.
	`ü—‹
(
Œª§ùiÚ_cu¼’cy
='EUR',

31 
Œª§ùiÚ_xe_¿‹
=
	`Decim®
('1.0'),

32 
¡©e
=
Invoiû
.
STATES
.
ISSUED
)

33 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

34 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
,

35 
cu¡om”
=
švoiû
.customer,

36 
ÿnûËd
=
F®£
,

37 
v”if›d
=
F®£


40 
ex³ùed_exû±iÚ
 = 
V®id©iÚE¼Ü


41 
ex³ùed_mes§ge
 = '{\'__all__\': [u"Currency EUR is‚ot‡llowed by ' \

45 
Œy
:

46 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
·ym’t_m‘hod
=payment_method,

47 
švoiû
=invoice)

48 
£lf
.
	`ç
('{}‚Ù„ai£d.'.
	`fÜm©
(
	$¡r
(
ex³ùed_exû±iÚ
)))

49 
exû±
 
ex³ùed_exû±iÚ
 
as
 
e
:

50 
£lf
.
	`as£¹Equ®
(
ex³ùed_mes§ge
, 
	$¡r
(
e
))

52 
def
 
	$‹¡_ü—‹_Œª§ùiÚs_Ú_v”if›d_·ym’t_m‘hod_ü—tiÚ
(
£lf
):

53 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

55 
lÚe_švoiû
 = 
InvoiûFaùÜy
.
	`ü—‹
(

56 
Œª§ùiÚ_cu¼’cy
='USD',

57 
Œª§ùiÚ_xe_¿‹
=
	`Decim®
('1.0'),

58 
¡©e
=
Invoiû
.
STATES
.
ISSUED
,

59 
cu¡om”
=customer

62 
lÚe_´ofÜma
 = 
ProfÜmaFaùÜy
.
	`ü—‹
(

63 
Œª§ùiÚ_cu¼’cy
='USD',

64 
Œª§ùiÚ_xe_¿‹
=
	`Decim®
('1.0'),

65 
¡©e
=
ProfÜma
.
STATES
.
ISSUED
,

66 
cu¡om”
=customer

69 
·œed_´ofÜma
 = 
ProfÜmaFaùÜy
.
	`ü—‹
(

70 
Œª§ùiÚ_cu¼’cy
='USD',

71 
Œª§ùiÚ_xe_¿‹
=
	`Decim®
('1.0'),

72 
¡©e
=
ProfÜma
.
STATES
.
ISSUED
,

73 
issue_d©e
=
timezÚe
.
	`now
().
	`d©e
(),

74 
cu¡om”
=customer

76 
·œed_švoiû
 = 
·œed_´ofÜma
.
	$ü—‹_švoiû
()

78 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

79 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
,

80 
cu¡om”
=customer,

81 
ÿnûËd
=
F®£
,

82 
v”if›d
=
True


85 
£lf
.
	`as£¹Equ®
(
lÚe_švoiû
.
Œª§ùiÚs
.
	`couÁ
(), 1)

87 
£lf
.
	`as£¹Equ®
(
lÚe_´ofÜma
.
Œª§ùiÚs
.
	`couÁ
(), 1)

89 
£lf
.
	`as£¹Equ®
(
	`li¡
(
·œed_švoiû
.
Œª§ùiÚs
),

90 
	$li¡
(
·œed_´ofÜma
.
Œª§ùiÚs
))

92 
£lf
.
	`as£¹Equ®
(
·œed_švoiû
.
Œª§ùiÚs
.
	`couÁ
(), 1)

94 
def
 
	$‹¡_ü—‹_Œª§ùiÚs_Ú_·ym’t_m‘hod_v”ify
(
£lf
):

95 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

97 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

98 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
,

99 
cu¡om”
=customer,

100 
ÿnûËd
=
F®£
,

101 
v”if›d
=
F®£


104 
lÚe_švoiû
 = 
InvoiûFaùÜy
.
	`ü—‹
(

105 
Œª§ùiÚ_cu¼’cy
='USD',

106 
Œª§ùiÚ_xe_¿‹
=
	`Decim®
('1.0'),

107 
¡©e
=
Invoiû
.
STATES
.
ISSUED
,

108 
cu¡om”
=customer

111 
lÚe_´ofÜma
 = 
ProfÜmaFaùÜy
.
	`ü—‹
(

112 
Œª§ùiÚ_cu¼’cy
='USD',

113 
Œª§ùiÚ_xe_¿‹
=
	`Decim®
('1.0'),

114 
¡©e
=
ProfÜma
.
STATES
.
ISSUED
,

115 
cu¡om”
=customer

118 
·œed_´ofÜma
 = 
ProfÜmaFaùÜy
.
	`ü—‹
(

119 
Œª§ùiÚ_cu¼’cy
='USD',

120 
Œª§ùiÚ_xe_¿‹
=
	`Decim®
('1.0'),

121 
¡©e
=
ProfÜma
.
STATES
.
ISSUED
,

122 
issue_d©e
=
timezÚe
.
	`now
().
	`d©e
(),

123 
cu¡om”
=customer

125 
·œed_švoiû
 = 
·œed_´ofÜma
.
	$ü—‹_švoiû
()

127 
£lf
.
	`as£¹Equ®
(
·ym’t_m‘hod
.
Œª§ùiÚs
.
	`couÁ
(), 0)

129 
·ym’t_m‘hod
.
v”if›d
 = 
True


130 
·ym’t_m‘hod
.
	$§ve
()

132 
£lf
.
	`as£¹Equ®
(
lÚe_švoiû
.
Œª§ùiÚs
.
	`couÁ
(), 1)

134 
£lf
.
	`as£¹Equ®
(
lÚe_´ofÜma
.
Œª§ùiÚs
.
	`couÁ
(), 1)

136 
£lf
.
	`as£¹Equ®
(
	`li¡
(
·œed_švoiû
.
Œª§ùiÚs
),

137 
	$li¡
(
·œed_´ofÜma
.
Œª§ùiÚs
))

139 
£lf
.
	`as£¹Equ®
(
·œed_švoiû
.
Œª§ùiÚs
.
	`couÁ
(), 1)

	@silver/tests/spec/__init__.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

	@silver/tests/spec/test_customer.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
jsÚ


17 
impÜt
 
py‹¡


19 
äom
 
»¡_äamewÜk
 
impÜt
 
¡©us


20 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

21 
äom
 
	g»¡_äamewÜk
.
‹¡
 
impÜt
 
APITe¡Ca£


23 
äom
 
	gsv”
.
mod–s
 
impÜt
 
Cu¡om”


24 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
impÜt
 
	gAdmšU£rFaùÜy
, 
Cu¡om”FaùÜy


25 
äom
 
	gsv”
.
	g‹¡s
.
uts
 
impÜt
 
bud_absŞu‹_‹¡_u¾


28 
şass
 
	$Te¡Cu¡om”Endpošts
(
APITe¡Ca£
):

29 
def
 
	$£tUp
(
£lf
):

30 
admš_u£r
 = 
AdmšU£rFaùÜy
.
	$ü—‹
()

31 
£lf
.
ş›Á
.
	$fÜû_auth’tiÿ‹
(
u£r
=
admš_u£r
)

32 
£lf
.
com¶‘e_d©a
 = {

51 "cÚsŞid©ed_blšg": 
F®£
,

53 "·ym’t_m‘hods": 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('payment-method-list',

54 
kw¬gs
={'customer_pk': 1})),

55 "Œª§ùiÚs": 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('transaction-list',

56 
kw¬gs
={'customer_pk': 1}))

57 
	}
}

59 
def
 
	$‹¡_ü—‹_po¡_cu¡om”
(
£lf
):

60 
u¾
 = 
	`»v”£
('customer-list')

62 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`po¡
(
u¾
, 
jsÚ
.
	`dumps
(£lf.
com¶‘e_d©a
),

63 
cÚ‹Á_ty³
='application/json')

64 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_201_CREATED
)

66 
def
 
	$‹¡_ü—‹_po¡_cu¡om”_w™hout_»quœed_f›ld
(
£lf
):

67 
u¾
 = 
	`»v”£
('customer-list')

69 
»quœed_f›lds
 = ['first_name', 'last_name', 'address_1', 'city',

72 
f›ld
 
š
 
»quœed_f›lds
:

73 
‹mp_d©a
 = 
£lf
.
com¶‘e_d©a
.
	$cİy
()

74 
Œy
:

75 
‹mp_d©a
.
	$pİ
(
f›ld
)

76 
exû±
 
KeyE¼Ü
:

77 
py‹¡
.
	`xç
('Customer„equired field %s‚ot…rovided inhe'

78 'com¶‘‹¡ d©a.' % 
f›ld
)

80 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`po¡
(
u¾
, 
jsÚ
.
	`dumps
(
‹mp_d©a
),

81 
cÚ‹Á_ty³
='application/json')

83 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

84 
	`as£¹
 (
»¥Ú£
.
d©a
 =ğ{
f›ld
: ['Thi f›ld may‚Ù bbÏnk.']
	}
} 
Ü


85 
»¥Ú£
.
d©a
 =ğ{
f›ld
: ['This field is„equired.']})

87 
def
 
	$‹¡_g‘_cu¡om”_li¡
(
£lf
):

88 
Cu¡om”FaùÜy
.
	$ü—‹_b©ch
(40)

90 
u¾
 = 
	`»v”£
('customer-list')

92 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

94 
fuÎ_u¾
 = 
NÚe


95 
f›ld
 
š
 
»¥Ú£
.
d©a
:

96 
fuÎ_u¾
 = 
f›ld
.
	`g‘
('u¾', 
NÚe
)

97 
fuÎ_u¾
:

99 
fuÎ_u¾
:

100 
domaš
 = 
fuÎ_u¾
.
	`¥l™
('/')[2]

101 
fuÎ_u¾
 = fuÎ_u¾.
	`¥l™
(
domaš
)[0] + domaš + 
u¾


103 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


104 
as£¹
 
»¥Ú£
.
_h—d”s
['link'] == \

105 ('Lšk', '<' + 
fuÎ_u¾
 + '?page=2>;„el="next", ' +

106 '<' + 
fuÎ_u¾
 + '?page=1>;„el="first", ' +

107 '<' + 
fuÎ_u¾
 + '?page=2>„el="last"')

109 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾
 + '?page=2')

111 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


112 
as£¹
 
»¥Ú£
.
_h—d”s
['link'] == \

113 ('Lšk', '<' + 
fuÎ_u¾
 + '>;„el="prev", ' +

114 '<' + 
fuÎ_u¾
 + '?page=1>;„el="first", ' +

115 '<' + 
fuÎ_u¾
 + '?page=2>„el="last"')

117 
def
 
	$‹¡_g‘_cu¡om”_d‘a
(
£lf
):

118 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

120 
u¾
 = 
	`»v”£
('customer-detail',

121 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
})

123 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

125 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

126 
£lf
.
	$as£¹NÙEqu®
(
»¥Ú£
.
d©a
, [])

127 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['phÚe'], 
cu¡om”
.
phÚe
)

129 
def
 
	$‹¡_g‘_cu¡om”_d‘a_uÃxi¡šg
(
£lf
):

130 
u¾
 = 
	`»v”£
('customer-detail',

131 
kw¬gs
={'cu¡om”_pk': 42
	}
})

133 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

135 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_404_NOT_FOUND
)

136 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {
u
'd‘a': u'NÙ found.'
	}
})

138 
def
 
	$‹¡_d–‘e_cu¡om”
(
£lf
):

139 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

141 
u¾
 = 
	`»v”£
('cu¡om”-d‘a', 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
})

142 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$d–‘e
(
u¾
)

144 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_204_NO_CONTENT


145 
as£¹
 
Cu¡om”
.
objeùs
.
	`®l
().
	`couÁ
() == 0

147 
def
 
	$‹¡_d–‘e_uÃxi¡šg_cu¡om”
(
£lf
):

148 
u¾
 = 
	`»v”£
('cu¡om”-d‘a', 
kw¬gs
={'cu¡om”_pk': 42
	}
})

149 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$d–‘e
(
u¾
)

151 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_404_NOT_FOUND


153 
def
 
	$‹¡_ed™_put_cu¡om”
(
£lf
):

154 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

156 
chªged_d©a
 = 
£lf
.
com¶‘e_d©a
.
	$cİy
()

158 
unchªged_f›lds
 = ['email', 'address_2']

159 
ignÜe_f›lds
 = ['url', 'id', 'subscriptions', 'payment_methods',

161 
f›ld
 
š
 
unchªged_f›lds
:

162 
chªged_d©a
.
	$pİ
(
f›ld
)

164 
u¾
 = 
	`»v”£
('cu¡om”-d‘a', 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
})

166 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(
chªged_d©a
),

167 
cÚ‹Á_ty³
='application/json')

169 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

171 
e
 
š
 
ignÜe_f›lds
:

172 
»¥Ú£
.
d©a
.
	$pİ
(
e
)

173 
f›ld
 
š
 
»¥Ú£
.
d©a
:

174 
f›ld
 
nÙ
 
š
 
unchªged_f›lds
:

175 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
[
f›ld
],

176 
£lf
.
com¶‘e_d©a
[
f›ld
])

178 
def
 
	$‹¡_ed™_·tch_cu¡om”
(
£lf
):

179 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

181 
chªged_d©a
 = 
£lf
.
com¶‘e_d©a
.
	$cİy
()

182 
unchªged_f›lds
 = ['email', 'zip_code', 'company', 'phone',

184 
ignÜe_f›lds
 = ['url', 'id', 'subscriptions', 'payment_methods',

186 
f›ld
 
š
 
unchªged_f›lds
:

187 
chªged_d©a
.
	$pİ
(
f›ld
)

189 
u¾
 = 
	`»v”£
('cu¡om”-d‘a', 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
})

191 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
d©a
=
jsÚ
.
dumps
(
chªged_d©a
),

192 
cÚ‹Á_ty³
='application/json')

194 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

196 
e
 
š
 
ignÜe_f›lds
:

197 
»¥Ú£
.
d©a
.
	$pİ
(
e
)

198 
f›ld
 
š
 
»¥Ú£
.
d©a
:

199 
f›ld
 
nÙ
 
š
 
unchªged_f›lds
:

200 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
[
f›ld
],

201 
£lf
.
com¶‘e_d©a
[
f›ld
])

	@silver/tests/spec/test_documents.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
impÜt
 
jsÚ


17 
äom
 
mock
 
impÜt
 
·tch


18 
äom
 
ä“zegun
 
impÜt
 
ä“ze_time


20 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
ov”ride_£‰šgs


22 
äom
 
»¡_äamewÜk
 
impÜt
 
¡©us


23 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

24 
äom
 
	g»¡_äamewÜk
.
‹¡
 
impÜt
 
APITe¡Ca£


26 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
ProfÜmaFaùÜy
, 
AdmšU£rFaùÜy
,

27 
InvoiûFaùÜy
, 
T¿n§ùiÚFaùÜy
,

28 
Paym’tM‘hodFaùÜy
, 
Docum’tEÁryFaùÜy
)

29 
äom
 
sv”
.
‹¡s
.
fixtu»s
 
impÜt
 
PAYMENT_PROCESSORS


30 
äom
 
sv”
.
‹¡s
.
uts
 
impÜt
 
bud_absŞu‹_‹¡_u¾


32 
FREEZED_TIME
 = '2017-01-24T12:46:07Z'

35 @
	`ov”ride_£‰šgs
(
PAYMENT_PROCESSORS
=PAYMENT_PROCESSORS)

36 @
	$ä“ze_time
(
FREEZED_TIME
)

37 
şass
 
	$Te¡Docum’tEndpošts
(
APITe¡Ca£
):

38 
def
 
	$£tUp
(
£lf
):

39 
admš_u£r
 = 
AdmšU£rFaùÜy
.
	$ü—‹
()

40 
£lf
.
ş›Á
.
	$fÜû_auth’tiÿ‹
(
u£r
=
admš_u£r
)

42 
def
 
	$_g‘_ex³ùed_d©a
(
£lf
, 
docum’t
, 
Œª§ùiÚs
=
NÚe
):

43 
kšd
 = 
	`unicode
(
docum’t
.kšd.
	$low”
())

44 
Œª§ùiÚs
 = [{

45 
u
'id': u'%s' % 
Œª§ùiÚ
.
uuid
,

46 
u
'u¾': 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('transaction-detail',

47 [
Œª§ùiÚ
.
cu¡om”
.
pk
,¿n§ùiÚ.
uuid
])),

48 
u
'cu¡om”': 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('customer-detail',

49 [
Œª§ùiÚ
.
cu¡om”
.
id
])),

50 
u
'´ovid”': 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('provider-detail',

51 [
Œª§ùiÚ
.
´ovid”
.
id
])),

52 
u
'švoiû': 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('invoice-detail',

53 [
Œª§ùiÚ
.
švoiû
.
id
])),

54 
u
'´ofÜma': 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('proforma-detail',

55 [
Œª§ùiÚ
.
´ofÜma
.
id
])),

56 
u
'·ym’t_´oûssÜ': 
Œª§ùiÚ
.
·ym’t_´oûssÜ
,

57 
u
'»fund_code': 
Œª§ùiÚ
.
»fund_code
,

58 
u
'ç_code': 
Œª§ùiÚ
.
ç_code
,

59 
u
'ÿnûl_code': 
Œª§ùiÚ
.
ÿnûl_code
,

60 
u
'ÿn_be_cÚsumed': 
Œª§ùiÚ
.
ÿn_be_cÚsumed
,

61 
u
'ü—‹d_©': 
FREEZED_TIME
,

62 
u
'¡©e': 
Œª§ùiÚ
.
¡©e
,

63 
u
'v®id_uÁ': 
Œª§ùiÚ
.
v®id_uÁ
,

64 
u
'upd©ed_©': 
FREEZED_TIME
,

65 
u
'cu¼’cy': u'%s' % 
Œª§ùiÚ
.
cu¼’cy
,

66 
u
'amouÁ': u'%.2f' % 
Œª§ùiÚ
.
amouÁ
,

67 
u
'·ym’t_m‘hod': 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('payment-method-detail',

68 [
Œª§ùiÚ
.
cu¡om”
.
pk
,

69 
Œª§ùiÚ
.
·ym’t_m‘hod
.
pk
])),

70 
u
'·y_u¾': 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('payment', ['token']))

71 
	}
} 
Œª§ùiÚ
 
š
 
Œª§ùiÚs
 
Ü
 []]

74 
u
'id': 
docum’t
.
pk
,

75 
u
'u¾': 
bud_absŞu‹_‹¡_u¾
(
»v”£
(
kšd
 + '-d‘a', [
docum’t
.
pk
])),

76 
u
'kšd': 
kšd
,

77 
u
'£r›s': 
docum’t
.
£r›s
,

78 
u
'numb”': 
docum’t
.
numb”
,

79 
u
'´ovid”': 
bud_absŞu‹_‹¡_u¾
(
»v”£
('provider-detail',

80 [
docum’t
.
´ovid”
.
id
])),

81 
u
'cu¡om”': 
bud_absŞu‹_‹¡_u¾
(
»v”£
('customer-detail',

82 [
docum’t
.
cu¡om”
.
id
])),

83 
u
'due_d©e': 
unicode
(
docum’t
.
due_d©e
èdocum’t.due_d©
NÚe
,

84 
u
'issue_d©e': 
unicode
(
docum’t
.
issue_d©e
èdocum’t.issue_d©
NÚe
,

85 
u
'·id_d©e': 
docum’t
.
·id_d©e
,

86 
u
'ÿnûl_d©e': 
docum’t
.
ÿnûl_d©e
,

87 
u
'§Ës_x_Çme': 
docum’t
.
§Ës_x_Çme
,

88 
u
'§Ës_x_³rûÁ': u'%.2f' % 
docum’t
.
§Ës_x_³rûÁ
,

89 
u
'cu¼’cy': 
docum’t
.
cu¼’cy
,

90 
u
'Œª§ùiÚ_cu¼’cy': 
docum’t
.
Œª§ùiÚ_cu¼’cy
,

91 
u
'¡©e': 
docum’t
.
¡©e
,

92 
u
'tÙ®': 
docum’t
.
tÙ®
,

93 
u
'pdf_u¾': 
bud_absŞu‹_‹¡_u¾
(
docum’t
.
pdf
.
u¾
èià(docum’t.pdà
ªd


94 
docum’t
.
pdf
.
u¾
è
NÚe
,

95 
u
'Œª§ùiÚs': 
Œª§ùiÚs
,

96 
u
'tÙ®_š_Œª§ùiÚ_cu¼’cy': 
docum’t
.
tÙ®_š_Œª§ùiÚ_cu¼’cy


99 
def
 
	$_jwt_tok’
(
£lf
, *
¬gs
, **
kw¬gs
):

102 
def
 
	$‹¡_docum’ts_li¡_ÿ£_1
(
£lf
):

104 
OÃ
 
´ofÜma
, 
Úe
 
švoiû
, 
w™hout
 
»Ï‹d
 
docum’ts


106 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

107 
švoiû_’Œ›s
 = 
Docum’tEÁryFaùÜy
.
	$ü—‹_b©ch
(3)

108 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
švoiû_’Œ›s
=invoice_entries)

109 
švoiû
.
	$issue
()

110 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
cu¡om”
=
švoiû
.customer)

111 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
·ym’t_m‘hod
=payment_method,

112 
švoiû
=invoice)

114 
u¾
 = 
	`»v”£
('document-list')

116 
w™h
 
	`·tch
('silver.utils.payments._get_jwt_token',

117 
Ãw
=
£lf
.
_jwt_tok’
):

118 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

120 #^ 
th”e
' ¨bug wh”¥ecifyšg fÜm©='
jsÚ
' dÛ¢'
t
 
wÜk


121 
»¥Ú£_d©a
 = 
»¥Ú£
.
d©a


123 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

124 
£lf
.
	`as£¹Equ®
(
	`Ën
(
»¥Ú£_d©a
), 2)

126 
£lf
.
	`as£¹In
(£lf.
	`_g‘_ex³ùed_d©a
(
švoiû
, [
Œª§ùiÚ
]),

127 
»¥Ú£_d©a
)

129 
£lf
.
	`as£¹In
(£lf.
	`_g‘_ex³ùed_d©a
(
´ofÜma
), 
»¥Ú£_d©a
)

131 
def
 
	$‹¡_docum’ts_li¡_ÿ£_2
(
£lf
):

133 
OÃ
 
´ofÜma
 
w™h
 
a
 
»Ï‹d
 
švoiû
, 
Úe
 invoice

135 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

136 
švoiû1
 = 
InvoiûFaùÜy
.
	$ü—‹
(
»Ï‹d_docum’t
=
´ofÜma
)

137 
´ofÜma
.
»Ï‹d_docum’t
 = 
švoiû1


138 
´ofÜma
.
	$§ve
()

140 
švoiû2
 = 
InvoiûFaùÜy
.
	$ü—‹
()

142 
u¾
 = 
	`»v”£
('document-list')

143 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

145 #^ 
th”e
' ¨bug wh”¥ecifyšg fÜm©='
jsÚ
' dÛ¢'
t
 
wÜk


146 
»¥Ú£_d©a
 = 
jsÚ
.
	`lßds
(jsÚ.
	$dumps
(
»¥Ú£
.
d©a
))

148 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

149 
£lf
.
	`as£¹Equ®
(
	`Ën
(
»¥Ú£_d©a
), 2)

151 
£lf
.
	`as£¹In
(£lf.
	`_g‘_ex³ùed_d©a
(
švoiû1
), 
»¥Ú£_d©a
)

153 
£lf
.
	`as£¹In
(£lf.
	`_g‘_ex³ùed_d©a
(
švoiû2
), 
»¥Ú£_d©a
)

	@silver/tests/spec/test_invoice.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
jsÚ


17 
äom
 
d©‘ime
 
impÜt
 
timed–


18 
äom
 
decim®
 
impÜt
 
Decim®


20 
äom
 
	gªnoyšg
.
funùiÚs
 
impÜt
 
g‘_objeù_Ü_NÚe


21 
äom
 
	gçùÜy
.
djªgo
 
impÜt
 
mu‹_sigÇls


22 
äom
 
mock
 
impÜt
 
·tch


23 
äom
 
»¡_äamewÜk
 
impÜt
 
¡©us


24 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

25 
äom
 
	g»¡_äamewÜk
.
‹¡
 
impÜt
 
APITe¡Ca£


27 
äom
 
	gdjªgo
.
	gdb
.
	gmod–s
.
sigÇls
 
impÜt
 
´e_§ve


28 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


29 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


31 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gInvoiû
, 
T¿n§ùiÚ


32 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
AdmšU£rFaùÜy
, 
Cu¡om”FaùÜy
,

33 
Provid”FaùÜy
, 
InvoiûFaùÜy
,

34 
SubsütiÚFaùÜy
, 
T¿n§ùiÚFaùÜy
,

35 
Paym’tM‘hodFaùÜy
)

36 
äom
 
sv”
.
‹¡s
.
uts
 
impÜt
 
bud_absŞu‹_‹¡_u¾


38 
PAYMENT_DUE_DAYS
 = 
	`g‘©Œ
(
£‰šgs
, 'SILVER_DEFAULT_DUE_DAYS', 5)

41 
şass
 
	$Te¡InvoiûEndpošts
(
APITe¡Ca£
):

42 
def
 
	$£tUp
(
£lf
):

43 
admš_u£r
 = 
AdmšU£rFaùÜy
.
	$ü—‹
()

44 
£lf
.
ş›Á
.
	$fÜû_auth’tiÿ‹
(
u£r
=
admš_u£r
)

46 
def
 
	$‹¡_po¡_švoiû_w™hout_švoiû_’Œ›s
(
£lf
):

47 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

48 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

49 
SubsütiÚFaùÜy
.
	$ü—‹
()

51 
u¾
 = 
	`»v”£
('invoice-list')

52 
´ovid”_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('´ovid”-d‘a', [
´ovid”
.
pk
]))

53 
cu¡om”_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('cu¡om”-d‘a', [
cu¡om”
.
pk
]))

55 
d©a
 = {

56 '´ovid”': 
´ovid”_u¾
,

57 'cu¡om”': 
cu¡om”_u¾
,

62 
	}
}

64 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$po¡
(
u¾
, 
d©a
=data)

65 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_201_CREATED
)

67 
švoiû
 = 
	`g‘_objeù_Ü_NÚe
(
Invoiû
, 
id
=
»¥Ú£
.
d©a
["id"])

68 
£lf
.
	$as£¹True
(
švoiû
)

70 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {

71 "id": 
»¥Ú£
.
d©a
["id"],

72 "£r›s": 
švoiû
.
£r›s
,

73 "numb”": 
švoiû
.
numb”
,

74 "´ovid”": 
´ovid”_u¾
,

75 "cu¡om”": 
cu¡om”_u¾
,

78 "due_d©e": 
NÚe
,

79 "issue_d©e": 
NÚe
,

80 "·id_d©e": 
NÚe
,

81 "ÿnûl_d©e": 
NÚe
,

82 "§Ës_x_Çme": 
švoiû
.
§Ës_x_Çme
,

83 "§Ës_x_³rûÁ": 
	`¡r
(
švoiû
.
§Ës_x_³rûÁ
),

85 "Œª§ùiÚ_cu¼’cy": 
švoiû
.
Œª§ùiÚ_cu¼’cy
,

86 "Œª§ùiÚ_xe_¿‹": 
NÚe
,

87 "Œª§ùiÚ_xe_d©e": 
švoiû
.
Œª§ùiÚ_xe_d©e
,

88 "¡©e": 
švoiû
.
¡©e
,

89 "´ofÜma": 
NÚe
,

91 "pdf_u¾": 
NÚe
,

92 "tÙ®": 
švoiû
.
tÙ®
,

93 "tÙ®_š_Œª§ùiÚ_cu¼’cy": 
švoiû
.
tÙ®
,

95 
	}
})

97 
def
 
	$‹¡_po¡_švoiû_w™h_švoiû_’Œ›s
(
£lf
):

98 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

99 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

100 
SubsütiÚFaùÜy
.
	$ü—‹
()

102 
u¾
 = 
	`»v”£
('invoice-list')

103 
´ovid”_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('´ovid”-d‘a', [
´ovid”
.
pk
]))

104 
cu¡om”_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('cu¡om”-d‘a', [
cu¡om”
.
pk
]))

106 
d©a
 = {

107 '´ovid”': 
´ovid”_u¾
,

108 'cu¡om”': 
cu¡om”_u¾
,

109 '£r›s': 
NÚe
,

110 'numb”': 
NÚe
,

117 
	}
}

119 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

120 
cÚ‹Á_ty³
='application/json')

122 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_201_CREATED
)

123 #TODO: 
Check
 
the
 
body
 
of
h
»¥Ú£
. 
Th”e
 
w”e
 
some
 
´obËms


124 #»Ï‹d 
to
 
the
 
švoiû_’Œ›s
 
li¡
.

126 
def
 
	$‹¡_g‘_švoiûs
(
£lf
):

127 
b©ch_size
 = 50

128 
InvoiûFaùÜy
.
	$ü—‹_b©ch
(
b©ch_size
)

130 
u¾
 = 
	`»v”£
('invoice-list')

131 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

133 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

135 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾
 + '?page=2')

137 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

139 @
	`·tch
('silver.api.serializers.common.settings')

140 
def
 
	$‹¡_g‘_švoiû
(
£lf
, 
mocked_£‰šgs
):

141 
InvoiûFaùÜy
.
	$»£t_£qu’û
(1)

142 
T¿n§ùiÚFaùÜy
.
	$»£t_£qu’û
(1)

144 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

145 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
cu¡om”
=cu¡om”, 
¡©e
=
Invoiû
.
STATES
.
ISSUED
)

147 
švoiû
.
	$g’”©e_pdf
()

149 
w™h
 
	$mu‹_sigÇls
(
´e_§ve
):

150 
Œª§ùiÚs
 = [

151 
T¿n§ùiÚFaùÜy
.
	`ü—‹
(

152 
¡©e
=¡©e, 
švoiû
=invoice,

153 
·ym’t_m‘hod
=
	$Paym’tM‘hodFaùÜy
(
cu¡om”
=customer)

155 
¡©e
 
š
 
T¿n§ùiÚ
.
S‹s
.
	$as_li¡
()

156 
¡©e
 
nÙ
 
š
 [
T¿n§ùiÚ
.
S‹s
.
CªûËd
,

157 
T¿n§ùiÚ
.
S‹s
.
Refunded
,

158 
T¿n§ùiÚ
.
S‹s
.
Faed
]

161 
ex³ùed_Œª§ùiÚs
 = [{

162 "id": 
	`¡r
(
Œª§ùiÚ
.
uuid
),

163 "u¾": 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('transaction-detail',

164 [
Œª§ùiÚ
.
cu¡om”
.
pk
,¿n§ùiÚ.
uuid
])),

165 "cu¡om”": 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('customer-detail',

166 [
Œª§ùiÚ
.
cu¡om”
.
id
])),

167 "´ovid”": 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('provider-detail',

168 [
Œª§ùiÚ
.
´ovid”
.
id
])),

169 "amouÁ": "%s.00" % 
	`¡r
(
Œª§ùiÚ
.
amouÁ
),

171 "¡©e": 
Œª§ùiÚ
.
¡©e
,

172 "´ofÜma": 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('proforma-detail',

173 [
Œª§ùiÚ
.
´ofÜma
.
id
])),

174 "švoiû": 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('invoice-detail',

175 [
Œª§ùiÚ
.
švoiû
.
id
])),

176 "ÿn_be_cÚsumed": 
Œª§ùiÚ
.
ÿn_be_cÚsumed
,

177 "·ym’t_´oûssÜ": 
Œª§ùiÚ
.
·ym’t_´oûssÜ
,

178 "·ym’t_m‘hod": 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('payment-method-detail',

179 [
Œª§ùiÚ
.
cu¡om”
.
pk
,

180 
Œª§ùiÚ
.
·ym’t_m‘hod
.
pk
])),

181 "·y_u¾": (
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('payment', ['token']))

182 
Œª§ùiÚ
.
¡©e
 =ğ
T¿n§ùiÚ
.
S‹s
.
In™Ÿl
 
NÚe
),

183 
	}
} 
Œª§ùiÚ
 
š
 
	gŒª§ùiÚs
]

185 
w™h
 
·tch
('sv”.uts.·ym’ts._g‘_jwt_tok’'è
as
 
	gmocked_tok’
:

186 
mocked_tok’
.
»tuº_v®ue
 = 'token'

187 
u¾
 = 
»v”£
('švoiû-d‘a', 
kw¬gs
={'pk': 
švoiû
.
pk
})

189 
show_pdf_¡Üage_u¾
, 
pdf_u¾
 
	gš
 [

190 (
True
, "h‰p://‹¡£rv”%s" % 
švoiû
.
pdf
.
u¾
),

191 (
F®£
, "h‰p://‹¡£rv”/pdfs/%s/" % 
švoiû
.
pk
)]:

192 
mocked_£‰šgs
.
SILVER_SHOW_PDF_STORAGE_URL
 = 
show_pdf_¡Üage_u¾


194 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

196 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

197 
ex³ùed_»¥Ú£
 = {

198 "id": 
švoiû
.
pk
,

201 "´ovid”": 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('provider-detail',

202 [
švoiû
.
´ovid”
.
pk
])),

203 "cu¡om”": 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('customer-detail',

204 [
švoiû
.
cu¡om”
.
pk
])),

207 "due_d©e": 
NÚe
,

208 "issue_d©e": 
švoiû
.
issue_d©e
.
	`¡ráime
('%Y-%m-%d'),

209 "·id_d©e": 
NÚe
,

210 "ÿnûl_d©e": 
NÚe
,

214 "Œª§ùiÚ_cu¼’cy": 
švoiû
.
Œª§ùiÚ_cu¼’cy
,

215 "Œª§ùiÚ_xe_¿‹": ("%.4f" % 
švoiû
.
Œª§ùiÚ_xe_¿‹


216 
švoiû
.
Œª§ùiÚ_xe_¿‹
 
NÚe
),

217 "Œª§ùiÚ_xe_d©e": 
švoiû
.
Œª§ùiÚ_xe_d©e
,

219 "´ofÜma": 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('proforma-detail',

220 [
švoiû
.
»Ï‹d_docum’t
.
pk
])),

222 "pdf_u¾": 
pdf_u¾
,

224 
	}
}

225 
f›ld
 
š
 
ex³ùed_»¥Ú£
:

226 
£lf
.
as£¹Equ®
(
ex³ùed_»¥Ú£
[
f›ld
], 
»¥Ú£
.
d©a
[field],

227 
msg
=("Expected %s,‡ctual %s for field %s" % (

228 
ex³ùed_»¥Ú£
[
f›ld
], 
»¥Ú£
.
d©a
[field],

229 
f›ld
)))

231 
	g£lf
.
as£¹Equ®
(
Ën
(
»¥Ú£
.
d©a
["transactions"]),

232 
	$Ën
(
ex³ùed_Œª§ùiÚs
))

234 
aùu®_Œª§ùiÚ
 
š
 
»¥Ú£
.
d©a
["transactions"]:

235 
ex³ùed_Œª§ùiÚ
 = [

236 
Œª§ùiÚ
 Œª§ùiÚ 
š
 
ex³ùed_Œª§ùiÚs
 

237 
Œª§ùiÚ
["id"] =ğ
aùu®_Œª§ùiÚ
["id"]

239 
£lf
.
	$as£¹True
(
ex³ùed_Œª§ùiÚ
)

240 
ex³ùed_Œª§ùiÚ
 =ƒxpected_transaction[0]

242 
£lf
.
	`as£¹Equ®
(

243 
ex³ùed_Œª§ùiÚ
[
f›ld
], 
aùu®_Œª§ùiÚ
[field],

244 
msg
=("Expected %s,‡ctual %s for field %s" % (

245 
ex³ùed_»¥Ú£
[
f›ld
], 
»¥Ú£
.
d©a
[field], field)

249 
def
 
	$‹¡_d–‘e_švoiû
(
£lf
):

250 
u¾
 = 
	`»v”£
('švoiû-d‘a', 
kw¬gs
={'pk': 1
	}
})

252 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$d–‘e
(
u¾
)

253 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_405_METHOD_NOT_ALLOWED
)

254 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {"d‘a": 'M‘hod "DELETE"‚Ù‡Îowed.'
	}
})

256 
def
 
	$‹¡_add_sšgË_švoiû_’Œy
(
£lf
):

257 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

259 
u¾
 = 
	`»v”£
('švoiû-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 
švoiû
.
pk
})

260 
’Œy_d©a
 = {

265 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
=
jsÚ
.
dumps
(
’Œy_d©a
),

266 
cÚ‹Á_ty³
='application/json')

268 
švoiû
 = 
Invoiû
.
objeùs
.
®l
()[0]

269 
tÙ®
 = 
Decim®
(200.0è* Decim®(1 + 
švoiû
.
§Ës_x_³rûÁ
 / 100)

271 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_201_CREATED
)

272 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {

274 'un™': 
NÚe
,

277 '¡¬t_d©e': 
NÚe
,

278 '’d_d©e': 
NÚe
,

279 '´Ü©ed': 
F®£
,

280 '´oduù_code': 
NÚe
,

281 'tÙ®': 
tÙ®
,

282 'tÙ®_befÜe_x': 
	`Decim®
(200.0)

283 
	}
})

285 
u¾
 = 
»v”£
('švoiû-d‘a', 
kw¬gs
={'pk': 
švoiû
.
pk
})

286 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

288 
švoiû_’Œ›s
 = 
»¥Ú£
.
d©a
.
	`g‘
('švoiû_’Œ›s', 
NÚe
)

289 
£lf
.
	`as£¹Equ®
(
	`Ën
(
švoiû_’Œ›s
), 1)

290 
£lf
.
	`as£¹Equ®
(
švoiû_’Œ›s
[0], {

292 'un™': 
NÚe
,

295 '¡¬t_d©e': 
NÚe
,

296 '’d_d©e': 
NÚe
,

297 '´Ü©ed': 
F®£
,

298 '´oduù_code': 
NÚe
,

299 'tÙ®': 
tÙ®
,

300 'tÙ®_befÜe_x': 
	`Decim®
(200.0)

301 
	}
})

303 
def
 
	$‹¡_Œy_to_g‘_švoiû_’Œ›s
(
£lf
):

304 
u¾
 = 
	`»v”£
('švoiû-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 1
	}
})

306 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

307 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_405_METHOD_NOT_ALLOWED
)

308 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {"d‘a": 'M‘hod "GET"‚Ù‡Îowed.'
	}
})

310 
def
 
	$‹¡_add_muÉË_švoiû_’Œ›s
(
£lf
):

311 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

313 
u¾
 = 
	`»v”£
('švoiû-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 
švoiû
.
pk
})

314 
’Œy_d©a
 = {

320 
švoiû
 = 
Invoiû
.
objeùs
.
®l
()[0]

321 
tÙ®
 = 
Decim®
(200.0è* Decim®(1 + 
švoiû
.
§Ës_x_³rûÁ
 / 100)

323 
’Œ›s_couÁ
 = 10

324 
út
 
š
 
	$¿nge
(
’Œ›s_couÁ
):

325 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`po¡
(
u¾
, 
d©a
=
jsÚ
.
	`dumps
(
’Œy_d©a
),

326 
cÚ‹Á_ty³
='application/json')

328 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_201_CREATED
)

329 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {

331 'un™': 
NÚe
,

334 '¡¬t_d©e': 
NÚe
,

335 '’d_d©e': 
NÚe
,

336 '´Ü©ed': 
F®£
,

337 '´oduù_code': 
NÚe
,

338 'tÙ®': 
tÙ®
,

339 'tÙ®_befÜe_x': 
	`Decim®
(200.0)

340 
	}
})

342 
u¾
 = 
»v”£
('švoiû-d‘a', 
kw¬gs
={'pk': 
švoiû
.
pk
})

343 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

344 
švoiû_’Œ›s
 = 
»¥Ú£
.
d©a
.
	`g‘
('švoiû_’Œ›s', 
NÚe
)

345 
£lf
.
	`as£¹Equ®
(
	`Ën
(
švoiû_’Œ›s
), 
’Œ›s_couÁ
)

347 
def
 
	$‹¡_d–‘e_švoiû_’Œy
(
£lf
):

348 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

350 
u¾
 = 
	`»v”£
('švoiû-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 
švoiû
.
pk
})

351 
’Œy_d©a
 = {

356 
’Œ›s_couÁ
 = 10

357 
út
 
š
 
	$¿nge
(
’Œ›s_couÁ
):

358 
£lf
.
ş›Á
.
	`po¡
(
u¾
, 
d©a
=
jsÚ
.
	`dumps
(
’Œy_d©a
),

359 
cÚ‹Á_ty³
='application/json')

361 
u¾
 = 
	`»v”£
('švoiû-’Œy-upd©e', 
kw¬gs
={'docum’t_pk': 
švoiû
.
pk
,

362 '’Œy_pk': 
	`li¡
(
švoiû
.
_’Œ›s
)[0].
pk
})

363 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$d–‘e
(
u¾
)

364 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_204_NO_CONTENT
)

366 
u¾
 = 
	`»v”£
('švoiû-d‘a', 
kw¬gs
={'pk': 
švoiû
.
pk
})

367 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

368 
švoiû_’Œ›s
 = 
»¥Ú£
.
d©a
.
	`g‘
('švoiû_’Œ›s', 
NÚe
)

369 
£lf
.
	`as£¹Equ®
(
	`Ën
(
švoiû_’Œ›s
), 
’Œ›s_couÁ
 - 1)

371 
def
 
	$‹¡_add_švoiû_’Œy_š_issued_¡©e
(
£lf
):

372 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

373 
švoiû
.
	$issue
()

375 
u¾
 = 
	`»v”£
('švoiû-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 
švoiû
.
pk
})

376 
’Œy_d©a
 = {

381 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
=
jsÚ
.
dumps
(
’Œy_d©a
),

382 
cÚ‹Á_ty³
='application/json')

384 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_403_FORBIDDEN
)

385 
msg
 = 'Invoiceƒntries can be‡dded only whenhe invoice is in draft state.'

386 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {'d‘a': 
msg
})

388 
u¾
 = 
»v”£
('švoiû-d‘a', 
kw¬gs
={'pk': 
švoiû
.
pk
})

389 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

390 
švoiû_’Œ›s
 = 
»¥Ú£
.
d©a
.
	`g‘
('švoiû_’Œ›s', 
NÚe
)

391 
£lf
.
	`as£¹Equ®
(
	`Ën
(
švoiû_’Œ›s
), 0)

393 
def
 
	$‹¡_add_švoiû_’Œy_š_ÿnûËd_¡©e
(
£lf
):

394 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

395 
švoiû
.
	$issue
()

396 
švoiû
.
	$ÿnûl
()

398 
u¾
 = 
	`»v”£
('švoiû-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 
švoiû
.
pk
})

399 
’Œy_d©a
 = {

404 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
=
jsÚ
.
dumps
(
’Œy_d©a
),

405 
cÚ‹Á_ty³
='application/json')

407 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_403_FORBIDDEN
)

408 
msg
 = 'Invoiceƒntries can be‡dded only whenhe invoice is in draft state.'

409 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {'d‘a': 
msg
})

411 
u¾
 = 
»v”£
('švoiû-d‘a', 
kw¬gs
={'pk': 
švoiû
.
pk
})

412 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

413 
švoiû_’Œ›s
 = 
»¥Ú£
.
d©a
.
	`g‘
('švoiû_’Œ›s', 
NÚe
)

414 
£lf
.
	`as£¹Equ®
(
	`Ën
(
švoiû_’Œ›s
), 0)

416 
def
 
	$‹¡_add_švoiû_’Œy_š_·id_¡©e
(
£lf
):

417 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

418 
švoiû
.
	$issue
()

419 
švoiû
.
	$·y
()

421 
u¾
 = 
	`»v”£
('švoiû-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 
švoiû
.
pk
})

422 
’Œy_d©a
 = {

427 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
=
jsÚ
.
dumps
(
’Œy_d©a
),

428 
cÚ‹Á_ty³
='application/json')

430 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_403_FORBIDDEN
)

431 
msg
 = 'Invoiceƒntries can be‡dded only whenhe invoice is in draft state.'

432 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {'d‘a': 
msg
})

434 
u¾
 = 
»v”£
('švoiû-d‘a', 
kw¬gs
={'pk': 
švoiû
.
pk
})

435 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

436 
švoiû_’Œ›s
 = 
»¥Ú£
.
d©a
.
	`g‘
('švoiû_’Œ›s', 
NÚe
)

437 
£lf
.
	`as£¹Equ®
(
	`Ën
(
švoiû_’Œ›s
), 0)

439 
def
 
	$‹¡_ed™_švoiû_š_issued_¡©e
(
£lf
):

440 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

441 
švoiû
.
	$issue
()

443 
u¾
 = 
	`»v”£
('švoiû-d‘a', 
kw¬gs
={'pk': 
švoiû
.
pk
})

444 
d©a
 = {"description": "New Page views"}

445 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

446 
cÚ‹Á_ty³
='application/json')

448 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

449 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {'non_field_errors': [

450 'You cªnÙƒd™hdocum’ˆÚû iˆi š issued s‹.']
	}
})

452 
def
 
	$‹¡_ed™_švoiû_š_ÿnûËd_¡©e
(
£lf
):

453 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

454 
švoiû
.
	$issue
()

455 
švoiû
.
	$ÿnûl
()

457 
u¾
 = 
	`»v”£
('švoiû-d‘a', 
kw¬gs
={'pk': 
švoiû
.
pk
})

458 
d©a
 = {"description": "New Page views"}

459 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

460 
cÚ‹Á_ty³
='application/json')

462 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

463 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {'non_field_errors': [

464 'You cªnÙƒd™hdocum’ˆÚû iˆi š cªûËd s‹.']
	}
})

466 
def
 
	$‹¡_ed™_švoiû_š_·id_¡©e
(
£lf
):

467 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

468 
švoiû
.
	$issue
()

469 
švoiû
.
	$·y
()

471 
u¾
 = 
	`»v”£
('švoiû-d‘a', 
kw¬gs
={'pk': 
švoiû
.
pk
})

472 
d©a
 = {"description": "New Page views"}

473 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

474 
cÚ‹Á_ty³
='application/json')

476 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

477 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {'non_field_errors': [

478 'You cªnÙƒd™hdocum’ˆÚû iˆi š…aid s‹.']
	}
})

480 
def
 
	$‹¡_issue_švoiû_w™h_deçuÉ_d©es
(
£lf
):

481 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

482 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

483 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

485 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

486 
d©a
 = {'state': 'issued'}

487 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

488 
cÚ‹Á_ty³
='application/json')

490 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

491 
due_d©e
 = 
timezÚe
.
	`now
().
	`d©e
(è+ 
	$timed–
(
days
=
PAYMENT_DUE_DAYS
)

492 
mªd©Üy_cÚ‹Á
 = {

493 'issue_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

494 'due_d©e': 
due_d©e
.
	`¡ráime
('%Y-%m-%d'),

496 
	}
}

497 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

498 
£lf
.
	`as£¹True
(
	`®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

499 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
()))

500 
£lf
.
	`as£¹NÙEqu®
(
»¥Ú£
.
d©a
.
	`g‘
('¬chived_´ovid”', {
	}
}), {})

501 
	g£lf
.
as£¹NÙEqu®
(
»¥Ú£
.
d©a
.
g‘
('archived_customer', {}), {})

503 
def
 
	$‹¡_issue_švoiû_w™h_cu¡om_issue_d©e
(
£lf
):

504 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

505 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

506 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

508 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

509 
d©a
 = {'state': 'issued', 'issue_date': '2014-01-01'}

510 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

511 
cÚ‹Á_ty³
='application/json')

513 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

514 
due_d©e
 = 
timezÚe
.
	`now
().
	`d©e
(è+ 
	$timed–
(
days
=
PAYMENT_DUE_DAYS
)

515 
mªd©Üy_cÚ‹Á
 = {

517 'due_d©e': 
due_d©e
.
	`¡ráime
('%Y-%m-%d'),

519 
	}
}

520 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

521 
£lf
.
	`as£¹True
(
	`®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

522 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
()))

523 
£lf
.
	`as£¹NÙEqu®
(
»¥Ú£
.
d©a
.
	`g‘
('¬chived_´ovid”', {
	}
}), {})

524 
	g£lf
.
as£¹NÙEqu®
(
»¥Ú£
.
d©a
.
g‘
('archived_customer', {}), {})

526 
def
 
	$‹¡_issue_švoiû_w™h_cu¡om_issue_d©e_ªd_due_d©e
(
£lf
):

527 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

528 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

529 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

531 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

532 
d©a
 = {

538 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

539 
cÚ‹Á_ty³
='application/json')

541 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


542 
mªd©Üy_cÚ‹Á
 = {

547 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


548 
as£¹
 
®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

549 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
())

550 
as£¹
 
»¥Ú£
.
d©a
.
	`g‘
('¬chived_´ovid”', {
	}
}) != {}

551 
as£¹
 
»¥Ú£
.
d©a
.
g‘
('archived_customer', {}) != {}

553 
def
 
	$‹¡_issue_švoiû_wh’_š_issued_¡©e
(
£lf
):

554 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

555 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

556 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

557 
švoiû
.
	$issue
()

559 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

560 
d©a
 = {'state': 'issued'}

561 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

562 
cÚ‹Á_ty³
='application/json')

563 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


564 
as£¹
 
»¥Ú£
.
d©a
 == {

568 
def
 
	$‹¡_issue_švoiû_wh’_š_·id_¡©e
(
£lf
):

569 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

570 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

571 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

572 
švoiû
.
	$issue
()

573 
švoiû
.
	$·y
()

575 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

576 
d©a
 = {'state': 'issued'}

577 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

578 
cÚ‹Á_ty³
='application/json')

579 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


580 
as£¹
 
»¥Ú£
.
d©a
 == {

584 
def
 
	$‹¡_·y_švoiû_w™h_deçuÉ_d©es
(
£lf
):

585 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

586 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

587 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

588 
švoiû
.
	$issue
()

590 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

591 
d©a
 = {'state': 'paid'}

592 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

593 
cÚ‹Á_ty³
='application/json')

595 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


596 
due_d©e
 = 
timezÚe
.
now
().
d©e
(è+ 
	$timed–
(
days
=
PAYMENT_DUE_DAYS
)

597 
mªd©Üy_cÚ‹Á
 = {

598 'issue_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

599 'due_d©e': 
due_d©e
.
	`¡ráime
('%Y-%m-%d'),

600 '·id_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

602 
	}
}

603 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


604 
as£¹
 
®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

605 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
())

607 
def
 
	$‹¡_·y_švoiû_w™h_´ovided_d©e
(
£lf
):

608 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

609 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

610 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

611 
švoiû
.
	$issue
()

613 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

614 
d©a
 = {

618 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

619 
cÚ‹Á_ty³
='application/json')

621 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


622 
due_d©e
 = 
timezÚe
.
now
().
d©e
(è+ 
	$timed–
(
days
=
PAYMENT_DUE_DAYS
)

623 
mªd©Üy_cÚ‹Á
 = {

624 'issue_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

625 'due_d©e': 
due_d©e
.
	`¡ráime
('%Y-%m-%d'),

628 
	}
}

629 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


630 
as£¹
 
®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

631 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
())

633 
def
 
	$‹¡_·y_švoiû_wh’_š_d¿á_¡©e
(
£lf
):

634 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

635 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

636 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

638 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

639 
d©a
 = {'state': 'paid'}

640 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

641 
cÚ‹Á_ty³
='application/json')

642 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


643 
as£¹
 
»¥Ú£
.
d©a
 == {

647 
def
 
	$‹¡_·y_švoiû_wh’_š_·id_¡©e
(
£lf
):

648 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

649 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

650 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

651 
švoiû
.
	$issue
()

652 
švoiû
.
	$·y
()

654 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

655 
d©a
 = {'state': 'paid'}

656 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

657 
cÚ‹Á_ty³
='application/json')

658 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


659 
as£¹
 
»¥Ú£
.
d©a
 == {

663 
def
 
	$‹¡_ÿnûl_švoiû_w™h_deçuÉ_d©es
(
£lf
):

664 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

665 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

666 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

667 
švoiû
.
	$issue
()

669 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

670 
d©a
 = {'state': 'canceled'}

671 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

672 
cÚ‹Á_ty³
='application/json')

674 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


675 
due_d©e
 = 
timezÚe
.
now
().
d©e
(è+ 
	$timed–
(
days
=
PAYMENT_DUE_DAYS
)

676 
mªd©Üy_cÚ‹Á
 = {

677 'issue_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

678 'due_d©e': 
due_d©e
.
	`¡ráime
('%Y-%m-%d'),

679 'ÿnûl_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

681 
	}
}

682 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


683 
as£¹
 
®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

684 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
())

686 
def
 
	$‹¡_ÿnûl_švoiû_w™h_´ovided_d©e
(
£lf
):

687 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

688 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

689 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

690 
švoiû
.
	$issue
()

692 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

693 
d©a
 = {

698 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

699 
cÚ‹Á_ty³
='application/json')

701 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


702 
due_d©e
 = 
timezÚe
.
now
().
d©e
(è+ 
	$timed–
(
days
=
PAYMENT_DUE_DAYS
)

703 
mªd©Üy_cÚ‹Á
 = {

704 'issue_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

705 'due_d©e': 
due_d©e
.
	`¡ráime
('%Y-%m-%d'),

708 
	}
}

709 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


710 
as£¹
 
®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

711 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
())

713 
def
 
	$‹¡_ÿnûl_švoiû_š_d¿á_¡©e
(
£lf
):

714 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

715 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

716 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

718 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

719 
d©a
 = {'state': 'canceled'}

721 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

722 
cÚ‹Á_ty³
='application/json')

724 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


725 
as£¹
 
»¥Ú£
.
d©a
 == {

729 
def
 
	$‹¡_ÿnûl_švoiû_š_ÿnûËd_¡©e
(
£lf
):

730 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

731 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

732 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

733 
švoiû
.
	$issue
()

734 
švoiû
.
	$ÿnûl
()

736 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

737 
d©a
 = {'state': 'canceled'}

739 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

740 
cÚ‹Á_ty³
='application/json')

742 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


743 
as£¹
 
»¥Ú£
.
d©a
 == {

747 
def
 
	$‹¡_ÿnûl_švoiû_š_·id_¡©e
(
£lf
):

748 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

749 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

750 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

751 
švoiû
.
	$issue
()

752 
švoiû
.
	$·y
()

754 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

755 
d©a
 = {'state': 'canceled'}

757 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

758 
cÚ‹Á_ty³
='application/json')

760 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


761 
as£¹
 
»¥Ú£
.
d©a
 == {

765 
def
 
	$‹¡_Ëg®_¡©e_chªge_wh’_š_d¿á_¡©e
(
£lf
):

766 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

767 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

768 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

770 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

771 
d©a
 = {'state': 'illegal-state'}

773 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

774 
cÚ‹Á_ty³
='application/json')

776 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


777 
as£¹
 
»¥Ú£
.
d©a
 == {'detail': 'Illegal state value.'}

779 
def
 
	$‹¡_Ëg®_¡©e_chªge_wh’_š_issued_¡©e
(
£lf
):

780 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

781 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

782 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

783 
švoiû
.
	$issue
()

785 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

786 
d©a
 = {'state': 'illegal-state'}

788 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

789 
cÚ‹Á_ty³
='application/json')

791 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


792 
as£¹
 
»¥Ú£
.
d©a
 == {'detail': 'Illegal state value.'}

794 
def
 
	$‹¡_Ëg®_¡©e_chªge_wh’_š_·id_¡©e
(
£lf
):

795 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

796 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

797 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

798 
švoiû
.
	$issue
()

799 
švoiû
.
	$·y
()

801 
u¾
 = 
	`»v”£
('švoiû-¡©e', 
kw¬gs
={'pk': 
švoiû
.
pk
})

802 
d©a
 = {'state': 'illegal-state'}

804 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

805 
cÚ‹Á_ty³
='application/json')

807 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


808 
as£¹
 
»¥Ú£
.
d©a
 == {'detail': 'Illegal state value.'}

	@silver/tests/spec/test_metered_feature.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
jsÚ


17 
impÜt
 
py‹¡


19 
äom
 
»¡_äamewÜk
 
impÜt
 
¡©us


20 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

21 
äom
 
	g»¡_äamewÜk
.
‹¡
 
impÜt
 
APITe¡Ca£


23 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
AdmšU£rFaùÜy
, 
M‘”edF—tu»FaùÜy
,

24 
ProduùCodeFaùÜy
)

25 
äom
 
sv”
.
‹¡s
.
uts
 
impÜt
 
bud_absŞu‹_‹¡_u¾


28 
şass
 
	$Te¡M‘”edF—tu»Endpošt
(
APITe¡Ca£
):

30 
def
 
	$£tUp
(
£lf
):

31 
admš_u£r
 = 
AdmšU£rFaùÜy
.
	$ü—‹
()

32 
£lf
.
ş›Á
.
	$fÜû_auth’tiÿ‹
(
u£r
=
admš_u£r
)

33 
ProduùCodeFaùÜy
.
	$»£t_£qu’û
(1)

34 
£lf
.
´oduù_code
 = 
ProduùCodeFaùÜy
.
	$ü—‹
()

35 
£lf
.
com¶‘e_d©a
 = {

40 "´oduù_code": 
£lf
.
´oduù_code
.
v®ue


41 
	}
}

44 
def
 
	$_fuÎ_u¾
(
£lf
, 
pk
=
NÚe
):

45 
ba£_u¾
 = "http://testserver"

46 
»Ïtive_u¾
 = 
	`»v”£
('m‘”ed-ã©u»-d‘a', 
kw¬gs
={'pk': 
pk
})

47  
u¾·r£
.
u¾još
(
ba£_u¾
, 
»Ïtive_u¾
)

50 
def
 
	$‹¡_ü—‹_po¡_m‘”ed_ã©u»
(
£lf
):

51 
u¾
 = 
	`»v”£
('metered-feature-list')

52 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`po¡
(
u¾
, 
jsÚ
.
	`dumps
(£lf.
com¶‘e_d©a
),

53 
cÚ‹Á_ty³
='application/json')

54 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_201_CREATED


55 
ex³ùed
 = 
£lf
.
com¶‘e_d©a


56 #ex³ùed.
	`upd©e
({'u¾': 
£lf
.
	`_fuÎ_u¾
(1)
	}
})

57 
as£¹
 
ex³ùed
 =ğ
»¥Ú£
.
d©a


59 
def
 
	$‹¡_ü—‹_po¡_m‘”ed_ã©u»_w™hout_»quœed_f›ld
(
£lf
):

60 
u¾
 = 
	`»v”£
('metered-feature-list')

62 
»quœed_f›lds
 = ['name', 'price_per_unit', 'included_units']

63 
f›ld
 
š
 
»quœed_f›lds
:

64 
‹mp_d©a
 = 
£lf
.
com¶‘e_d©a
.
	$cİy
()

65 
Œy
:

66 
‹mp_d©a
.
	$pİ
(
f›ld
)

67 
exû±
 
KeyE¼Ü
:

68 
py‹¡
.
	`xç
('Metered Feature„equired field %s‚ot…rovided in'

69 'thcom¶‘‹¡ d©a.' % 
f›ld
)

71 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`po¡
(
u¾
, 
jsÚ
.
	`dumps
(
‹mp_d©a
),

72 
cÚ‹Á_ty³
='application/json')

74 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

75 
	`as£¹
 (
»¥Ú£
.
d©a
 =ğ{
f›ld
: ['Thi f›ld may‚Ù bbÏnk.']
	}
} 
Ü


76 
»¥Ú£
.
d©a
 =ğ{
f›ld
: ['This field is„equired.']})

78 #deà
‹¡_ü—‹_po¡_m‘”ed_ã©u»_bulk
(
£lf
):

79 #mf ğ
M‘”edF—tu»FaùÜy
.
ü—‹_b©ch
(7)

81 #¿w_mf ğ
jsÚ
.
lßds
(
£rŸliz”s
.
£rŸlize
('jsÚ', 
mfs
))

84 #fÜ 
™em
 
š
 
¿w_mfs
:

85 #£rŸlized_mfs.
­³nd
(
™em
['fields'])

87 #u¾ = 
»v”£
('metered-feature-list')

89 #»¥Ú£ = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
=
jsÚ
.
dumps
(
£rŸlized_mfs
),

92 #£lf.
as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_201_CREATED
)

93 #£lf.
as£¹Equ®
(
Ën
(
»¥Ú£
.
d©a
), 7)

95 
def
 
	$‹¡_g‘_m‘”ed_ã©u»_d‘a
(
£lf
):

96 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
(
´oduù_code
=
£lf
.product_code)

98 
u¾
 = 
	`»v”£
('metered-feature-detail',

99 
kw¬gs
={'pk': 
m‘”ed_ã©u»
.
pk
})

101 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

103 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


104 
as£¹
 
»¥Ú£
.
d©a
 == {

105 "Çme": 
m‘”ed_ã©u»
.
Çme
,

106 "un™": 
m‘”ed_ã©u»
.
un™
,

107 "šşuded_un™s": 
m‘”ed_ã©u»
.
šşuded_un™s
.
	`to_’g_¡ršg
(),

108 "´iû_³r_un™": 
m‘”ed_ã©u»
.
´iû_³r_un™
.
	`to_’g_¡ršg
(),

109 "´oduù_code": 
£lf
.
´oduù_code
.
v®ue
,

110 'u¾': 
£lf
.
	`_fuÎ_u¾
(1)

111 
	}
}

114 
def
 
	$‹¡_g‘_m‘”ed_ã©u»_li¡
(
£lf
):

115 
M‘”edF—tu»FaùÜy
.
	$ü—‹_b©ch
(40)

116 
u¾
 = 
	`»v”£
('metered-feature-list')

118 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

120 
fuÎ_u¾
 = 
	$bud_absŞu‹_‹¡_u¾
(
u¾
)

122 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


123 
as£¹
 
»¥Ú£
.
_h—d”s
['link'] == \

124 ('Lšk', '<' + 
fuÎ_u¾
 + '?page=2>;„el="next", ' +

125 '<' + 
fuÎ_u¾
 + '?page=1>;„el="first", ' +

126 '<' + 
fuÎ_u¾
 + '?page=2>„el="last"')

128 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾
 + '?page=2')

130 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


131 
as£¹
 
»¥Ú£
.
_h—d”s
['link'] == \

132 ('Lšk', '<' + 
fuÎ_u¾
 + '>;„el="prev", ' +

133 '<' + 
fuÎ_u¾
 + '?page=1>;„el="first", ' +

134 '<' + 
fuÎ_u¾
 + '?page=2>„el="last"')

137 
def
 
	$‹¡_g‘_m‘”ed_ã©u»_uÃxi¡šg
(
£lf
):

138 
u¾
 = 
	`»v”£
('metered-feature-detail',

139 
kw¬gs
={'pk': 42
	}
})

141 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

143 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_404_NOT_FOUND
)

144 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {
u
'd‘a': u'NÙ found'
	}
})

146 
def
 
	$‹¡_d–‘e_m‘”ed_ã©u»
(
£lf
):

147 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

149 
u¾
 = 
	`»v”£
('m‘”ed-ã©u»-d‘a', 
kw¬gs
={'pk': 1
	}
})

151 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$d–‘e
(
u¾
)

153 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
,

154 
¡©us
.
HTTP_405_METHOD_NOT_ALLOWED
)

155 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
,

156 {
u
'd‘a': u"M‘hod 'DELETE'‚Ù‡Îowed."
	}
})

158 
def
 
	$‹¡_ed™_put_m‘”ed_ã©u»
(
£lf
):

159 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

161 
u¾
 = 
	`»v”£
('m‘”ed-ã©u»-d‘a', 
kw¬gs
={'pk': 1
	}
})

163 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$put
(
u¾
)

165 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
,

166 
¡©us
.
HTTP_405_METHOD_NOT_ALLOWED
)

167 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
,

168 {
u
'd‘a': u"M‘hod 'PUT'‚Ù‡Îowed."
	}
})

170 
def
 
	$‹¡_ed™_·tch_m‘”ed_ã©u»
(
£lf
):

171 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

173 
u¾
 = 
	`»v”£
('m‘”ed-ã©u»-d‘a', 
kw¬gs
={'pk': 1
	}
})

175 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$·tch
(
u¾
)

177 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
,

178 
¡©us
.
HTTP_405_METHOD_NOT_ALLOWED
)

179 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
,

180 {
u
'd‘a': u"M‘hod 'PATCH'‚Ù‡Îowed."
	}
})

	@silver/tests/spec/test_payment_method.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
impÜt
 
sys


16 
äom
 
cİy
 
impÜt
 
d“pcİy


18 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
ov”ride_£‰šgs


19 
äom
 
»¡_äamewÜk
 
impÜt
 
	g³rmissiÚs
, 
¡©us


20 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

22 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
·ym’t_m‘hods_£rŸliz”s
 
impÜt
 
Paym’tM‘hodS”Ÿliz”


23 
äom
 
	gsv”
.
	g­i
.
	gv›ws
.
·ym’t_m‘hod_v›ws
 
impÜt
 
	gPaym’tM‘hodLi¡
, 
Paym’tM‘hodD‘a


24 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gPaym’tM‘hod
, 
T¿n§ùiÚ


25 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
Cu¡om”FaùÜy
, 
Paym’tM‘hodFaùÜy
,

26 
T¿n§ùiÚFaùÜy
)

27 
äom
 
sv”
.
‹¡s
.
fixtu»s
 
	$impÜt
 (
PAYMENT_PROCESSORS
, 
mªu®_´oûssÜ
,

28 
Œigg”ed_´oûssÜ
, 
çšg_void_´oûssÜ
)

29 
äom
 
sv”
.
‹¡s
.
¥ec
.
ut
.
­i_g‘_as£¹
 
impÜt
 
APIG‘As£¹


32 @
	$ov”ride_£‰šgs
(
PAYMENT_PROCESSORS
=PAYMENT_PROCESSORS)

33 
şass
 
	$Te¡Paym’tM‘hodEndpošts
(
APIG‘As£¹
):

34 
£rŸliz”_şass
 = 
Paym’tM‘hodS”Ÿliz”


36 
def
 
	$£tUp
(
£lf
):

37 
£lf
.
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

38 
	`su³r
(
Te¡Paym’tM‘hodEndpošts
, 
£lf
).
	$£tUp
()

40 
def
 
	$ü—‹_·ym’t_m‘hod
(
£lf
, *
¬gs
, **
kw¬gs
):

41 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(*
¬gs
, **
kw¬gs
)

42 
·ym’t_m‘hod
.
added_©
.
	$»¶aû
(
miüo£cÚd
=0)

44  
·ym’t_m‘hod


46 
def
 
	$‹¡_g‘_li¡šg
(
£lf
):

47 
Paym’tM‘hodFaùÜy
.
	`ü—‹
(
cu¡om”
=
Cu¡om”FaùÜy
.
	$ü—‹
())

48 
·ym’t_m‘hod
 = 
£lf
.
	$ü—‹_·ym’t_m‘hod
(
cu¡om”
=
£lf
.customer)

50 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-li¡', 
kw¬gs
={

51 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk


52 
	}
})

54 
£lf
.
	$as£¹_g‘_d©a
(
u¾
, [
·ym’t_m‘hod
])

56 
def
 
	$‹¡_g‘_d‘a
(
£lf
):

57 
Paym’tM‘hodFaùÜy
.
	`ü—‹
(
cu¡om”
=
Cu¡om”FaùÜy
.
	$ü—‹
())

58 
·ym’t_m‘hod
 = 
£lf
.
	$ü—‹_·ym’t_m‘hod
(
cu¡om”
=
£lf
.customer)

60 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-d‘a', 
kw¬gs
={

61 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk
,

62 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk


63 
	}
})

65 
£lf
.
	$as£¹_g‘_d©a
(
u¾
, 
·ym’t_m‘hod
)

67 
def
 
	$‹¡_po¡_li¡šg
(
£lf
):

68 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-li¡', 
kw¬gs
={

69 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk


70 
	}
})

72 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
={

73 '·ym’t_´oûssÜ_Çme': 
mªu®_´oûssÜ


74 }, 
fÜm©
='json')

76 
·ym’t_m‘hod
 = 
Paym’tM‘hod
.
objeùs
.
	$g‘
(
cu¡om”
=
£lf
.customer)

77 
£lf
.
	`as£¹_g‘_d©a
(
»¥Ú£
.
d©a
['u¾'], 
·ym’t_m‘hod
)

79 
def
 
	$‹¡_put_d‘a_ignÜe_cu¡om”_chªge
(
£lf
):

80 
Ùh”_cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

81 
·ym’t_m‘hod
 = 
£lf
.
	$ü—‹_·ym’t_m‘hod
(
cu¡om”
=
£lf
.customer)

83 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-d‘a', 
kw¬gs
={

84 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk
,

85 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk


86 
	}
})

87 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾
, 
fÜm©
='json')

89 
ex³ùed_d©a
 = 
	$d“pcİy
(
»¥Ú£
.
d©a
)

90 
d©a
 = 
»¥Ú£
.data

91 
d©a
['cu¡om”'] = 
	`»v”£
('customer-detail',

92 
»que¡
=
»¥Ú£
.
wsgi_»que¡
,

93 
kw¬gs
={'cu¡om”_pk': 
Ùh”_cu¡om”
.
pk
})

95 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=d©a, 
fÜm©
='json')

96 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

97 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
, 
ex³ùed_d©a
)

99 
def
 
	$‹¡_put_d‘a_ÿÂÙ_chªge_´oûssÜ
(
£lf
):

100 
·ym’t_m‘hod
 = 
£lf
.
	$ü—‹_·ym’t_m‘hod
(
cu¡om”
=
£lf
.customer)

102 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-d‘a', 
kw¬gs
={

103 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk
,

104 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk


105 
	}
})

106 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾
, 
fÜm©
='json')

108 
d©a
 = 
»¥Ú£
.data

109 
d©a
['·ym’t_´oûssÜ_Çme'] = 
Œigg”ed_´oûssÜ


111 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=d©a, 
fÜm©
='json')

112 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

113 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {

114 '·ym’t_´oûssÜ_Çme': [
u
'This field may‚ot be modified.']

115 
	}
})

117 
def
 
	$‹¡_put_d‘a_»’abË_·ym’t_m‘hod
(
£lf
):

119 
·ym’t_m‘hod
.
ÿnûËd
 
äom
 
True
 
to
 
F®£


122 
·ym’t_m‘hod
 = 
£lf
.
	$ü—‹_·ym’t_m‘hod
(
cu¡om”
=
£lf
.customer,

123 
ÿnûËd
=
True
)

125 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-d‘a', 
kw¬gs
={

126 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk
,

127 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk


128 
	}
})

130 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾
, 
fÜm©
='json')

131 
d©a
 = 
»¥Ú£
.data

132 
d©a
['ÿnûËd'] = 
F®£


134 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=d©a, 
fÜm©
='json')

135 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

136 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {

137 'nÚ_f›ld_”rÜs': [
u
'You cannot update‡ canceled…ayment method.']

138 
	}
})

140 
def
 
	$‹¡_put_d‘a_unv”ify_·ym’t_m‘hod
(
£lf
):

142 
·ym’t_m‘hod
.
ÿnûËd
 
äom
 
True
 
to
 
F®£


145 
·ym’t_m‘hod
 = 
£lf
.
	$ü—‹_·ym’t_m‘hod
(
cu¡om”
=
£lf
.customer,

146 
v”if›d
=
True
)

148 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-d‘a', 
kw¬gs
={

149 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk
,

150 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk


151 
	}
})

153 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾
, 
fÜm©
='json')

154 
d©a
 = 
»¥Ú£
.data

155 
d©a
['v”if›d'] = 
F®£


157 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=d©a, 
fÜm©
='json')

158 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

159 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {

160 'v”if›d': [
u
'You cannot unverify‡…ayment method.']

161 
	}
})

163 
def
 
	$‹¡_put_d‘a
(
£lf
):

164 
·ym’t_m‘hod
 = 
£lf
.
	$ü—‹_·ym’t_m‘hod
(
cu¡om”
=
£lf
.customer,

165 
ÿnûËd
=
F®£
,

166 
v”if›d
=
F®£
)

168 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-d‘a', 
kw¬gs
={

169 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk
,

170 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk


171 
	}
})

173 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾
, 
fÜm©
='json')

174 
d©a
 = 
»¥Ú£
.data

175 
d©a
['ÿnûËd'] = 
True


176 
d©a
['v”if›d'] = 
True


178 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=d©a, 
fÜm©
='json')

179 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

180 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
, data)

182 
def
 
	$‹¡_g‘_li¡šg_no_cu¡om”
(
£lf
):

183 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-li¡', 
kw¬gs
={

184 'cu¡om”_pk': 
sys
.
maxšt


185 
	}
})

187 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾
, 
fÜm©
='json')

188 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_404_NOT_FOUND
)

189 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {'d‘a': 'NÙ found.'
	}
})

191 
def
 
	$‹¡_g‘_d‘a_no_cu¡om”
(
£lf
):

192 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-d‘a', 
kw¬gs
={

193 'cu¡om”_pk': 
sys
.
maxšt
,

195 
	}
})

197 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾
, 
fÜm©
='json')

198 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_404_NOT_FOUND
)

199 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {'d‘a': 'NÙ found.'
	}
})

201 
def
 
	$‹¡_g‘_d‘a_no_·ym’t_m‘hod
(
£lf
):

202 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-d‘a', 
kw¬gs
={

203 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk
,

204 '·ym’t_m‘hod_id': 
sys
.
maxšt


205 
	}
})

207 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾
, 
fÜm©
='json')

208 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_404_NOT_FOUND
)

209 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {'d‘a': 'NÙ found.'
	}
})

211 
def
 
	$‹¡_po¡_li¡šg_no_cu¡om”
(
£lf
):

212 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-li¡', 
kw¬gs
={

213 'cu¡om”_pk': 
sys
.
maxšt


214 
	}
})

216 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
={

217 '·ym’t_´oûssÜ_Çme': 
mªu®_´oûssÜ
,

218 }, 
fÜm©
='json')

220 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_404_NOT_FOUND
)

221 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {'d‘a': 'NÙ found.'
	}
})

223 
def
 
	$‹¡_po¡_li¡šg_šcom¶‘e_body_1
(
£lf
):

224 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-li¡', 
kw¬gs
={

226 
	}
})

228 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
={}, 
fÜm©
='json')

229 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

230 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {

231 '·ym’t_´oûssÜ_Çme': ['Thi f›ld i »quœed.']
	}
})

233 
def
 
	$‹¡_³rmissiÚs
(
£lf
):

234 
£lf
.
	`as£¹Equ®
(
Paym’tM‘hodLi¡
.
³rmissiÚ_şas£s
,

235 (
³rmissiÚs
.
IsAuth’tiÿ‹d
,))

236 
£lf
.
	`as£¹Equ®
(
Paym’tM‘hodD‘a
.
³rmissiÚ_şas£s
,

237 (
³rmissiÚs
.
IsAuth’tiÿ‹d
,))

239 
def
 
	$‹¡_f‹r_´oûssÜ
(
£lf
):

240 
·ym’t_m‘hod
 = 
£lf
.
	$ü—‹_·ym’t_m‘hod
(
cu¡om”
=
£lf
.customer)

242 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-li¡', 
kw¬gs
={

243 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk


244 
	}
})

246 
u¾_mªu®_´oûssÜ
 = 
u¾
 + '?´oûssÜ=' + 
mªu®_´oûssÜ


247 
u¾_no_ouut
 = 
u¾
 + '?processor=random'

249 
£lf
.
	$as£¹_g‘_d©a
(
u¾_mªu®_´oûssÜ
, [
·ym’t_m‘hod
])

250 
£lf
.
	$as£¹_g‘_d©a
(
u¾_no_ouut
, [])

252 
def
 
	$‹¡_f‹r_ÿnûËd
(
£lf
):

253 
·ym’t_m‘hod
 = 
£lf
.
	$ü—‹_·ym’t_m‘hod
(
cu¡om”
=
£lf
.customer)

255 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-li¡', 
kw¬gs
={

256 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk


257 
	}
})

259 
u¾_mªu®_´oûssÜ
 = 
u¾
 + '?canceled=False'

260 
u¾_no_ouut
 = 
u¾
 + '?canceled=True'

262 
£lf
.
	$as£¹_g‘_d©a
(
u¾_mªu®_´oûssÜ
, [
·ym’t_m‘hod
])

263 
£lf
.
	$as£¹_g‘_d©a
(
u¾_no_ouut
, [])

265 
def
 
	$‹¡_f‹r_v”if›d
(
£lf
):

266 
·ym’t_m‘hod
 = 
£lf
.
	$ü—‹_·ym’t_m‘hod
(
cu¡om”
=
£lf
.customer)

268 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-li¡', 
kw¬gs
={

269 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk


270 
	}
})

272 
u¾_mªu®_´oûssÜ
 = 
u¾
 + '?verified=False'

273 
u¾_no_ouut
 = 
u¾
 + '?verified=True'

275 
£lf
.
	$as£¹_g‘_d©a
(
u¾_mªu®_´oûssÜ
, [
·ym’t_m‘hod
])

276 
£lf
.
	$as£¹_g‘_d©a
(
u¾_no_ouut
, [])

278 
def
 
	$‹¡_ÿnûl_aùiÚ
(
£lf
):

279 
·ym’t_m‘hod
 = 
£lf
.
	`ü—‹_·ym’t_m‘hod
(
cu¡om”
=self.customer,

280 
·ym’t_´oûssÜ
='triggered')

281 
Œª§ùiÚ_š™Ÿl
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
·ym’t_m‘hod
=payment_method)

282 
Œª§ùiÚ_³ndšg
 = 
T¿n§ùiÚFaùÜy
.
	`ü—‹
(
·ym’t_m‘hod
=payment_method,

283 
¡©e
='pending')

285 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-aùiÚ', 
kw¬gs
={

286 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk
,

287 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
,

289 
	}
})

291 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$po¡
(
u¾
)

292 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

294 
·ym’t_m‘hod
.
	$»äesh_äom_db
()

295 
Œª§ùiÚ_š™Ÿl
.
	$»äesh_äom_db
()

296 
Œª§ùiÚ_³ndšg
.
	$»äesh_äom_db
()

298 
£lf
.
	$as£¹True
(
·ym’t_m‘hod
.
ÿnûËd
)

299 
£lf
.
	$as£¹Equ®
(
Œª§ùiÚ_š™Ÿl
.
¡©e
, 
T¿n§ùiÚ
.
S‹s
.
CªûËd
)

300 
£lf
.
	`as£¹Equ®
(
Œª§ùiÚ_³ndšg
.
¡©e
, 
T¿n§ùiÚ
.
S‹s
.
CªûËd
)

302 @
	$ov”ride_£‰šgs
(
PAYMENT_PROCESSORS
=PAYMENT_PROCESSORS)

303 
def
 
	$‹¡_ÿnûl_aùiÚ_çed_void
(
£lf
):

304 
·ym’t_m‘hod
 = 
£lf
.
	$ü—‹_·ym’t_m‘hod
(

305 
cu¡om”
=
£lf
.cu¡om”, 
·ym’t_´oûssÜ
=
çšg_void_´oûssÜ


308 
Œª§ùiÚ_š™Ÿl
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
·ym’t_m‘hod
=payment_method)

309 
Œª§ùiÚ_³ndšg
 = 
T¿n§ùiÚFaùÜy
.
	`ü—‹
(
·ym’t_m‘hod
=payment_method,

310 
¡©e
='pending')

312 
u¾
 = 
	`»v”£
('·ym’t-m‘hod-aùiÚ', 
kw¬gs
={

313 'cu¡om”_pk': 
£lf
.
cu¡om”
.
pk
,

314 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
,

316 
	}
})

318 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$po¡
(
u¾
)

319 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

321 
ex³ùed_”rÜ
 = "T¿n§ùiÚ {} couldn'ˆbvoided".
	$fÜm©
(
Œª§ùiÚ_³ndšg
.
uuid
)

322 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {'”rÜs': [
ex³ùed_”rÜ
]
	}
})

	@silver/tests/spec/test_payment_processors.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
ov”ride_£‰šgs


16 
äom
 
»¡_äamewÜk
 
impÜt
 
¡©us


17 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

18 
äom
 
	g»¡_äamewÜk
.
‹¡
 
impÜt
 
APITe¡Ca£


20 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
impÜt
 
AdmšU£rFaùÜy


21 
äom
 
	gsv”
.
	g‹¡s
.
fixtu»s
 
impÜt
 
PAYMENT_PROCESSORS


22 
äom
 
	gsv”
.
	g‹¡s
.
uts
 
impÜt
 
	gbud_absŞu‹_‹¡_u¾


25 @
	$ov”ride_£‰šgs
(
PAYMENT_PROCESSORS
=PAYMENT_PROCESSORS)

26 
şass
 
	$Te¡Paym’tProûssÜsEndpošts
(
APITe¡Ca£
):

27 
def
 
	$£tUp
(
£lf
):

28 
admš_u£r
 = 
AdmšU£rFaùÜy
.
	$ü—‹
()

29 
£lf
.
ş›Á
.
	$fÜû_auth’tiÿ‹
(
u£r
=
admš_u£r
)

31 
def
 
	$‹¡_·ym’t_´oûssÜs_li¡
(
£lf
):

32 
u¾
 = 
	`»v”£
('payment-processor-list')

33 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾
, 
fÜm©
='json')

35 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

36 
£lf
.
	`as£¹In
(

41 "u¾": 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('payment-processor-detail', ['triggered']))

42 
	}
},

43 
	g»¥Ú£
.
	gd©a


45 
	g£lf
.
as£¹In
(

50 "u¾": 
bud_absŞu‹_‹¡_u¾
(
»v”£
('payment-processor-detail', ['manual']))

52 
»¥Ú£
.
d©a


55 
def
 
	$‹¡_·ym’t_´oûssÜs_d‘a
(
£lf
):

56 
u¾
 = 
	`»v”£
('·ym’t-´oûssÜ-d‘a', 
kw¬gs
={

58 
	}
})

59 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾
, 
fÜm©
='json')

61 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

62 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {

63 'Çme': 
u
'manual',

64 'ty³': 
u
'manual',

66 'u¾': 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('payment-processor-detail', ['manual']))

67 
	}
})

69 
def
 
	$‹¡_·ym’t_´oûssÜs_d‘a_nÙ_found
(
£lf
):

70 
u¾
 = 
	`»v”£
('·ym’t-´oûssÜ-d‘a', 
kw¬gs
={

72 
	}
})

73 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾
, 
fÜm©
='json')

75 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_404_NOT_FOUND
)

76 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {"d‘a": "NÙ found."
	}
})

	@silver/tests/spec/test_payments.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
d©‘ime
 
impÜt
 
	gd©‘ime
, 
timed–


17 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


18 
äom
 
	gdjªgo
.
	g‹m¶©e
.
lßd”
 
impÜt
 
»nd”_to_¡ršg


19 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
ov”ride_£‰šgs


20 
äom
 
mock
 
impÜt
 
·tch


21 
äom
 
»¡_äamewÜk
 
impÜt
 
¡©us


22 
äom
 
	g»¡_äamewÜk
.
‹¡
 
impÜt
 
APITe¡Ca£


23 
äom
 
	gsv”
.
mod–s
 
impÜt
 
T¿n§ùiÚ


24 
äom
 
	gsv”
.
	guts
.
·ym’ts
 
impÜt
 
	gg‘_·ym’t_u¾
, 
g‘_·ym’t_com¶‘e_u¾


26 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
AdmšU£rFaùÜy
, 
T¿n§ùiÚFaùÜy
)

27 
äom
 
sv”
.
‹¡s
.
fixtu»s
 
impÜt
 
PAYMENT_PROCESSORS
, 
nÙ_im¶em’‹d_v›w


30 @
	$ov”ride_£‰šgs
(
PAYMENT_PROCESSORS
=PAYMENT_PROCESSORS)

31 
şass
 
	$Te¡Paym’tU¾s
(
APITe¡Ca£
):

32 
def
 
	$£tUp
(
£lf
):

33 
£lf
.
u£r
 = 
AdmšU£rFaùÜy
.
	$ü—‹
()

34 
£lf
.
ş›Á
.
	$fÜû_auth’tiÿ‹
(
u£r
=
£lf
.user)

36 
def
 
	$‹¡_·y_Œª§ùiÚ_v›w_expœed
(
£lf
):

37 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
()

39 
w™h
 
	`·tch
('sv”.uts.·ym’ts.d©‘ime'è
as
 
mocked_d©‘ime
:

40 
mocked_d©‘ime
.
utúow
.
»tuº_v®ue
 = 
d©‘ime
.
	`utúow
(è- 
	$timed–
(
days
=365)

41 
u¾
 = 
	$g‘_·ym’t_u¾
(
Œª§ùiÚ
, 
NÚe
)

43 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

45 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

46 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
cÚ‹Á
,

47 
	`»nd”_to_¡ršg
('transactions/expired_payment.html', {

48 'docum’t': 
Œª§ùiÚ
.
docum’t
,

49 
	}
}))

51 
def
 
	$‹¡_·y_Œª§ùiÚ_v›w_šv®id_¡©e
(
£lf
):

52 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
¡©e
=
T¿n§ùiÚ
.
S‹s
.
S‘ed
)

54 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
	$g‘_·ym’t_u¾
(
Œª§ùiÚ
, 
NÚe
))

55 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

56 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
cÚ‹Á
,

57 
	`»nd”_to_¡ršg
('transactions/complete_payment.html', {

58 'Œª§ùiÚ': 
Œª§ùiÚ
,

59 'docum’t': 
Œª§ùiÚ
.
docum’t
,

60 
	}
}))

62 
def
 
	$‹¡_·y_Œª§ùiÚ_v›w_nÙ_cÚsumabË_Œª§ùiÚ
(
£lf
):

63 
Ï¡_y—r
 = 
timezÚe
.
	`now
(è- 
	$timed–
(
days
=365)

64 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
¡©e
=
T¿n§ùiÚ
.
S‹s
.
In™Ÿl
,

65 
v®id_uÁ
=
Ï¡_y—r
)

67 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
	$g‘_·ym’t_u¾
(
Œª§ùiÚ
, 
NÚe
))

68 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

69 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
cÚ‹Á
,

70 
	`»nd”_to_¡ršg
('transactions/expired_payment.html', {

71 'docum’t': 
Œª§ùiÚ
.
docum’t
,

72 
	}
}))

74 
def
 
	$‹¡_·y_Œª§ùiÚ_v›w_missšg_v›w
(
£lf
):

75 
Ï¡_y—r
 = 
timezÚe
.
	`now
(è- 
	$timed–
(
days
=365)

76 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
¡©e
=
T¿n§ùiÚ
.
S‹s
.
In™Ÿl
,

77 
v®id_uÁ
=
Ï¡_y—r
)

79 
def
 
	$g‘_v›w
(
´oûssÜ
, 
Œª§ùiÚ
, 
»que¡
):

80  
NÚe


82 
w™h
 
	`·tch
('silver.tests.fixtures.ManualProcessor.get_view',

83 
Ãw
=
g‘_v›w
):

84 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
	$g‘_·ym’t_u¾
(
Œª§ùiÚ
, 
NÚe
))

86 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

87 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
cÚ‹Á
,

88 
	`»nd”_to_¡ršg
('transactions/expired_payment.html', {

89 'docum’t': 
Œª§ùiÚ
.
docum’t
,

90 
	}
}))

92 
def
 
	$‹¡_·y_Œª§ùiÚ_nÙ_im¶em’‹d_g‘_ÿÎ
(
£lf
):

93 
Ï¡_y—r
 = 
timezÚe
.
	`now
(è- 
	$timed–
(
days
=365)

94 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
¡©e
=
T¿n§ùiÚ
.
S‹s
.
In™Ÿl
,

95 
v®id_uÁ
=
Ï¡_y—r
)

97 
def
 
	$g‘_v›w
(
´oûssÜ
, 
Œª§ùiÚ
, 
»que¡
):

98  
nÙ_im¶em’‹d_v›w


100 
w™h
 
	`·tch
('silver.tests.fixtures.ManualProcessor.get_view',

101 
Ãw
=
g‘_v›w
):

102 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
	$g‘_·ym’t_u¾
(
Œª§ùiÚ
, 
NÚe
))

104 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

105 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
cÚ‹Á
,

106 
	`»nd”_to_¡ršg
('transactions/expired_payment.html', {

107 'docum’t': 
Œª§ùiÚ
.
docum’t
,

108 
	}
}))

110 
def
 
	$‹¡_com¶‘e_·ym’t_v›w_w™h_»tuº_u¾
(
£lf
):

111 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
¡©e
=
T¿n§ùiÚ
.
S‹s
.
S‘ed
)

113 
»tuº_u¾
 = 'http://home.com'

114 
com¶‘e_u¾
 = "{}?»tuº_u¾={}".
	`fÜm©
(
	`g‘_·ym’t_com¶‘e_u¾
(
Œª§ùiÚ
, 
NÚe
),

115 
»tuº_u¾
)

116 
ex³ùed_u¾
 = "{}?Œª§ùiÚ_uuid={}".
	$fÜm©
(
»tuº_u¾
,

117 
Œª§ùiÚ
.
uuid
)

119 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
com¶‘e_u¾
, 
fŞlow
=
F®£
)

120 
£lf
.
	$as£¹Redœeùs
(
»¥Ú£
, 
ex³ùed_u¾
,

121 
ãtch_»dœeù_»¥Ú£
=
F®£
)

123 
def
 
	$‹¡_com¶‘e_·ym’t_v›w_w™hout_»tuº_u¾
(
£lf
):

124 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
¡©e
=
T¿n§ùiÚ
.
S‹s
.
S‘ed
)

126 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
	$g‘_·ym’t_com¶‘e_u¾
(
Œª§ùiÚ
, 
NÚe
))

128 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

129 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
cÚ‹Á
,

130 
	`»nd”_to_¡ršg
('transactions/complete_payment.html', {

131 'expœed': 
F®£
,

132 'Œª§ùiÚ': 
Œª§ùiÚ
,

133 'docum’t': 
Œª§ùiÚ
.
docum’t
,

134 
	}
}))

	@silver/tests/spec/test_plan.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
jsÚ


18 
äom
 
»¡_äamewÜk
 
impÜt
 
¡©us


19 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

20 
äom
 
	g»¡_äamewÜk
.
‹¡
 
impÜt
 
APITe¡Ca£


22 
äom
 
	gsv”
.
mod–s
 
impÜt
 
ProduùCode


23 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
AdmšU£rFaùÜy
, 
Provid”FaùÜy
,

24 
PÏnFaùÜy
, 
ProduùCodeFaùÜy
)

27 
şass
 
	$Te¡PÏnEndpošt
(
APITe¡Ca£
):

28 
def
 
	$£tUp
(
£lf
):

29 
admš_u£r
 = 
AdmšU£rFaùÜy
.
	$ü—‹
()

30 
£lf
.
ş›Á
.
	$fÜû_auth’tiÿ‹
(
u£r
=
admš_u£r
)

32 
def
 
	$‹¡_ü—‹_¶ª
(
£lf
):

33 
u¾
 = 
	`»v”£
('plan-list')

35 
ProduùCodeFaùÜy
.
	$ü—‹_b©ch
(2)

36 
ã©u»1_pc
 = 
ProduùCode
.
objeùs
.
	`®l
()[0].
v®ue


37 
¶ª_pc
 = 
ProduùCode
.
objeùs
.
	`®l
()[1].
v®ue


38 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

39 
´ovid”_u¾
 = 
	`»v”£
('provider-detail',

40 
kw¬gs
={'pk': 
´ovid”
.
pk
})

41 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
jsÚ
.
dumps
({

49 "’abËd": 
True
,

50 "´iv©e": 
F®£
,

51 "´oduù_code": 
¶ª_pc
,

57 '´oduù_code': 
ã©u»1_pc
},

64 '´ovid”': 
´ovid”_u¾


65 }), 
cÚ‹Á_ty³
='application/json')

67 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_201_CREATED


69 
def
 
	$‹¡_ü—‹_¶ª_w™hout_»quœed_f›lds
(
£lf
):

70 
u¾
 = 
	`»v”£
('plan-list')

72 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`po¡
(
u¾
, 
jsÚ
.
	`dumps
({

79 "’abËd": 
True
,

80 "´iv©e": 
F®£
,

82 
	}
}), 
	gcÚ‹Á_ty³
='application/json')

83 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

85 
def
 
	$‹¡_·tch_¶ª
(
£lf
):

86 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
()

88 
u¾
 = 
	`»v”£
('¶ª-d‘a', 
kw¬gs
={'pk': 
¶ª
.
pk
})

90 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
jsÚ
.
dumps
({

93 }), 
cÚ‹Á_ty³
='application/json')

94 
£lf
.
as£¹Equ®
(
»¥Ú£
.
d©a
['name'], 'Hydrogen')

95 
	g£lf
.
as£¹Equ®
(
»¥Ú£
.
d©a
['generate_after'], 86400)

96 
	g£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

98 
def
 
	$‹¡_·tch_¶ª_nÚ_ed™abË_f›ld
(
£lf
):

99 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
()

101 
u¾
 = 
	`»v”£
('¶ª-d‘a', 
kw¬gs
={'pk': 
¶ª
.
pk
})

103 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
jsÚ
.
dumps
({

105 }), 
cÚ‹Á_ty³
='application/json')

106 
£lf
.
as£¹NÙEqu®
(
»¥Ú£
.
d©a
['currency'], 'DollaDolla')

107 
	g£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

109 
def
 
	$‹¡_put_¶ª
(
£lf
):

110 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
()

112 
u¾
 = 
	`»v”£
('¶ª-d‘a', 
kw¬gs
={'pk': 
¶ª
.
pk
})

114 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$put
(
u¾
)

116 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
,

117 
¡©us
.
HTTP_405_METHOD_NOT_ALLOWED
)

118 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
,

119 {
u
'd‘a': u'M‘hod "PUT"‚Ù‡Îowed.'
	}
})

121 
def
 
	$‹¡_g‘_¶ª_li¡
(
£lf
):

122 
PÏnFaùÜy
.
	$ü—‹_b©ch
(40)

124 
u¾
 = 
	`»v”£
('plan-list')

126 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

128 
fuÎ_u¾
 = 
NÚe


129 
f›ld
 
š
 
»¥Ú£
.
d©a
:

130 
fuÎ_u¾
 = 
f›ld
.
	`g‘
('u¾', 
NÚe
)

131 
fuÎ_u¾
:

133 
fuÎ_u¾
:

134 
domaš
 = 
fuÎ_u¾
.
	`¥l™
('/')[2]

135 
fuÎ_u¾
 = fuÎ_u¾.
	`¥l™
(
domaš
)[0] + domaš + 
u¾


137 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


138 
as£¹
 
»¥Ú£
.
_h—d”s
['link'] == \

139 ('Lšk', '<' + 
fuÎ_u¾
 + '?page=2>;„el="next", ' +

140 '<' + 
fuÎ_u¾
 + '?page=1>;„el="first", ' +

141 '<' + 
fuÎ_u¾
 + '?page=2>„el="last"')

143 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾
 + '?page=2')

145 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


146 
as£¹
 
»¥Ú£
.
_h—d”s
['link'] == \

147 ('Lšk', '<' + 
fuÎ_u¾
 + '>;„el="prev", ' +

148 '<' + 
fuÎ_u¾
 + '?page=1>;„el="first", ' +

149 '<' + 
fuÎ_u¾
 + '?page=2>„el="last"')

151 
def
 
	$‹¡_g‘_¶ª_d‘a
(
£lf
):

152 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
()

154 
u¾
 = 
	`»v”£
('¶ª-d‘a', 
kw¬gs
={'pk': 
¶ª
.
pk
})

156 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

158 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

159 
£lf
.
	$as£¹NÙEqu®
(
»¥Ú£
.
d©a
, [])

161 
def
 
	$‹¡_g‘_¶ª_d‘a_uÃxi¡šg
(
£lf
):

162 
u¾
 = 
	`»v”£
('¶ª-d‘a', 
kw¬gs
={'pk': 1
	}
})

164 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

166 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_404_NOT_FOUND
)

168 
def
 
	$‹¡_d–‘e_¶ª
(
£lf
):

169 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
()

170 
¶ª
.
’abËd
 = 
True


171 
¶ª
.
	$§ve
()

173 
u¾
 = 
	`»v”£
('¶ª-d‘a', 
kw¬gs
={'pk': 
¶ª
.
pk
})

175 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$d–‘e
(
u¾
)

177 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

178 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {"d–‘ed": 
True
})

180 
def
 
	$‹¡_d–‘e_¶ª_uÃxi¡šg
(
£lf
):

181 
u¾
 = 
	`»v”£
('¶ª-d‘a', 
kw¬gs
={'pk': 1
	}
})

183 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$d–‘e
(
u¾
)

185 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_404_NOT_FOUND
)

	@silver/tests/spec/test_proforma.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
jsÚ


17 
äom
 
d©‘ime
 
impÜt
 
timed–


18 
äom
 
decim®
 
impÜt
 
Decim®


20 
äom
 
mock
 
impÜt
 
·tch


21 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


22 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


23 
äom
 
»¡_äamewÜk
 
impÜt
 
¡©us


24 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

25 
äom
 
	g»¡_äamewÜk
.
‹¡
 
impÜt
 
APITe¡Ca£


26 
äom
 
	gªnoyšg
.
funùiÚs
 
impÜt
 
g‘_objeù_Ü_NÚe


28 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gInvoiû
, 
	gProfÜma
, 
PDF


29 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
AdmšU£rFaùÜy
, 
Cu¡om”FaùÜy
,

30 
Provid”FaùÜy
, 
ProfÜmaFaùÜy
,

31 
SubsütiÚFaùÜy
)

32 
äom
 
sv”
.
‹¡s
.
uts
 
impÜt
 
bud_absŞu‹_‹¡_u¾


35 
PAYMENT_DUE_DAYS
 = 
	`g‘©Œ
(
£‰šgs
, 'SILVER_DEFAULT_DUE_DAYS', 5)

38 
şass
 
	$Te¡ProfÜmaEndpošts
(
APITe¡Ca£
):

39 
def
 
	$£tUp
(
£lf
):

40 
admš_u£r
 = 
AdmšU£rFaùÜy
.
	$ü—‹
()

41 
£lf
.
ş›Á
.
	$fÜû_auth’tiÿ‹
(
u£r
=
admš_u£r
)

43 
def
 
	$‹¡_po¡_´ofÜma_w™hout_´ofÜma_’Œ›s
(
£lf
):

44 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

45 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

46 
SubsütiÚFaùÜy
.
	$ü—‹
()

48 
u¾
 = 
	`»v”£
('proforma-list')

49 
´ovid”_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('´ovid”-d‘a', [
´ovid”
.
pk
]))

50 
cu¡om”_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('cu¡om”-d‘a', [
cu¡om”
.
pk
]))

52 
d©a
 = {

53 '´ovid”': 
´ovid”_u¾
,

54 'cu¡om”': 
cu¡om”_u¾
,

59 
	}
}

61 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$po¡
(
u¾
, 
d©a
=data)

63 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_201_CREATED
)

65 
´ofÜma
 = 
	`g‘_objeù_Ü_NÚe
(
ProfÜma
, 
id
=
»¥Ú£
.
d©a
["id"])

66 
£lf
.
	$as£¹True
(
´ofÜma
)

68 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {

69 "id": 
»¥Ú£
.
d©a
["id"],

71 "numb”": 
NÚe
,

72 "´ovid”": 
´ovid”_u¾
,

73 "cu¡om”": 
cu¡om”_u¾
,

76 "due_d©e": 
NÚe
,

77 "issue_d©e": 
NÚe
,

78 "·id_d©e": 
NÚe
,

79 "ÿnûl_d©e": 
NÚe
,

83 "Œª§ùiÚ_cu¼’cy": 
´ofÜma
.
Œª§ùiÚ_cu¼’cy
,

84 "Œª§ùiÚ_xe_¿‹": (
	`¡r
(
´ofÜma
.
Œª§ùiÚ_xe_¿‹
)

85 
´ofÜma
.
Œª§ùiÚ_xe_¿‹
 
NÚe
),

86 "Œª§ùiÚ_xe_d©e": 
´ofÜma
.
Œª§ùiÚ_xe_d©e
,

87 "pdf_u¾": 
NÚe
,

89 "švoiû": 
NÚe
,

94 
	}
})

96 
def
 
	$‹¡_po¡_´ofÜma_w™h_´ofÜma_’Œ›s
(
£lf
):

97 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

98 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

99 
SubsütiÚFaùÜy
.
	$ü—‹
()

101 
u¾
 = 
	`»v”£
('proforma-list')

102 
´ovid”_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('´ovid”-d‘a', [
´ovid”
.
pk
]))

103 
cu¡om”_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('cu¡om”-d‘a', [
cu¡om”
.
pk
]))

105 
d©a
 = {

106 '´ovid”': 
´ovid”_u¾
,

107 'cu¡om”': 
cu¡om”_u¾
,

108 '£r›s': 
NÚe
,

109 'numb”': 
NÚe
,

117 
	}
}

119 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

120 
cÚ‹Á_ty³
='application/json')

122 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_201_CREATED


123 #TODO: 
Check
 
the
 
body
 
of
h
»¥Ú£
. 
Th”e
 
w”e
 
some
 
´obËms


124 #»Ï‹d 
to
 
the
 
švoiû_’Œ›s
 
li¡
.

126 
def
 
	$‹¡_g‘_´ofÜmas
(
£lf
):

127 
b©ch_size
 = 50

128 
ProfÜmaFaùÜy
.
	$ü—‹_b©ch
(
b©ch_size
)

130 
u¾
 = 
	`»v”£
('proforma-list')

131 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

133 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


135 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾
 + '?page=2')

137 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


139 @
	`·tch
('silver.api.serializers.common.settings')

140 
def
 
	$‹¡_g‘_´ofÜma
(
£lf
, 
mocked_£‰šgs
):

141 
ProfÜmaFaùÜy
.
	$»£t_£qu’û
(1)

143 
u¶ßd_·th
 = '%s/docum’ts/' % 
£‰šgs
.
MEDIA_ROOT


144 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	`ü—‹
(
pdf
=
PDF
.
objeùs
.
	$ü—‹
(
u¶ßd_·th
=upload_path))

145 
´ofÜma
.
	$g’”©e_pdf
()

147 
u¾
 = 
	`»v”£
('´ofÜma-d‘a', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

149 
show_pdf_¡Üage_u¾
, 
pdf_u¾
 
	gš
 [

150 (
True
, "h‰p://‹¡£rv”%s" % 
´ofÜma
.
pdf
.
u¾
),

151 (
F®£
, "h‰p://‹¡£rv”/pdfs/%s/" % 
´ofÜma
.
pk
)]:

152 
mocked_£‰šgs
.
SILVER_SHOW_PDF_STORAGE_URL
 = 
show_pdf_¡Üage_u¾


153 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

155 
´ovid”_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('provider-detail',

156 [
´ofÜma
.
´ovid”
.
pk
]))

157 
cu¡om”_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('customer-detail',

158 [
´ofÜma
.
cu¡om”
.
pk
]))

160 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

161 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {

162 "id": 
´ofÜma
.
pk
,

164 "numb”": 
´ofÜma
.
numb”
,

165 "´ovid”": 
´ovid”_u¾
,

166 "cu¡om”": 
cu¡om”_u¾
,

169 "due_d©e": 
NÚe
,

170 "issue_d©e": 
NÚe
,

171 "·id_d©e": 
NÚe
,

172 "ÿnûl_d©e": 
NÚe
,

176 "Œª§ùiÚ_cu¼’cy": 
´ofÜma
.
Œª§ùiÚ_cu¼’cy
,

177 "Œª§ùiÚ_xe_¿‹": ("%.4f" % 
´ofÜma
.
Œª§ùiÚ_xe_¿‹


178 
´ofÜma
.
Œª§ùiÚ_xe_¿‹
 
NÚe
),

179 "Œª§ùiÚ_xe_d©e": 
´ofÜma
.
Œª§ùiÚ_xe_d©e
,

180 "pdf_u¾": 
pdf_u¾
,

182 "švoiû": 
NÚe
,

187 
	}
})

189 
def
 
	$‹¡_d–‘e_´ofÜma
(
£lf
):

190 
u¾
 = 
	`»v”£
('´ofÜma-d‘a', 
kw¬gs
={'pk': 1
	}
})

191 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$d–‘e
(
u¾
)

193 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_405_METHOD_NOT_ALLOWED


194 
as£¹
 
»¥Ú£
.
d©a
 =ğ{"d‘a": 'M‘hod "DELETE"‚Ù‡Îowed.'
	}
}

196 
def
 
	$‹¡_add_sšgË_´ofÜma_’Œy
(
£lf
):

197 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

199 
u¾
 = 
	`»v”£
('´ofÜma-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 
´ofÜma
.
pk
})

200 
’Œy_d©a
 = {

205 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
=
jsÚ
.
dumps
(
’Œy_d©a
),

206 
cÚ‹Á_ty³
='application/json')

208 
´ofÜma
.
	$»äesh_äom_db
()

210 
tÙ®
 = 
	`Decim®
(200.0è* Decim®(1 + 
´ofÜma
.
§Ës_x_³rûÁ
 / 100)

212 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_201_CREATED


213 
as£¹
 
»¥Ú£
.
d©a
 == {

215 'un™': 
NÚe
,

218 '¡¬t_d©e': 
NÚe
,

219 '’d_d©e': 
NÚe
,

220 '´Ü©ed': 
F®£
,

221 '´oduù_code': 
NÚe
,

222 'tÙ®': 
tÙ®
,

223 'tÙ®_befÜe_x': 
	`Decim®
(200.0)

224 
	}
}

226 
u¾
 = 
»v”£
('´ofÜma-d‘a', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

227 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

229 
švoiû_’Œ›s
 = 
»¥Ú£
.
d©a
.
	`g‘
('´ofÜma_’Œ›s', 
NÚe
)

230 
as£¹
 
	`Ën
(
švoiû_’Œ›s
) == 1

231 
as£¹
 
švoiû_’Œ›s
[0] == {

233 'un™': 
NÚe
,

236 '¡¬t_d©e': 
NÚe
,

237 '’d_d©e': 
NÚe
,

238 '´Ü©ed': 
F®£
,

239 '´oduù_code': 
NÚe
,

240 'tÙ®': 
tÙ®
,

241 'tÙ®_befÜe_x': 
	`Decim®
(200.0)

242 
	}
}

244 
def
 
	$‹¡_Œy_to_g‘_´ofÜma_’Œ›s
(
£lf
):

245 
u¾
 = 
	`»v”£
('´ofÜma-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 1
	}
})

247 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

248 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_405_METHOD_NOT_ALLOWED


249 
as£¹
 
»¥Ú£
.
d©a
 =ğ{"d‘a": 'M‘hod "GET"‚Ù‡Îowed.'
	}
}

251 
def
 
	$‹¡_add_muÉË_´ofÜma_’Œ›s
(
£lf
):

252 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

254 
u¾
 = 
	`»v”£
('´ofÜma-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 
´ofÜma
.
pk
})

255 
’Œy_d©a
 = {

261 
’Œ›s_couÁ
 = 10

262 
út
 
š
 
	$¿nge
(
’Œ›s_couÁ
):

263 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`po¡
(
u¾
, 
d©a
=
jsÚ
.
	`dumps
(
’Œy_d©a
),

264 
cÚ‹Á_ty³
='application/json')

266 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_201_CREATED


268 
´ofÜma
.
	$»äesh_äom_db
()

269 
tÙ®
 = 
	`Decim®
(200.0) * Decimal(1 +

270 
´ofÜma
.
§Ës_x_³rûÁ
 / 100)

271 
as£¹
 
»¥Ú£
.
d©a
 == {

273 'un™': 
NÚe
,

276 '¡¬t_d©e': 
NÚe
,

277 '’d_d©e': 
NÚe
,

278 '´Ü©ed': 
F®£
,

279 '´oduù_code': 
NÚe
,

280 'tÙ®': 
tÙ®
,

281 'tÙ®_befÜe_x': 
	`Decim®
(200.0)

282 
	}
}

284 
u¾
 = 
»v”£
('´ofÜma-d‘a', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

285 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

286 
švoiû_’Œ›s
 = 
»¥Ú£
.
d©a
.
	`g‘
('´ofÜma_’Œ›s', 
NÚe
)

287 
as£¹
 
	`Ën
(
švoiû_’Œ›s
è=ğ
’Œ›s_couÁ


289 
def
 
	$‹¡_d–‘e_´ofÜma_’Œy
(
£lf
):

290 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

292 
u¾
 = 
	`»v”£
('´ofÜma-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 
´ofÜma
.
pk
})

293 
’Œy_d©a
 = {

298 
’Œ›s_couÁ
 = 10

299 
út
 
š
 
	$¿nge
(
’Œ›s_couÁ
):

300 
£lf
.
ş›Á
.
	`po¡
(
u¾
, 
d©a
=
jsÚ
.
	`dumps
(
’Œy_d©a
),

301 
cÚ‹Á_ty³
='application/json')

303 
u¾
 = 
	`»v”£
('´ofÜma-’Œy-upd©e', 
kw¬gs
={'docum’t_pk': 
´ofÜma
.
pk
,

304 '’Œy_pk': 
	`li¡
(
´ofÜma
.
_’Œ›s
)[0].
pk
})

305 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$d–‘e
(
u¾
)

306 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_204_NO_CONTENT


308 
u¾
 = 
	`»v”£
('´ofÜma-d‘a', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

309 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

310 
švoiû_’Œ›s
 = 
»¥Ú£
.
d©a
.
	`g‘
('´ofÜma_’Œ›s', 
NÚe
)

311 
as£¹
 
	`Ën
(
švoiû_’Œ›s
è=ğ
’Œ›s_couÁ
 - 1

313 
def
 
	$‹¡_add_´ofÜma_’Œy_š_issued_¡©e
(
£lf
):

314 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

315 
´ofÜma
.
	$issue
()

317 
u¾
 = 
	`»v”£
('´ofÜma-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 
´ofÜma
.
pk
})

318 
’Œy_d©a
 = {

323 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
=
jsÚ
.
dumps
(
’Œy_d©a
),

324 
cÚ‹Á_ty³
='application/json')

326 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


327 
msg
 = 'Proformaƒntries can be‡dded only whenhe…roforma is in draft state.'

328 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'d‘a': 
msg
}

330 
u¾
 = 
»v”£
('´ofÜma-d‘a', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

331 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

332 
švoiû_’Œ›s
 = 
»¥Ú£
.
d©a
.
	`g‘
('´ofÜma_’Œ›s', 
NÚe
)

333 
as£¹
 
	`Ën
(
švoiû_’Œ›s
) == 0

335 
def
 
	$‹¡_add_´ofÜma_’Œy_š_ÿnûËd_¡©e
(
£lf
):

336 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

337 
´ofÜma
.
	$issue
()

338 
´ofÜma
.
	$ÿnûl
()

340 
u¾
 = 
	`»v”£
('´ofÜma-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 
´ofÜma
.
pk
})

341 
’Œy_d©a
 = {

346 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
=
jsÚ
.
dumps
(
’Œy_d©a
),

347 
cÚ‹Á_ty³
='application/json')

349 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


350 
msg
 = 'Proformaƒntries can be‡dded only whenhe…roforma is in draft state.'

351 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'d‘a': 
msg
}

353 
u¾
 = 
»v”£
('´ofÜma-d‘a', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

354 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

355 
švoiû_’Œ›s
 = 
»¥Ú£
.
d©a
.
	`g‘
('´ofÜma_’Œ›s', 
NÚe
)

356 
as£¹
 
	`Ën
(
švoiû_’Œ›s
) == 0

358 
def
 
	$‹¡_add_´ofÜma_’Œy_š_·id_¡©e
(
£lf
):

359 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

360 
´ofÜma
.
	$issue
()

361 
´ofÜma
.
	$·y
()

363 
u¾
 = 
	`»v”£
('´ofÜma-’Œy-ü—‹', 
kw¬gs
={'docum’t_pk': 
´ofÜma
.
pk
})

364 
’Œy_d©a
 = {

369 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
=
jsÚ
.
dumps
(
’Œy_d©a
),

370 
cÚ‹Á_ty³
='application/json')

372 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


373 
msg
 = 'Proformaƒntries can be‡dded only whenhe…roforma is in draft state.'

374 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'d‘a': 
msg
}

376 
u¾
 = 
»v”£
('´ofÜma-d‘a', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

377 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

378 
švoiû_’Œ›s
 = 
»¥Ú£
.
d©a
.
	`g‘
('´ofÜma_’Œ›s', 
NÚe
)

379 
as£¹
 
	`Ën
(
švoiû_’Œ›s
) == 0

381 
def
 
	$‹¡_ed™_´ofÜma_š_issued_¡©e
(
£lf
):

382 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

383 
´ofÜma
.
	$issue
()

385 
u¾
 = 
	`»v”£
('´ofÜma-d‘a', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

386 
d©a
 = {"description": "New Page views"}

387 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

388 
cÚ‹Á_ty³
='application/json')

390 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_400_BAD_REQUEST


391 
”rÜ_mes§ge
 = 'You cannotƒdithe document once it is in issued state.'

392 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'nÚ_f›ld_”rÜs': [
”rÜ_mes§ge
]}

394 
def
 
	$‹¡_ed™_´ofÜma_š_ÿnûËd_¡©e
(
£lf
):

395 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

396 
´ofÜma
.
	$issue
()

397 
´ofÜma
.
	$ÿnûl
()

399 
u¾
 = 
	`»v”£
('´ofÜma-d‘a', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

400 
d©a
 = {"description": "New Page views"}

401 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

402 
cÚ‹Á_ty³
='application/json')

404 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_400_BAD_REQUEST


405 
”rÜ_mes§ge
 = 'You cannotƒdithe document once it is in canceled state.'

406 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'nÚ_f›ld_”rÜs': [
”rÜ_mes§ge
]}

408 
def
 
	$‹¡_ed™_´ofÜma_š_·id_¡©e
(
£lf
):

409 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

410 
´ofÜma
.
	$issue
()

411 
´ofÜma
.
	$·y
()

413 
u¾
 = 
	`»v”£
('´ofÜma-d‘a', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

414 
d©a
 = {"description": "New Page views"}

415 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
d©a
=
jsÚ
.
dumps
(data),

416 
cÚ‹Á_ty³
='application/json')

418 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_400_BAD_REQUEST


419 
”rÜ_mes§ge
 = 'You cannotƒdithe document once it is in…aid state.'

420 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'nÚ_f›ld_”rÜs': [
”rÜ_mes§ge
]}

422 
def
 
	$‹¡_issue_´ofÜma_w™h_deçuÉ_d©es
(
£lf
):

423 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

424 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

425 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

427 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

428 
d©a
 = {'state': 'issued'}

429 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

431 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


432 
due_d©e
 = 
timezÚe
.
now
().
d©e
(è+ 
	$timed–
(
days
=
PAYMENT_DUE_DAYS
)

433 
mªd©Üy_cÚ‹Á
 = {

434 'issue_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

435 'due_d©e': 
due_d©e
.
	`¡ráime
('%Y-%m-%d'),

437 
	}
}

438 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


439 
as£¹
 
®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

440 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
())

441 
as£¹
 
»¥Ú£
.
d©a
.
	`g‘
('¬chived_´ovid”', {
	}
}) != {}

442 
as£¹
 
»¥Ú£
.
d©a
.
g‘
('archived_customer', {}) != {}

443 
as£¹
 
Invoiû
.
objeùs
.
couÁ
() == 0

445 
def
 
	$‹¡_issue_´ofÜma_w™h_cu¡om_issue_d©e
(
£lf
):

446 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

447 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

448 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

450 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

451 
d©a
 = {'state': 'issued', 'issue_date': '2014-01-01'}

452 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

454 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


455 
due_d©e
 = 
timezÚe
.
now
().
d©e
(è+ 
	$timed–
(
days
=
PAYMENT_DUE_DAYS
)

456 
mªd©Üy_cÚ‹Á
 = {

458 'due_d©e': 
due_d©e
.
	`¡ráime
('%Y-%m-%d'),

460 
	}
}

461 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


462 
as£¹
 
®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

463 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
())

464 
as£¹
 
»¥Ú£
.
d©a
.
	`g‘
('¬chived_´ovid”', {
	}
}) != {}

465 
as£¹
 
»¥Ú£
.
d©a
.
g‘
('archived_customer', {}) != {}

466 
as£¹
 
Invoiû
.
objeùs
.
couÁ
() == 0

468 
´ofÜma
 = 
	$g‘_objeù_Ü_NÚe
(
ProfÜma
, 
pk
=1)

470 
def
 
	$‹¡_issue_´ofÜma_w™h_cu¡om_issue_d©e_ªd_due_d©e
(
£lf
):

471 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

472 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

473 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

475 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

476 
d©a
 = {

482 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

484 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


485 
mªd©Üy_cÚ‹Á
 = {

490 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


491 
as£¹
 
®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

492 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
())

493 
as£¹
 
»¥Ú£
.
d©a
.
	`g‘
('¬chived_´ovid”', {
	}
}) != {}

494 
as£¹
 
»¥Ú£
.
d©a
.
g‘
('archived_customer', {}) != {}

495 
as£¹
 
Invoiû
.
objeùs
.
couÁ
() == 0

497 
´ofÜma
 = 
	$g‘_objeù_Ü_NÚe
(
ProfÜma
, 
pk
=1)

499 
def
 
	$‹¡_issue_´ofÜma_wh’_š_issued_¡©e
(
£lf
):

500 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

501 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

502 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

503 
´ofÜma
.
	$issue
()

505 
švoiûs_couÁ
 = 
Invoiû
.
objeùs
.
	$couÁ
()

507 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

508 
d©a
 = {'state': 'issued'}

509 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

510 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


511 
as£¹
 
»¥Ú£
.
d©a
 == {'detail': 'A…roforma can be issued only if it is in draft state.'}

512 
as£¹
 
Invoiû
.
objeùs
.
couÁ
(è=ğ
švoiûs_couÁ


514 
def
 
	$‹¡_issue_´ofÜma_wh’_š_·id_¡©e
(
£lf
):

515 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

516 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

517 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

518 
´ofÜma
.
	$issue
()

519 
´ofÜma
.
	$·y
()

521 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

522 
d©a
 = {'state': 'issued'}

523 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

524 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


525 
as£¹
 
»¥Ú£
.
d©a
 == {'detail': 'A…roforma can be issued only if it is in draft state.'}

526 
as£¹
 
Invoiû
.
objeùs
.
couÁ
() == 1

528 
def
 
	$‹¡_·y_´ofÜma_w™h_deçuÉ_d©es
(
£lf
):

529 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

530 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

531 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

532 
´ofÜma
.
	$issue
()

534 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

535 
d©a
 = {'state': 'paid'}

536 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

538 
´ofÜma
.
	$»äesh_äom_db
()

539 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


540 
due_d©e
 = 
timezÚe
.
	`now
().
	`d©e
(è+ 
	$timed–
(
days
=
PAYMENT_DUE_DAYS
)

542 
švoiû_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('invoice-detail',

543 [
´ofÜma
.
»Ï‹d_docum’t
.
pk
]))

544 
mªd©Üy_cÚ‹Á
 = {

545 'issue_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

546 'due_d©e': 
due_d©e
.
	`¡ráime
('%Y-%m-%d'),

547 '·id_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

549 'švoiû': 
švoiû_u¾


550 
	}
}

551 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


552 
as£¹
 
®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

553 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
())

555 
švoiû
 = 
Invoiû
.
objeùs
.
	`®l
()[0]

556 
as£¹
 
´ofÜma
.
»Ï‹d_docum’t
 =ğ
švoiû


557 
as£¹
 
švoiû
.
»Ï‹d_docum’t
 =ğ
´ofÜma


559 
def
 
	$‹¡_·y_´ofÜma_w™h_´ovided_d©e
(
£lf
):

560 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

561 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

562 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

563 
´ofÜma
.
	$issue
()

565 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

566 
d©a
 = {

570 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

572 
´ofÜma
.
	$»äesh_äom_db
()

573 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


574 
due_d©e
 = 
timezÚe
.
	`now
().
	`d©e
(è+ 
	$timed–
(
days
=
PAYMENT_DUE_DAYS
)

576 
švoiû_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('invoice-detail',

577 [
´ofÜma
.
»Ï‹d_docum’t
.
pk
]))

578 
mªd©Üy_cÚ‹Á
 = {

579 'issue_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

580 'due_d©e': 
due_d©e
.
	`¡ráime
('%Y-%m-%d'),

583 'švoiû': 
švoiû_u¾


584 
	}
}

585 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


586 
as£¹
 
®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

587 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
())

589 
švoiû
 = 
Invoiû
.
objeùs
.
	`®l
()[0]

590 
as£¹
 
´ofÜma
.
»Ï‹d_docum’t
 =ğ
švoiû


591 
as£¹
 
švoiû
.
»Ï‹d_docum’t
 =ğ
´ofÜma


593 
def
 
	$‹¡_·y_´ofÜma_wh’_š_d¿á_¡©e
(
£lf
):

594 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

595 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

596 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

598 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

599 
d©a
 = {'state': 'paid'}

600 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

601 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


602 
as£¹
 
»¥Ú£
.
d©a
 == {'detail': 'A…roforma can be…aid only if it is in issued state.'}

603 
as£¹
 
Invoiû
.
objeùs
.
couÁ
() == 0

605 
def
 
	$‹¡_·y_´ofÜma_wh’_š_·id_¡©e
(
£lf
):

606 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

607 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

608 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

609 
´ofÜma
.
	$issue
()

610 
´ofÜma
.
	$·y
()

612 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

613 
d©a
 = {'state': 'paid'}

614 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

615 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


616 
as£¹
 
»¥Ú£
.
d©a
 == {'detail': 'A…roforma can be…aid only if it is in issued state.'}

617 
as£¹
 
Invoiû
.
objeùs
.
couÁ
() == 1

619 
def
 
	$‹¡_ÿnûl_´ofÜma_w™h_deçuÉ_d©es
(
£lf
):

620 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

621 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

622 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

623 
´ofÜma
.
	$issue
()

625 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

626 
d©a
 = {'state': 'canceled'}

627 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

629 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


630 
due_d©e
 = 
timezÚe
.
now
().
d©e
(è+ 
	$timed–
(
days
=
PAYMENT_DUE_DAYS
)

631 
mªd©Üy_cÚ‹Á
 = {

632 'issue_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

633 'due_d©e': 
due_d©e
.
	`¡ráime
('%Y-%m-%d'),

634 'ÿnûl_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

636 
	}
}

637 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


638 
as£¹
 
®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

639 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
())

640 
as£¹
 
Invoiû
.
objeùs
.
	`couÁ
() == 0

642 
def
 
	$‹¡_ÿnûl_´ofÜma_w™h_´ovided_d©e
(
£lf
):

643 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

644 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

645 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

646 
´ofÜma
.
	$issue
()

648 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

649 
d©a
 = {

654 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

656 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


657 
due_d©e
 = 
timezÚe
.
now
().
d©e
(è+ 
	$timed–
(
days
=
PAYMENT_DUE_DAYS
)

658 
mªd©Üy_cÚ‹Á
 = {

659 'issue_d©e': 
timezÚe
.
	`now
().
	`d©e
().
	`¡ráime
('%Y-%m-%d'),

660 'due_d©e': 
due_d©e
.
	`¡ráime
('%Y-%m-%d'),

663 
	}
}

664 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


665 
as£¹
 
®l
(
™em
 
š
 
»¥Ú£
.
d©a
.
	$™ems
()

666 
™em
 
š
 
mªd©Üy_cÚ‹Á
.
	$™”™ems
())

667 
as£¹
 
Invoiû
.
objeùs
.
	`couÁ
() == 0

669 
def
 
	$‹¡_ÿnûl_´ofÜma_š_d¿á_¡©e
(
£lf
):

670 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

671 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

672 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

674 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

675 
d©a
 = {'state': 'canceled'}

677 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

679 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


681 
as£¹ed_»¥Ú£
 = 'A…roforma can be canceled only if it is in issued state.'

682 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'d‘a': 
as£¹ed_»¥Ú£
}

683 
as£¹
 
Invoiû
.
objeùs
.
couÁ
() == 0

685 
def
 
	$‹¡_ÿnûl_´ofÜma_š_ÿnûËd_¡©e
(
£lf
):

686 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

687 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

688 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

689 
´ofÜma
.
	$issue
()

690 
´ofÜma
.
	$ÿnûl
()

692 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

693 
d©a
 = {'state': 'canceled'}

695 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

697 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


699 
as£¹ed_»¥Ú£
 = 'A…roforma can be canceled only if it is in issued state.'

700 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'d‘a': 
as£¹ed_»¥Ú£
}

701 
as£¹
 
Invoiû
.
objeùs
.
couÁ
() == 0

703 
def
 
	$‹¡_ÿnûl_´ofÜma_š_·id_¡©e
(
£lf
):

704 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

705 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

706 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

707 
´ofÜma
.
	$issue
()

708 
´ofÜma
.
	$·y
()

710 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

711 
d©a
 = {'state': 'canceled'}

713 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

715 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


716 
as£¹ed_»¥Ú£
 = 'A…roforma can be canceled only if it is in issued state.'

717 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'d‘a': 
as£¹ed_»¥Ú£
}

718 
as£¹
 
Invoiû
.
objeùs
.
couÁ
() == 1

720 
def
 
	$‹¡_Ëg®_¡©e_chªge_wh’_š_d¿á_¡©e
(
£lf
):

721 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

722 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

723 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

725 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

726 
d©a
 = {'state': 'illegal-state'}

728 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

730 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


731 
as£¹
 
»¥Ú£
.
d©a
 == {'detail': 'Illegal state value.'}

732 
as£¹
 
Invoiû
.
objeùs
.
couÁ
() == 0

734 
def
 
	$‹¡_Ëg®_¡©e_chªge_wh’_š_issued_¡©e
(
£lf
):

735 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

736 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

737 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

738 
´ofÜma
.
	$issue
()

740 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

741 
d©a
 = {'state': 'illegal-state'}

743 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

745 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


746 
as£¹
 
»¥Ú£
.
d©a
 == {'detail': 'Illegal state value.'}

747 
as£¹
 
Invoiû
.
objeùs
.
couÁ
() == 0

749 
def
 
	$‹¡_Ëg®_¡©e_chªge_wh’_š_·id_¡©e
(
£lf
):

750 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

751 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

752 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ovid”
õrovid”, 
cu¡om”
=customer)

753 
´ofÜma
.
	$issue
()

754 
´ofÜma
.
	$·y
()

756 
u¾
 = 
	`»v”£
('´ofÜma-¡©e', 
kw¬gs
={'pk': 
´ofÜma
.
pk
})

757 
d©a
 = {'state': 'illegal-state'}

759 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
d©a
=
jsÚ
.
dumps
(d©a), 
cÚ‹Á_ty³
='application/json')

761 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


762 
as£¹
 
»¥Ú£
.
d©a
 == {'detail': 'Illegal state value.'}

763 
as£¹
 
Invoiû
.
objeùs
.
couÁ
() == 1

	@silver/tests/spec/test_provider.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


3 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

5 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

6 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


9 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


11 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

12 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

13 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


14 #lim™©iÚ 
und”
 
the
 
Liûn£
.

17 
impÜt
 
jsÚ


18 
impÜt
 
py‹¡


19 
äom
 
	gdjªgo
.
	gcÜe
.
u¾»sŞv”s
 
impÜt
 
»v”£


20 
äom
 
	g»¡_äamewÜk
.
‹¡
 
impÜt
 
APITe¡Ca£


21 
äom
 
»¡_äamewÜk
 
impÜt
 
¡©us


23 
äom
 
	gsv”
.
mod–s
 
impÜt
 
Provid”


24 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
impÜt
 
	gProvid”FaùÜy
, 
AdmšU£rFaùÜy


25 
äom
 
	gsv”
.
	g‹¡s
.
uts
 
impÜt
 
bud_absŞu‹_‹¡_u¾


28 
şass
 
	$Te¡Provid”Endpošts
(
APITe¡Ca£
):

30 
def
 
	$£tUp
(
£lf
):

31 
admš_u£r
 = 
AdmšU£rFaùÜy
.
	$ü—‹
()

32 
£lf
.
ş›Á
.
	$fÜû_auth’tiÿ‹
(
u£r
=
admš_u£r
)

34 
def
 
	$_f‹r_´ovid”s
(
£lf
, *
¬gs
, **
kw¬gs
):

35  
Provid”
.
objeùs
.
	$f‹r
(*
¬gs
, **
kw¬gs
)

37 
def
 
	$‹¡_po¡_v®id_´ovid”
(
£lf
):

38 
u¾
 = 
	`»v”£
('provider-list')

39 
d©a
 = {

51 
	}
}

52 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$po¡
(
u¾
, 
d©a
)

54 
ex³ùed_d©a
 = {

55 'Çme': 
u
'TestProviderÃ¡',

56 'com·ny': 
u
'S.C. TimisoarÃ¡ S.R.L',

57 'ema': 
NÚe
,

58 'add»ss_1': 
u
'Address',

59 'add»ss_2': 
NÚe
,

60 'c™y': 
u
'Timisoara',

61 '¡©e': 
NÚe
,

62 'z_code': 
u
'300300',

63 'couÁry': 
u
'RO',

64 'exŒa': 
NÚe
,

71 
	}
}

73 
©Œ
, 
v®ue
 
š
 
	gex³ùed_d©a
.
	$™”™ems
():

74 
as£¹
 
»¥Ú£
.
d©a
[
©Œ
] =ğ
v®ue


76 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_201_CREATED


78 
qs
 = 
£lf
.
	$_f‹r_´ovid”s
()

79 
as£¹
 
qs
.
	`couÁ
() == 1

81 
def
 
	$‹¡_po¡_´ovid”_w™hout_»quœed_f›lds
(
£lf
):

82 
u¾
 = 
	`»v”£
('provider-list')

83 
com¶‘e_d©a
 = {

85 'com·ny': 
u
'S.C. Timisoara S.R.L',

95 
	}
}

96 
»quœed_f›lds
 = ['address_1', 'country', 'city', 'name',

100 
f›ld
 
š
 
	g»quœed_f›lds
:

101 
‹mp_d©a
 = 
com¶‘e_d©a
.
	$cİy
()

102 
Œy
:

103 
‹mp_d©a
.
	$pİ
(
f›ld
)

104 
exû±
 
KeyE¼Ü
:

105 
py‹¡
.
	`xç
("Required field %s for Provider‚ot…rovided"

106 " iÀth‹¡ d©a." % 
f›ld
)

108 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$po¡
(
u¾
, 
‹mp_d©a
)

110 
as£¹
 
»¥Ú£
.
¡©us_code
 == 400

112 
»¥Ú£_™em
 
š
 
»¥Ú£
.
d©a
.
	$™”™ems
():

113 
f›ld_Çme
 = 
»¥Ú£_™em
[0]

114 
f›ld_Çme
 
š
 ['id', 'url']:

117 
v®id_»¥Ú£s
 = [

118 (
f›ld_Çme
, ['This field may‚ot be blank.']),

119 (
f›ld_Çme
, ['This field is„equired.']),

120 (
f›ld_Çme
, ['This field is„equired‡she chosen flow '

122 
as£¹
 
»¥Ú£_™em
 
š
 
v®id_»¥Ú£s


124 
qs
 = 
£lf
.
	$_f‹r_´ovid”s
()

125 
as£¹
 
qs
.
	`couÁ
() == 0

127 
def
 
	$‹¡_g‘_´ovid”s
(
£lf
):

128 
b©ch_size
 = 40

129 
Provid”FaùÜy
.
	$ü—‹_b©ch
(
b©ch_size
)

130 
u¾
 = 
	`»v”£
('provider-list')

131 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

133 
fuÎ_u¾
 = 
NÚe


134 
f›ld
 
š
 
»¥Ú£
.
d©a
:

135 
fuÎ_u¾
 = 
f›ld
.
	`g‘
('u¾', 
NÚe
)

136 
fuÎ_u¾
:

138 
fuÎ_u¾
:

139 
domaš
 = 
fuÎ_u¾
.
	`¥l™
('/')[2]

140 
fuÎ_u¾
 = fuÎ_u¾.
	`¥l™
(
domaš
)[0] + domaš + 
u¾


142 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


143 
as£¹
 
»¥Ú£
.
_h—d”s
['link'] == \

144 ('Lšk', '<' + 
fuÎ_u¾
 + '?page=2>;„el="next", ' +

145 '<' + 
fuÎ_u¾
 + '?page=1>;„el="first", ' +

146 '<' + 
fuÎ_u¾
 + '?page=2>„el="last"')

148 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾
 + '?page=2')

150 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


151 
as£¹
 
»¥Ú£
.
_h—d”s
['link'] == \

152 ('Lšk', '<' + 
fuÎ_u¾
 + '>;„el="prev", ' +

153 '<' + 
fuÎ_u¾
 + '?page=1>;„el="first", ' +

154 '<' + 
fuÎ_u¾
 + '?page=2>„el="last"')

156 
def
 
	$‹¡_POST_bulk_´ovid”s
(
£lf
):

157 
»que¡_body
 = [

159 
u
'city': u'Cit\u01770',

160 
u
'proforma_series': u'ProformaSeries',

161 
u
'name': u'N\xe1me0',

162 
u
'extra': u'Extra0',

163 
u
'default_document_state': u'draft',

164 
u
'country': u'AD',

165 
u
'company': u'Comp\xe1ny0',

166 
u
'flow': u'proforma',

167 
u
'state': u'State0',

168 
u
'invoice_starting_number': 1,

169 
u
'phÚe': 
NÚe
,

170 
u
'live': 
True
,

171 
u
'meta': {"something": [0, 1]},

172 
u
'address_1': u'Add\xe3ress10',

173 
u
'address_2': u'Add\xe5ress20',

174 
u
'proforma_starting_number': 1,

175 
u
'invoice_series': u'InvoiceSeries',

176 
u
'email': u'provider0@email.com',

177 
u
'zip_code': u'0'

178 
	}
},

180 
	gu
'c™y': 
u
'Cit\u01771',

181 
	gu
'´ofÜma_£r›s': 
u
'ProformaSeries',

182 
	gu
'Çme': 
u
'N\xe1me1',

183 
	gu
'exŒa': 
u
'Extra1',

184 
	gu
'deçuÉ_docum’t_¡©e': 
u
'draft',

185 
	gu
'couÁry': 
u
'AD',

186 
	gu
'com·ny': 
u
'Comp\xe1ny1',

187 
	gu
'æow': 
u
'proforma',

188 
	gu
'¡©e': 
u
'State1',

189 
	gu
'invoice_starting_number': 1,

190 
	gu
'phÚe': 
NÚe
,

191 
	gu
'live': 
True
,

192 
	gu
'meta': {"something": [2, 3]},

193 
	gu
'add»ss_1': 
u
'Add\xe3ress11',

194 
	gu
'add»ss_2': 
u
'Add\xe5ress21',

195 
	gu
'proforma_starting_number': 1,

196 
	gu
'švoiû_£r›s': 
u
'InvoiceSeries',

197 
	gu
'ema': 
u
'provider10@email.com',

198 
	gu
'z_code': 
u
'1'

202 
u¾
 = 
»v”£
('provider-list')

203 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
d©a
=
jsÚ
.
dumps
(
»que¡_body
),

204 
cÚ‹Á_ty³
='application/json')

206 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_201_CREATED


207 
as£¹
 
Ën
(
»¥Ú£
.
d©a
) == 2

209 
def
 
	$‹¡_g‘_´ovid”
(
£lf
):

210 
Provid”FaùÜy
.
	$»£t_£qu’û
(1)

211 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

213 
u¾
 = 
	`»v”£
('´ovid”-d‘a', 
kw¬gs
={'pk': 
´ovid”
.
pk
})

215 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

217 
as£¹
 
»¥Ú£
.
¡©us_code
 == 200

219 
£lf_u¾
 = 
	$bud_absŞu‹_‹¡_u¾
(
u¾
)

220 
ex³ùed
 = {

221 'id': 
´ovid”
.
pk
,

222 'u¾': 
£lf_u¾
,

223 'Çme': 
´ovid”
.
Çme
,

224 'com·ny': 
´ovid”
.
com·ny
,

225 'æow': 
´ovid”
.
æow
,

226 'švoiû_£r›s': 
´ovid”
.
švoiû_£r›s
,

227 'švoiû_¡¬tšg_numb”': 
´ovid”
.
švoiû_¡¬tšg_numb”
,

228 '´ofÜma_£r›s': 
´ovid”
.
´ofÜma_£r›s
,

229 '´ofÜma_¡¬tšg_numb”': 
´ovid”
.
´ofÜma_¡¬tšg_numb”
,

230 'ema': 
´ovid”
.
ema
,

231 'add»ss_1': 
´ovid”
.
add»ss_1
,

232 'add»ss_2': 
´ovid”
.
add»ss_2
,

233 'c™y': 
´ovid”
.
c™y
,

234 '¡©e': 
´ovid”
.
¡©e
,

235 'z_code': 
´ovid”
.
z_code
,

236 'couÁry': 
´ovid”
.
couÁry
,

237 'exŒa': 
´ovid”
.
exŒa
,

238 'm‘a': {
u
'something': [1, 2]},

239 
	}
}

240 
as£¹
 
»¥Ú£
.
d©a
 =ğ
ex³ùed


242 
def
 
	$‹¡_g‘_uÃxi¡šg_´ovid”
(
£lf
):

243 
u¾
 = 
	`»v”£
('´ovid”-d‘a', 
kw¬gs
={'pk': 1
	}
})

244 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

246 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_404_NOT_FOUND


248 
def
 
	$‹¡_put_´ovid”_cÜ»ùly
(
£lf
):

249 
Provid”FaùÜy
.
	$»£t_£qu’û
(1)

250 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

252 
u¾
 = 
	`»v”£
('´ovid”-d‘a', 
kw¬gs
={'pk': 
´ovid”
.
pk
})

253 
Ãw_d©a
 = {

254 'id': 
´ovid”
.
pk
,

267 #TODO: 
add
 
Ãw
 
m‘a
 
JSON
 
v®ue


270 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$put
(
u¾
, 
d©a
=
Ãw_d©a
)

272 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


274 
£lf_u¾
 = 
	$bud_absŞu‹_‹¡_u¾
(
u¾
)

275 
as£¹
 
»¥Ú£
.
d©a
 == {

276 'id': 
´ovid”
.
pk
,

277 'u¾': 
£lf_u¾
,

278 'Çme': 
Ãw_d©a
['name'],

279 'com·ny': 
Ãw_d©a
['company'],

280 'æow': 
´ovid”
.
æow
,

281 'ema': 
Ãw_d©a
['email'],

282 'add»ss_1': 
Ãw_d©a
['address_1'],

283 'add»ss_2': 
´ovid”
.
add»ss_2
,

284 'c™y': 
Ãw_d©a
['city'],

285 '¡©e': 
´ovid”
.
¡©e
,

286 'z_code': 
Ãw_d©a
['zip_code'],

287 'couÁry': 
Ãw_d©a
['country'],

288 'exŒa': 
´ovid”
.
exŒa
,

289 'æow': 
Ãw_d©a
['flow'],

290 'švoiû_£r›s': 
Ãw_d©a
['invoice_series'],

291 'švoiû_¡¬tšg_numb”': 
Ãw_d©a
['invoice_starting_number'],

292 '´ofÜma_£r›s': 
Ãw_d©a
['proforma_series'],

293 '´ofÜma_¡¬tšg_numb”': 
Ãw_d©a
['proforma_starting_number'],

294 'm‘a': 
´ovid”
.
m‘a
,

295 
	}
}

297 
def
 
	$‹¡_put_´ovid”_w™hout_»quœed_f›ld
(
£lf
):

299 .. 
nÙe
::

301 
The
 
‹¡
 
dÛs
 
nÙ
 
v”ify
 
—ch
 
»quœed
 
f›ld
, 
beÿu£
 
the
est

302 
‹¡_ü—‹_´ovid”_w™hout_»quœed_f›lds
 
dÛs
 
this
 
ªd
 
sšû
 
the


303 
ü—tiÚ
 
wl
 
ç
 
the
 
upd©e
 wÈç 
too
. 
This
 
is
 
mÜe
 
of
 
a


304 
§n™y
 
‹¡
, 
to
 
check
 
the
 
cÜ»ù
 
v›w
 
is
 
ÿÎed
 
ªd
 
™
 
dÛs


305 
wh©
's supposedo do for‡t†east one field.

308 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

310 
u¾
 = 
	`»v”£
('´ovid”-d‘a', 
kw¬gs
={'pk': 
´ovid”
.
pk
})

311 
Ãw_d©a
 = {

312 'id': 
´ovid”
.
pk
,

323 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$put
(
u¾
, 
d©a
=
Ãw_d©a
)

325 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_400_BAD_REQUEST


326 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'Çme': ['Thi f›ld i »quœed.']
	}
}

328 
def
 
	$‹¡_·tch_´ovid”
(
£lf
):

329 
Provid”FaùÜy
.
	$»£t_£qu’û
(1)

330 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

332 
u¾
 = 
	`»v”£
('´ovid”-d‘a', 
kw¬gs
={'pk': 
´ovid”
.
pk
})

334 
Ãw_d©a
 = {

335 'com·ny': 'TheNewCom·ny', #Th
chªged
 
f›ld


344 'couÁry': 
u
'AL',

347 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$·tch
(
u¾
, 
d©a
=
Ãw_d©a
)

349 
as£¹
 
»¥Ú£
.
¡©us_code
 == 200

351 
£lf_u¾
 = 
	$bud_absŞu‹_‹¡_u¾
(
u¾
)

352 
as£¹
 
»¥Ú£
.
d©a
 == {

353 'id': 
´ovid”
.
pk
,

354 'u¾': 
£lf_u¾
,

355 'Çme': 
´ovid”
.
Çme
,

356 'com·ny': 
Ãw_d©a
['company'],

357 'æow': 
Ãw_d©a
['flow'],

358 'švoiû_£r›s': 
Ãw_d©a
['invoice_series'],

359 'švoiû_¡¬tšg_numb”': 
Ãw_d©a
['invoice_starting_number'],

360 '´ofÜma_£r›s': 
Ãw_d©a
['proforma_series'],

361 '´ofÜma_¡¬tšg_numb”': 
Ãw_d©a
['proforma_starting_number'],

362 'ema': 
´ovid”
.
ema
,

363 'add»ss_1': 
Ãw_d©a
['address_1'],

364 'add»ss_2': 
´ovid”
.
add»ss_2
,

365 'c™y': 
Ãw_d©a
['city'],

366 '¡©e': 
´ovid”
.
¡©e
,

367 'z_code': 
Ãw_d©a
['zip_code'],

368 'couÁry': 
Ãw_d©a
['country'],

369 'exŒa': 
´ovid”
.
exŒa
,

370 'm‘a': 
´ovid”
.
m‘a
,

371 
	}
}

373 
def
 
	$‹¡_d–‘e_´ovid”
(
£lf
):

374 
´ovid”
 = 
Provid”FaùÜy
.
	$ü—‹
()

376 
u¾
 = 
	`»v”£
('´ovid”-d‘a', 
kw¬gs
={'pk': 
´ovid”
.
pk
})

377 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$d–‘e
(
u¾
)

379 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_204_NO_CONTENT


381 
def
 
	$‹¡_d–‘e_uÃxi¡šg_´ovid”
(
£lf
):

382 
u¾
 = 
	`»v”£
('´ovid”-d‘a', 
kw¬gs
={'pk': 1
	}
})

383 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$d–‘e
(
u¾
)

385 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_404_NOT_FOUND


	@silver/tests/spec/test_subscription.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
d©‘ime


17 
impÜt
 
jsÚ


19 
äom
 
ä“zegun
 
impÜt
 
ä“ze_time


20 
äom
 
»¡_äamewÜk
 
impÜt
 
¡©us


21 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

22 
äom
 
	g»¡_äamewÜk
.
‹¡
 
impÜt
 
APITe¡Ca£


24 
äom
 
	gsv”
.
mod–s
 
impÜt
 
SubsütiÚ


25 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
AdmšU£rFaùÜy
, 
Cu¡om”FaùÜy
,

26 
PÏnFaùÜy
, 
SubsütiÚFaùÜy
,

27 
M‘”edF—tu»FaùÜy
)

30 
şass
 
	$Te¡SubsütiÚEndpošt
(
APITe¡Ca£
):

31 
def
 
	$£tUp
(
£lf
):

32 
admš_u£r
 = 
AdmšU£rFaùÜy
.
	$ü—‹
()

33 
£lf
.
ş›Á
.
	$fÜû_auth’tiÿ‹
(
u£r
=
admš_u£r
)

35 
def
 
	$‹¡_ü—‹_po¡_subsütiÚ
(
£lf
):

36 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
()

37 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

39 
¶ª_u¾
 = 
	`»v”£
('¶ª-d‘a', 
kw¬gs
={'pk': 
¶ª
.
pk
})

41 
u¾
 = 
»v”£
('subsütiÚ-li¡', 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
})

43 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
jsÚ
.
dumps
({

44 "¶ª": 
¶ª_u¾
,

47 }), 
cÚ‹Á_ty³
='application/json')

48 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_201_CREATED


50 
def
 
	$‹¡_ü—‹_po¡_subsütiÚ_»ã»nû
(
£lf
):

51 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
()

52 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

54 
¶ª_u¾
 = 
	`»v”£
('¶ª-d‘a', 
kw¬gs
={'pk': 
¶ª
.
pk
})

56 
u¾
 = 
»v”£
('subsütiÚ-li¡', 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
})

58 
‹¡_»ã»nû
 = 'test„eference'

59 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
jsÚ
.
dumps
({

60 "¶ª": 
¶ª_u¾
,

62 "»ã»nû": 
‹¡_»ã»nû
,

63 }), 
cÚ‹Á_ty³
='application/json')

65 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_201_CREATED


67 
as£¹
 
»¥Ú£
.
d©a
["»ã»nû"] =ğ
‹¡_»ã»nû


69 
def
 
	$‹¡_ü—‹_po¡_subsütiÚ_desütiÚ
(
£lf
):

70 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
()

71 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

73 
¶ª_u¾
 = 
	`»v”£
('¶ª-d‘a', 
kw¬gs
={'pk': 
¶ª
.
pk
})

75 
u¾
 = 
»v”£
('subsütiÚ-li¡', 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
})

77 
‹¡_desütiÚ
 = 'test description'

78 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
jsÚ
.
dumps
({

79 "¶ª": 
¶ª_u¾
,

81 "desütiÚ": 
‹¡_desütiÚ
,

82 }), 
cÚ‹Á_ty³
='application/json')

84 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_201_CREATED


86 
as£¹
 
»¥Ú£
.
d©a
["desütiÚ"] =ğ
‹¡_desütiÚ


88 
def
 
	$‹¡_ü—‹_po¡_subsütiÚ_w™h_šv®id_ŒŸl_’d
(
£lf
):

89 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
()

90 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

92 
¶ª_u¾
 = 
	`»v”£
('¶ª-d‘a', 
kw¬gs
={'pk': 
¶ª
.
pk
})

94 
u¾
 = 
»v”£
('subsütiÚ-li¡', 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
})

96 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
jsÚ
.
dumps
({

97 "¶ª": 
¶ª_u¾
,

100 }), 
cÚ‹Á_ty³
='application/json')

102 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_400_BAD_REQUEST


104 
def
 
	$‹¡_aùiv©e_subsütiÚ
(
£lf
):

105 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

106 
u¾
 = 
	`»v”£
('sub-activate',

107 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

108 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
})

110 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
cÚ‹Á_ty³
='application/json')

112 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


113 
as£¹
 
»¥Ú£
.
d©a
 == {'state': 'active'}

115 
def
 
	$‹¡_aùiv©e_subsütiÚ_äom_‹rmš®_¡©e
(
£lf
):

116 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

117 
subsütiÚ
.
	$aùiv©e
()

118 
subsütiÚ
.
	$ÿnûl
(
wh’
=
SubsütiÚ
.
CANCEL_OPTIONS
.
NOW
)

119 
subsütiÚ
.
	$§ve
()

121 
u¾
 = 
	`»v”£
('sub-activate',

122 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

123 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
})

125 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
cÚ‹Á_ty³
='application/json')

127 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_400_BAD_REQUEST


128 
as£¹
 
»¥Ú£
.
d©a
 == {

129 '”rÜ': 
u
'Cannot‡ctivate subscription from canceled state.'

132 @
ä“ze_time
('2017-02-05')

133 
def
 
	$‹¡_ÿnûl_subsütiÚ
(
£lf
):

134 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

135 
subsütiÚ
.
	$aùiv©e
()

136 
subsütiÚ
.
	$§ve
()

138 
u¾
 = 
	`»v”£
('sub-cancel',

139 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

140 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
})

142 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
jsÚ
.
dumps
({

143 "wh’": "’d_of_blšg_cyşe"}), 
cÚ‹Á_ty³
='application/json')

145 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


146 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'¡©e': 
SubsütiÚ
.
STATES
.
CANCELED
}

148 
subsütiÚ
 = 
SubsütiÚ
.
objeùs
.
	$g‘
(
pk
=
subsütiÚ
.pk)

149 
as£¹
 
subsütiÚ
.
¡©e
 =ğ
SubsütiÚ
.
STATES
.
CANCELED


150 
as£¹
 
subsütiÚ
.
ÿnûl_d©e
 =ğ
d©‘ime
.
	$d©e
(2017, 2, 28)

152 
def
 
	$‹¡_ÿnûl_subsütiÚ_äom_‹rmš®_¡©e
(
£lf
):

153 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

155 
u¾
 = 
	`»v”£
('sub-cancel',

156 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

157 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
})

159 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
jsÚ
.
dumps
({

160 "wh’": "’d_of_blšg_cyşe"}), 
cÚ‹Á_ty³
='application/json')

162 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_400_BAD_REQUEST


163 
as£¹
 
»¥Ú£
.
d©a
 == {

164 '”rÜ': 
u
'Cannot cancel subscription from inactive state.'

167 
as£¹
 
subsütiÚ
.
¡©e
 =ğ
SubsütiÚ
.
STATES
.
INACTIVE


169 
def
 
	$‹¡_’d_subsütiÚ
(
£lf
):

170 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

171 
subsütiÚ
.
	$aùiv©e
()

172 
subsütiÚ
.
	$§ve
()

174 
u¾
 = 
	`»v”£
('sub-cancel',

175 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

176 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
})

178 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
jsÚ
.
dumps
({

179 "wh’": "now"}), 
cÚ‹Á_ty³
='application/json')

181 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


182 
as£¹
 
»¥Ú£
.
d©a
 == {'state': 'canceled'}

184 
def
 
	$‹¡_’d_subsütiÚ_äom_‹rmš®_¡©e
(
£lf
):

185 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

187 
u¾
 = 
	`»v”£
('sub-cancel',

188 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

189 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
})

191 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
jsÚ
.
dumps
({

192 "wh’": "now"}), 
cÚ‹Á_ty³
='application/json')

194 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_400_BAD_REQUEST


195 
as£¹
 
»¥Ú£
.
d©a
 == {

196 '”rÜ': 
u
'Cannot cancel subscription from inactive state.'

199 
def
 
	$‹¡_»aùiv©e_subsütiÚ
(
£lf
):

200 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

201 
subsütiÚ
.
	$aùiv©e
()

202 
subsütiÚ
.
	$ÿnûl
(
wh’
=
SubsütiÚ
.
CANCEL_OPTIONS
.
NOW
)

203 
subsütiÚ
.
	$§ve
()

205 
u¾
 = 
	`»v”£
('sub-reactivate',

206 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

207 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
})

209 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
cÚ‹Á_ty³
='application/json')

211 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


212 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'¡©e': 
SubsütiÚ
.
STATES
.
ACTIVE
}

214 
def
 
	$‹¡_»aùiv©e_subsütiÚ_äom_‹rmš®_¡©e
(
£lf
):

215 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

216 
subsütiÚ
.
	$aùiv©e
()

217 
subsütiÚ
.
	$ÿnûl
(
wh’
=
SubsütiÚ
.
CANCEL_OPTIONS
.
NOW
)

218 
subsütiÚ
.
	$’d
()

219 
subsütiÚ
.
	$§ve
()

221 
u¾
 = 
	`»v”£
('sub-reactivate',

222 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

223 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
})

225 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
cÚ‹Á_ty³
='application/json')

227 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_400_BAD_REQUEST


228 
as£¹
 
»¥Ú£
.
d©a
 == {

229 '”rÜ': 
u
'Cannot„eactivate subscription fromƒnded state.'

232 
def
 
	$‹¡_g‘_subsütiÚ_li¡
(
£lf
):

233 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

234 
SubsütiÚFaùÜy
.
	$ü—‹_b©ch
(40, 
cu¡om”
=customer)

236 
u¾
 = 
	`»v”£
('subscription-list',

237 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
})

239 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

241 
fuÎ_u¾
 = 
NÚe


242 
f›ld
 
š
 
»¥Ú£
.
d©a
:

243 
fuÎ_u¾
 = 
f›ld
.
	`g‘
('u¾', 
NÚe
)

244 
fuÎ_u¾
:

246 
fuÎ_u¾
:

247 
domaš
 = 
fuÎ_u¾
.
	`¥l™
('/')[2]

248 
fuÎ_u¾
 = fuÎ_u¾.
	`¥l™
(
domaš
)[0] + domaš + 
u¾


250 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


251 
as£¹
 
»¥Ú£
.
_h—d”s
['link'] == \

252 ('Lšk', '<' + 
fuÎ_u¾
 + '?page=2>;„el="next", ' +

253 '<' + 
fuÎ_u¾
 + '?page=1>;„el="first", ' +

254 '<' + 
fuÎ_u¾
 + '?page=2>„el="last"')

256 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾
 + '?page=2')

258 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


259 
as£¹
 
»¥Ú£
.
_h—d”s
['link'] == \

260 ('Lšk', '<' + 
fuÎ_u¾
 + '>;„el="prev", ' +

261 '<' + 
fuÎ_u¾
 + '?page=1>;„el="first", ' +

262 '<' + 
fuÎ_u¾
 + '?page=2>„el="last"')

264 
def
 
	$‹¡_g‘_subsütiÚ_li¡_»ã»nû_f‹r
(
£lf
):

265 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

266 
subsütiÚs
 = 
SubsütiÚFaùÜy
.
	$ü—‹_b©ch
(3, 
cu¡om”
=customer)

268 
u¾
 = 
	`»v”£
('subscription-list',

269 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
})

271 
»ã»nûs
 = [
subsütiÚ
.
»ã»nû
 subsütiÚ 
š
 
subsütiÚs
]

273 
»ã»nû
 = '?»ã»nû=' + 
»ã»nûs
[0]

274 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾
 + 
»ã»nû
)

276 
as£¹
 
Ën
(
»¥Ú£
.
d©a
) == 1

277 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


279 
»ã»nû
 = '?»ã»nû=' + ','.
	$još
(
»ã»nûs
)

280 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾
 + 
»ã»nû
)

282 
as£¹
 
	`Ën
(
»¥Ú£
.
d©a
) == 3

283 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


285 
»ã»nû
 = '?»ã»nû=' + ','.
	`još
(
»ã»nûs
[:-1]) + ',invalid'

286 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾
 + 
»ã»nû
)

287 
as£¹
 
	`Ën
(
»¥Ú£
.
d©a
) == 2

288 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


290 
def
 
	$‹¡_g‘_subsütiÚ_d‘a
(
£lf
):

291 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

293 
u¾
 = 
	`»v”£
('subscription-detail',

294 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

295 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
})

297 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

299 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


300 
as£¹
 
»¥Ú£
.
d©a
 != []

302 
def
 
	$‹¡_g‘_subsütiÚ_d‘a_uÃxi¡šg
(
£lf
):

303 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

304 
u¾
 = 
	`»v”£
('subscription-detail',

305 
kw¬gs
={'subscription_pk': 42,

306 'cu¡om”_pk': 
cu¡om”
.
pk
})

308 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$g‘
(
u¾
)

310 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_404_NOT_FOUND


311 
as£¹
 
»¥Ú£
.
d©a
 =ğ{
u
'd‘a': u'NÙ found.'
	}
}

313 
def
 
	$‹¡_ü—‹_subsütiÚ_mf_un™s_log_aùive_sub
(
£lf
):

314 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

315 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

317 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

319 
subsütiÚ
.
	$aùiv©e
()

320 
subsütiÚ
.
	$§ve
()

322 
u¾
 = 
	`»v”£
('mf-log-units',

323 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

324 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
,

325 'mf_´oduù_code': 
m‘”ed_ã©u»
.
´oduù_code
})

327 
d©e
 = 
¡r
(
d©‘ime
.d©e.
	$today
())

329 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`·tch
(
u¾
, 
jsÚ
.
	`dumps
({

331 "d©e": 
d©e
,

333 
	}
}), 
	gcÚ‹Á_ty³
='application/json')

335 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


336 
as£¹
 
»¥Ú£
.
d©a
 == {'count': 150}

338 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
jsÚ
.
dumps
({

340 "d©e": 
d©e
,

342 }), 
cÚ‹Á_ty³
='application/json')

344 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


345 
as£¹
 
»¥Ú£
.
d©a
 == {'count': 179}

347 @
ä“ze_time
('2017-01-01')

348 
def
 
	$‹¡_ü—‹_subsütiÚ_mf_un™s_log_sub_ÿnûËd_©_’d_of_mÚth
(
£lf
):

349 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(
¡©e
=
SubsütiÚ
.
STATES
.
CANCELED
,

350 
¡¬t_d©e
=
d©‘ime
.
	`d©e
(2016, 1, 1),

351 
ÿnûl_d©e
=
d©‘ime
.
	$d©e
(2017, 1, 31))

352 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

354 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

356 
subsütiÚ
.
	$aùiv©e
()

357 
subsütiÚ
.
	$§ve
()

359 
u¾
 = 
	`»v”£
('mf-log-units',

360 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

361 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
,

362 'mf_´oduù_code': 
m‘”ed_ã©u»
.
´oduù_code
})

364 
d©e
 = 
¡r
(
d©‘ime
.d©e.
	$today
())

366 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`·tch
(
u¾
, 
jsÚ
.
	`dumps
({

368 "d©e": 
d©e
,

370 
	}
}), 
	gcÚ‹Á_ty³
='application/json')

372 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


373 
as£¹
 
»¥Ú£
.
d©a
 == {'count': 150}

375 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
jsÚ
.
dumps
({

377 "d©e": 
d©e
,

379 }), 
cÚ‹Á_ty³
='application/json')

381 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


382 
as£¹
 
»¥Ú£
.
d©a
 == {'count': 179}

384 @
ä“ze_time
('2017-01-01')

385 
def
 
	$‹¡_ü—‹_subsütiÚ_mf_un™s_log_w™h_sub_ÿnûËd_now
(
£lf
):

386 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(
¡©e
=
SubsütiÚ
.
STATES
.
CANCELED
,

387 
¡¬t_d©e
=
d©‘ime
.
	`d©e
(2016, 1, 1),

388 
ÿnûl_d©e
=
d©‘ime
.
	$d©e
(2017, 1, 1))

389 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

390 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

392 
u¾
 = 
	`»v”£
('mf-log-units',

393 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

394 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
,

395 'mf_´oduù_code': 
m‘”ed_ã©u»
.
´oduù_code
})

397 
d©e
 = 
¡r
(
d©‘ime
.d©e.
	$today
())

399 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`·tch
(
u¾
, 
jsÚ
.
	`dumps
({

401 "d©e": 
d©e
,

403 
	}
}), 
	gcÚ‹Á_ty³
='application/json')

405 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


406 
as£¹
 
»¥Ú£
.
d©a
 == {'count': 150}

408 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
jsÚ
.
dumps
({

410 "d©e": 
d©e
,

412 }), 
cÚ‹Á_ty³
='application/json')

414 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_200_OK


415 
as£¹
 
»¥Ú£
.
d©a
 == {'count': 179}

417 @
ä“ze_time
('2017-01-01')

418 
def
 
	$‹¡_ü—‹_subsütiÚ_mf_un™s_log_w™h_sub_ÿnûËd_befÜe
(
£lf
):

419 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(
¡©e
=
SubsütiÚ
.
STATES
.
CANCELED
,

420 
¡¬t_d©e
=
d©‘ime
.
	`d©e
(2016, 1, 1),

421 
ÿnûl_d©e
=
d©‘ime
.
	$d©e
(2016, 12, 31))

422 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

423 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

425 
u¾
 = 
	`»v”£
('mf-log-units',

426 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

427 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
,

428 'mf_´oduù_code': 
m‘”ed_ã©u»
.
´oduù_code
})

430 
d©e
 = 
¡r
(
d©‘ime
.d©e.
	$today
())

432 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`·tch
(
u¾
, 
jsÚ
.
	`dumps
({

434 "d©e": 
d©e
,

436 
	}
}), 
	gcÚ‹Á_ty³
='application/json')

438 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_400_BAD_REQUEST


439 
as£¹
 
»¥Ú£
.
d©a
 == {"detail": "Date is out of bounds."}

441 
def
 
	$‹¡_ü—‹_subsütiÚ_mf_un™s_log_w™h_uÃxi¡šg_mf
(
£lf
):

442 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

444 
subsütiÚ
.
	$aùiv©e
()

445 
subsütiÚ
.
	$§ve
()

447 
u¾
 = 
	`»v”£
('mf-log-units',

448 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

449 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
,

450 'mf_´oduù_code': '1234'
	}
})

452 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$·tch
(
u¾
)

454 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_404_NOT_FOUND


455 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'d‘a': 'M‘”ed F—tu» NÙ found.'
	}
}

457 
def
 
	$‹¡_ü—‹_subsütiÚ_mf_un™s_log_w™h_šaùive_sub
(
£lf
):

458 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

459 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

460 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

462 
u¾
 = 
	`»v”£
('mf-log-units',

463 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

464 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
,

465 'mf_´oduù_code': 
m‘”ed_ã©u»
.
´oduù_code
})

467 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$·tch
(
u¾
)

469 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


470 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'d‘a': 'SubsütiÚ i šaùive.'
	}
}

472 
def
 
	$‹¡_ü—‹_subsütiÚ_mf_un™s_log_w™h_’ded_sub
(
£lf
):

473 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
(
¡©e
=
SubsütiÚ
.
STATES
.
ENDED
)

474 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

475 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

477 
u¾
 = 
	`»v”£
('mf-log-units',

478 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

479 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
,

480 'mf_´oduù_code': 
m‘”ed_ã©u»
.
´oduù_code
})

482 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$·tch
(
u¾
)

484 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_403_FORBIDDEN


485 
as£¹
 
»¥Ú£
.
d©a
 =ğ{'d‘a': 'SubsütiÚ i ’ded.'
	}
}

487 
def
 
	$‹¡_ü—‹_subsütiÚ_mf_un™s_log_w™h_šv®id_d©e
(
£lf
):

488 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

489 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

491 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

493 
subsütiÚ
.
	$aùiv©e
()

494 
subsütiÚ
.
	$§ve
()

496 
u¾
 = 
	`»v”£
('mf-log-units',

497 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

498 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
,

499 'mf_´oduù_code': 
m‘”ed_ã©u»
.
´oduù_code
})

501 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
jsÚ
.
dumps
({

505 }), 
cÚ‹Á_ty³
='application/json')

507 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_400_BAD_REQUEST


508 
as£¹
 
»¥Ú£
.
d©a
 == {'detail': 'Date is out of bounds.'}

510 
def
 
	$‹¡_ü—‹_subsütiÚ_mf_un™s_log_w™h_šsuffic›Á_d©a
(
£lf
):

511 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

512 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

514 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

516 
subsütiÚ
.
	$aùiv©e
()

517 
subsütiÚ
.
	$§ve
()

519 
u¾
 = 
	`»v”£
('mf-log-units',

520 
kw¬gs
={'subsütiÚ_pk': 
subsütiÚ
.
pk
,

521 'cu¡om”_pk': 
subsütiÚ
.
cu¡om”
.
pk
,

522 'mf_´oduù_code': 
m‘”ed_ã©u»
.
´oduù_code
})

524 
d©a
 = {

530 
f›ld
 
š
 
d©a
:

531 
d©a_cİy
 = 
d©a
.
	$cİy
()

532 
d©a_cİy
.
	$pİ
(
f›ld
)

534 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`·tch
(
u¾
, 
jsÚ
.
	`dumps
(
d©a_cİy
),

535 
cÚ‹Á_ty³
='application/json')

537 
as£¹
 
»¥Ú£
.
¡©us_code
 =ğ
¡©us
.
HTTP_400_BAD_REQUEST


538 
as£¹
 
»¥Ú£
.
d©a
 =ğ{
f›ld
: ['Thi f›ld i »quœed.']
	}
}

	@silver/tests/spec/test_transactions.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
d©‘ime
 
impÜt
 
	gd©‘ime
, 
timed–


16 
äom
 
cŞËùiÚs
 
impÜt
 
Ord”edDiù


17 
äom
 
decim®
 
impÜt
 
Decim®


19 
äom
 
mock
 
impÜt
 
·tch


21 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


22 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
ov”ride_£‰šgs


23 
äom
 
»¡_äamewÜk
 
impÜt
 
¡©us


24 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„ev”£ 
as
 
_»v”£


25 
äom
 
	g»¡_äamewÜk
.
‹¡
 
impÜt
 
APITe¡Ca£


27 
äom
 
	gsv”
.
mod–s
 
impÜt
 
ProfÜma


29 
äom
 
	gsv”
.
mod–s
 
impÜt
 
T¿n§ùiÚ


30 
äom
 
	gsv”
.
	g‹¡s
.
uts
 
impÜt
 
bud_absŞu‹_‹¡_u¾


31 
äom
 
	gsv”
.
	guts
.
·ym’ts
 
impÜt
 
g‘_·ym’t_u¾


33 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
AdmšU£rFaùÜy
, 
T¿n§ùiÚFaùÜy
,

34 
Paym’tM‘hodFaùÜy
, 
InvoiûFaùÜy
,

35 
ProfÜmaFaùÜy
, 
Cu¡om”FaùÜy
,

36 
Docum’tEÁryFaùÜy
)

37 
äom
 
sv”
.
‹¡s
.
fixtu»s
 
	$impÜt
 (
Trigg”edProûssÜ
, 
PAYMENT_PROCESSORS
,

38 
Œigg”ed_´oûssÜ
)

41 
def
 
	$»v”£
(*
¬gs
, **
kw¬gs
):

42  
	`bud_absŞu‹_‹¡_u¾
(
	`_»v”£
(*
¬gs
, **
kw¬gs
))

45 @
	$ov”ride_£‰šgs
(
PAYMENT_PROCESSORS
=PAYMENT_PROCESSORS)

46 
şass
 
	$Te¡T¿n§ùiÚEndpošt
(
APITe¡Ca£
):

47 
def
 
	$£tUp
(
£lf
):

48 
£lf
.
u£r
 = 
AdmšU£rFaùÜy
.
	$ü—‹
()

49 
£lf
.
ş›Á
.
	$fÜû_auth’tiÿ‹
(
u£r
=
£lf
.user)

51 
def
 
	$‹¡_g‘_Œª§ùiÚ
(
£lf
):

52 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

53 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

55 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
·ym’t_m‘hod
=payment_method)

56 
ex³ùed
 = 
£lf
.
	$_Œª§ùiÚ_d©a
(
Œª§ùiÚ
)

58 
w™h
 
	`·tch
('sv”.uts.·ym’ts._g‘_jwt_tok’'è
as
 
mocked_tok’
:

59 
mocked_tok’
.
»tuº_v®ue
 = 'token'

61 
u¾
 = 
	`»v”£
('transaction-detail',

62 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

63 'Œª§ùiÚ_uuid': 
Œª§ùiÚ
.
uuid
})

64 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾
, 
fÜm©
='json')

66 
£lf
.
as£¹Equ®
(
»¥Ú£
.
d©a
, 
	$diù
(
ex³ùed
))

68 
def
 
	$‹¡_li¡_Œª§ùiÚs
(
£lf
):

69 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

70 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

72 
Œª§ùiÚ_1
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
·ym’t_m‘hod
=payment_method)

73 
ex³ùed_t1
 = 
£lf
.
	$_Œª§ùiÚ_d©a
(
Œª§ùiÚ_1
)

74 
Œª§ùiÚ_2
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
·ym’t_m‘hod
=payment_method)

75 
ex³ùed_t2
 = 
£lf
.
	$_Œª§ùiÚ_d©a
(
Œª§ùiÚ_2
)

77 
w™h
 
	`·tch
('sv”.uts.·ym’ts._g‘_jwt_tok’'è
as
 
mocked_tok’
:

78 
mocked_tok’
.
»tuº_v®ue
 = 'token'

80 
u¾
 = 
	`»v”£
('transaction-list',

81 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
})

83 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾
, 
fÜm©
='json')

85 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
[1], 
ex³ùed_t1
)

86 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
[0], 
ex³ùed_t2
)

88 
def
 
	$‹¡_add_Œª§ùiÚ
(
£lf
):

89 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

90 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

92 
’Œy
 = 
	$Docum’tEÁryFaùÜy
(
quªt™y
=1, 
un™_´iû
=200)

93 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
cu¡om”
=customer,

94 
´ofÜma_’Œ›s
=[
’Œy
])

95 
´ofÜma
.
	$issue
()

96 
´ofÜma
.
	$ü—‹_švoiû
()

97 
´ofÜma
.
	$»äesh_äom_db
()

98 
švoiû
 = 
´ofÜma
.
»Ï‹d_docum’t


100 
·ym’t_m‘hod_u¾
 = 
	`»v”£
('payment-method-detail',

101 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

102 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
id
})

104 
švoiû_u¾
 = 
»v”£
('švoiû-d‘a', 
¬gs
=[
švoiû
.
pk
])

105 
´ofÜma_u¾
 = 
»v”£
('´ofÜma-d‘a', 
¬gs
=[
´ofÜma
.
pk
])

107 
u¾
 = 
»v”£
('payment-method-transaction-list',

108 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

109 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
})

111 
v®id_uÁ
 = 
d©‘ime
.
now
().
»¶aû
(
miüo£cÚd
=0è+ 
	$timed–
(
mšu‹s
=30)

113 
cu¼’cy
 = 
švoiû
.
Œª§ùiÚ_cu¼’cy


115 
d©a
 = {

116 '·ym’t_m‘hod': 
	`»v”£
('payment-method-detail',

117 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

118 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
id
}),

119 'amouÁ': 
švoiû
.
tÙ®_š_Œª§ùiÚ_cu¼’cy
,

120 'švoiû': 
švoiû_u¾
,

121 '´ofÜma': 
´ofÜma_u¾
,

122 'v®id_uÁ': 
v®id_uÁ
,

123 'cu¼’cy': 
cu¼’cy
,

124 
	}
}

126 
	g»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

128 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_201_CREATED
)

130 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['·ym’t_m‘hod'], 
·ym’t_m‘hod_u¾
)

131 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['v®id_uÁ'][:-1], 
v®id_uÁ
.
	$isofÜm©
())

132 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['ÿn_be_cÚsumed'], 
True
)

133 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['amount'],

134 
	$unicode
(
švoiû
.
tÙ®_š_Œª§ùiÚ_cu¼’cy
))

135 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['švoiû'], 
švoiû_u¾
)

136 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['´ofÜma'], 
´ofÜma_u¾
)

137 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['cu¼’cy'], 
cu¼’cy
)

139 
£lf
.
	`as£¹True
(
T¿n§ùiÚ
.
objeùs
.
	`f‹r
(
uuid
=
»¥Ú£
.
d©a
['id']))

141 
def
 
	$‹¡_add_Œª§ùiÚ_w™hout_docum’ts
(
£lf
):

142 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

143 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

144 
v®id_uÁ
 = 
d©‘ime
.
	`now
().
	$»¶aû
(
miüo£cÚd
=0)

145 
u¾
 = 
	`»v”£
('payment-method-transaction-list',

146 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

147 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
})

148 
d©a
 = {

149 '·ym’t_m‘hod': 
»v”£
('payment-method-detail',

150 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

151 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
id
}),

152 'v®id_uÁ': 
v®id_uÁ
,

156 
	g»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

158 
ex³ùed_d©a
 = {

159 'nÚ_f›ld_”rÜs': [
u
'Theransaction must have‡t†east one billing document '

160 
u
'(invoice or…roforma).']

162 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
, 
ex³ùed_d©a
)

163 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

165 
def
 
	$‹¡_add_Œª§ùiÚ_w™h_d¿á_docum’t
(
£lf
):

166 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

167 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

168 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

169 
´ofÜma_u¾
 = 
	`»v”£
('´ofÜma-d‘a', 
¬gs
=[
´ofÜma
.
pk
])

170 
v®id_uÁ
 = 
d©‘ime
.
	`now
().
	$»¶aû
(
miüo£cÚd
=0)

171 
u¾
 = 
	`»v”£
('payment-method-transaction-list',

172 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

173 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
})

174 
d©a
 = {

175 '·ym’t_m‘hod': 
»v”£
('payment-method-detail',

176 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

177 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
}),

178 'v®id_uÁ': 
v®id_uÁ
,

180 '´ofÜma': 
´ofÜma_u¾


183 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

185 
ex³ùed_d©a
 = {

186 'nÚ_f›ld_”rÜs': [
u
'Theransaction must have‡‚on-draft billing document '

187 
u
'(invoice or…roforma).']

189 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
, 
ex³ùed_d©a
)

190 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

192 
def
 
	$‹¡_add_Œª§ùiÚ_w™h_uÄ–©ed_docum’ts
(
£lf
):

193 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

194 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

196 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

197 
švoiû
.
	$issue
()

199 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

200 
´ofÜma
.
	$issue
()

202 
v®id_uÁ
 = 
d©‘ime
.
	`now
().
	$»¶aû
(
miüo£cÚd
=0)

203 
u¾
 = 
	`»v”£
('payment-method-transaction-list',

204 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

205 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
})

207 
švoiû_u¾
 = 
»v”£
('švoiû-d‘a', 
¬gs
=[
švoiû
.
pk
])

208 
´ofÜma_u¾
 = 
»v”£
('´ofÜma-d‘a', 
¬gs
=[
´ofÜma
.
pk
])

209 
d©a
 = {

210 '·ym’t_m‘hod': 
»v”£
('payment-method-detail',

211 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

212 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
id
}),

213 'v®id_uÁ': 
v®id_uÁ
,

215 'švoiû': 
švoiû_u¾
,

216 '´ofÜma': 
´ofÜma_u¾


219 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

221 
ex³ùed_d©a
 = {

222 'nÚ_f›ld_”rÜs': [
u
'Invoice‡nd…roforma‡re‚ot„elated.']

224 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
, 
ex³ùed_d©a
)

225 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

227 
def
 
	$‹¡_add_Œª§ùiÚ_w™h_docum’ts_fÜ_a_difã»Á_cu¡om”
(
£lf
):

228 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

229 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

231 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

232 
´ofÜma
.
	$issue
()

233 
´ofÜma
.
	$ü—‹_švoiû
()

234 
´ofÜma
.
	$»äesh_äom_db
()

235 
švoiû
 = 
´ofÜma
.
»Ï‹d_docum’t


237 
v®id_uÁ
 = 
d©‘ime
.
	`now
().
	$»¶aû
(
miüo£cÚd
=0)

238 
u¾
 = 
	`»v”£
('payment-method-transaction-list',

239 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

240 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
})

242 
švoiû_u¾
 = 
»v”£
('švoiû-d‘a', 
¬gs
=[
švoiû
.
pk
])

243 
´ofÜma_u¾
 = 
»v”£
('´ofÜma-d‘a', 
¬gs
=[
´ofÜma
.
pk
])

244 
d©a
 = {

245 '·ym’t_m‘hod': 
»v”£
('payment-method-detail',

246 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

247 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
id
}),

248 'v®id_uÁ': 
v®id_uÁ
,

250 'švoiû': 
švoiû_u¾
,

251 '´ofÜma': 
´ofÜma_u¾


254 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

256 
ex³ùed_d©a
 = {

257 'nÚ_f›ld_”rÜs': [
u
"Customer doesn't match withhe one in documents."]

259 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
, 
ex³ùed_d©a
)

260 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

262 
def
 
	$‹¡_add_Œª§ùiÚ_w™hout_cu¼’cy_ªd_amouÁ
(
£lf
):

263 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

264 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

266 
’Œ›s
 = 
Docum’tEÁryFaùÜy
.
	$ü—‹_b©ch
(2)

267 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	`ü—‹
(
cu¡om”
=customer,

268 
¡©e
=
ProfÜma
.
STATES
.
ISSUED
,

269 
issue_d©e
=
timezÚe
.
	`now
().
	`d©e
(),

270 
cu¼’cy
='USD', 
Œª§ùiÚ_cu¼’cy
='RON',

271 
Œª§ùiÚ_xe_¿‹
=
	`Decim®
('0.25'),

272 
´ofÜma_’Œ›s
=
’Œ›s
)

273 
´ofÜma
.
	$ü—‹_švoiû
()

274 
švoiû
 = 
´ofÜma
.
»Ï‹d_docum’t


276 
v®id_uÁ
 = 
d©‘ime
.
	`now
().
	`»¶aû
(
miüo£cÚd
=0è+ 
	$timed–
(
mšu‹s
=30)

277 
u¾
 = 
	`»v”£
('payment-method-transaction-list',

278 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

279 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
})

281 
·ym’t_m‘hod_u¾
 = 
»v”£
('payment-method-detail',

282 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

283 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
id
})

284 
švoiû_u¾
 = 
»v”£
('švoiû-d‘a', 
¬gs
=[
švoiû
.
pk
])

285 
´ofÜma_u¾
 = 
»v”£
('´ofÜma-d‘a', 
¬gs
=[
´ofÜma
.
pk
])

286 
d©a
 = {

287 '·ym’t_m‘hod': 
»v”£
('payment-method-detail',

288 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

289 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
id
}),

290 'v®id_uÁ': 
v®id_uÁ
,

291 'švoiû': 
švoiû_u¾
,

292 '´ofÜma': 
´ofÜma_u¾


295 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

297 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_201_CREATED
)

299 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['·ym’t_m‘hod'], 
·ym’t_m‘hod_u¾
)

300 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['v®id_uÁ'][:-1], 
v®id_uÁ
.
	$isofÜm©
())

301 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['ÿn_be_cÚsumed'], 
True
)

302 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['amount'],

303 
	$unicode
(
švoiû
.
tÙ®_š_Œª§ùiÚ_cu¼’cy
))

304 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['švoiû'], 
švoiû_u¾
)

305 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['´ofÜma'], 
´ofÜma_u¾
)

306 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
['cu¼’cy'], 
švoiû
.
Œª§ùiÚ_cu¼’cy
)

308 
def
 
	$‹¡_add_Œª§ùiÚ_w™h_cu¼’cy_difã»Á_äom_docum’t
(
£lf
):

309 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

310 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

312 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	`ü—‹
(
cu¡om”
=customer,

313 
¡©e
=
ProfÜma
.
STATES
.
ISSUED
,

314 
issue_d©e
=
timezÚe
.
	`now
().
	$d©e
())

315 
´ofÜma
.
	$ü—‹_švoiû
()

316 
švoiû
 = 
´ofÜma
.
»Ï‹d_docum’t


318 
v®id_uÁ
 = 
d©‘ime
.
	`now
().
	$»¶aû
(
miüo£cÚd
=0)

319 
u¾
 = 
	`»v”£
('payment-method-transaction-list',

320 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

321 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
})

323 
švoiû_u¾
 = 
»v”£
('švoiû-d‘a', 
¬gs
=[
švoiû
.
pk
])

324 
´ofÜma_u¾
 = 
»v”£
('´ofÜma-d‘a', 
¬gs
=[
´ofÜma
.
pk
])

325 
d©a
 = {

326 '·ym’t_m‘hod': 
»v”£
('payment-method-detail',

327 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

328 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
id
}),

329 'v®id_uÁ': 
v®id_uÁ
,

331 'amouÁ': 
švoiû
.
tÙ®_š_Œª§ùiÚ_cu¼’cy
,

332 'švoiû': 
švoiû_u¾
,

333 '´ofÜma': 
´ofÜma_u¾


336 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

338 
ex³ùed_d©a
 = {

339 'nÚ_f›ld_”rÜs': [
u
"Transaction currency is different from it's "

340 
u
"document'sransaction_currency."]

342 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
, 
ex³ùed_d©a
)

343 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

345 
def
 
	$‹¡_add_Œª§ùiÚ_w™h_amouÁ_g»©”_thª_wh©_should_be_ch¬ged
(
£lf
):

346 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

347 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

349 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	`ü—‹
(
cu¡om”
=customer,

350 
¡©e
=
ProfÜma
.
STATES
.
ISSUED
,

351 
issue_d©e
=
timezÚe
.
	`now
().
	$d©e
())

352 
´ofÜma
.
	$ü—‹_švoiû
()

353 
švoiû
 = 
´ofÜma
.
»Ï‹d_docum’t


355 
v®id_uÁ
 = 
d©‘ime
.
	`now
().
	$»¶aû
(
miüo£cÚd
=0)

356 
u¾
 = 
	`»v”£
('payment-method-transaction-list',

357 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

358 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
})

360 
švoiû_u¾
 = 
»v”£
('švoiû-d‘a', 
¬gs
=[
švoiû
.
pk
])

361 
´ofÜma_u¾
 = 
»v”£
('´ofÜma-d‘a', 
¬gs
=[
´ofÜma
.
pk
])

362 
d©a
 = {

363 '·ym’t_m‘hod': 
»v”£
('payment-method-detail',

364 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
,

365 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
id
}),

366 'v®id_uÁ': 
v®id_uÁ
,

367 'amouÁ': 
švoiû
.
tÙ®_š_Œª§ùiÚ_cu¼’cy
 + 1,

368 'švoiû': 
švoiû_u¾
,

369 '´ofÜma': 
´ofÜma_u¾


372 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

374 
ex³ùed_d©a
 = {

375 'nÚ_f›ld_”rÜs': [
u
"Amount is greaterhanhe‡mounthat should be charged in "

376 
u
"ordero…ayhe billing document."]

378 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
, 
ex³ùed_d©a
)

379 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

381 
def
 
	$‹¡_·tch_Œª§ùiÚ_w™h_š™Ÿl_¡©us
(
£lf
):

382 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

383 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ


386 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
·ym’t_m‘hod
=payment_method)

388 
u¾
 = 
	`»v”£
('Œª§ùiÚ-d‘a', 
¬gs
=[
Œª§ùiÚ
.
cu¡om”
.
pk
,

389 
Œª§ùiÚ
.
uuid
])

391 
v®id_uÁ
 = 
timezÚe
.
	`now
().
	$»¶aû
(
miüo£cÚd
=0)

393 
d©a
 = {

394 'v®id_uÁ': 
v®id_uÁ
,

395 
	}
}

397 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

399 
£lf
.
as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
,

400 "¡©u %s, d©¨%s" % (
»¥Ú£
.
¡©us_code
,

401 
»¥Ú£
.
d©a
))

403 
	gŒª§ùiÚ
.
	$»äesh_äom_db
()

404 
£lf
.
	$as£¹Equ®
(
Œª§ùiÚ
.
v®id_uÁ
, valid_until)

406 
def
 
	$‹¡_·tch_Œª§ùiÚ_nÙ_®lowed_f›lds
(
£lf
):

407 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

408 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ


411 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
·ym’t_m‘hod
=payment_method)

413 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	`ü—‹
(
¡©e
='issued')

414 
švoiû
 = 
InvoiûFaùÜy
.
	`ü—‹
(
»Ï‹d_docum’t
=
´ofÜma
, 
¡©e
='issued')

415 
´ofÜma
.
»Ï‹d_docum’t
 = 
švoiû


416 
´ofÜma
.
	$§ve
()

418 
švoiû_u¾
 = 
	`»v”£
('švoiû-d‘a', 
¬gs
=[
švoiû
.
pk
])

419 
´ofÜma_u¾
 = 
	`»v”£
('´ofÜma-d‘a', 
¬gs
=[
´ofÜma
.
pk
])

420 
u¾
 = 
	`»v”£
('Œª§ùiÚ-d‘a', 
¬gs
=[
Œª§ùiÚ
.
cu¡om”
.
pk
,

421 
Œª§ùiÚ
.
uuid
])

423 
Ãw_·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

424 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
,

425 
cu¡om”
=
·ym’t_m‘hod
.customer

428 
Ãw_·ym’t_m‘hod_u¾
 = 
	`»v”£
('·ym’t-m‘hod-d‘a', 
kw¬gs
={

429 'cu¡om”_pk': 
Ãw_·ym’t_m‘hod
.
cu¡om”
.
pk
,

430 '·ym’t_m‘hod_id': 
Ãw_·ym’t_m‘hod
.
pk


431 
	}
})

433 
d©a
 = {

434 '´ofÜma': 
´ofÜma_u¾
,

435 'švoiû': 
švoiû_u¾
,

438 '·ym’t_m‘hod': 
Ãw_·ym’t_m‘hod_u¾


441 
»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

443 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

445 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {

446 '´ofÜma': [
u
'This field may‚ot be modified.'],

447 'švoiû': [
u
'This field may‚ot be modified.'],

448 'cu¼’cy': [
u
'This field may‚ot be modified.'],

449 'amouÁ': [
u
'This field may‚ot be modified.'],

450 '·ym’t_m‘hod': [
u
'This field may‚ot be modified.']

451 
	}
})

453 
def
 
	$‹¡_·tch_aá”_š™Ÿl_¡©e
(
£lf
):

454 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
¡©e
=
T¿n§ùiÚ
.
S‹s
.
P’dšg
)

456 
d©a
 = {

457 'v®id_uÁ': 
timezÚe
.
	`now
()

458 
	}
}

460 
u¾
 = 
»v”£
('Œª§ùiÚ-d‘a', 
¬gs
=[
Œª§ùiÚ
.
cu¡om”
.
pk
,

461 
Œª§ùiÚ
.
uuid
])

463 
	g»¥Ú£
 = 
£lf
.
ş›Á
.
·tch
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

465 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

467 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {

468 
u
'non_field_errors': [

469 
u
'Theransaction cannot be modified once it is in…ending state.'

471 
	}
})

473 
def
 
	$‹¡_nÙ_®lowed_m‘hods
(
£lf
):

474 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

475 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

476 
Œª§ùiÚ_1
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(
·ym’t_m‘hod
=payment_method)

477 
v®id_uÁ
 = 
d©‘ime
.
	`now
().
	$»¶aû
(
miüo£cÚd
=0)

478 
u¾
 = 
	`»v”£
('transaction-detail',

479 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
id
,

480 'Œª§ùiÚ_uuid': 
Œª§ùiÚ_1
.
uuid
})

481 
d©a
 = {

482 'v®id_uÁ': 
v®id_uÁ


485 
»¥Ú£
 = 
£lf
.
ş›Á
.
put
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

486 
£lf
.
as£¹Equ®
(
»¥Ú£
.
d©a
['detail'], 'Method "PUT"‚ot‡llowed.')

488 
	g»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

489 
£lf
.
as£¹Equ®
(
»¥Ú£
.
d©a
['detail'], 'Method "POST"‚ot‡llowed.')

491 
def
 
	$‹¡_ü—‹_Úe_w™hout_»quœed_f›lds
(
£lf
):

492 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

493 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
cu¡om”
=customer)

494 
v®id_uÁ
 = 
d©‘ime
.
	`now
().
	$»¶aû
(
miüo£cÚd
=0)

496 
d©a
 = {

497 'v®id_uÁ': 
v®id_uÁ


498 
	}
}

500 
u¾
 = 
»v”£
('payment-method-transaction-list',

501 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
id
,

502 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
id
})

504 
»¥Ú£
 = 
£lf
.
ş›Á
.
po¡
(
u¾
, 
fÜm©
='jsÚ', 
d©a
=data)

506 
£lf
.
as£¹Equ®
(
»¥Ú£
.
d©a
['payment_method'],

509 
def
 
	$‹¡_f‹r_·ym’t_m‘hod
(
£lf
):

510 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
()

511 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

512 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
,

513 
cu¡om”
=customer

516 
Œª§ùiÚ1
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(

517 
·ym’t_m‘hod
=payment_method

519 
Œª§ùiÚ_d©a_1
 = 
£lf
.
	$_Œª§ùiÚ_d©a
(
Œª§ùiÚ1
)

521 
Œª§ùiÚ2
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(

522 
·ym’t_m‘hod
=payment_method

524 
Œª§ùiÚ_d©a_2
 = 
£lf
.
	$_Œª§ùiÚ_d©a
(
Œª§ùiÚ2
)

526 
u¾s
 = [

527 
	`»v”£
(

528 '·ym’t-m‘hod-Œª§ùiÚ-li¡', 
kw¬gs
={

529 'cu¡om”_pk': 
cu¡om”
.
pk
,

530 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
}),

531 
»v”£
(

532 'Œª§ùiÚ-li¡', 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
})]

534 
u¾
 
š
 
u¾s
:

535 
u¾_m‘hod_som•roûssÜ
 = (

536 
u¾
 + '?·ym’t_´oûssÜ=' + 
Œigg”ed_´oûssÜ


539 
u¾_no_ouut
 = 
u¾
 + '?payment_processor=Random'

541 
w™h
 
·tch
('sv”.uts.·ym’ts._g‘_jwt_tok’'è
as
 
mocked_tok’
:

542 
mocked_tok’
.
»tuº_v®ue
 = 'token'

544 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾_m‘hod_som•roûssÜ
, 
fÜm©
='json')

545 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

547 
Œª§ùiÚ1
.
	$»äesh_äom_db
()

548 
Œª§ùiÚ_d©a_1
['upd©ed_©'] = 
»¥Ú£
.
d©a
[1]['updated_at']

550 
Œª§ùiÚ1
.
	$»äesh_äom_db
()

551 
Œª§ùiÚ_d©a_2
['upd©ed_©'] = 
»¥Ú£
.
d©a
[0]['updated_at']

553 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
[1], 
Œª§ùiÚ_d©a_1
)

554 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
[0], 
Œª§ùiÚ_d©a_2
)

556 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾_no_ouut
, 
fÜm©
='json')

557 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

558 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
, [])

560 
def
 
	$‹¡_f‹r_mš_max_amouÁ
(
£lf
):

561 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(

562 
·ym’t_´oûssÜ
=
Œigg”ed_´oûssÜ
,

564 
cu¡om”
 = 
·ym’t_m‘hod
.customer

566 
’Œy
 = 
	$Docum’tEÁryFaùÜy
(
quªt™y
=1, 
un™_´iû
=100)

567 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
švoiû_’Œ›s
=[
’Œy
],

568 
cu¡om”
=customer)

569 
švoiû
.
	$issue
()

571 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	$ü—‹
(

572 
·ym’t_m‘hod
=payment_method,

573 
švoiû
=invoice

576 
Œª§ùiÚ_d©a
 = 
£lf
.
	$_Œª§ùiÚ_d©a
(
Œª§ùiÚ
)

578 
u¾s
 = [

579 
	`»v”£
(

580 '·ym’t-m‘hod-Œª§ùiÚ-li¡', 
kw¬gs
={

581 'cu¡om”_pk': 
cu¡om”
.
pk
,

582 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
}),

583 
»v”£
(

584 'Œª§ùiÚ-li¡', 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
pk
})]

586 
u¾
 
š
 
u¾s
:

587 
u¾_w™h_f‹¿bË_d©a
 = 
u¾
 + '?min_amount=10'

588 
u¾_no_ouut
 = 
u¾
 + '?min_amount=150'

590 
w™h
 
·tch
('sv”.uts.·ym’ts._g‘_jwt_tok’'è
as
 
mocked_tok’
:

591 
mocked_tok’
.
»tuº_v®ue
 = 'token'

593 
»¥Ú£
 = 
£lf
.
ş›Á
.
g‘
(
u¾_w™h_f‹¿bË_d©a
, 
fÜm©
='json')

595 
Œª§ùiÚ
.
	$»äesh_äom_db
()

596 
Œª§ùiÚ_d©a
['upd©ed_©'] = 
»¥Ú£
.
d©a
[0]['updated_at']

598 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

599 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
[0], 
Œª§ùiÚ_d©a
)

601 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾_no_ouut
, 
fÜm©
='json')

602 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

603 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
, [])

605 
u¾_w™h_f‹¿bË_d©a
 = 
u¾
 + '?max_amount=1050'

606 
u¾_no_ouut
 = 
u¾
 + '?max_amount=10'

608 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾_w™h_f‹¿bË_d©a
, 
fÜm©
='json')

610 
Œª§ùiÚ
.
	$»äesh_äom_db
()

611 
Œª§ùiÚ_d©a
['upd©ed_©'] = 
»¥Ú£
.
d©a
[0]['updated_at']

613 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

614 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
[0], 
Œª§ùiÚ_d©a
)

616 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾_no_ouut
, 
fÜm©
='json')

617 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

618 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
d©a
, [])

620 
def
 
	$‹¡_ÿnûl_aùiÚ
(
£lf
):

621 
Œª§ùiÚ_š™Ÿl
 = 
T¿n§ùiÚFaùÜy
.
	`ü—‹
(
¡©e
='initial')

622 
Œª§ùiÚ_³ndšg
 = 
T¿n§ùiÚFaùÜy
.
	`ü—‹
(
¡©e
='pending')

624 
Œª§ùiÚ
 
š
 [
Œª§ùiÚ_š™Ÿl
, 
Œª§ùiÚ_³ndšg
]:

625 
u¾
 = 
	`»v”£
('Œª§ùiÚ-aùiÚ', 
kw¬gs
={

626 'cu¡om”_pk': 
Œª§ùiÚ
.
·ym’t_m‘hod
.
cu¡om”
.
pk
,

627 'Œª§ùiÚ_uuid': 
	`¡r
(
Œª§ùiÚ
.
uuid
),

629 
	}
})

631 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$po¡
(
u¾
)

632 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

634 
Œª§ùiÚ
.
	$»äesh_äom_db
()

635 
£lf
.
	$as£¹Equ®
(
Œª§ùiÚ
.
¡©e
,

636 
T¿n§ùiÚ
.
S‹s
.
CªûËd
)

638 
def
 
	$‹¡_šv®id_Œª§ùiÚ_aùiÚ
(
£lf
):

639 
Œª§ùiÚ
 = 
T¿n§ùiÚFaùÜy
.
	`ü—‹
(
¡©e
='settled')

641 
u¾
 = 
	`»v”£
('Œª§ùiÚ-aùiÚ', 
kw¬gs
={

642 'cu¡om”_pk': 
Œª§ùiÚ
.
·ym’t_m‘hod
.
cu¡om”
.
pk
,

643 'Œª§ùiÚ_uuid': 
	`¡r
(
Œª§ùiÚ
.
uuid
),

645 
	}
})

647 
»¥Ú£
 = 
£lf
.
ş›Á
.
	$po¡
(
u¾
)

648 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_400_BAD_REQUEST
)

650 
ex³ùed_”rÜ
 = "Can'tƒxecute‡ction becauseheransaction is in "\

652 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, {'”rÜs': 
ex³ùed_”rÜ
})

654 
def
 
	$_Œª§ùiÚ_d©a
(
£lf
, 
Œª§ùiÚ
):

655 
Œª§ùiÚ
.
	$»äesh_äom_db
()

657 
·ym’t_m‘hod
 = 
Œª§ùiÚ
.payment_method

658 
cu¡om”
 = 
Œª§ùiÚ
.customer

659 
´ovid”
 = 
Œª§ùiÚ
.provider

660 
´ofÜma
 = 
Œª§ùiÚ
.proforma

661 
švoiû
 = 
Œª§ùiÚ
.invoice

663 
w™h
 
	`·tch
('sv”.uts.·ym’ts._g‘_jwt_tok’'è
as
 
mocked_tok’
:

664 
mocked_tok’
.
»tuº_v®ue
 = 'token'

666  
	`Ord”edDiù
([

667 ('id', 
	`unicode
(
Œª§ùiÚ
.
uuid
)),

668 ('u¾', 
	`»v”£
('transaction-detail',

669 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
id
,

670 'Œª§ùiÚ_uuid': 
Œª§ùiÚ
.
uuid
})),

671 ('cu¡om”', 
»v”£
('cu¡om”-d‘a', 
¬gs
=[
cu¡om”
.
pk
])),

672 ('´ovid”', 
»v”£
('´ovid”-d‘a', 
¬gs
=[
´ovid”
.
pk
])),

673 ('amouÁ', 
unicode
(
Decim®
('0.00'è+ 
Œª§ùiÚ
.
amouÁ
)),

674 ('cu¼’cy', 
unicode
(
Œª§ùiÚ
.
cu¼’cy
)),

675 ('¡©e', 
unicode
(
Œª§ùiÚ
.
¡©e
)),

676 ('´ofÜma', 
»v”£
('´ofÜma-d‘a', 
¬gs
=[
´ofÜma
.
pk
])),

677 ('švoiû', 
»v”£
('švoiû-d‘a', 
¬gs
=[
švoiû
.
pk
])),

678 ('ÿn_be_cÚsumed', 
	gŒª§ùiÚ
.
	gÿn_be_cÚsumed
),

679 ('·ym’t_´oûssÜ', 
	g·ym’t_m‘hod
.
	g·ym’t_´oûssÜ
),

680 ('·ym’t_m‘hod', 
»v”£
('payment-method-detail',

681 
kw¬gs
={'cu¡om”_pk': 
cu¡om”
.
id
,

682 '·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
id
})),

683 ('·y_u¾', 
bud_absŞu‹_‹¡_u¾
(
g‘_·ym’t_u¾
(
Œª§ùiÚ
, 
NÚe
))),

684 ('v®id_uÁ', 
	gNÚe
),

686 ('upd©ed_©', 
	gŒª§ùiÚ
.
	gupd©ed_©
.
isofÜm©
()[:-6] + 'Z'),

687 ('ü—‹d_©', 
	gŒª§ùiÚ
.
	gü—‹d_©
.
isofÜm©
()[:-6] + 'Z'),

688 ('ç_code', 
	gŒª§ùiÚ
.
	gç_code
),

689 ('»fund_code', 
	gŒª§ùiÚ
.
	g»fund_code
),

690 ('ÿnûl_code', 
	gŒª§ùiÚ
.
	gÿnûl_code
)

	@silver/tests/spec/util/__init__.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

	@silver/tests/spec/util/api_get_assert.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
»¡_äamewÜk
 
impÜt
 
¡©us


16 
äom
 
	g»¡_äamewÜk
.
‹¡
 
impÜt
 
APITe¡Ca£


18 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
impÜt
 
AdmšU£rFaùÜy


21 
şass
 
	$APIG‘As£¹
(
APITe¡Ca£
):

22 
£rŸliz”_şass
 = 
NÚe


24 
def
 
	$£tUp
(
£lf
):

25 
admš_u£r
 = 
AdmšU£rFaùÜy
.
	$ü—‹
()

26 
£lf
.
ş›Á
.
	$fÜû_auth’tiÿ‹
(
u£r
=
admš_u£r
)

28 
def
 
	$as£¹_g‘_d©a
(
£lf
, 
u¾
, 
ex³ùed_d©a
):

29 
mªy
 = 
	$isš¡ªû
(
ex³ùed_d©a
, 
li¡
)

30 
»¥Ú£
 = 
£lf
.
ş›Á
.
	`g‘
(
u¾
, 
fÜm©
='json')

31 
»que¡
 = 
»¥Ú£
.
wsgi_»que¡


32 
ex³ùed
 = 
£lf
.
	`£rŸliz”_şass
(
ex³ùed_d©a
,

33 
cÚ‹xt
={'»que¡': 
»que¡
},

34 
	gmªy
=
mªy
).
d©a


36 
£lf
.
	$as£¹Equ®
(
»¥Ú£
.
¡©us_code
, 
¡©us
.
HTTP_200_OK
)

37 
£lf
.
	`as£¹Equ®
(
»¥Ú£
.
d©a
, 
ex³ùed
)

	@silver/tests/tasks/__init__.py

	@silver/tests/tasks/test_generate_pdfs.py

1 
impÜt
 
py‹¡


2 
äom
 
mock
 
impÜt
 
	g·tch
, 
	gÿÎ
, 
MagicMock


4 
äom
 
	gsv”
.
sks
 
impÜt
 
	gg’”©e_pdfs
, 
g’”©e_pdf


5 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
impÜt
 
	gInvoiûFaùÜy
, 
ProfÜmaFaùÜy


7 
äom
 
	gsv”
.
	guts
.
pdf
 
impÜt
 
	gãtch_»sourûs


10 @
	gpy‹¡
.
	gm¬k
.
djªgo_db


11 
def
 
	$‹¡_g’”©e_pdfs_sk
(
mÚkey·tch
):

12 
issued_švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

13 
issued_švoiû
.
	$issue
()

15 
·id_švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

16 
·id_švoiû
.
	$issue
()

17 
·id_švoiû
.
	$·y
()

19 
ÿnûËd_švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

20 
ÿnûËd_švoiû
.
	$issue
()

21 
ÿnûËd_švoiû
.
	$ÿnûl
()

23 
issued_švoiû_®»ady_g’”©ed
 = 
InvoiûFaùÜy
.
	$ü—‹
()

24 
issued_švoiû_®»ady_g’”©ed
.
	$issue
()

25 
issued_švoiû_®»ady_g’”©ed
.
pdf
.
dœty
 = 
F®£


26 
issued_švoiû_®»ady_g’”©ed
.
pdf
.
	$§ve
()

28 
issued_´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

29 
issued_´ofÜma
.
	$issue
()

31 
issued_´ofÜma_®»ady_g’”©ed
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

32 
issued_´ofÜma_®»ady_g’”©ed
.
	$issue
()

33 
issued_´ofÜma_®»ady_g’”©ed
.
pdf
.
dœty
 = 
F®£


34 
issued_´ofÜma_®»ady_g’”©ed
.
pdf
.
	$§ve
()

36 
docum’ts_to_g’”©e
 = [
issued_švoiû
, 
ÿnûËd_švoiû
, 
·id_švoiû
,

37 
issued_´ofÜma
]

39 
docum’t
 
š
 
docum’ts_to_g’”©e
:

40 
as£¹
 
docum’t
.
pdf
.
dœty


42 
lock_mock
 = 
	$MagicMock
()

43 
mÚkey·tch
.
	`£‰r
('sv”.sks.»dis.lock', 
lock_mock
)

45 
w™h
 
	`·tch
('sv”.sks.group'è
as
 
group_mock
:

46 
	$g’”©e_pdfs
()

48 
as£¹
 
group_mock
.
ÿÎ_couÁ


51 @
py‹¡
.
m¬k
.
djªgo_db


52 @
	`·tch
('silver.models.documents.base.BillingDocumentBase.get_template')

53 @
	`·tch
('silver.models.documents.pdf.HttpResponse')

54 
def
 
	$‹¡_g’”©e_pdf_sk
(
mock_h‰p_»¥Ú£
, 
mock_g‘_‹m¶©e
, 
£‰šgs
,

55 
tmpdœ
, 
mÚkey·tch
):

56 
£‰šgs
.
MEDIA_ROOT
 = 
tmpdœ
.
¡½©h


58 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

59 
švoiû
.
	$issue
()

61 
as£¹
 
švoiû
.
pdf
.
dœty


63 
pi§_docum’t_mock
 = 
	$MagicMock
()

65 
mÚkey·tch
.
	`£‰r
('silver.models.documents.pdf.pisa.pisaDocument',

66 
pi§_docum’t_mock
)

68 
	$g’”©e_pdf
(
švoiû
.
id
, invoiû.
kšd
)

70 #pdà
Ãeds
 
to
 
be
 
»äeshed
 
as
 
the
 
švoiû
 
»ã»nû
 
š
h
‹¡
 
is
 
nÙ
h
§me
 
w™h
h
Úe


71 #š 
the
 
sk


72 
švoiû
.
pdf
.
	$»äesh_äom_db
()

74 
as£¹
 
nÙ
 
švoiû
.
pdf
.
dœty


76 
as£¹
 
švoiû
.
pdf
.
u¾
 =ğ
£‰šgs
.
MEDIA_URL
 + invoiû.
	$g‘_pdf_u¶ßd_·th
()

78 
as£¹
 
pi§_docum’t_mock
.
ÿÎ_couÁ
 == 1

79 
pi§_docum’t_mock
.
	`as£¹_ÿÎed_Úû_w™h
(
¤c
=
	`mock_g‘_‹m¶©e
().
	`»nd”
().
	`’code
('UTF-8'),

80 
de¡
=
	`mock_h‰p_»¥Ú£
(),

81 
’codšg
='UTF-8',

82 
lšk_ÿÎback
=
ãtch_»sourûs
)

	@silver/tests/unit/__init__.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

	@silver/tests/unit/test_invoice.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
äom
 
decim®
 
impÜt
 
Decim®


18 
äom
 
d©‘ime
 
impÜt
 
d©e


20 
äom
 
d©‘ime
 
impÜt
 
timed–


21 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
Te¡Ca£


23 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gDocum’tEÁry
, 
	gProfÜma
, 
Invoiû


24 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
ProfÜmaFaùÜy
, 
InvoiûFaùÜy
,

25 
Docum’tEÁryFaùÜy
, 
Cu¡om”FaùÜy
)

28 
şass
 
	$Te¡Invoiû
(
Te¡Ca£
):

29 
def
 
	$‹¡_·y_švoiû_»Ï‹d_´ofÜma_¡©e_chªge_to_·id
(
£lf
):

30 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

31 
´ofÜma
.
	$issue
()

32 
´ofÜma
.
	$ü—‹_švoiû
()

34 
as£¹
 
´ofÜma
.
»Ï‹d_docum’t
.
¡©e
 =ğ
Invoiû
.
STATES
.
ISSUED


36 
´ofÜma
.
»Ï‹d_docum’t
.
	$·y
()

38 
as£¹
 
´ofÜma
.
»Ï‹d_docum’t
.
¡©e
 =ğ
Invoiû
.
STATES
.
PAID


39 
as£¹
 
´ofÜma
.
¡©e
 =ğ
ProfÜma
.
STATES
.
PAID


41 
def
 
	$‹¡_şÚe_švoiû_što_d¿á
(
£lf
):

42 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

43 
švoiû
.
	$issue
()

44 
švoiû
.
	$·y
()

46 
’Œ›s
 = 
Docum’tEÁryFaùÜy
.
	$ü—‹_b©ch
(3)

47 
švoiû
.
švoiû_’Œ›s
.
	$add
(*
’Œ›s
)

49 
şÚe
 = 
švoiû
.
	$şÚe_što_d¿á
()

51 
as£¹
 
şÚe
.
¡©e
 =ğ
Invoiû
.
STATES
.
DRAFT


52 
as£¹
 
şÚe
.
·id_d©e
 
is
 
NÚe


53 
as£¹
 
şÚe
.
issue_d©e
 
is
 
NÚe


54 
as£¹
 
şÚe
.
»Ï‹d_docum’t
 
is
 
NÚe


55 
	`as£¹
 (
şÚe
.
£r›s
 !ğ
švoiû
.£r› 
Ü


56 
şÚe
.
numb”
 !ğ
švoiû
.number)

57 
as£¹
 
şÚe
.
§Ës_x_³rûÁ
 =ğ
švoiû
.sales_tax_percent

58 
as£¹
 
şÚe
.
§Ës_x_Çme
 =ğ
švoiû
.sales_tax_name

60 
as£¹
 
nÙ
 
şÚe
.
¬chived_cu¡om”


61 
as£¹
 
nÙ
 
şÚe
.
¬chived_´ovid”


62 
as£¹
 
şÚe
.
cu¡om”
 =ğ
švoiû
.customer

63 
as£¹
 
şÚe
.
´ovid”
 =ğ
švoiû
.provider

65 
as£¹
 
şÚe
.
cu¼’cy
 =ğ
švoiû
.currency

66 
as£¹
 
şÚe
.
_Ï¡_¡©e
 =ğşÚe.
¡©e


67 
as£¹
 
şÚe
.
pk
 !ğ
švoiû
.pk

68 
as£¹
 
şÚe
.
id
 !ğ
švoiû
.id

69 
as£¹
 
nÙ
 
şÚe
.
pdf


71 
as£¹
 
şÚe
.
švoiû_’Œ›s
.
	`couÁ
() == 3

72 
as£¹
 
švoiû
.
švoiû_’Œ›s
.
	`couÁ
() == 3

74 
’Œy_f›lds
 = [
’Œy
.
Çme
 ’Œy 
š
 
Docum’tEÁry
.
_m‘a
.
	`g‘_f›lds
()]

75 
şÚe_’Œy
, 
Üigš®_’Œy
 
š
 
	`z
(
şÚe
.
švoiû_’Œ›s
.
	`®l
(),

76 
švoiû
.
švoiû_’Œ›s
.
	$®l
()):

77 
’Œy
 
š
 
’Œy_f›lds
:

78 
’Œy
 
nÙ
 
	`š
 ('id', 'proforma', 'invoice'):

79 
as£¹
 
	`g‘©Œ
(
şÚe_’Œy
, 
’Œy
) == \

80 
	$g‘©Œ
(
Üigš®_’Œy
, 
’Œy
)

81 
as£¹
 
švoiû
.
¡©e
 =ğ
Invoiû
.
STATES
.
PAID


83 
def
 
	$‹¡_ÿnûl_issued_švoiû_w™h_»Ï‹d_´ofÜma
(
£lf
):

84 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

85 
´ofÜma
.
	$issue
()

87 
nÙ
 
´ofÜma
.
»Ï‹d_docum’t
:

88 
´ofÜma
.
	$ü—‹_švoiû
()

90 
´ofÜma
.
»Ï‹d_docum’t
.
	$ÿnûl
()

92 
as£¹
 
´ofÜma
.
»Ï‹d_docum’t
.
¡©e
 =ğ´ofÜma.¡©=ğ
Invoiû
.
STATES
.
CANCELED


94 
def
 
	$_g‘_decim®_¶aûs
(
£lf
, 
numb”
):

95  
	`max
(0, -
numb”
.
	`as_tu¶e
().
expÚ’t
)

97 
def
 
	$‹¡_švoiû_tÙ®_decim®_pošts
(
£lf
):

98 
švoiû_’Œ›s
 = 
Docum’tEÁryFaùÜy
.
	$ü—‹_b©ch
(3)

99 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
švoiû_’Œ›s
=invoice_entries)

101 
as£¹
 
£lf
.
	`_g‘_decim®_¶aûs
(
švoiû
.
tÙ®
) == 2

103 
def
 
	$‹¡_švoiû_tÙ®_befÜe_x_decim®_¶aûs
(
£lf
):

104 
švoiû_’Œ›s
 = 
Docum’tEÁryFaùÜy
.
	$ü—‹_b©ch
(3)

105 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
švoiû_’Œ›s
=invoice_entries)

107 
švoiû
.
§Ës_x_³rûÁ
 = 
	`Decim®
('20.00')

109 
as£¹
 
£lf
.
	`_g‘_decim®_¶aûs
(
švoiû
.
tÙ®_befÜe_x
) == 2

111 
def
 
	$‹¡_švoiû_x_v®ue_decim®_¶aûs
(
£lf
):

112 
švoiû_’Œ›s
 = 
Docum’tEÁryFaùÜy
.
	$ü—‹_b©ch
(3)

113 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
švoiû_’Œ›s
=invoice_entries)

115 
švoiû
.
§Ës_x_³rûÁ
 = 
	`Decim®
('20.00')

117 
as£¹
 
£lf
.
	`_g‘_decim®_¶aûs
(
švoiû
.
x_v®ue
) == 2

119 
def
 
	$‹¡_švoiû_tÙ®_w™h_x_š‹gr™y
(
£lf
):

120 
švoiû_’Œ›s
 = 
Docum’tEÁryFaùÜy
.
	$ü—‹_b©ch
(5)

121 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
švoiû_’Œ›s
=invoice_entries)

123 
švoiû
.
§Ës_x_³rûÁ
 = 
	`Decim®
('20.00')

125 
£lf
.
	`as£¹Equ®
(
švoiû
.
tÙ®
, invoiû.
tÙ®_befÜe_x
 + invoiû.
x_v®ue
)

127 
def
 
	$‹¡_d¿á_švoiû_£r›s_numb”
(
£lf
):

128 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
()

129 
švoiû
.
numb”
 = 
NÚe


131 
as£¹
 
švoiû
.
£r›s_numb”
 =ğ'%s-d¿á-id:%d' % (švoiû.
£r›s
,

132 
švoiû
.
pk
)

134 
švoiû
.
£r›s
 = 
NÚe


136 
as£¹
 
švoiû
.
£r›s_numb”
 =ğ'd¿á-id:%d' % invoiû.
pk


138 
def
 
	$‹¡_issues_švoiû_£r›s_numb”
(
£lf
):

139 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
¡©e
=
Invoiû
.
STATES
.
ISSUED
)

141 
as£¹
 
švoiû
.
£r›s_numb”
 =ğ'%s-%s' % (švoiû.
£r›s
,

142 
švoiû
.
numb”
)

144 
def
 
	$‹¡_švoiû_due_today_qu”y£t
(
£lf
):

145 
švoiûs
 = 
InvoiûFaùÜy
.
	$ü—‹_b©ch
(5)

147 
švoiûs
[0].
due_d©e
 = 
d©e
.
	$today
()

148 
švoiûs
[0].
	$§ve
()

150 
švoiûs
[1].
due_d©e
 = 
d©e
.
	$today
()

151 
švoiûs
[1].
	$issue
()

153 
švoiûs
[2].
due_d©e
 = 
d©e
.
	`today
(è- 
	$timed–
(
days
=1)

154 
švoiûs
[2].
	$issue
()

155 
švoiûs
[2].
	$·y
()

157 
švoiûs
[3].
due_d©e
 = 
d©e
.
	$today
()

158 
švoiûs
[3].
	$issue
()

159 
švoiûs
[3].
	$ÿnûl
()

161 
švoiûs
[4].
due_d©e
 = 
d©e
.
	`today
(è+ 
	$timed–
(
days
=1)

162 
švoiûs
[4].
	$issue
()

164 
qu”y£t
 = 
Invoiû
.
objeùs
.
	$due_today
()

166 
as£¹
 
qu”y£t
.
	`couÁ
() == 1

167 
as£¹
 
švoiûs
[1] 
š
 
qu”y£t


169 
def
 
	$‹¡_švoiû_due_this_mÚth_qu”y£t
(
£lf
):

170 
švoiûs
 = 
InvoiûFaùÜy
.
	$ü—‹_b©ch
(4)

172 
švoiûs
[0].
due_d©e
 = 
d©e
.
	`today
().
	$»¶aû
(
day
=20)

173 
švoiûs
[0].
	$issue
()

175 
švoiûs
[1].
due_d©e
 = 
d©e
.
	`today
().
	$»¶aû
(
day
=1)

176 
švoiûs
[1].
	$issue
()

178 
švoiûs
[2].
due_d©e
 = 
d©e
.
	`today
(è- 
	$timed–
(
days
=31)

179 
švoiûs
[2].
	$issue
()

181 
švoiûs
[3].
	$issue
()

182 
švoiûs
[3].
	$ÿnûl
()

184 
qu”y£t
 = 
Invoiû
.
objeùs
.
	$due_this_mÚth
()

186 
as£¹
 
qu”y£t
.
	`couÁ
() == 2

187 
švoiû
 
š
 
švoiûs
[:2]:

188 
as£¹
 
švoiû
 
š
 
qu”y£t


190 
def
 
	$‹¡_švoiû_ov”due_qu”y£t
(
£lf
):

191 
švoiûs
 = 
InvoiûFaùÜy
.
	$ü—‹_b©ch
(3)

193 
švoiûs
[0].
due_d©e
 = 
d©e
.
	`today
(è- 
	$timed–
(
days
=1)

194 
švoiûs
[0].
	$issue
()

196 
švoiûs
[1].
due_d©e
 = 
d©e
.
	`today
(è- 
	$timed–
(
days
=3)

197 
švoiûs
[1].
	$issue
()

199 
švoiûs
[2].
due_d©e
 = 
d©e
.
	`today
(è- 
	$timed–
(
days
=31)

200 
švoiûs
[2].
	$issue
()

201 
švoiûs
[2].
	$·y
()

203 
qu”y£t
 = 
Invoiû
.
objeùs
.
	$ov”due
()

205 
as£¹
 
qu”y£t
.
	`couÁ
() == 2

206 
švoiû
 
š
 
švoiûs
[:2]:

207 
as£¹
 
švoiû
 
š
 
qu”y£t


209 
def
 
	$‹¡_švoiû_ov”due_sšû_Ï¡_mÚth_qu”y£t
(
£lf
):

210 
švoiûs
 = 
InvoiûFaùÜy
.
	$ü—‹_b©ch
(3)

212 
švoiûs
[0].
due_d©e
 = 
d©e
.
	`today
().
	$»¶aû
(
day
=1)

213 
švoiûs
[0].
	$issue
()

215 
švoiûs
[1].
due_d©e
 = 
d©e
.
	`today
(è- 
	$timed–
(
days
=31)

216 
švoiûs
[1].
	$issue
()

218 
qu”y£t
 = 
Invoiû
.
objeùs
.
	$ov”due_sšû_Ï¡_mÚth
()

220 
as£¹
 
qu”y£t
.
	`couÁ
() == 1

221 
as£¹
 
švoiûs
[1] 
š
 
qu”y£t


223 
def
 
	$‹¡_cu¡om”_cu¼’cy_u£d_fÜ_Œª§ùiÚ_cu¼’cy
(
£lf
):

224 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(
cu¼’cy
='EUR')

225 
švoiû
 = 
InvoiûFaùÜy
.
	$ü—‹
(
cu¡om”
=customer,

226 
Œª§ùiÚ_cu¼’cy
=
NÚe
)

228 
£lf
.
	`as£¹Equ®
(
švoiû
.
Œª§ùiÚ_cu¼’cy
, 'EUR')

230 
def
 
	$‹¡_švoiû_cu¼’cy_u£d_fÜ_Œª§ùiÚ_cu¼’cy
(
£lf
):

231 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
(
cu¼’cy
=
NÚe
)

232 
švoiû
 = 
InvoiûFaùÜy
.
	`ü—‹
(
cu¡om”
=customer,

233 
cu¼’cy
='EUR',

234 
Œª§ùiÚ_cu¼’cy
=
NÚe
)

236 
£lf
.
	`as£¹Equ®
(
švoiû
.
Œª§ùiÚ_cu¼’cy
, 'EUR')

	@silver/tests/unit/test_payment_method_serializer.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

14 
äom
 
cŞËùiÚs
 
impÜt
 
Ord”edDiù


16 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
	gTe¡Ca£
, 
ov”ride_£‰šgs


17 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


18 
äom
 
	g»¡_äamewÜk
.
»nd””s
 
impÜt
 
JSONR’d””


19 
äom
 
	g»¡_äamewÜk
.
‹¡
 
impÜt
 
APIReque¡FaùÜy


20 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

22 
äom
 
	gsv”
.
	g­i
.
	g£rŸliz”s
.
·ym’t_m‘hods_£rŸliz”s
 
impÜt
 
Paym’tM‘hodS”Ÿliz”


23 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
impÜt
 
Paym’tM‘hodFaùÜy


24 
äom
 
	gsv”
.
	g‹¡s
.
fixtu»s
 
	$impÜt
 (
PAYMENT_PROCESSORS
, 
mªu®_´oûssÜ
,

25 
Mªu®ProûssÜ
)

26 
äom
 
sv”
.
‹¡s
.
uts
 
impÜt
 
bud_absŞu‹_‹¡_u¾


29 @
	$ov”ride_£‰šgs
(
PAYMENT_PROCESSORS
=PAYMENT_PROCESSORS)

30 
şass
 
	$Te¡Paym’tM‘hodS”Ÿliz”
(
Te¡Ca£
):

31 
def
 
	$‹¡_’codšg
(
£lf
):

32 
now
 = 
timezÚe
.
	`now
().
	$»¶aû
(
miüo£cÚd
=0)

33 
·ym’t_m‘hod
 = 
Paym’tM‘hodFaùÜy
.
	$ü—‹
(
added_©
=
now
)

35 
çùÜy
 = 
	$APIReque¡FaùÜy
()

36 
u¾
 = 
	`»v”£
('payment-method-detail',

37 
kw¬gs
={'·ym’t_m‘hod_id': 
·ym’t_m‘hod
.
pk
,

38 'cu¡om”_pk': 
·ym’t_m‘hod
.
cu¡om”
.
pk
})

39 
»que¡
 = 
çùÜy
.
g‘
(
u¾
, 
fÜm©
='json')

41 
£rŸliz”
 = 
Paym’tM‘hodS”Ÿliz”
(
·ym’t_m‘hod
, 
cÚ‹xt
={

42 '»que¡': 
»que¡


45 
£lf_u¾
 = 
	$bud_absŞu‹_‹¡_u¾
(
u¾
)

46 
Œª§ùiÚs_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(

47 
	`»v”£
('payment-method-transaction-list',

48 [
·ym’t_m‘hod
.
pk
,…aym’t_m‘hod.
cu¡om”
.pk])

50 
cu¡om”_u¾
 = 
	`bud_absŞu‹_‹¡_u¾
(

51 
	`»v”£
('cu¡om”-d‘a', [
·ym’t_m‘hod
.
cu¡om”
.
pk
])

53 
ex³ùed_d©a
 = 
	`Ord”edDiù
([

54 ('u¾', 
£lf_u¾
),

55 ('Œª§ùiÚs', 
Œª§ùiÚs_u¾
),

56 ('cu¡om”', 
cu¡om”_u¾
),

57 ('·ym’t_´oûssÜ_Çme', 
mªu®_´oûssÜ
),

58 ('·ym’t_´oûssÜ', 
	`Ord”edDiù
([

59 ("ty³", 
Mªu®ProûssÜ
.
ty³
),

60 ("Çme", 
mªu®_´oûssÜ
),

62 ("u¾", 
	`bud_absŞu‹_‹¡_u¾
(
	`»v”£
('payment-processor-detail', ['manual'])))

64 ('added_©', 
·ym’t_m‘hod
.
added_©
),

65 ('v”if›d', 
F®£
),

66 ('ÿnûËd', 
F®£
),

67 ('v®id_uÁ', 
NÚe
),

68 ('di¥Ïy_šfo', 
NÚe
),

71 
jsÚ
 = 
	`JSONR’d””
().
	$»nd”
(
£rŸliz”
.
d©a
)

72 
£lf
.
	`as£¹Equ®
(
jsÚ
, 
	`JSONR’d””
().
	`»nd”
(
ex³ùed_d©a
))

	@silver/tests/unit/test_payments_util.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

14 
äom
 
uuid
 
impÜt
 
UUID


15 
äom
 
d©‘ime
 
impÜt
 
	gd©‘ime
, 
timed–


17 
äom
 
mock
 
impÜt
 
	g·tch
, 
	gMagicMock
, 
ÿÎ


19 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
	gTe¡Ca£
, 
ov”ride_£‰šgs


21 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
impÜt
 
T¿n§ùiÚFaùÜy


22 
äom
 
	gsv”
.
	g‹¡s
.
fixtu»s
 
impÜt
 
PAYMENT_PROCESSORS


24 
äom
 
	gsv”
.
	guts
.
decÜ©Üs
 
impÜt
 
g‘_Œª§ùiÚ_äom_tok’


25 
äom
 
	gsv”
.
	guts
.
·ym’ts
 
impÜt
 (
g‘_·ym’t_u¾
, 
g‘_·ym’t_com¶‘e_u¾
,

26 
_g‘_jwt_tok’
)

29 @
	$ov”ride_£‰šgs
(
PAYMENT_PROCESSORS
=PAYMENT_PROCESSORS)

30 
şass
 
	$Te¡Paym’tsUtM‘hods
(
Te¡Ca£
):

31 
def
 
	$‹¡_g‘_·ym’t_u¾
(
£lf
):

32 
Œª§ùiÚ
 = 
	$T¿n§ùiÚFaùÜy
()

34 
ex³ùed_u¾
 = '/pay/token/'

35 
w™h
 
	`·tch
('sv”.uts.·ym’ts._g‘_jwt_tok’'è
as
 
mocked_tok’
:

36 
mocked_tok’
.
»tuº_v®ue
 = 'token'

38 
£lf
.
	`as£¹Equ®
(
	`g‘_·ym’t_u¾
(
Œª§ùiÚ
, 
NÚe
), 
ex³ùed_u¾
)

40 
mocked_tok’
.
	$as£¹_ÿÎed_Úû_w™h
(
Œª§ùiÚ
)

42 
def
 
	$‹¡_g‘_·ym’t_com¶‘e_u¾
(
£lf
):

43 
Œª§ùiÚ
 = 
	$T¿n§ùiÚFaùÜy
()

45 
ex³ùed_u¾
 = '/pay/token/complete?return_url=http://google.com'

46 
mocked_»que¡
 = 
	`MagicMock
(
GET
={'»tuº_u¾': 'h‰p://googË.com'
	}
},

47 
	gv”siÚšg_scheme
=
NÚe
)

48 
mocked_»que¡
.
bud_absŞu‹_uri
.
»tuº_v®ue
 = '/pay/token/complete'

50 
w™h
 
·tch
('sv”.uts.·ym’ts._g‘_jwt_tok’'è
as
 
mocked_tok’
:

51 
mocked_tok’
.
»tuº_v®ue
 = 'token'

53 
£lf
.
as£¹Equ®
(
g‘_·ym’t_com¶‘e_u¾
(
Œª§ùiÚ
, 
mocked_»que¡
),

54 
ex³ùed_u¾
)

56 
	gmocked_tok’
.
	$as£¹_ÿÎed_Úû_w™h
(
Œª§ùiÚ
)

58 
def
 
	$‹¡_g‘_Œª§ùiÚ_äom_tok’
(
£lf
):

59 
Œª§ùiÚ
 = 
	$T¿n§ùiÚFaùÜy
()

61 
mocked_v›w
 = 
	$MagicMock
()

62 
tok’
 = 
	$_g‘_jwt_tok’
(
Œª§ùiÚ
)

64 
£lf
.
	`as£¹Equ®s
(
	$g‘_Œª§ùiÚ_äom_tok’
(
mocked_v›w
)(
NÚe
, 
tok’
),

65 
	$mocked_v›w
())

66 
mocked_v›w
.
	`has_ÿÎs
([
	`ÿÎ
(
NÚe
, 
Œª§ùiÚ
, 
F®£
), call()])

68 
def
 
	$‹¡_g‘_Œª§ùiÚ_äom_expœed_tok’
(
£lf
):

69 
Œª§ùiÚ
 = 
	$T¿n§ùiÚFaùÜy
()

71 
mocked_v›w
 = 
	$MagicMock
()

72 
w™h
 
	`·tch
('sv”.uts.·ym’ts.d©‘ime'è
as
 
mocked_d©‘ime
:

73 
mocked_d©‘ime
.
utúow
.
»tuº_v®ue
 = 
d©‘ime
.
	`utúow
(è- 
	$timed–
(
days
=2 * 365)

74 
tok’
 = 
	$_g‘_jwt_tok’
(
Œª§ùiÚ
)

76 
£lf
.
	`as£¹Equ®s
(
	$g‘_Œª§ùiÚ_äom_tok’
(
mocked_v›w
)(
NÚe
, 
tok’
),

77 
	$mocked_v›w
())

78 
mocked_v›w
.
	`has_ÿÎs
([
	`ÿÎ
(
NÚe
, 
Œª§ùiÚ
, 
True
), call()])

80 @
	`ov”ride_£‰šgs
(
PAYMENT_METHOD_SECRET
='a')

81 @
	`ov”ride_£‰šgs
(
SILVER_PAYMENT_TOKEN_EXPIRATION
=
	$timed–
(
mšu‹s
=1))

82 
def
 
	$‹¡_g‘_jwt_tok’
(
£lf
):

83 
uuid
 = 
	`UUID
('6ç459—-“8a-3ÿ4-894e-db77e160355e', 
v”siÚ
=4)

84 
Œª§ùiÚ
 = 
	$T¿n§ùiÚFaùÜy
(
uuid
=uuid)

86 
ex³ùed_tok’
 = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0cmFuc2FjdG' \

90 
w™h
 
	`·tch
('sv”.uts.·ym’ts.d©‘ime'è
as
 
mocked_d©‘ime
:

91 
mocked_d©‘ime
.
utúow
.
»tuº_v®ue
 = 
d©‘ime
.
	`¡½time
('Jun 20 2017 1:33PM',

93 
£lf
.
	`as£¹Equ®s
(
	`_g‘_jwt_tok’
(
Œª§ùiÚ
), 
ex³ùed_tok’
)

	@silver/tests/unit/test_proforma.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
äom
 
decim®
 
impÜt
 
Decim®


18 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
Te¡Ca£


20 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gDocum’tEÁry
, 
	gInvoiû
, 
ProfÜma


21 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
impÜt
 
	gProfÜmaFaùÜy
, 
	gDocum’tEÁryFaùÜy
, \

22 
Cu¡om”FaùÜy


25 
şass
 
	$Te¡ProfÜma
(
Te¡Ca£
):

26 
def
 
	$‹¡_·y_´ofÜma_»Ï‹d_švoiû_¡©e_chªge_to_·id
(
£lf
):

27 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

28 
´ofÜma
.
	$issue
()

29 
´ofÜma
.
	$ü—‹_švoiû
()

31 
´ofÜma
.
	$·y
()

33 
as£¹
 
´ofÜma
.
»Ï‹d_docum’t
.
¡©e
 =ğ
Invoiû
.
STATES
.
PAID


34 
as£¹
 
´ofÜma
.
¡©e
 =ğ
Invoiû
.
STATES
.
PAID


36 
def
 
	$‹¡_şÚe_´ofÜma_što_d¿á
(
£lf
):

37 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

38 
´ofÜma
.
	$issue
()

39 
´ofÜma
.
	$·y
()

41 
’Œ›s
 = 
Docum’tEÁryFaùÜy
.
	$ü—‹_b©ch
(3)

42 
´ofÜma
.
´ofÜma_’Œ›s
.
	$add
(*
’Œ›s
)

44 
şÚe
 = 
´ofÜma
.
	$şÚe_što_d¿á
()

46 
as£¹
 
şÚe
.
¡©e
 =ğ
ProfÜma
.
STATES
.
DRAFT


47 
as£¹
 
şÚe
.
·id_d©e
 
is
 
NÚe


48 
as£¹
 
şÚe
.
issue_d©e
 
is
 
NÚe


49 
as£¹
 
şÚe
.
»Ï‹d_docum’t
 
is
 
NÚe


50 
	`as£¹
 (
şÚe
.
£r›s
 !ğ
´ofÜma
.£r› 
Ü


51 
şÚe
.
numb”
 !ğ
´ofÜma
.number)

52 
as£¹
 
şÚe
.
§Ës_x_³rûÁ
 =ğ
´ofÜma
.sales_tax_percent

53 
as£¹
 
şÚe
.
§Ës_x_Çme
 =ğ
´ofÜma
.sales_tax_name

55 
as£¹
 
nÙ
 
şÚe
.
¬chived_cu¡om”


56 
as£¹
 
nÙ
 
şÚe
.
¬chived_´ovid”


57 
as£¹
 
şÚe
.
cu¡om”
 =ğ
´ofÜma
.customer

58 
as£¹
 
şÚe
.
´ovid”
 =ğ
´ofÜma
.provider

60 
as£¹
 
şÚe
.
cu¼’cy
 =ğ
´ofÜma
.currency

61 
as£¹
 
şÚe
.
_Ï¡_¡©e
 =ğşÚe.
¡©e


62 
as£¹
 
şÚe
.
pk
 !ğ
´ofÜma
.pk

63 
as£¹
 
şÚe
.
id
 !ğ
´ofÜma
.id

64 
as£¹
 
nÙ
 
şÚe
.
pdf


66 
as£¹
 
şÚe
.
´ofÜma_’Œ›s
.
	`couÁ
() == 3

67 
as£¹
 
´ofÜma
.
´ofÜma_’Œ›s
.
	`couÁ
() == 3

69 
’Œy_f›lds
 = [
’Œy
.
Çme
 ’Œy 
š
 
Docum’tEÁry
.
_m‘a
.
	`g‘_f›lds
()]

70 
şÚe_’Œy
, 
Üigš®_’Œy
 
š
 
	`z
(
şÚe
.
´ofÜma_’Œ›s
.
	`®l
(),

71 
´ofÜma
.
´ofÜma_’Œ›s
.
	$®l
()):

72 
’Œy
 
š
 
’Œy_f›lds
:

73 
’Œy
 
nÙ
 
	`š
 ('id', 'proforma', 'invoice'):

74 
as£¹
 
	`g‘©Œ
(
şÚe_’Œy
, 
’Œy
) == \

75 
	$g‘©Œ
(
Üigš®_’Œy
, 
’Œy
)

77 
as£¹
 
´ofÜma
.
¡©e
 =ğ
ProfÜma
.
STATES
.
PAID


79 
def
 
	$‹¡_ÿnûl_issued_´ofÜma_w™h_»Ï‹d_švoiû
(
£lf
):

80 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

81 
´ofÜma
.
	$issue
()

83 
nÙ
 
´ofÜma
.
»Ï‹d_docum’t
:

84 
´ofÜma
.
	$ü—‹_švoiû
()

86 
´ofÜma
.
	$ÿnûl
()

88 
as£¹
 
´ofÜma
.
¡©e
 =ğ´ofÜma.
»Ï‹d_docum’t
.¡©=ğ
ProfÜma
.
STATES
.
CANCELED


90 
def
 
	$_g‘_decim®_¶aûs
(
£lf
, 
numb”
):

91  
	`max
(0, -
numb”
.
	`as_tu¶e
().
expÚ’t
)

93 
def
 
	$‹¡_´ofÜma_tÙ®_decim®_pošts
(
£lf
):

94 
´ofÜma_’Œ›s
 = 
Docum’tEÁryFaùÜy
.
	$ü—‹_b©ch
(3)

95 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ofÜma_’Œ›s
=proforma_entries)

97 
as£¹
 
£lf
.
	`_g‘_decim®_¶aûs
(
´ofÜma
.
tÙ®
) == 2

99 
def
 
	$‹¡_´ofÜma_tÙ®_befÜe_x_decim®_¶aûs
(
£lf
):

100 
´ofÜma_’Œ›s
 = 
Docum’tEÁryFaùÜy
.
	$ü—‹_b©ch
(3)

101 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ofÜma_’Œ›s
=proforma_entries)

103 
´ofÜma
.
§Ës_x_³rûÁ
 = 
	`Decim®
('20.00')

105 
as£¹
 
£lf
.
	`_g‘_decim®_¶aûs
(
´ofÜma
.
tÙ®_befÜe_x
) == 2

107 
def
 
	$‹¡_´ofÜma_x_v®ue_decim®_¶aûs
(
£lf
):

108 
´ofÜma_’Œ›s
 = 
Docum’tEÁryFaùÜy
.
	$ü—‹_b©ch
(3)

109 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ofÜma_’Œ›s
=proforma_entries)

111 
´ofÜma
.
§Ës_x_³rûÁ
 = 
	`Decim®
('20.00')

113 
as£¹
 
£lf
.
	`_g‘_decim®_¶aûs
(
´ofÜma
.
x_v®ue
) == 2

115 
def
 
	$‹¡_´ofÜma_tÙ®_w™h_x_š‹gr™y
(
£lf
):

116 
´ofÜma_’Œ›s
 = 
Docum’tEÁryFaùÜy
.
	$ü—‹_b©ch
(5)

117 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
´ofÜma_’Œ›s
=proforma_entries)

119 
´ofÜma
.
§Ës_x_³rûÁ
 = 
	`Decim®
('20.00')

121 
as£¹
 
´ofÜma
.
tÙ®
 =ğ´ofÜma.
tÙ®_befÜe_x
 +…rofÜma.
x_v®ue


123 
def
 
	$‹¡_d¿á_´ofÜma_£r›s_numb”
(
£lf
):

124 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
()

125 
´ofÜma
.
numb”
 = 
NÚe


127 
as£¹
 
´ofÜma
.
£r›s_numb”
 =ğ'%s-d¿á-id:%d' % (´ofÜma.
£r›s
,

128 
´ofÜma
.
pk
)

130 
´ofÜma
.
£r›s
 = 
NÚe


132 
as£¹
 
´ofÜma
.
£r›s_numb”
 =ğ'd¿á-id:%d' %…rofÜma.
pk


134 
def
 
	$‹¡_issues_´ofÜma_£r›s_numb”
(
£lf
):

135 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
¡©e
=
Invoiû
.
STATES
.
ISSUED
)

137 
as£¹
 
´ofÜma
.
£r›s_numb”
 =ğ'%s-%s' % (´ofÜma.
£r›s
,

138 
´ofÜma
.
numb”
)

140 
def
 
	$‹¡_cu¡om”_cu¼’cy_u£d_fÜ_Œª§ùiÚ_cu¼’cy
(
£lf
):

141 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	`ü—‹
(
cu¼’cy
='EUR')

142 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	$ü—‹
(
cu¡om”
=customer,

143 
Œª§ùiÚ_cu¼’cy
=
NÚe
)

145 
£lf
.
	`as£¹Equ®
(
´ofÜma
.
Œª§ùiÚ_cu¼’cy
, 'EUR')

147 
def
 
	$‹¡_´ofÜma_cu¼’cy_u£d_fÜ_Œª§ùiÚ_cu¼’cy
(
£lf
):

148 
cu¡om”
 = 
Cu¡om”FaùÜy
.
	$ü—‹
(
cu¼’cy
=
NÚe
)

149 
´ofÜma
 = 
ProfÜmaFaùÜy
.
	`ü—‹
(
cu¡om”
=customer,

150 
cu¼’cy
='EUR',

151 
Œª§ùiÚ_cu¼’cy
=
NÚe
)

153 
£lf
.
	`as£¹Equ®
(
´ofÜma
.
Œª§ùiÚ_cu¼’cy
, 'EUR')

	@silver/tests/unit/test_subscription.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

16 
impÜt
 
d©‘ime


18 
äom
 
	gdjªgo
.
‹¡
 
impÜt
 
Te¡Ca£


19 
äom
 
ä“zegun
 
impÜt
 
ä“ze_time


20 
äom
 
mock
 
impÜt
 
	g·tch
, 
	gPrİ”tyMock
, 
MagicMock


22 
äom
 
	gsv”
.
mod–s
 
impÜt
 
	gPÏn
, 
	gSubsütiÚ
, 
BlšgLog


23 
äom
 
	gsv”
.
	g‹¡s
.
çùÜ›s
 
	$impÜt
 (
SubsütiÚFaùÜy
, 
M‘”edF—tu»FaùÜy
,

24 
PÏnFaùÜy
)

27 
şass
 
	$Te¡SubsütiÚ
(
Te¡Ca£
):

28 
def
 
	$‹¡_subsütiÚ_mf_un™s_log_š‹rv®s_1
(
£lf
):

29 #Ev”y 
mÚth
, 16 
days
 
of
 
ŒŸl


31 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

32 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

34 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

36 
subsütiÚ
.
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=17)

37 
subsütiÚ
.
	$aùiv©e
()

38 
subsütiÚ
.
	$§ve
()

40 
subsütiÚ
.
¶ª
.
š‹rv®
 = 
PÏn
.
INTERVALS
.
MONTH


41 
subsütiÚ
.
¶ª
.
š‹rv®_couÁ
 = 1

42 
subsütiÚ
.
¶ª
.
	$§ve
()

43 
subsütiÚ
.
¶ª
.
£·¿‹_cyşes_duršg_ŒŸl
 = 
True


45 
subsütiÚ
.
ŒŸl_’d
 = (subsütiÚ.
¡¬t_d©e
 +

46 
d©‘ime
.
	$timed–
(
days
=15))

48 
¡¬t_d©e
 = 
subsütiÚ
.start_date

49 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

50 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=17))

52 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=28)

53 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

54 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=23))

56 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=3, 
day
=1)

57 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

58 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=3, 
day
=1))

60 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=3, 
day
=4)

61 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

62 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=3, 
day
=1))

64 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=3, 
day
=5)

65 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

66 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=3, 
day
=5))

68 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=3, 
day
=31)

69 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

70 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=3, 
day
=22))

72 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=4, 
day
=1)

73 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

74 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=4, 
day
=5))

76 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=4, 
day
=30)

77 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

78 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=4, 
day
=22))

80 
def
 
	$‹¡_subsütiÚ_mf_un™s_log_š‹rv®s_2
(
£lf
):

81 #Ev”y 2 
mÚths
, 5 mÚth 
of
 
	`ŒŸl
 (2015-05-30)

83 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

84 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

86 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

88 
subsütiÚ
.
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=17)

89 
subsütiÚ
.
	$aùiv©e
()

90 
subsütiÚ
.
	$§ve
()

92 
subsütiÚ
.
¶ª
.
š‹rv®
 = 
PÏn
.
INTERVALS
.
MONTH


93 
subsütiÚ
.
¶ª
.
š‹rv®_couÁ
 = 2

94 
subsütiÚ
.
¶ª
.
£·¿‹_cyşes_duršg_ŒŸl
 = 
True


95 
subsütiÚ
.
¶ª
.
	$§ve
()

97 
subsütiÚ
.
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2014, 
mÚth
=12, 
day
=31)

98 
subsütiÚ
.
ŒŸl_’d
 = (subsütiÚ.
¡¬t_d©e
 +

99 
d©‘ime
.
	$timed–
(
days
=150))

100 
subsütiÚ
.
	$§ve
()

102 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2014, 
mÚth
=12, 
day
=31)

103 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

104 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2014, 
mÚth
=12, 
day
=31))

106 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2014, 
mÚth
=12, 
day
=31)

107 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

108 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2014, 
mÚth
=12, 
day
=31))

110 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=1, 
day
=1)

111 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

112 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=1, 
day
=1))

114 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=1, 
day
=31)

115 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

116 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=1, 
day
=1))

118 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=3, 
day
=1)

119 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

120 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=3, 
day
=23))

122 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=4, 
day
=30)

123 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

124 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=4, 
day
=30))

126 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=1)

127 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

128 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=23))

130 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=30)

131 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

132 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=30))

134 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=1)

135 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

136 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=1))

138 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=30)

139 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

140 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=1))

142 
def
 
	$‹¡_subsütiÚ_mf_un™s_log_š‹rv®s_3
(
£lf
):

143 #Ev”y 2 
w“ks
, 8 
days
 
of
 
ŒŸl


145 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

146 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

148 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

150 
subsütiÚ
.
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=17)

151 
subsütiÚ
.
	$aùiv©e
()

152 
subsütiÚ
.
	$§ve
()

154 
subsütiÚ
.
¶ª
.
š‹rv®
 = 
PÏn
.
INTERVALS
.
WEEK


155 
subsütiÚ
.
¶ª
.
š‹rv®_couÁ
 = 2

156 
subsütiÚ
.
¶ª
.
£·¿‹_cyşes_duršg_ŒŸl
 = 
True


157 
subsütiÚ
.
¶ª
.
	$§ve
()

159 
subsütiÚ
.
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=31)

160 
subsütiÚ
.
ŒŸl_’d
 = (subsütiÚ.
¡¬t_d©e
 +

161 
d©‘ime
.
	$timed–
(
days
=7))

162 
subsütiÚ
.
	$§ve
()

164 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=31)

165 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

166 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=31))

168 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=31)

169 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

170 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=31))

172 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=1)

173 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

174 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=1))

176 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=7)

177 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

178 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=1))

180 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=8)

181 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

182 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=8))

184 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=14)

185 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

186 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=8))

188 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=15)

189 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

190 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=15))

192 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=28)

193 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

194 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=28))

196 
def
 
	$‹¡_subsütiÚ_mf_un™s_log_š‹rv®s_4
(
£lf
):

197 #Ev”y 
y—r
, 3 
	`mÚths
 (90 
days
è
of
 
ŒŸl


199 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

200 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

202 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

204 
subsütiÚ
.
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=17)

205 
subsütiÚ
.
	$aùiv©e
()

206 
subsütiÚ
.
	$§ve
()

208 
subsütiÚ
.
¶ª
.
š‹rv®
 = 
PÏn
.
INTERVALS
.
YEAR


209 
subsütiÚ
.
¶ª
.
š‹rv®_couÁ
 = 1

210 
subsütiÚ
.
¶ª
.
	$§ve
()

212 
subsütiÚ
.
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=2)

213 
subsütiÚ
.
ŒŸl_’d
 = (subsütiÚ.
¡¬t_d©e
 +

214 
d©‘ime
.
	$timed–
(
days
=90))

215 
subsütiÚ
.
	$§ve
()

217 
¡¬t_d©e
 = 
subsütiÚ
.start_date

218 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

219 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=2)

222 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=3)

223 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

224 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=2))

226 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=4)

227 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

228 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=4))

230 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=12, 
day
=31)

231 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

232 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=5))

234 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2016, 
mÚth
=1, 
day
=1)

235 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	`buck‘_¡¬t_d©e
(

236 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2016, 
mÚth
=1, 
day
=1))

238 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2016, 
mÚth
=12, 
day
=31)

239 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	`buck‘_’d_d©e
(

240 
»ã»nû_d©e
=
d©‘ime
.
	$d©e
(
y—r
=2016, 
mÚth
=12, 
day
=31))

242 
def
 
	$‹¡_subsütiÚ_blšg_cyşe_š‹rv®s_1
(
£lf
):

244 
Ev”y
 
mÚth
, 16 
days
 
of
 
ŒŸl


245 
£·¿‹_cyşes_duršg_ŒŸl
 = 
True


246 
g’”©e_docum’ts_Ú_ŒŸl_’d
 = 
F®£


249 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

250 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

252 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

254 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=17)

256 
subsütiÚ
.
¡¬t_d©e
 = start_date

257 
subsütiÚ
.
ŒŸl_’d
 = (subsütiÚ.
¡¬t_d©e
 +

258 
d©‘ime
.
	$timed–
(
days
=15))

259 
subsütiÚ
.
	$aùiv©e
()

260 
subsütiÚ
.
	$§ve
()

262 
subsütiÚ
.
¶ª
.
š‹rv®
 = 
PÏn
.
INTERVALS
.
MONTH


263 
subsütiÚ
.
¶ª
.
š‹rv®_couÁ
 = 1

264 
subsütiÚ
.
¶ª
.
£·¿‹_cyşes_duršg_ŒŸl
 = 
True


265 
subsütiÚ
.
¶ª
.
g’”©e_docum’ts_Ú_ŒŸl_’d
 = 
F®£


266 
subsütiÚ
.
¶ª
.
	$§ve
()

268 
»ã»nû_d©e
 = 
¡¬t_d©e


269 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

271 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=28)

272 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

274 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=3, 
day
=1)

275 
»ã»nû_d©e
 = 
¡¬t_d©e


276 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

278 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=3, 
day
=31)

279 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

281 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=4, 
day
=1)

282 
»ã»nû_d©e
 = 
¡¬t_d©e


283 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

285 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=4, 
day
=30)

286 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

288 
def
 
	$‹¡_subsütiÚ_blšg_cyşe_š‹rv®s_2
(
£lf
):

290 
Ev”y
 2 
mÚths
, 150 
days
 
of
 
	`ŒŸl
 (2015-05-30)

291 
£·¿‹_cyşes_duršg_ŒŸl
 = 
True


292 
g’”©e_docum’ts_Ú_ŒŸl_’d
 = 
True


295 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

296 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

298 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

300 
subsütiÚ
.
¶ª
.
š‹rv®
 = 
PÏn
.
INTERVALS
.
MONTH


301 
subsütiÚ
.
¶ª
.
š‹rv®_couÁ
 = 2

302 
subsütiÚ
.
¶ª
.
£·¿‹_cyşes_duršg_ŒŸl
 = 
True


303 
subsütiÚ
.
¶ª
.
g’”©e_docum’ts_Ú_ŒŸl_’d
 = 
True


304 
subsütiÚ
.
¶ª
.
	$§ve
()

306 
subsütiÚ
.
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2014, 
mÚth
=12, 
day
=31)

307 
subsütiÚ
.
ŒŸl_’d
 = (subsütiÚ.
¡¬t_d©e
 +

308 
d©‘ime
.
	$timed–
(
days
=150))

309 
subsütiÚ
.
	$aùiv©e
()

310 
subsütiÚ
.
	$§ve
()

312 
¡¬t_d©e
 = 
subsütiÚ
.start_date

313 
»ã»nû_d©e
 = 
¡¬t_d©e


314 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

316 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2014, 
mÚth
=12, 
day
=31)

317 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

319 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=1, 
day
=1)

320 
»ã»nû_d©e
 = 
¡¬t_d©e


321 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

323 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=28)

324 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

326 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=3, 
day
=1)

327 
»ã»nû_d©e
 = 
¡¬t_d©e


328 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

330 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=4, 
day
=30)

331 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

333 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=1)

334 
»ã»nû_d©e
 = 
¡¬t_d©e


335 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

337 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=30è#ŒŸÈ
’d


338 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

340 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=31)

341 
»ã»nû_d©e
 = 
¡¬t_d©e


342 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

344 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=30è#»®igÃd 
to
 
š™Ÿl
 
®ignm’t


345 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

347 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=7, 
day
=1)

348 
»ã»nû_d©e
 = 
¡¬t_d©e


349 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

351 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=8, 
day
=31)

352 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

354 
def
 
	$‹¡_subsütiÚ_blšg_cyşe_š‹rv®s_3
(
£lf
):

356 
Ev”y
 2 
w“ks
, 8 
days
 
of
 
ŒŸl


357 
£·¿‹_cyşes_duršg_ŒŸl
 = 
True


358 
g’”©e_docum’ts_Ú_ŒŸl_’d
 = 
True


361 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

362 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

364 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

366 
subsütiÚ
.
¶ª
.
š‹rv®
 = 
PÏn
.
INTERVALS
.
WEEK


367 
subsütiÚ
.
¶ª
.
š‹rv®_couÁ
 = 2

368 
subsütiÚ
.
¶ª
.
£·¿‹_cyşes_duršg_ŒŸl
 = 
True


369 
subsütiÚ
.
¶ª
.
g’”©e_docum’ts_Ú_ŒŸl_’d
 = 
True


370 
subsütiÚ
.
¶ª
.
	$§ve
()

372 
subsütiÚ
.
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=31)

373 
subsütiÚ
.
ŒŸl_’d
 = (subsütiÚ.
¡¬t_d©e
 +

374 
d©‘ime
.
	$timed–
(
days
=7))

375 
subsütiÚ
.
	$aùiv©e
()

376 
subsütiÚ
.
	$§ve
()

378 
¡¬t_d©e
 = 
subsütiÚ
.start_date

379 
»ã»nû_d©e
 = 
¡¬t_d©e


380 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

382 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=5, 
day
=31è#blšg 
cyşe
 
®ignm’t


383 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

385 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=1)

386 
»ã»nû_d©e
 = 
¡¬t_d©e


387 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

389 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=7è#ŒŸÈ
’d


390 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

392 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=8)

393 
»ã»nû_d©e
 = 
¡¬t_d©e


394 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

396 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=14è#cyş
»®ignm’t
 
aá”
 
ŒŸl


397 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

399 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=15)

400 
»ã»nû_d©e
 = 
¡¬t_d©e


401 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

403 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=6, 
day
=28)

404 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

406 
def
 
	$‹¡_subsütiÚ_blšg_cyşe_š‹rv®s_4
(
£lf
):

408 
Ev”y
 
y—r
, 90 
days
 
of
 
ŒŸl


409 
£·¿‹_cyşes_duršg_ŒŸl
 = 
True


410 
g’”©e_docum’ts_Ú_ŒŸl_’d
 = 
F®£


413 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	$ü—‹
()

414 
m‘”ed_ã©u»
 = 
M‘”edF—tu»FaùÜy
.
	$ü—‹
()

416 
subsütiÚ
.
¶ª
.
m‘”ed_ã©u»s
.
	$add
(
m‘”ed_ã©u»
)

418 
subsütiÚ
.
¶ª
.
š‹rv®
 = 
PÏn
.
INTERVALS
.
YEAR


419 
subsütiÚ
.
¶ª
.
š‹rv®_couÁ
 = 1

420 
subsütiÚ
.
¶ª
.
£·¿‹_cyşes_duršg_ŒŸl
 = 
True


421 
subsütiÚ
.
¶ª
.
g’”©e_docum’ts_Ú_ŒŸl_’d
 = 
F®£


422 
subsütiÚ
.
¶ª
.
	$§ve
()

424 
subsütiÚ
.
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=2, 
day
=2)

425 
subsütiÚ
.
ŒŸl_’d
 = (subsütiÚ.
¡¬t_d©e
 +

426 
d©‘ime
.
	$timed–
(
days
=90))

427 
subsütiÚ
.
	$aùiv©e
()

428 
subsütiÚ
.
	$§ve
()

430 
¡¬t_d©e
 = 
subsütiÚ
.start_date

431 
»ã»nû_d©e
 = 
¡¬t_d©e


432 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

434 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2015, 
mÚth
=12, 
day
=31)

435 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

437 
¡¬t_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2016, 
mÚth
=1, 
day
=1)

438 
»ã»nû_d©e
 = 
¡¬t_d©e


439 
as£¹
 
¡¬t_d©e
 =ğ
subsütiÚ
.
	$cyşe_¡¬t_d©e
(
»ã»nû_d©e
)

441 
’d_d©e
 = 
d©‘ime
.
	$d©e
(
y—r
=2016, 
mÚth
=12, 
day
=31)

442 
as£¹
 
’d_d©e
 =ğ
subsütiÚ
.
	$cyşe_’d_d©e
(
»ã»nû_d©e
)

445 
şass
 
	$Te¡SubsütiÚShouldBeBËd
(
Te¡Ca£
):

447 
	$NOTE
 (
impÜÁ
 
abb»vŸtiÚs
):

448 * 
sbb
 = 
should_be_bËd


449 * 
w
 = 
w™h


450 * 
wa
 = 
w™hout


451 * 
cb
 = 
cÚsŞid©ed
 
blšg


454 
def
 
	$‹¡_sub_ÿnûËd_©_’d_of_bc_w_cÚsŞid©ed_blšg
(
£lf
):

455 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=120)

456 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

457 
¶ª
=plan,

458 
¡©e
=
SubsütiÚ
.
STATES
.
CANCELED
,

459 
¡¬t_d©e
=
d©‘ime
.
	`d©e
(2015, 8, 22),

460 
ÿnûl_d©e
=
d©‘ime
.
	$d©e
(2015, 9, 1)

462 
cÜ»ù_blšg_d©e
 = 
d©‘ime
.
	$d©e
(2015, 9, 2)

463 
šcÜ»ù_blšg_d©e
 = 
d©‘ime
.
	$d©e
(2015, 8, 22)

465 
Œue_´İ”ty
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
True
)

466 
w™h
 
·tch
.
	$muÉË
(

467 
SubsütiÚ
,

468 
_has_exi¡šg_cu¡om”_w™h_cÚsŞid©ed_blšg
=
Œue_´İ”ty


470 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e
è
is
 
True


471 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
šcÜ»ù_blšg_d©e
è
is
 
F®£


473 
def
 
	$‹¡_sub_ÿnûËd_now_w_cÚsŞid©ed_blšg
(
£lf
):

474 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=120)

475 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

476 
¶ª
=plan,

477 
¡©e
=
SubsütiÚ
.
STATES
.
CANCELED
,

478 
¡¬t_d©e
=
d©‘ime
.
	`d©e
(2015, 8, 10),

479 
ÿnûl_d©e
=
d©‘ime
.
	$d©e
(2015, 8, 22)

481 
blšg_d©e_1
 = 
d©‘ime
.
	$d©e
(2015, 9, 1)

482 
blšg_d©e_2
 = 
d©‘ime
.
	$d©e
(2015, 8, 23)

484 
Œue_´İ”ty
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
True
)

485 
w™h
 
·tch
.
	$muÉË
(

486 
SubsütiÚ
,

487 
_has_exi¡šg_cu¡om”_w™h_cÚsŞid©ed_blšg
=
Œue_´İ”ty


489 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
blšg_d©e_1
è
is
 
True


490 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
blšg_d©e_2
è
is
 
True


492 
def
 
	$‹¡_ÿnûËd_sub_wa_cÚsŞid©ed_blšg
(
£lf
):

493 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=120)

494 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

495 
¶ª
=plan,

496 
¡©e
=
SubsütiÚ
.
STATES
.
CANCELED
,

497 
¡¬t_d©e
=
d©‘ime
.
	`d©e
(2015, 8, 10),

498 
ÿnûl_d©e
=
d©‘ime
.
	$d©e
(2015, 8, 22)

500 
cÜ»ù_blšg_d©e
 = 
d©‘ime
.
	$d©e
(2015, 8, 23)

502 
çl£_´İ”ty
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
F®£
)

503 
w™h
 
·tch
.
	$muÉË
(

504 
SubsütiÚ
,

505 
_has_exi¡šg_cu¡om”_w™h_cÚsŞid©ed_blšg
=
çl£_´İ”ty


507 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e
è
is
 
True


509 
def
 
	$‹¡_ÿnûËd_sub_w_d©e_befÜe_ÿnûl_d©e
(
£lf
):

510 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=120)

511 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

512 
¶ª
=plan,

513 
¡©e
=
SubsütiÚ
.
STATES
.
CANCELED
,

514 
ÿnûl_d©e
=
d©‘ime
.
	`d©e
(2015, 8, 22),

515 
¡¬t_d©e
=
d©‘ime
.
	$d©e
(2015, 8, 1)

517 
šcÜ»ù_blšg_d©e
 = 
d©‘ime
.
	$d©e
(2015, 8, 10)

519 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
šcÜ»ù_blšg_d©e
è
is
 
F®£


521 
def
 
	$‹¡_Ãw_aùive_sub_no_ŒŸl_w_cÚsŞid©ed_blšg
(
£lf
):

522 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=120)

523 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

524 
¶ª
=plan,

525 
¡©e
=
SubsütiÚ
.
STATES
.
ACTIVE
,

526 
¡¬t_d©e
=
d©‘ime
.
	$d©e
(2015, 8, 12)

528 
šcÜ»ù_blšg_d©e
 = 
d©‘ime
.
	$d©e
(2015, 8, 11)

529 
cÜ»ù_blšg_d©e
 = 
d©‘ime
.
	$d©e
(2015, 8, 12)

531 
Œue_´İ”ty
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
True
)

532 
mocked_buck‘_’d_d©e
 = 
	`MagicMock
(

533 
»tuº_v®ue
=
d©‘ime
.
	$d©e
(2015, 8, 31)

535 
w™h
 
·tch
.
	$muÉË
(

536 
SubsütiÚ
,

537 
_has_exi¡šg_cu¡om”_w™h_cÚsŞid©ed_blšg
=
Œue_´İ”ty
,

538 
is_bËd_fœ¡_time
=
Œue_´İ”ty
,

539 
buck‘_’d_d©e
=
mocked_buck‘_’d_d©e
,

541 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e
è
is
 
True


542 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
šcÜ»ù_blšg_d©e
è
is
 
F®£


544 
def
 
	$‹¡_Ãw_aùive_sub_no_ŒŸl_wa_cÚsŞid©ed_blšg
(
£lf
):

545 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=120)

546 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

547 
¶ª
=plan,

548 
¡©e
=
SubsütiÚ
.
STATES
.
ACTIVE
,

549 
¡¬t_d©e
=
d©‘ime
.
	$d©e
(2015, 8, 12)

551 
cÜ»ù_blšg_d©e_1
 = 
d©‘ime
.
	$d©e
(2015, 8, 12)

552 
cÜ»ù_blšg_d©e_2
 = 
d©‘ime
.
	$d©e
(2015, 8, 20)

554 
Œue_´İ”ty
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
True
)

555 
çl£_´İ”ty
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
F®£
)

556 
w™h
 
·tch
.
	$muÉË
(

557 
SubsütiÚ
,

558 
is_bËd_fœ¡_time
=
Œue_´İ”ty
,

559 
_has_exi¡šg_cu¡om”_w™h_cÚsŞid©ed_blšg
=
çl£_´İ”ty
,

561 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e_1
è
is
 
True


562 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e_2
è
is
 
True


564 
def
 
	$‹¡_Ãw_aùive_sub_w™h_sm®Ër_blšg_d©e_thª_¡¬t_d©e
(
£lf
):

565 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=120)

566 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

567 
¶ª
=plan,

568 
¡©e
=
SubsütiÚ
.
STATES
.
ACTIVE
,

569 
¡¬t_d©e
=
d©‘ime
.
	$d©e
(2015, 8, 22)

571 
blšg_d©e
 = 
d©‘ime
.
	$d©e
(2015, 8, 10)

573 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
blšg_d©e
è
is
 
F®£


575 
def
 
	$‹¡_Ãw_aùive_sub_ŒŸl_’d_§me_mÚth_as_¡¬t_d©e_w_cb
(
£lf
):

576 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=100)

577 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

578 
¶ª
=plan,

579 
¡©e
=
SubsütiÚ
.
STATES
.
ACTIVE
,

580 
¡¬t_d©e
=
d©‘ime
.
	`d©e
(2015, 8, 12),

581 
ŒŸl_’d
=
d©‘ime
.
	$d©e
(2015, 8, 26)

583 
cÜ»ù_blšg_d©e_1
 = 
d©‘ime
.
	$d©e
(2015, 9, 1)

584 
cÜ»ù_blšg_d©e_2
 = 
d©‘ime
.
	$d©e
(2015, 8, 12)

585 
šcÜ»ù_blšg_d©e_1
 = 
d©‘ime
.
	$d©e
(2015, 8, 11)

586 
šcÜ»ù_blšg_d©e_2
 = 
d©‘ime
.
	$d©e
(2015, 7, 11)

588 
Œue_´İ”ty
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
True
)

589 
w™h
 
·tch
.
	$muÉË
(

590 
SubsütiÚ
,

591 
is_bËd_fœ¡_time
=
Œue_´İ”ty
,

592 
_has_exi¡šg_cu¡om”_w™h_cÚsŞid©ed_blšg
=
Œue_´İ”ty
,

594 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e_1
è
is
 
True


595 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e_2
è
is
 
True


596 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
šcÜ»ù_blšg_d©e_1
è
is
 
F®£


597 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
šcÜ»ù_blšg_d©e_2
è
is
 
F®£


599 
def
 
	$‹¡_Ãw_aùive_sub_ŒŸl_’d_§me_mÚth_as_¡¬t_d©e_wa_cb
(
£lf
):

600 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=100)

601 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

602 
¶ª
=plan,

603 
¡©e
=
SubsütiÚ
.
STATES
.
ACTIVE
,

604 
¡¬t_d©e
=
d©‘ime
.
	`d©e
(2015, 8, 12),

605 
ŒŸl_’d
=
d©‘ime
.
	$d©e
(2015, 8, 26)

607 
cÜ»ù_blšg_d©e_1
 = 
d©‘ime
.
	$d©e
(2015, 8, 27)

608 
cÜ»ù_blšg_d©e_2
 = 
d©‘ime
.
	$d©e
(2015, 8, 12)

609 
šcÜ»ù_blšg_d©e
 = 
d©‘ime
.
	$d©e
(2015, 8, 11)

611 
Œue_´İ”ty
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
True
)

612 
çl£_´İ”ty
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
F®£
)

613 
mocked_buck‘_’d_d©e
 = 
	`MagicMock
(

614 
»tuº_v®ue
=
d©‘ime
.
	$d©e
(2015, 8, 26)

616 
w™h
 
·tch
.
	$muÉË
(

617 
SubsütiÚ
,

618 
is_bËd_fœ¡_time
=
Œue_´İ”ty
,

619 
_has_exi¡šg_cu¡om”_w™h_cÚsŞid©ed_blšg
=
çl£_´İ”ty
,

620 
buck‘_’d_d©e
=
mocked_buck‘_’d_d©e


622 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e_1
è
is
 
True


623 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e_2
è
is
 
True


624 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
šcÜ»ù_blšg_d©e
è
is
 
F®£


626 
def
 
	$‹¡_Ãw_aùive_sub_ŒŸl_’d_difã»Á_mÚth_äom_¡¬t_d©e_w_cb
(
£lf
):

627 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=100)

628 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

629 
¶ª
=plan,

630 
¡©e
=
SubsütiÚ
.
STATES
.
ACTIVE
,

631 
¡¬t_d©e
=
d©‘ime
.
	`d©e
(2015, 8, 12),

632 
ŒŸl_’d
=
d©‘ime
.
	$d©e
(2015, 9, 12)

634 
cÜ»ù_blšg_d©e_1
 = 
d©‘ime
.
	$d©e
(2015, 9, 1)

635 
cÜ»ù_blšg_d©e_2
 = 
d©‘ime
.
	$d©e
(2015, 8, 12)

636 
šcÜ»ù_blšg_d©e_1
 = 
d©‘ime
.
	$d©e
(2015, 8, 11)

637 
šcÜ»ù_blšg_d©e_2
 = 
d©‘ime
.
	$d©e
(2015, 7, 3)

639 
Œue_´İ”ty
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
True
)

640 
mocked_buck‘_’d_d©e
 = 
	`MagicMock
(

641 
»tuº_v®ue
=
d©‘ime
.
	$d©e
(2015, 8, 31)

643 
w™h
 
·tch
.
	$muÉË
(

644 
SubsütiÚ
,

645 
is_bËd_fœ¡_time
=
Œue_´İ”ty
,

646 
_has_exi¡šg_cu¡om”_w™h_cÚsŞid©ed_blšg
=
Œue_´İ”ty
,

647 
buck‘_’d_d©e
=
mocked_buck‘_’d_d©e


649 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e_1
è
is
 
True


650 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e_2
è
is
 
True


651 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
šcÜ»ù_blšg_d©e_1
è
is
 
F®£


652 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
šcÜ»ù_blšg_d©e_2
è
is
 
F®£


654 
def
 
	$‹¡_®»ady_bËd_sub_w_cb_Ú_ŒŸl_Ï¡_blšg_d©e
(
£lf
):

655 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=100)

656 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

657 
¶ª
=plan,

658 
¡©e
=
SubsütiÚ
.
STATES
.
ACTIVE
,

659 
¡¬t_d©e
=
d©‘ime
.
	`d©e
(2015, 8, 12),

660 
ŒŸl_’d
=
d©‘ime
.
	$d©e
(2015, 9, 12)

662 
cÜ»ù_blšg_d©e_1
 = 
d©‘ime
.
	$d©e
(2015, 10, 1)

663 
cÜ»ù_blšg_d©e_2
 = 
d©‘ime
.
	$d©e
(2015, 9, 12)

664 
cÜ»ù_blšg_d©e_3
 = 
d©‘ime
.
	$d©e
(2015, 8, 12)

665 
šcÜ»ù_blšg_d©e
 = 
d©‘ime
.
	$d©e
(2015, 8, 11)

667 
Œue_´İ”ty
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
True
)

668 
çl£_´İ”ty
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
F®£
)

669 
mocked_Ú_ŒŸl
 = 
	$MagicMock
(
»tuº_v®ue
=
True
)

670 
mocked_Ï¡_blšg_d©e
 = 
	`Prİ”tyMock
(

671 
»tuº_v®ue
=
d©‘ime
.
	$d©e
(2015, 9, 2)

673 
w™h
 
·tch
.
	$muÉË
(

674 
SubsütiÚ
,

675 
is_bËd_fœ¡_time
=
çl£_´İ”ty
,

676 
Ú_ŒŸl
=
mocked_Ú_ŒŸl
,

677 
Ï¡_blšg_d©e
=
mocked_Ï¡_blšg_d©e
,

678 
_has_exi¡šg_cu¡om”_w™h_cÚsŞid©ed_blšg
=
Œue_´İ”ty
,

680 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e_1
è
is
 
True


681 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e_2
è
is
 
True


682 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e_3
è
is
 
True


683 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
šcÜ»ù_blšg_d©e
è
is
 
F®£


685 
def
 
	$‹¡_®»ady_bËd_sub_wa_cb_Ú_ŒŸl_Ï¡_blšg_d©e
(
£lf
):

686 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=100,

687 
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

688 
š‹rv®_couÁ
=1)

689 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

690 
¶ª
=plan,

691 
¡©e
=
SubsütiÚ
.
STATES
.
ACTIVE
,

692 
¡¬t_d©e
=
d©‘ime
.
	`d©e
(2015, 8, 12),

693 
ŒŸl_’d
=
d©‘ime
.
	$d©e
(2015, 9, 12)

695 
cÜ»ù_blšg_d©e
 = 
d©‘ime
.
	$d©e
(2015, 8, 12)

696 
šcÜ»ù_blšg_d©e_1
 = 
d©‘ime
.
	$d©e
(2015, 8, 11)

698 
çl£_´İ”ty
 = 
	$Prİ”tyMock
(
»tuº_v®ue
=
F®£
)

699 
mocked_Ú_ŒŸl
 = 
	$MagicMock
(
»tuº_v®ue
=
True
)

700 
mocked_Ï¡_blšg_d©e
 = 
	`Prİ”tyMock
(

701 
»tuº_v®ue
=
d©‘ime
.
	$d©e
(2015, 9, 2)

703 
mocked_buck‘_’d_d©e
 = 
	`MagicMock
(

704 
»tuº_v®ue
=
d©‘ime
.
	$d©e
(2015, 9, 12)

706 
w™h
 
·tch
.
	$muÉË
(

707 
SubsütiÚ
,

708 
is_bËd_fœ¡_time
=
çl£_´İ”ty
,

709 
Ú_ŒŸl
=
mocked_Ú_ŒŸl
,

710 
Ï¡_blšg_d©e
=
mocked_Ï¡_blšg_d©e
,

711 
_has_exi¡šg_cu¡om”_w™h_cÚsŞid©ed_blšg
=
çl£_´İ”ty
,

712 
buck‘_’d_d©e
=
mocked_buck‘_’d_d©e


714 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e
è
is
 
True


715 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
šcÜ»ù_blšg_d©e_1
è
is
 
F®£


717 
def
 
	$‹¡_®»ady_bËd_sub_wa_cb
(
£lf
):

718 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=100,

719 
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

720 
š‹rv®_couÁ
=1)

721 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

722 
¶ª
=plan,

723 
¡©e
=
SubsütiÚ
.
STATES
.
ACTIVE
,

724 
¡¬t_d©e
=
d©‘ime
.
	$d©e
(2015, 1, 1)

726 
cÜ»ù_blšg_d©e
 = 
d©‘ime
.
	$d©e
(2015, 10, 1)

727 
šcÜ»ù_blšg_d©e_1
 = 
d©‘ime
.
	$d©e
(2015, 9, 3)

728 
šcÜ»ù_blšg_d©e_2
 = 
d©‘ime
.
	$d©e
(2015, 9, 12)

729 
šcÜ»ù_blšg_d©e_3
 = 
d©‘ime
.
	$d©e
(2015, 9, 30)

731 
BlšgLog
.
objeùs
.
	`ü—‹
(
subsütiÚ
=subscription,

732 
blšg_d©e
=
d©‘ime
.
	`d©e
(2015, 9, 2),

733 
¶ª_bËd_up_to
=
d©‘ime
.
	`d©e
(2015, 9, 30),

734 
m‘”ed_ã©u»s_bËd_up_to
=
d©‘ime
.
	$d©e
(2015, 9, 2))

736 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
cÜ»ù_blšg_d©e
è
is
 
True


737 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
šcÜ»ù_blšg_d©e_1
è
is
 
F®£


738 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
šcÜ»ù_blšg_d©e_2
è
is
 
F®£


739 
as£¹
 
subsütiÚ
.
	$should_be_bËd
(
šcÜ»ù_blšg_d©e_3
è
is
 
F®£


741 @
	`ä“ze_time
('2015-01-01')

742 
def
 
	$‹¡_upd©—bË_buck‘s_aùive_subsütiÚ
(
£lf
):

743 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=24 * 60,

744 
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

745 
š‹rv®_couÁ
=1)

746 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

747 
¶ª
=plan,

748 
¡©e
=
SubsütiÚ
.
STATES
.
ACTIVE
,

749 
¡¬t_d©e
=
d©‘ime
.
	$d©e
(2015, 1, 1)

751 
as£¹
 
subsütiÚ
.
	`upd©—bË_buck‘s
() == [

752 {'¡¬t_d©e': 
d©‘ime
.
	`d©e
(2015, 1, 1), '’d_d©e': d©‘ime.d©e(2015, 1, 31)
	}
},

755 @
ä“ze_time
('2015-01-01')

756 
def
 
	$‹¡_upd©—bË_buck‘s_2_mÚths_aùive_subsütiÚ
(
£lf
):

757 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=24 * 60,

758 
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

759 
š‹rv®_couÁ
=1)

760 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

761 
¶ª
=plan,

762 
¡©e
=
SubsütiÚ
.
STATES
.
ACTIVE
,

763 
¡¬t_d©e
=
d©‘ime
.
	$d©e
(2014, 1, 1)

765 
as£¹
 
subsütiÚ
.
	`upd©—bË_buck‘s
() == [

766 {'¡¬t_d©e': 
d©‘ime
.
	`d©e
(2015, 1, 1), '’d_d©e': d©‘ime.d©e(2015, 1, 31)
	}
},

767 {'¡¬t_d©e': 
d©‘ime
.
d©e
(2014, 12, 1), 'end_date': datetime.date(2014, 12, 31)},

770 @
ä“ze_time
('2015-01-01')

771 
def
 
	$‹¡_upd©—bË_buck‘s_2_mÚths_ÿnûËd_subsütiÚ_©_’d_of_mÚth
(
£lf
):

772 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=24 * 60,

773 
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

774 
š‹rv®_couÁ
=1)

775 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

776 
¶ª
=plan,

777 
¡©e
=
SubsütiÚ
.
STATES
.
CANCELED
,

778 
¡¬t_d©e
=
d©‘ime
.
	`d©e
(2015, 1, 1),

779 
ÿnûl_d©e
=
d©‘ime
.
	$d©e
(2015, 1, 31)

781 
as£¹
 
subsütiÚ
.
	`upd©—bË_buck‘s
() == [

782 {'¡¬t_d©e': 
d©‘ime
.
	`d©e
(2015, 1, 1), '’d_d©e': d©‘ime.d©e(2015, 1, 31)
	}
},

785 @
ä“ze_time
('2015-01-01')

786 
def
 
	$‹¡_upd©—bË_buck‘s_2_mÚths_ÿnûËd_subsütiÚ_Ï¡_mÚth
(
£lf
):

787 
¶ª
 = 
PÏnFaùÜy
.
	$ü—‹
(
g’”©e_aá”
=24 * 60,

788 
š‹rv®
=
PÏn
.
INTERVALS
.
MONTH
,

789 
š‹rv®_couÁ
=1)

790 
subsütiÚ
 = 
SubsütiÚFaùÜy
.
	`ü—‹
(

791 
¶ª
=plan,

792 
¡©e
=
SubsütiÚ
.
STATES
.
CANCELED
,

793 
¡¬t_d©e
=
d©‘ime
.
	`d©e
(2014, 1, 1),

794 
ÿnûl_d©e
=
d©‘ime
.
	$d©e
(2014, 12, 31)

796 
as£¹
 
subsütiÚ
.
	`upd©—bË_buck‘s
() == []

	@silver/tests/utils.py

1 
def
 
	$bud_absŞu‹_‹¡_u¾
(
»Ïtive_·th
):

2  'h‰p://‹¡£rv”' + 
»Ïtive_·th


	@silver/urls.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

18 
äom
 
	gdjªgo
.
	gcÚf
.
u¾s
 
impÜt
 
	gšşude
, 
u¾


19 
äom
 
	gdjªgo
.
cÚŒib
 
impÜt
 
admš


21 
äom
 
	gsv”
.
v›ws
 
	$impÜt
 (
·y_Œª§ùiÚ_v›w
, 
com¶‘e_·ym’t_v›w
,

22 
InvoiûAutocom¶‘e
, 
ProfÜmaAutocom¶‘e
,

23 
Paym’tM‘hodAutocom¶‘e
)

25 
admš
.
	$autodiscov”
()

27 
u¾·‰”ns
 = [

28 
	`u¾
(
r
'^admš/', 
	`šşude
(
admš
.
s™e
.
u¾s
)),

29 
	`u¾
(
r
'^­i-auth/', 
	`šşude
('rest_framework.urls',

30 
Çme¥aû
='rest_framework')),

31 
	`u¾
(
r
'', 
	`šşude
('silver.api.urls')),

33 
	`u¾
(
r
'pay/(?P<token>[0-9a-zA-Z-_\.]+)/$',

34 
·y_Œª§ùiÚ_v›w
, 
Çme
='payment'),

35 
	`u¾
(
r
'pay/(?P<token>[0-9a-zA-Z-_\.]+)/complete$',

36 
com¶‘e_·ym’t_v›w
, 
Çme
='payment-complete'),

38 
	`u¾
(
r
'^autocomplete/invoices/$',

39 
InvoiûAutocom¶‘e
.
	`as_v›w
(), 
Çme
='autocomplete-invoice'),

40 
	`u¾
(
r
'^autocomplete/proformas/$',

41 
ProfÜmaAutocom¶‘e
.
	`as_v›w
(), 
Çme
='autocomplete-proforma'),

42 
	`u¾
(
r
'^autocomplete/payment-method/$',

43 
Paym’tM‘hodAutocom¶‘e
.
	`as_v›w
(), 
Çme
='autocomplete-payment-method'),

	@silver/utils/__init__.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

	@silver/utils/dates.py

1 #Cİyrighˆ(
c
è2015 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
d©‘ime
 
impÜt
 
timed–


16 
äom
 
	gd©eut
.
»Ïtived–
 
impÜt
 *

18 
	gONE_DAY
 = 
	$timed–
(
days
=1)

19 
ONE_MONTH
 = 
	$»Ïtived–
(
mÚths
=1)

22 
def
 
	$Ãxt_mÚth
(
d©e
):

23  
d©e
 + 
ONE_MONTH


26 
def
 
	$fœ¡_day_of_mÚth
(
d©e
):

27  
d©e
 + 
	$»Ïtived–
(
day
=1)

30 
def
 
	$Ï¡_day_of_mÚth
(
d©e
):

31  
d©e
 + 
	$»Ïtived–
(
day
=31)

34 
def
 
	$´ev_mÚth
(
d©e
):

35  
d©e
 - 
ONE_MONTH


	@silver/utils/decorators.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

14 
äom
 
uuid
 
impÜt
 
UUID


16 
impÜt
 
jwt


17 
äom
 
	gdjªgo
.
h‰p
 
impÜt
 
H‰p404


19 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


20 
äom
 
	gdjªgo
.
shÜtcuts
 
impÜt
 
g‘_objeù_Ü_404


22 
äom
 
	gsv”
.
	gmod–s
.
Œª§ùiÚs
 
impÜt
 
T¿n§ùiÚ


25 
def
 
	$g‘_Œª§ùiÚ_äom_tok’
(
v›w
):

26 
def
 
	$decÜ©Ü
(
»que¡
, 
tok’
):

27 
Œy
:

28 
expœed
 = 
F®£


29 
Œª§ùiÚ_uuid
 = 
jwt
.
	`decode
(
tok’
,

30 
£‰šgs
.
PAYMENT_METHOD_SECRET
)['transaction']

31 
exû±
 
jwt
.
ExpœedSigÇtu»E¼Ü
:

32 
expœed
 = 
True


33 
Œª§ùiÚ_uuid
 = 
jwt
.
	`decode
(
tok’
, 
£‰šgs
.
PAYMENT_METHOD_SECRET
,

34 
İtiÚs
={'v”ify_exp': 
F®£
})['Œª§ùiÚ']

36 
Œy
:

37 
uuid
 = 
	$UUID
(
Œª§ùiÚ_uuid
, 
v”siÚ
=4)

38 
exû±
 
V®ueE¼Ü
:

39 
¿i£
 
H‰p404


41  
	`v›w
(
»que¡
, 
	`g‘_objeù_Ü_404
(
T¿n§ùiÚ
, 
uuid
=uuid), 
expœed
)

42  
decÜ©Ü


	@silver/utils/international.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
impÜt
 
pycouÁry


17 
	gcouÁr›s
 = 
sÜ‹d
([(
couÁry
.
®pha_2
, couÁry.
Çme
ècouÁry 
š


18 
pycouÁry
.
couÁr›s
])

19 
	gcu¼’c›s
 = 
sÜ‹d
([(
cu¼’cy
.
®pha_3
,

20 
u
'{} ({})'.
	$fÜm©
(
cu¼’cy
.
®pha_3
, cu¼’cy.
Çme
))

21 
cu¼’cy
 
š
 
pycouÁry
.
cu¼’c›s
])

	@silver/utils/models.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
	gdjªgo
.
db
 
impÜt
 
mod–s


16 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


19 
şass
 
	$Un§vedFÜeignKey
(
mod–s
.
FÜeignKey
):

20 
®low_un§ved_š¡ªû_assignm’t
 = 
True


23 
şass
 
	$AutoD©eTimeF›ld
(
mod–s
.
D©eTimeF›ld
):

24 
def
 
	$´e_§ve
(
£lf
, 
mod–_š¡ªû
, 
add
):

25  
timezÚe
.
	`now
()

	@silver/utils/payments.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

14 
äom
 
d©‘ime
 
impÜt
 datetime

16 
impÜt
 
jwt


17 
äom
 
fu¾
 
impÜt
 furl

19 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


20 
äom
 
	g»¡_äamewÜk
.
»v”£
 
impÜt
„everse

23 
def
 
	$_g‘_jwt_tok’
(
Œª§ùiÚ
):

24 
v®id_uÁ
 = 
d©‘ime
.
	`utúow
(è+ 
£‰šgs
.
SILVER_PAYMENT_TOKEN_EXPIRATION


25  
jwt
.
	`’code
({

26 'exp': 
v®id_uÁ
,

27 'Œª§ùiÚ': 
	`¡r
(
Œª§ùiÚ
.
uuid
)

28 
	}
}, 
	g£‰šgs
.
	gPAYMENT_METHOD_SECRET
)

31 
def
 
	$g‘_·ym’t_u¾
(
Œª§ùiÚ
, 
»que¡
):

32 
kw¬gs
 = {'tok’': 
	`¡r
(
	`_g‘_jwt_tok’
(
Œª§ùiÚ
))
	}
}

33  
»v”£
('·ym’t', 
kw¬gs
=kw¬gs, 
»que¡
=request)

36 
def
 
	$g‘_·ym’t_com¶‘e_u¾
(
Œª§ùiÚ
, 
»que¡
):

37 
kw¬gs
 = {'tok’': 
	`¡r
(
	`_g‘_jwt_tok’
(
Œª§ùiÚ
))
	}
}

38 
u¾
 = 
fu¾
(
»v”£
('·ym’t-com¶‘e', 
kw¬gs
=kw¬gs, 
»que¡
=request))

40 
»que¡
 
ªd
 '»tuº_u¾' 
š
„eque¡.
GET
:

41 
u¾
 = u¾.
add
({'»tuº_u¾': 
»que¡
.
GET
['return_url']})

43  
u¾
.url

	@silver/utils/pdf.py

1 
impÜt
 
os


3 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


6 
şass
 
	$UnsuµÜ‹dMedŸP©hExû±iÚ
(
Exû±iÚ
):

7 
·ss


10 
def
 
	$ãtch_»sourûs
(
uri
, 
»l
):

12 
C®lback
 
to
 
®low
 
xhtml2pdf
/
»pÜab
Ø
»Œ›ve
 
Images
,
StyËsh“ts
, 
‘c
.

13 `
uri
` 
is
 
the
 
h»f
 
©Œibu‹
 
äom
h
html
 
lšk
 
–em’t
.

14 `
»l
` 
gives
 
a
 
»Ïtive
 
·th
, 
but
 
™
's‚ot used here.

16 
£‰šgs
.
MEDIA_URL
 
ªd
 
uri
.
	$¡¬tsw™h
(
£‰šgs
.
MEDIA_URL
):

17 
·th
 = 
os
.·th.
	`još
(
£‰šgs
.
MEDIA_ROOT
,

18 
uri
.
	`»¶aû
(
£‰šgs
.
MEDIA_URL
, ""))

19 
–if
 
£‰šgs
.
STATIC_URL
 
ªd
 
uri
.
	$¡¬tsw™h
(
£‰šgs
.
STATIC_URL
):

20 
·th
 = 
os
.·th.
	`još
(
£‰šgs
.
STATIC_ROOT
,

21 
uri
.
	`»¶aû
(
£‰šgs
.
STATIC_URL
, ""))

22 
nÙ
 
os
.
·th
.
	$exi¡s
(
·th
):

23 
d
 
š
 
£‰šgs
.
STATICFILES_DIRS
:

24 
·th
 = 
os
.·th.
	`još
(
d
, 
uri
.
	`»¶aû
(
£‰šgs
.
STATIC_URL
, ""))

25 
os
.
·th
.
	$exi¡s
(
·th
):

27 
–if
 
uri
.
	`¡¬tsw™h
("h‰p://"è
Ü
 uri.startswith("https://"):

28 
·th
 = 
uri


30 
¿i£
 
	`UnsuµÜ‹dMedŸP©hExû±iÚ
('media urls must start with %s or %s' % (

31 
£‰šgs
.
MEDIA_URL
, s‘tšgs.
STATIC_URL
))

33  
·th


	@silver/validators.py

1 #Cİyrighˆ(
c
è2017 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

15 
äom
 
	gdjªgo
.
cÜe
 
impÜt
 
v®id©Üs


16 
äom
 
	gdjªgo
.
	gcÜe
.
exû±iÚs
 
impÜt
 
V®id©iÚE¼Ü


17 
äom
 
	gdjªgo
.
	guts
.
moduË_lßdšg
 
impÜt
 
impÜt_¡ršg


20 
	gv®id©e_»ã»nû
 = 
v®id©Üs
.
RegexV®id©Ü
(

21 
»gex
=
r
'^[^,]*$',

22 
mes§ge
=
u
'Reference must‚ot contain commas.'

	@silver/vendors/__init__.py

	@silver/vendors/redis_server.py

1 
äom
 
»dis
 
impÜt
 
SŒiùRedis


3 
äom
 
	gdjªgo
.
cÚf
 
impÜt
 
£‰šgs


5 
	g»dis
 = 
SŒiùRedis
.
äom_u¾
(

6 
g‘©Œ
(
£‰šgs
, 'CONFIG_SERVER', 'redis://127.0.0.1:6379')

	@silver/views.py

1 #Cİyrighˆ(
c
è2016 
P»s¦abs
 
SRL


2 #
#Liûn£d 
und”
 
the
 
A·che
 
Liûn£
, 
V”siÚ
 2.0 (the "License");

4 #you 
may
 
nÙ
 
u£
 
this
 
fe
 
exû±
 
š
 
com¶Ÿnû
 
w™h
 
the
 
Liûn£
.

5 #You 
may
 
obš
 
a
 
cİy
 
of
 
the
 
Liûn£
 
©


8 #
#UÆes 
»quœed
 
by
 
­¶iÿbË
 
Ïw
 
Ü
 
ag»ed
 
to
 
š
 
wr™šg
, 
soáw¬e


10 #di¡ribu‹d 
und”
 
the
 
Liûn£
 
is
 
di¡ribu‹d
 
Ú
 
ª
 "AS IS" 
BASIS
,

11 #WITHOUT 
WARRANTIES
 
OR
 
CONDITIONS
 
OF
 
ANY
 
KIND
, 
e™h”
 
ex´ess
 
Ü
 
im¶›d
.

12 #S“ 
the
 
Liûn£
 th
¥ecific
 
Ïnguage
 
gov”nšg
 
³rmissiÚs
 
ªd


13 #lim™©iÚ 
und”
 
the
 
Liûn£
.

14 
äom
 
fu¾
 
impÜt
 furl

15 
äom
 
d®
 
impÜt
 
autocom¶‘e


17 
äom
 
	gdjªgo
.
	gdb
.
mod–s
 
impÜt
 
Q


18 
äom
 
	gdjªgo
.
uts
 
impÜt
 
timezÚe


19 
äom
 
	gdjªgo
.
shÜtcuts
 
impÜt
 
	gg‘_objeù_Ü_404
, 
»nd”


20 
äom
 
	gdjªgo
.
	gcÚŒib
.
	gauth
.
decÜ©Üs
 
impÜt
 
logš_»quœed


21 
äom
 
	gdjªgo
.
	gv›ws
.
	gdecÜ©Üs
.
c¤f
 
impÜt
 
c¤f_exem±


22 
äom
 
	gdjªgo
.
h‰p
 
impÜt
 
	gH‰p404
, 
H‰pRe¥Ú£Redœeù


25 
äom
 
	gsv”
.
	gmod–s
.
·ym’t_m‘hods
 
impÜt
 
Paym’tM‘hod


26 
äom
 
	gsv”
.
	gmod–s
.
Œª§ùiÚs
 
impÜt
 
T¿n§ùiÚ


27 
äom
 
	gsv”
.
	gmod–s
.
docum’ts
 
impÜt
 
	gProfÜma
, 
Invoiû


28 
äom
 
	gsv”
.
	gmod–s
.
	gŒª§ùiÚs
.
codes
 
impÜt
 
FAIL_CODES


29 
äom
 
	gsv”
.
·ym’t_´oûssÜs
 
impÜt
 
g‘_š¡ªû


30 
äom
 
	gsv”
.
	guts
.
decÜ©Üs
 
impÜt
 
	gg‘_Œª§ùiÚ_äom_tok’


33 @
logš_»quœed


34 
def
 
	$´ofÜma_pdf
(
»que¡
, 
´ofÜma_id
):

35 
´ofÜma
 = 
	$g‘_objeù_Ü_404
(
ProfÜma
, 
id
=
´ofÜma_id
)

36  
	`H‰pRe¥Ú£Redœeù
(
´ofÜma
.
pdf
.
u¾
)

39 @
logš_»quœed


40 
def
 
	$švoiû_pdf
(
»que¡
, 
švoiû_id
):

41 
švoiû
 = 
	$g‘_objeù_Ü_404
(
Invoiû
, 
id
=
švoiû_id
)

42  
	`H‰pRe¥Ú£Redœeù
(
švoiû
.
pdf
.
u¾
)

45 @
c¤f_exem±


46 @
g‘_Œª§ùiÚ_äom_tok’


47 
def
 
	$com¶‘e_·ym’t_v›w
(
»que¡
, 
Œª§ùiÚ
, 
expœed
=
NÚe
):

48 
Œª§ùiÚ
.
¡©e
 =ğŒª§ùiÚ.
S‹s
.
In™Ÿl
:

49 
·ym’t_´oûssÜ
 = 
	$g‘_š¡ªû
(
Œª§ùiÚ
.
·ym’t_´oûssÜ
)

50 
·ym’t_´oûssÜ
.
	$hªdË_Œª§ùiÚ_»¥Ú£
(
Œª§ùiÚ
, 
»que¡
)

52 '»tuº_u¾' 
š
 
»que¡
.
GET
:

53 
»dœeù_u¾
 = 
	`fu¾
(
»que¡
.
GET
['»tuº_u¾']).
	`add
({

54 'Œª§ùiÚ_uuid': 
Œª§ùiÚ
.
uuid


55 
	}
}).
u¾


56  
	$H‰pRe¥Ú£Redœeù
(
»dœeù_u¾
)

58  
	`»nd”
(
»que¡
, 'transactions/complete_payment.html',

60 'Œª§ùiÚ': 
Œª§ùiÚ
,

61 'docum’t': 
Œª§ùiÚ
.
docum’t
,

62 'ç_d©a': 
FAIL_CODES
.
	`g‘
(
Œª§ùiÚ
.
ç_code
),

63 
	}
})

66 @
	gc¤f_exem±


67 @
g‘_Œª§ùiÚ_äom_tok’


68 
def
 
	$·y_Œª§ùiÚ_v›w
(
»que¡
, 
Œª§ùiÚ
, 
expœed
=
NÚe
):

69 
expœed
:

70  
	`»nd”
(
»que¡
, 'transactions/expired_payment.html',

72 'docum’t': 
Œª§ùiÚ
.
docum’t
,

73 
	}
})

75 
	gŒª§ùiÚ
.
	g¡©e
 !ğ
T¿n§ùiÚ
.
S‹s
.
In™Ÿl
:

76  
»nd”
(
»que¡
, 'transactions/complete_payment.html',

78 'Œª§ùiÚ': 
Œª§ùiÚ
,

79 'docum’t': 
Œª§ùiÚ
.
docum’t
,

80 'ç_d©a': 
FAIL_CODES
.
g‘
(
Œª§ùiÚ
.
ç_code
)

83 
·ym’t_´oûssÜ
 = 
Œª§ùiÚ
.
·ym’t_m‘hod
.
	$g‘_·ym’t_´oûssÜ
()

85 
v›w
 = 
·ym’t_´oûssÜ
.
	$g‘_v›w
(
Œª§ùiÚ
, 
»que¡
)

86 
nÙ
 
v›w
 
Ü
‚Ù 
Œª§ùiÚ
.
ÿn_be_cÚsumed
:

87  
	`»nd”
(
»que¡
, 'transactions/expired_payment.html',

89 'docum’t': 
Œª§ùiÚ
.
docum’t
,

90 
	}
})

92 
	gŒª§ùiÚ
.
	gÏ¡_acûss
 = 
timezÚe
.
	$now
()

93 
Œª§ùiÚ
.
	$§ve
()

95 
Œy
:

96  
	$v›w
(
»que¡
)

97 
exû±
 
NÙIm¶em’‹dE¼Ü
:

98 
¿i£
 
H‰p404


101 
şass
 
	$Docum’tAutocom¶‘e
(
autocom¶‘e
.
S–eù2Qu”yS‘V›w
):

102 
def
 
	$g‘_qu”y£t
(
£lf
):

103 
	`nÙ
 (
£lf
.
»que¡
.
u£r
.
	$is_auth’tiÿ‹d
(è
ªd
 
£lf
.
»que¡
.
u£r
.
is_¡aff
):

104 
¿i£
 
H‰p404


106 
qu”y£t
 = 
£lf
.
mod–
.
objeùs
.
	$®l
()

108 
£lf
.
q
:

109 
q
 = 
£lf
.q.
	`r¥l™
('-')

110 
	`Ën
(
q
) == 2:

111 
qu”y
 = (
	`Q
(
£r›s
=
q
[0]), 
	$Q
(
numb”
=
q
[1]))

113 
qu”y
 = (
	`Q
(
£r›s__i¡¬tsw™h
=
£lf
.
q
) |

114 
	`Q
(
numb”__i¡¬tsw™h
=
£lf
.
q
) |

115 
	`Q
(
cu¡om”__fœ¡_Çme__icÚšs
=
£lf
.
q
) |

116 
	`Q
(
cu¡om”__Ï¡_Çme__icÚšs
=
£lf
.
q
) |

117 
	$Q
(
cu¡om”__com·ny__icÚšs
=
£lf
.
q
))

118 
qu”y£t
 = qu”y£t.
	$f‹r
(
qu”y
)

120  
qu”y£t


123 
şass
 
	$InvoiûAutocom¶‘e
(
Docum’tAutocom¶‘e
):

124 
def
 
	$__š™__
(
£lf
, **
kw¬gs
):

125 
£lf
.
mod–
 = 
Invoiû


127 
	`su³r
(
InvoiûAutocom¶‘e
, 
£lf
).
	$__š™__
(**
kw¬gs
)

130 
şass
 
	$ProfÜmaAutocom¶‘e
(
Docum’tAutocom¶‘e
):

131 
def
 
	$__š™__
(
£lf
, **
kw¬gs
):

132 
£lf
.
mod–
 = 
ProfÜma


134 
	`su³r
(
ProfÜmaAutocom¶‘e
, 
£lf
).
	$__š™__
(**
kw¬gs
)

137 
şass
 
	$Paym’tM‘hodAutocom¶‘e
(
autocom¶‘e
.
S–eù2Qu”yS‘V›w
):

138 
def
 
	$g‘_qu”y£t
(
£lf
):

139 
	`nÙ
 (
£lf
.
»que¡
.
u£r
.
	$is_auth’tiÿ‹d
(è
ªd
 
£lf
.
»que¡
.
u£r
.
is_¡aff
):

140 
¿i£
 
H‰p404


142 
qu”y£t
 = 
Paym’tM‘hod
.
objeùs
.
	$®l
()

144 
£lf
.
q
:

145 
qu”y
 = (
	`Q
(
cu¡om”__fœ¡_Çme__i¡¬tsw™h
=
£lf
.
q
) |

146 
	`Q
(
cu¡om”__Ï¡_Çme__i¡¬tsw™h
=
£lf
.
q
) |

147 
	`Q
(
·ym’t_´oûssÜ__i¡¬tsw™h
=
£lf
.
q
) |

148 
	$Q
(
di¥Ïy_šfo__i¡¬tsw™h
=
£lf
.
q
))

149 
qu”y£t
 = qu”y£t.
	$f‹r
(
qu”y
)

151  
qu”y£t


	@
1
.
1
/usr/include
148
5521
manage.py
settings.py
settings_test.py
setup.py
silver/__init__.py
silver/admin.py
silver/api/__init__.py
silver/api/exceptions.py
silver/api/filters.py
silver/api/pagination.py
silver/api/serializers/__init__.py
silver/api/serializers/billing_entities_serializers.py
silver/api/serializers/common.py
silver/api/serializers/documents_serializers.py
silver/api/serializers/payment_methods_serializers.py
silver/api/serializers/plans_serializer.py
silver/api/serializers/product_codes_serializer.py
silver/api/serializers/subscriptions_serializers.py
silver/api/serializers/transaction_serializers.py
silver/api/urls.py
silver/api/views/__init__.py
silver/api/views/billing_entities_views.py
silver/api/views/documents_views.py
silver/api/views/payment_method_views.py
silver/api/views/plan_views.py
silver/api/views/product_code_views.py
silver/api/views/subscription_views.py
silver/api/views/transaction_views.py
silver/currencies.py
silver/documents_generator.py
silver/management/__init__.py
silver/management/commands/__init__.py
silver/management/commands/execute_transactions.py
silver/management/commands/fetch_transactions_status.py
silver/management/commands/generate_docs.py
silver/management/commands/generate_pdfs.py
silver/management/commands/seed.py
silver/management/commands/tweak_billing_log.py
silver/migrations/0001_initial.py
silver/migrations/0002_auto_20150416_1009.py
silver/migrations/0003_auto_20150417_0634.py
silver/migrations/0004_auto_20150429_1731.py
silver/migrations/0005_auto_20150429_1732.py
silver/migrations/0006_auto_20150430_1457.py
silver/migrations/0007_auto_20150430_1549.py
silver/migrations/0008_auto_20150430_1804.py
silver/migrations/0009_auto_20150717_1428.py
silver/migrations/0031_auto_20170125_1343.py
silver/migrations/0032_auto_20170201_1342.py
silver/migrations/0033_auto_20170203_1540.py
silver/migrations/0034_auto_20170203_1644.py
silver/migrations/0035_auto_20170206_0941.py
silver/migrations/0036_auto_20170514_1627.py
silver/migrations/0037_auto_20170719_1159.py
silver/migrations/0038_auto_20170724_0708.py
silver/migrations/0039_auto_20170811_1101.py
silver/migrations/0040_auto_20170925_0646.py
silver/migrations/0041_auto_20170929_1045.py
silver/migrations/0042_compute_totals_in_document_view.py
silver/migrations/0043_auto_20171113_1048.py
silver/migrations/0044_auto_20171115_1809.py
silver/migrations/__init__.py
silver/models/__init__.py
silver/models/billing_entities/__init__.py
silver/models/billing_entities/base.py
silver/models/billing_entities/customer.py
silver/models/billing_entities/provider.py
silver/models/documents/__init__.py
silver/models/documents/base.py
silver/models/documents/entries.py
silver/models/documents/invoice.py
silver/models/documents/pdf.py
silver/models/documents/proforma.py
silver/models/payment_methods.py
silver/models/plans.py
silver/models/product_codes.py
silver/models/subscriptions.py
silver/models/transactions/__init__.py
silver/models/transactions/codes.py
silver/models/transactions/transaction.py
silver/payment_processors/__init__.py
silver/payment_processors/base.py
silver/payment_processors/forms.py
silver/payment_processors/manual.py
silver/payment_processors/mixins.py
silver/payment_processors/views.py
silver/static/css/skeleton.css
silver/tasks.py
silver/templates/admin/issue_all_customer_documents.html
silver/templates/admin/monthly_totals.html
silver/templates/billing_documents/document_pdf_base.html
silver/templates/billing_documents/entry_description.html
silver/templates/billing_documents/entry_unit.html
silver/templates/billing_documents/invoice_pdf.html
silver/templates/billing_documents/proforma_pdf.html
silver/templates/forms/transaction_form.html
silver/templates/transactions/complete_payment.html
silver/templates/transactions/expired_payment.html
silver/tests/__init__.py
silver/tests/admin/__init__.py
silver/tests/admin/test_invoice.py
silver/tests/admin/test_proforma.py
silver/tests/commands/__init__.py
silver/tests/commands/test_execute_transactions.py
silver/tests/commands/test_generate_docs.py
silver/tests/commands/test_generate_docs_args.py
silver/tests/commands/test_update_transactions_status.py
silver/tests/factories.py
silver/tests/fixtures.py
silver/tests/integration/__init__.py
silver/tests/integration/test_documents_transactions.py
silver/tests/integration/test_transactions_payment_methods.py
silver/tests/spec/__init__.py
silver/tests/spec/test_customer.py
silver/tests/spec/test_documents.py
silver/tests/spec/test_invoice.py
silver/tests/spec/test_metered_feature.py
silver/tests/spec/test_payment_method.py
silver/tests/spec/test_payment_processors.py
silver/tests/spec/test_payments.py
silver/tests/spec/test_plan.py
silver/tests/spec/test_proforma.py
silver/tests/spec/test_provider.py
silver/tests/spec/test_subscription.py
silver/tests/spec/test_transactions.py
silver/tests/spec/util/__init__.py
silver/tests/spec/util/api_get_assert.py
silver/tests/tasks/__init__.py
silver/tests/tasks/test_generate_pdfs.py
silver/tests/unit/__init__.py
silver/tests/unit/test_invoice.py
silver/tests/unit/test_payment_method_serializer.py
silver/tests/unit/test_payments_util.py
silver/tests/unit/test_proforma.py
silver/tests/unit/test_subscription.py
silver/tests/utils.py
silver/urls.py
silver/utils/__init__.py
silver/utils/dates.py
silver/utils/decorators.py
silver/utils/international.py
silver/utils/models.py
silver/utils/payments.py
silver/utils/pdf.py
silver/validators.py
silver/vendors/__init__.py
silver/vendors/redis_server.py
silver/views.py
